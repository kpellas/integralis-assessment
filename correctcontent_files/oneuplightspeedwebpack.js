/*! For license information please see oneuplightspeedwebpack.js.LICENSE.txt */
var __webpack_result__;(()=>{var e=[,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");a.Ov.isActivated("0F025BDE-6561-48CD-8F76-0CB01AFB2B83");const i=new a.OJ("appPageContext")}
,,,(e,t,n)=>{"use strict";n.d(t,{$:()=>$,$b:()=>Ne,A:()=>Y,Ab:()=>de,Ac:()=>ht,B:()=>J,Bb:()=>Be,C:()=>C,Cb:()=>vt,Cc:()=>oe,D:()=>g,Db:()=>$e,Dc:()=>Lt,E:()=>W,Eb:()=>Tt,Ec:()=>kt,F:()=>R,Fb:()=>lt,G:()=>U,Gb:()=>nt,H:()=>T,Hb:()=>we,I:()=>H,Ib:()=>rt,Ic:()=>Ge,J:()=>F,Jb:()=>_t,K:()=>z,Kb:()=>ne,L:()=>V,Lb:()=>mt,Lc:()=>_e,M:()=>K,Mb:()=>ct,N:()=>j,Nb:()=>Ot,O:()=>G,Ob:()=>Dt,Oc:()=>Te,P:()=>y,Pb:()=>Ce,Q:()=>_,Qb:()=>Oe,R:()=>h,Rb:()=>Et,S:()=>v,Sb:()=>Je,Sc:()=>be,T:()=>L,Tb:()=>ze,U:()=>ye,Ub:()=>Re,V:()=>Se,Vb:()=>Ee,W:()=>X,Wb:()=>ke,X:()=>w,Xb:()=>dt,Y:()=>s,Yb:()=>St,Z:()=>ae,Zb:()=>je,_:()=>pe,_b:()=>re,_c:()=>He,a:()=>d,ab:()=>at,ac:()=>ft,b:()=>te,bb:()=>We,bc:()=>Le,c:()=>A,cb:()=>se,cc:()=>ut,d:()=>k,db:()=>Mt,dc:()=>Pe,e:()=>l,eb:()=>q,ec:()=>xe,f:()=>x,fb:()=>Ft,fc:()=>Ae,g:()=>p,gb:()=>it,gc:()=>It,h:()=>ge,hb:()=>tt,hc:()=>Fe,i:()=>b,ib:()=>le,ic:()=>et,j:()=>ve,jb:()=>r,k:()=>I,kb:()=>Ct,kc:()=>me,l:()=>f,lb:()=>At,lc:()=>Ue,m:()=>N,mb:()=>Pt,mc:()=>yt,n:()=>B,nb:()=>ue,nc:()=>wt,o:()=>S,ob:()=>xt,oc:()=>Me,p:()=>M,pb:()=>Ut,pc:()=>Xe,q:()=>P,qb:()=>bt,r:()=>D,rb:()=>fe,rc:()=>De,s:()=>u,sb:()=>ce,sc:()=>Ve,t:()=>E,tb:()=>o,tc:()=>pt,u:()=>m,ub:()=>Ht,uc:()=>gt,v:()=>O,vb:()=>Qe,vc:()=>Ze,w:()=>ee,wb:()=>he,wc:()=>ot,x:()=>c,xb:()=>qe,xc:()=>Ye,y:()=>Z,yb:()=>Ke,yc:()=>Ie,z:()=>Q,zb:()=>st});var a=n("odsp.util_385"),i=n(403);const r=a.JW.isFeatureEnabled,o={ODB:817,ODC:!0,OneDrive:!0},s={ODB:60124,Fallback:!1},c={ODB:60358},d={ODB:62197},l={ODB:1655,ODC:!1,Fallback:!1},u={ODB:61828,Fallback:!1},f={ODB:61978,ODC:!1,Fallback:!1},p={ODB:60839,Fallback:!1},m={ODB:62087,Fallback:!1},_={ODB:62435,Fallback:!1},h={ODB:60389,Fallback:!1},b={ODB:62399,Fallback:!1},g={ODB:62450,Fallback:!1},v={ODB:62238,Fallback:!1},y={ODB:62667,Fallback:!1},S={ODB:62117,Fallback:!1},D={ODB:62325,Fallback:!1},I={ODB:62570,Fallback:!1},x={ODB:61749,Fallback:!1},C={ODB:61860,Fallback:!1},O={ODB:62264,Fallback:!1},w={ECS:1071224},E={ECS:1538945},A={ECS:1534310},L={ODB:!0,Fallback:!0},k={ODB:1614,Fallback:!1},M={ODB:1063,Fallback:!1},P={ODB:61719,Fallback:!1},T={ODB:1513,Fallback:!1},U={ODB:62343,Fallback:!1},F={ODB:62448,Fallback:!1},H={ODB:62558,Fallback:!1},R={ODB:62477,Fallback:!1},N={ODB:62071,Fallback:!1},B={ODB:61561,Fallback:!1},j={ECS:1551255},V={ODB:61881,Fallback:!1},z={ODB:61973,Fallback:!1},G={ODB:61982,Fallback:!1},K={ODB:62242,Fallback:!1},W={ODB:61403},q={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},Q={ODB:61890,ODC:!1,OneDrive:!1,Fallback:!1},Y={ODB:62164,ODC:!1,OneDrive:!1,Fallback:!1},J={ODB:62154,ODC:!1,OneDrive:!1,Fallback:!1},X={ODB:61709,ODC:!0,OneDrive:!0,Fallback:!0},Z={ODB:62143,ODC:!1,OneDrive:!1,Fallback:!1},$={ODB:61094,ODC:!1,OneDrive:!1,Fallback:!1},ee={ODB:62312},te={ODB:62290,ODC:!1,OneDrive:!1,Fallback:!1};function ne(e){return(0,i.n)({pageContextForEAPCheck:e})}const ae={ODB:!a.Ov.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},ie={ODB:1698};function re(){return a.Ov.isActivated("654448bc-6e4d-4549-8df3-4aedd7e604cd")}function oe(){return a.Ov.isActivated("efa666e1-be72-4739-8a97-ace125257194")}function se(){return!a.Ov.isActivated("ca174314-6a76-407f-94e4-196cefd1c38f","02/13/2025","Define and pass method to get augloop token from host")}function ce(){return!a.Ov.isActivated("f354777e-75e7-4c72-b712-13edc24ce313","04/01/2025","Define and pass method to get augloop token from same domain host")}function de(){return!a.Ov.isActivated("acdb253c-32ab-4596-97a5-c9a5bad0c3e2","02/26/2025","Get listId for oneup share dialog from oneupstore")}function le(){return!a.Ov.isActivated("75589528-9502-4766-af7e-ea81c45d9c58","02/10/2025","Add more file metadata (createTime, modifyTime, size) for oneup copilot telemetry")}function ue(){return!a.Ov.isActivated("644f5b58-825e-47c6-a523-1ddab71ccbae","02/21/2025","Add copilot host app telemetry")}function fe(){return!a.Ov.isActivated("93E97E3A-4A8D-42FE-A949-3F67593C24DB","03/21/2025","Add siteId and webId from item pageContext")}const pe={ODB:!0,OneDrive:!0},me={ODB:61113},_e={ODB:61686},he={ODB:62536};function be(){return!a.Ov.isActivated("8829b122-25f1-497b-889d-18046e90cdb4","05/23/2024","Update oneupitem processing to exclude unsupported files from officebundle generation, to prevent unsupported wac viewer usage")}const ge={ODB:61210},ve={ODB:61338},ye={ODB:61220},Se={ODB:61238};function De(){return r(ie)}function Ie(){return!a.Ov.isActivated("6b3d3f79-542e-416d-a2d5-df4c81a10a67","04/19/2024","Update 3d viewer to support gltf csl")}function xe(){return!a.Ov.isActivated("5904d91a-f2d9-492f-809a-0628008a7395","01/18/2024","Refactor UA and Esign for PDF perf improvement")}function Ce(){return!a.Ov.isActivated("a57daca8-0ab6-44bc-85da-ad7ef0256836","02/01/2024","Default OneNote file to other viewer no matter if it contains thumbnail url")}function Oe(){return!a.Ov.isActivated("ca112383-8d78-4a73-8406-2825ad372646","02/06/2024","useMemo in oneupSlide to avoid unnecessary re-rendering")}function we(){return!a.Ov.isActivated("5DB864CD-C8C0-412B-BDCF-7B1D19DC6408","02/07/2024","Refactor eSignature for perf improvement")}function Ee(){return!a.Ov.isActivated("2786c500-79af-45d2-a8bc-9e24bba711dc","02/14/2024","set accessToken to undefined for file handler")}function Ae(){return!a.Ov.isActivated("878753ca-7dc4-4e78-9149-0385365eb96e","02/28/2024","update the file type check for thumbnail")}function Le(){return!a.Ov.isActivated("a647a6fc-3e82-4662-9c1c-7fe30dc1c1ed","03/05/2024","update the file picker to use webDavUrl")}function ke(){return!a.Ov.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","04/05/2024","log experiment data for oneup")}function Me(){return!a.Ov.isActivated("ba334243-6ae7-47f8-b998-b7d40e2b1a5f","04/22/2024","display right pane with error message")}function Pe(){return!a.Ov.isActivated("59dd68f8-625d-4d16-b841-b507c7cae5ba","04/24/2024","enable show presence for current single client")}function Te(){return a.Ov.isActivated("59599a46-3c86-46b4-b44e-8e9836b0c8cc","05/13/2024","refactor command bar styles")}function Ue(){return!a.Ov.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","05/15/2024","use onedrive/sharepoint for filehandler client name")}function Fe(){return!a.Ov.isActivated("27ee7a45-8265-4d6e-a9c8-5c375f656b8b","05/14/2024","enable od3 style for info pane iframe")}function He(){return!a.Ov.isActivated("dfafd001-d599-49cf-b756-f64d5614b6c7","05/23/2024","use first focusable target")}function Re(){return!a.Ov.isActivated("6884f3e1-f7e7-429c-829d-de15202d7086","05/29/2024","disable FRE for WAC and Video")}function Ne(){return!a.Ov.isActivated("83b9c996-3090-4417-ad53-fc565729550b","06/14/2024","Enable override to other viewer for specific extensions")}function Be(){return!a.Ov.isActivated("2fc93384-9c5a-45c4-a1d7-5938985af39e","07/18/2024","fast one up error handling for no access scenarios")}function je(){return!a.Ov.isActivated("21df4421-5b42-4f02-b214-c13002058ff0","07/11/2024","suppress web keyboard shortcuts while oneup is open")}function Ve(){return!a.Ov.isActivated("9b38ea60-d047-400c-b415-50e7d0a5ab6d","07/03/2024","send oauth token over in crosslist scenario for info pane")}function ze(){return!a.Ov.isActivated("4439e66f-5028-47c6-a785-33ccd584aee6","07/25/2024","Check ODB info pane status and auto launch in oneup on boot if open")}function Ge(){return!a.Ov.isActivated("9b38ea60-d047-400c-b415-50e7d0a5ab6d","07/10/2024","load wac viewer when offset is 0")}const Ke={ODB:62047};function We(){return!a.Ov.isActivated("02071577-5f64-4528-af85-232e917aecb5","08/27/2024","aterentiev - enable builder for copilot viewer")}function qe(){return!a.Ov.isActivated("bf73f6e4-c9d8-4ee6-bbbe-8b594bc274c1","10/30/2024","haonwan - enable show default badge for oneup")}function Qe(){return!a.Ov.isActivated("9b559192-7d10-466a-a1be-da381f30568a","09/04/2024","aterentiev - enable OCV feedback for copilot viewer")}function Ye(){return!a.Ov.isActivated("438f44e6-9109-48e0-ad63-1422c7a65475","09/04/2024","aterentiev - pass token provider to copilot data source")}function Je(){return!a.Ov.isActivated("cfbff67e-09b8-486e-a4b8-ed7c9434ae22","09/13/2024","allow commandbar set updates when file handler api returns")}function Xe(){return!a.Ov.isActivated("2f6e0461-222d-4d79-a39f-831d09809081","10/18/2024","use updated path to check other viewer override extensions")}function Ze(){return!a.Ov.isActivated("9284827c-56e3-4243-8ef5-5afecfb65666","10/16/2024","Enable Vroom API fallback for image loading")}function $e(){return!a.Ov.isActivated("b642e08a-06ad-49e9-bf39-0db7e490a0a3","10/21/2024","sanitize all sent telemetry data")}function et(){return!a.Ov.isActivated("534bb451-0390-4c4a-927c-ec97a617fd7d","10/24/2024","expose resource key for host theme")}function tt(){return!a.Ov.isActivated("0d37f72d-8169-41fe-b594-8452db7e28c0","10/28/2024","Enable Add to Teams for Copilot Agents")&&r({ODB:62053})}function nt(){return!a.Ov.isActivated("ca96046d-3322-4be7-84f5-9ca5281a9a99","11/12/2024","HTML viewer access expiration retry")}function at(){return!a.Ov.isActivated("c3e8b8a9-6ea6-4e5d-88f9-ff5c5eaffc95","11/07/2024","Add vroom fallback for empty thumbnail url")}function it(){return!a.Ov.isActivated("d2b2f4a4-0c6b-4e0d-8b7e-7e8b6c3e6c6f","11/14/2024","enable log flight data for fast oneup")}function rt(){return!a.Ov.isActivated("d2b2f4a4-0c6b-4e0d-8b7e-7e8b6c3e6c6f","11/14/2024","enable shorten cxp timeout")}function ot(){return a.Ov.isActivated("6F22857B-5848-4E9E-8624-15642948563C")}function st(){return!a.Ov.isActivated("de59bdac-1542-4bb7-9c1c-7a880892c286")}function ct(){return a.Ov.isActivated("5fc1ded9-c576-4bf6-b8ab-457eddd55bd2")}function dt(){return a.Ov.isActivated("0aeb81cf-c6e7-4d6b-b198-cd0e194f6dde")}function lt(){return a.Ov.isActivated("264c573a-03eb-4282-be9c-c88d19d1eb09")}function ut(){return a.Ov.isActivated("e6b8f0a6-7e0a-4f5c-9e1a-1d0f7c1c7a0d")}function ft(){return a.Ov.isActivated("a708bde5-cb00-40e4-a756-3e986734603b")}function pt(){return a.Ov.isActivated("2e8efc47-e426-4c39-ae38-1a2bec5772f1")}function mt(){return a.Ov.isActivated("d0109f10-ad73-47b5-a998-9acfc42b16ba")}function _t(){return a.Ov.isActivated("5f0e16a3-0d23-4e17-9abd-b43d22831c61")}function ht(){return a.Ov.isActivated("522c147a-a792-48d2-9a26-aa1720532889")}function bt(){return a.Ov.isActivated("eadaa6c7-1c75-4926-be30-0510bc5697e0")}function gt(){return a.Ov.isActivated("8dd563db-9593-4bba-91a0-a91168179353")}function vt(){return!a.Ov.isActivated("51c9bf6c-73e8-40ad-b80b-b38739fa14a5")&&(0,i.g)()}function yt(){return a.Ov.isActivated("bb0e5c2b-b32e-44ba-9aff-26e05ec9017f")}function St(){return!a.Ov.isActivated("58C70DD8-6098-4631-B087-8AB0DAA4D91A")}function Dt(){return!a.Ov.isActivated("1e4b1d7e-3be7-4ec1-ac86-1650f9b16b68")}function It(){return!a.Ov.isActivated("f1a2b0d4-3c8e-4b5f-9c7d-6a0e1f2a3b8d")}function xt(){return!a.Ov.isActivated("f3a2b0d1-4c5e-4b8f-9a7c-6d0e1f3a2b0d","04/30/2025","allow direct image content url instead of requesting the thumbnail")}function Ct(){return!a.Ov.isActivated("56479aa3-3d34-4c29-8c6c-9a2f1e48cd62")}function Ot(){return!a.Ov.isActivated("f1a2b0d4-3c8e-4b5f-9c7d-6a0e1f2a3b8d")}function wt(){return!a.Ov.isActivated("9bf3f748-8f0e-46d7-84c5-72d8b0ad29dc","05/20/2025","KS of temp auth deprecation for PDF conversion")&&r({ODB:62389})}function Et(){return!a.Ov.isActivated("18eed333-212d-4a6e-b8fe-9065600b6cf2")}function At(){return!a.Ov.isActivated("80B0E160-C226-405A-9A8A-67FF98C5D942")}function Lt(){return!a.Ov.isActivated("f73b0655-d633-4840-bff8-6aa522e57e04")}function kt(){return!a.Ov.isActivated("3c204aba-1510-4f6a-a383-4b50604ff43f")}function Mt(){return!a.Ov.isActivated("11aaa868-80fc-41cf-b2df-8f66ddcfe134")}function Pt(){return!a.Ov.isActivated("7c6d6850-2bcb-4471-a37e-f41e621a5d5a")}function Tt(){return!a.Ov.isActivated("5db3ccd8-17b0-42ef-9d97-67700e0fa004")}function Ut(){return!a.Ov.isActivated("68e4747f-72d4-4108-8169-d7878ea7d17d")}function Ft(){return!a.Ov.isActivated("42c1814c-3aac-4384-ba9b-e1b76136e02e")}function Ht(){return!a.Ov.isActivated("0ba2b5b5-4709-4098-8d6e-08b7bb9ceafd")}}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>o,c:()=>r,d:()=>s,e:()=>i,f:()=>h,g:()=>b});var a,i,r,o,s,c=n(76),d=n("odsp.util_385"),l=n(529),u=n(70),f=n("react-lib"),p=n(4),m=n(517);!function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(a||(a={})),function(e){e[e.none=0]="none",e[e.detailPane=1]="detailPane",e[e.versionHistory=2]="versionHistory",e[e.copilotPane=3]="copilotPane",e[e.commentsPane=4]="commentsPane",e[e.copilotDetailPane=5]="copilotDetailPane"}(i||(i={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(r||(r={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(o||(o={})),function(e){e[e.carousel=0]="carousel",e[e.single=1]="single"}(s||(s={}));class _ extends l.a{getViewerState(e){return this.state.currentState.viewerStates?.get(e)}getOneUpNavMode(){return this.state.currentState.navMode||0}getAnnotationViewerState(){return this.state.currentState.annotationViewerState}getESignData(){return this.state.currentState.eSignData}getFileHandlerOptions(){return this.state.currentState.fileHandlerOptions}updateViewerState(e,t){const n=this.state.currentState.viewerStates||new Map,a=n?.get(t.key);t.options={...a,...t.options,pdfViewerStates:{...a?.pdfViewerStates,...t.options.pdfViewerStates}},n.set(t.key,t.options),this.update("currentState",{publisher:e,viewerStates:new Map(n)})}updateRightPaneError(e,t){(0,p.oc)()&&this.update("currentState",{publisher:e,rightPane:{...t,hasError:!0}})}updateRightPaneState(e,t){0!==t.type&&this.updateESignDataState(e,{isCreateSidePanelActive:!1}),this.update("currentState",{publisher:e,rightPane:{...t,hasError:void 0,error:void 0}})}get rightPaneType(){return this.currentAppState.rightPane.type}updateNavMode(e,t){this.update("currentState",{publisher:e,navMode:1===t?1:0})}updateModalState(e,t){this.update("currentState",{publisher:e,modal:t})}updatePdfCopilotAction(e,t,n){this.update("currentState",{publisher:e,pdfCopilotAction:{prompt:t,isSent:n}})}updateFabCopilotAction(e,t){this.update("currentState",{publisher:e,fabCopilotAction:{prompt:t}})}updateParentPermissionValidity(e,t){this.update("currentState",{publisher:e,hasValidPermissionToParent:t})}updateFileHandlerOptions(e,t){this.update("currentState",{publisher:e,fileHandlerOptions:t})}updatePerfButtonState(e,t){this.update("currentState",{publisher:e,perfDataReported:t})}updatePerfButtonIsVisible(e,t){this.update("currentState",{publisher:e,isPerfButtonOpen:t})}updateIsPresenceFacepileVisible(e,t){this.state.currentState.isPrecenseFacepileVisible!==t&&this.update("currentState",{publisher:e,isPrecenseFacepileVisible:t})}updateOneUpShellFreIsOpen(e,t){this.update("currentState",{publisher:e,isOneUpFreOpen:t})}updateImageState(e,t){this.update("currentState",{publisher:e,imageMode:t})}updatePdfState(e,t){this.update("currentState",{publisher:e,pdfAppMode:t})}updateIsPdfPaidFeaturesEnabled(e,t){this.update("currentState",{publisher:e,isPdfPaidFeaturesEnabled:t})}updateToastState(e,t){let n=this.state.currentState.toast;t.timeStamp=Date.now();const a=t.toastKey?t.toastKey:"defaultKeyToDisplayOnlyOneToast";if(n||(n=new Map),n.set(a,t),!1===t.visible&&n.delete(a),n.size>2){let e="",t=1/0;n.forEach((n,a)=>{n.timeStamp&&n.timeStamp<t&&(e=a,t=n.timeStamp)}),n.delete(e)}const i=new Map(n);this.update("currentState",{publisher:e,toast:i})}updateErrorState(e,t){this.update("currentState",{publisher:e,errorState:t})}setIsFocusItemFavorited(e,t){this.update("currentState",{publisher:e,isFocusItemFavorited:t})}setIsFeedbackEnabled(e,t){this.update("currentState",{publisher:e,isFeedbackEnabled:t})}toggleAnnotationViewerVisiblity(e){const t=this.state.currentState.annotationViewerState,n=t.viewerVisiblity,a=0===n||void 0===n?1:0,i={...t,viewerVisiblity:a,isActive:!t.isActive};this.update("currentState",{publisher:e,annotationViewerState:i}),(0,p.jb)(p.z)&&this.hideUACommentsPane(a,e)}hideUACommentsPane(e,t){0===e&&4===this.state.currentState.rightPane.type&&this.updateRightPaneState(t,{type:0})}setSiteHidePeoplePreviewingFiles(e,t){this.update("currentState",{publisher:e,siteHidePeoplePreviewingFiles:t})}setAnnotationViewerPreloadSucceeded(e,t){const n=this.state.currentState.annotationViewerState;this.update("currentState",{publisher:e,annotationViewerState:{...n,hasPreloadSucceeded:t}})}updateDeletedKeysState(e,t){this.update("currentState",{publisher:e,deletedKeys:t})}updateRenamedKeyInFastOneUpState(e,t){this.update("currentState",{publisher:e,renamedKeyInFastOneUp:t})}updateIsUniversalPrintLicenseValidState(e,t){this.update("currentState",{publisher:e,isUniversalPrintLicenseValid:t})}updateIsNoAccessScenarioState(e,t){this.update("currentState",{publisher:e,isNoAccessScenario:t})}updateESignDataState(e,t){t.isCreateSidePanelActive&&this.updateRightPaneState(e,{type:0}),this.update("currentState",{publisher:e,eSignData:t})}updateIsTeamsFileScenaro(e,t){this.update("currentState",{publisher:e,isTeamsFileScenario:t})}updateIsPublishToWebNavIdSet(e,t){this.update("currentState",{publisher:e,isPublishToWebNavIdSet:t})}get currentAppState(){return this.state.currentState}clean(){this.update("currentState",{publisher:"close",rightPane:{type:0},errorState:void 0,viewerStates:void 0,imageMode:0,annotationViewerState:{viewerVisiblity:_._defaultAnnotationVisibility,hasPreloadSucceeded:!1,isActive:!1},pdfAppMode:c.a.View,toast:void 0,modal:{showModal:!1,content:void 0},eSignData:{isCreateSidePanelActive:!1},perfDataReported:void 0,isFocusItemFavorited:void 0,isFeedbackEnabled:void 0,renamedKeyInFastOneUp:void 0,fabCopilotAction:void 0,pdfCopilotAction:void 0})}navClean(){this.update("currentState",{publisher:"nav",eSignData:{isCreateSidePanelActive:!1}})}updateAutoOpenCopilotExperimentEnabled(e){this.update("currentState",{publisher:"OneUpAutoActionExecutor",isAutoOpenCopilotExperimentEnabled:e})}constructor(){super({currentState:{publisher:"init",rightPane:{type:0},modal:{showModal:!1},navMode:0,eSignData:{isCreateSidePanelActive:!1},annotationViewerState:{viewerVisiblity:_._defaultAnnotationVisibility,isActive:!1},isFocusItemFavorited:void 0,isFeedbackEnabled:void 0,isPerfButtonOpen:(0,p.jb)(p.kc),isOneUpFreOpen:!1,isPrecenseFacepileVisible:!1,isTeamsFileScenario:!1,isPublishToWebNavIdSet:!1,isAutoOpenCopilotExperimentEnabled:void 0}}),(0,m.a)().attachStores({oneUpStateStore:this})}}_._defaultAnnotationVisibility=0;const h=new d.OJ({name:"OneUpStateStore",factory:new d.zX(_)});function b(e,t){return function(e,t,n){const[a,i]=(0,f.useState)(),[r,o]=(0,f.useState)(()=>{const a=e.state[t],r=n?n(a):a;if(!(0,d.td)(r))return r;r.then(e=>o(e)).catch(e=>i(e))});return(0,f.useLayoutEffect)(function(){return e.onUpdate(t,e=>{const t=n?n(e.detail):e.detail;(0,d.td)(t)?t.then(e=>o(e)).catch(e=>i(e)):o(t)})},[]),[r,a]}((0,u.c)().consume(h),e,t)}}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i.a,b:()=>i.d,c:()=>o});var a=n(1),i=n(13),r=n(49);const o=(0,n("odsp.util_385").C2)("ItemUrlHelper",r.a,{pageContext:a.a})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>d});var a,i,r=n(154),o=n("odsp.util_385"),s=n(517);!function(e){e.updateOneUpStatus="updateOneUpStatus"}(a||(a={})),function(e){e.oneUpItemCacheUpdate="oneUpItemCacheUpdate",e.oneUpSpartanUpdate="oneUpSpartanUpdate",e.initialStoreDataWhenSubscribing="initialStoreDataWhenSubscribing"}(i||(i={}));class c{subscribe(e,t,n){const a=this._eventMC.subscribe(e,t),i=this.getOneUpProperties();return t(new CustomEvent("updateOneUpStatus",{detail:{publisher:"initialStoreDataWhenSubscribing",update:i}})),a}update(e,t){this._focusItem=e.focusItem||this._focusItem,this._focusItemSet=e.focusItemSet||this._focusItemSet,this._parentItem=e.parentItem||this._parentItem,this._currentIndex=void 0!==e.currentIndex?e.currentIndex:this._currentIndex,this._focusItemKey=e.focusItemKey||this._focusItemKey,this._childItemKeys=e.childItemKeys||this._childItemKeys,this._currentItemSetKey=e.currentItemSetKey||this._currentItemSetKey,this._list=e.list||this._list,this._appLevelPageContext=e.appLevelPageContext||this._appLevelPageContext,this._pageContexts=e.pageContexts||this._pageContexts,this._parentStoreKey=e.parentStoreKey||this._parentStoreKey,this._invalidateitemsAfterRename=e.invalidateItemsAfterRename||this._invalidateitemsAfterRename;const n={publisher:t,update:e};this._eventMC.publish("updateOneUpStatus",n)}getOneUpProperties(){return this._focusItem?{focusItem:this._focusItem,focusItemSet:this._focusItemSet,parentItem:this._parentItem,currentIndex:this._currentIndex,focusItemKey:this._focusItemKey,childItemKeys:this._childItemKeys,currentItemSetKey:this._currentItemSetKey,list:this._list,appLevelPageContext:this._appLevelPageContext,pageContexts:this._pageContexts,parentStoreKey:this._parentStoreKey,invalidateItemsAfterRename:this._invalidateitemsAfterRename}:void 0}clean(){this._focusItem=void 0,this._focusItemSet=void 0,this._parentItem=void 0,this._currentIndex=void 0,this._focusItemKey=void 0,this._childItemKeys=void 0,this._currentItemSetKey=void 0,this._list=void 0,this._appLevelPageContext=void 0,this._pageContexts=void 0,this._parentStoreKey=void 0}get focusItem(){return this._focusItem}get focusItemSet(){return this._focusItemSet}get parentItem(){return this._parentItem}get currentIndex(){return this._currentIndex}get focusItemKey(){return this._focusItemKey}get childItemKeys(){return this._childItemKeys}get currentItemSetKey(){return this._currentItemSetKey}get list(){return this._list}get pageContexts(){return this._pageContexts}get appLevelPageContext(){return this._appLevelPageContext}get parentStoreKey(){return this._parentStoreKey}constructor(){this._eventMC=new r.a,(0,s.a)().attachStores({oneUpStore:this})}}const d=new o.OJ({name:"OneUpStore",factory:{dependencies:{},create:()=>({instance:new c})}})}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>f,c:()=>l});var a=n(152),i=n(260),r=n(261),o=n(856),s=n(153),c=n(262),d=n(263);const l=/^Filter(Field|Value|Type|Op|LookupId|Display)(s?)([1-9]|10)$/,u={idParamKey:a.b,parentIdParamKey:r.a,driveIdParamKey:"driveId",parentDriveIdParamKey:"parentDriveId",driveEndpointParamKey:"endpoint",queryTypeParamKey:d.b,pageParamKey:"p",parentQueryTypeParamKey:d.a,windowNameJsonKey:"ODBParams",queryParamKey:a.g,conversationIdParamKey:"cvid",metadataSearchIdKey:a.f,uniqueParamKey:"u",navParamKey:"nav",localeKey:"locale",dateFilterKey:"dateFilter",typeFiltersKey:a.i,userFiltersKey:"userFilters",viewIdKey:a.j,viewPathKey:a.k,isPowerAppView:"isPowerAppView",listIdKey:a.d,listUrlKey:a.e,webUrlKey:a.l,routingKey:"routeid",sortFieldKey:a.h,isAscendingKey:a.c,policyTipKey:"policyTipForListItemId",sharingKey:"sharingDialogForListItemId",openShare:"openShare",managePermissionsKey:"managePermissionsForListItemId",pseudoPolicyTipKey:"showpolicytips",groupByKey:a.a,errorTypeKey:"type",correlationIdKey:"correlation",approvalItemVersion:"approvalItemVersion",commentIdKey:"commentId",emailCTRParamKey:"e",useFiltersInViewXmlKey:"useFiltersInViewXml",itemId:"itemId",playlistLayout:"playlistLayout",needsAttentionViewKey:"needsAttentionView",requiredColumnsKey:"required",pickerLinkTypeKey:"link_type",pickerAADClientIdKey:"aad_client_id",pickerMSAClientIdKey:"msa_client_id",pickerSelectionModeKey:"selection_mode",pickerViewTypeKey:"view_type",pickerAccessLevelKey:"access",pickerReturnUrlKey:"ru",remoteItem:i.a,stateParamKey:"state",agentBuilderModeKey:"agentBuilderMode",callerId:"CallerId",callerScenarioId:"CallerScenarioId",listItemIdKey:"ID",rootFolderParamKey:"RootFolder",sourceKey:"Source",isDialogKey:"IsDlg",contentTypeId:"ContentTypeId",newTargetListUrlKey:"newTargetListUrl",shareLinkId:"slrid",settingKey:"setting",userExpirationPanelKey:"userExpiration",sharedLibraryCreated:"sharedLibraryCreated",expandPageRowLimitKey:"rowLimit",fileBrowserOptionsKey:"fileBrowser",groupIdKey:"groupId",odSkipAutoFocus:"odSkipAutoFocus",teamIdKey:"teamId",channelIdKey:"channelId",entityIdKey:"entityId",subEntityIdKey:"subEntityId",ringIdKey:"ringId",asidKey:"asid",sidKey:"sid",hostName:"hostName",returnUrl:"returnUrl",disableQueryAlterationKey:"dqa",searchScopeKey:"searchScope",searchQueryKey:"q",action:s.a,openedFrom:"openedfrom",videoDriveId:"videoDriveId",videoItemId:"videoItemId",videoParentId:"videoParentId",referrer:"referrer",referrerScenario:"referrerScenario",referrerPlatform:"referrerPlatform",referrerVersion:"referrerVersion",referrerSessionId:"referrerSessionId",referrerConversationId:"conversationId",viewerKey:"viewer",personIdKey:"personId",emailIdKey:"emailId",meetingIdKey:"meetingId",templateId:"templateId",sourceDoc:"sourcedoc",entryPoint:"entry",noAuthRedirect:"noAuthRedirect",appParamKey:"app",scenarioParamKey:"scenario",loadFormWithNucleus:"loadFormWithNucleus",referringClientKey:"referringClient",localKey:"local",shareTokenKey:c.a,cid:o.d,sortBy:o.r,sortDirection:o.s,mid:o.k,mcid:o.j,contextualFilter:o.e,extensionFilter:o.h,searchConversationId:o.q,dateFilterType:o.f,beginDate:o.b,endDate:o.g,scope:o.p,authKey:o.a,navModeKey:"navMode"},f=u}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a.a});var a=n(447)}
,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n("odsp.util_385");const i=window._spPageContextInfo,r=e=>{const t=(e=>{if(i&&i.farmSettings)return i.farmSettings[e]})(e);return!!t&&(1===Number(t)||"true"===t.toLowerCase())},o=e=>e.serviceSetting?r(e.serviceSetting):a.JW.isFeatureEnabled(e)}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("tslib_145"),i=n(83),r=function(){function e(){}return e.setAll=function(e){var t=e.workerSrc,n=e.wasmModuleInit,a=e.fontConfigs,i=e.enableLogging,r=e.disableExternalWasmCache,o=e.globalVarNameForWorkerVer,s=e.features,c=e.mipPrefetchConfig;this.workerSrc=t,this.wasmModuleInit=n,this.fontConfigs=a,this.enableLogging=i,this.disableExternalWasmCache=r,this.globalVarNameForWorkerVer=o,this.features=s,this.mipPrefetchConfig=c},Object.defineProperty(e,"workerSrc",{get:function(){return this.value.workerSrc},set:function(e){this.value.workerSrc=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"wasmModuleInit",{get:function(){return this.value.wasmModuleInit},set:function(e){this.value.wasmModuleInit=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"fontConfigs",{get:function(){return this.value.fontConfigs},set:function(e){this.value.fontConfigs=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableLogging",{get:function(){return this.value.enableLogging},set:function(e){i.a.enabled=this.value.enableLogging=!!e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"disableExternalWasmCache",{get:function(){return this.value.disableExternalWasmCache},set:function(e){this.value.disableExternalWasmCache=!!e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"globalVarNameForWorkerVer",{get:function(){return this.value.globalVarNameForWorkerVer},set:function(e){this.value.globalVarNameForWorkerVer=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"mipPrefetchConfig",{get:function(){return this.value.mipPrefetchConfig},set:function(e){this.value.mipPrefetchConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"features",{get:function(){return this.value.features},set:function(e){this.value.features=e},enumerable:!1,configurable:!0}),e.setMessengerOptions=function(e){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return e?[4,n.e(31).then(n.bind(n,461))]:[2];case 1:return t.sent().setMessengerOptions(e),this.value.messengerOptions=e,[2]}})})},Object.defineProperty(e,"messengerOptions",{get:function(){return this.value.messengerOptions},enumerable:!1,configurable:!0}),e.value={workerSrc:"index.worker.js",wasmModuleInit:[]},e}()}
,,,,,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Y,resourceKey:()=>J});var a=n(538),i=n(1),r=n(9),o=n("odsp.util_385"),s=n(6),c=n(138),d=n(861),l=n(58),u=n(144),f=n(0);function p({tokenName:e,resource:t,tokenType:n,scopes:a}){let i;return a&&(i=[...a].sort().join("-")),`${e}|${t}|${n||""}|${i||""}`.toUpperCase()}const m=new Map,_=new o.OJ({name:"PrefetchPromiseCache.key.prefetchPromiseCache",factory:new o.Rn(m)});var h=n(428),b=n(288);function g(e){const{pageContext:t}=e,n=function(e){const{pageContext:t}=e,n=t?.systemUserKey;return n&&n.substring(n.lastIndexOf("|")+1).replace("@live.com","")||""}(e),a=!0===t.isAnonymousGuestUser||!0===t.isEmailAuthenticationGuestUser?b.a.anonymous:b.a.aad,i=t.userLoginName,r=t.webPermMasks;return{email:t.userEmail,id:n,loginName:i,type:a,sessionState:"",webPermMasks:r}}const v=new o.OJ({name:"getUserIdentity",factory:{dependencies:{pageContext:i.a},create:e=>({instance:()=>g(e)})}});var y=n(165),S=n(541);const D=n(40).a.local,I=new o.OJ({name:"CachingType.key.cachingType",factory:new o.Rn(D)}),x=new o.OJ({name:"IdentityCache.key",factory:{dependencies:{pageContext:i.a,identityDataStoreCachingType:I},create:({pageContext:e,identityDataStoreCachingType:t})=>({instance:new S.a({userId:e.systemUserKey,cachingType:t})})}});var C=n(98),O=n(72),w=n(60);function E(e){const{access_token:t,expires_on:n}=e;let a;return n&&(a=1e3*Number(n),isNaN(a)&&(a=new Date(n).getTime())),a&&!isNaN(a)||(a=1e3*Number((0,w.b)(t).exp)),isNaN(a)?void 0:a-3e5}const A=36e5,L=new o.OJ({name:"cachingTokenFetcher",factory:new o.A3(class{async getToken(e){const{resource:t,url:n,tokenType:a,claimsChallenge:i,scopes:r,expiration:o,apiQosName:s,name:c}=e,d=p({tokenName:c,resource:t,tokenType:a,scopes:r}),l=this._promiseCache.get(d),u=this._prefetchPromiseCache?.get(d),m=e=>{const t=E(e),{access_token:n,correlationId:a}=e;let i=t;if(t&&"ms-substrate"===c){const e=Date.now();t-e>A&&(i=e+A)}return this._cache.setValue(d,{value:n,expiration:i,correlationId:a}),{accessToken:n,tokenExpiry:t,correlationId:a}};if(i||o)await Promise.all([...l?[l.catch(e=>{})]:[],...u?[u.catch(e=>{})]:[]]),this._cache.setValue(d,void 0);else{const e=this._cache.getValue(d,Date.now());if(e)return{access_token:e.value,expires_on:`${e.expiration}`,correlationId:e.correlationId};if(l){const e=await l;if(e)return{access_token:e.accessToken,expires_on:`${e.tokenExpiry}`,correlationId:e.correlationId}}if(u){this._prefetchPromiseCache?.delete(d);const e=(async()=>{try{const e=await u;let t;if(new f.a(e.qos.start).end({...e.qos.end,resultType:e.qos.success?f.b.Success:f.b.Failure}),e.response){if(!e.response.ok)return;const n=await e.response.json();t=m({...n,correlationId:e.response.headers.get("SPRequestGuid")||""})}return t}catch(e){return}})();this._promiseCache.set(d,e);const t=await e;if(this._promiseCache.delete(d),t)return{access_token:t.accessToken,correlationId:t.correlationId,expires_on:`${t.tokenExpiry}`}}}const _=(async()=>await this._tokenFetcher.getToken({name:c,resource:t,url:n,tokenType:a,claimsChallenge:i,scopes:r,apiQosName:s}))().then(e=>{const t=m(e);return this._promiseCache.delete(d),t},e=>(this._promiseCache.delete(d),Promise.reject(e)));this._promiseCache.set(d,_);const h=await _;return{access_token:h.accessToken,correlationId:h.correlationId,expires_on:`${h.tokenExpiry}`}}constructor(e,t){this._tokenFetcher=t.tokenFetcher,this._cache=t.cache,this._prefetchPromiseCache=t.prefetchPromiseCache,this._promiseCache=new Map}},{tokenFetcher:h.a,cache:x,prefetchPromiseCache:_})}),k=o.Ov.isActivated("1CE5296B-7E05-45B7-B19C-0F0A4F6BBAE6"),M=new o.OJ("graphTokenProviderOverride");var P=n(227);const T=o.Ov.isActivated("6BC7F79B-F64E-45FD-8C10-8A0B11E1A1AE"),U=o.Ov.isActivated("A3C20F37-C7C2-4AC6-ADB4-8C6958661CE0"),F=!o.Ov.isActivated("646D58EC-51E4-4C3E-9B03-EC9E3174625D"),H=!o.Ov.isActivated("a7484c4e-8121-4906-9a28-6611d11e8e64"),R=!o.Ov.isActivated("DDD0B6F7-6461-4DFD-A821-98C1FB34AA32"),N=o.Ov.isActivated("34908FC4-B8D9-43F0-9ACF-7C6834B7E992"),B=o.Ov.isActivated("908187BF-9713-42A6-87F8-1DF09061838F"),j=o.Ov.isActivated("CE33C02E-50E4-42DC-A90F-21222CB273FF"),V=o.Ov.isActivated("E28AAE17-1BB8-40DA-821F-22E93744EB98"),z=!o.Ov.isActivated("421F2F5A-FEE0-43C7-8348-381AF429EF4D"),G="https://graph.microsoft.com",K="https://substrate.office.com",W="api://63c9fecc-99c2-4c4c-878f-84685641aa94",q="https://augloop.office.com/v2",Q=["https://esign.svc.cloud.dev.microsoft","https://esign.svc.cloud.microsoft","9471276c-aa67-4dd2-bde2-291a033f3c3c","396ef0b6-ae1c-4404-86ce-0a869d4d2987",c.c];class Y extends a.a{getIdentity(){return z?this._getUserIdentity():g({pageContext:this._pageContext})}getSignInUrl(){throw new Error("Not Implemented")}getGraphToken(e){return r.c.resolve((async()=>{const{resource:t,scopes:n,claimsChallenge:a,apiQosName:i,forceSpHttpClient:o}=e;if(k){const e=this._getGraphTokenProviderOverride?.(),n=e?await e({resource:t&&new s.a(t).authority||G,apiQosName:i}):void 0;if(n)return n}return t&&!this._isGraphEndpoint(t)?this.getSharePointToken({webAbsoluteUrl:t,forceRefresh:!!a||void 0,claimsChallenge:a?{claims:a.claims,access_token:a.access_token,error:a.error}:void 0,apiQosName:i}):n&&(n.indexOf("InformationProtection.Read.All")>-1||n.indexOf("InformationProtectionPolicy.Read")>-1||n.indexOf("Calendars.Read")>-1)?T?r.c.resolve(this.resources.consumeAsync(u.a.bypass)).then(e=>e.fetchToken({resource:t,tokenName:R?"ms-graph":void 0,claims:a?.claims,apiQosName:i})).then(e=>({accessToken:e})):this._getTokenForResource("ms-graph",{resource:t&&new s.a(t).authority||G,claimsChallenge:a,scopes:n,...o?{useSpHttpDataSource:(0,O.i)(O.c)||H&&o}:{},apiQosName:i}):this._getTokenForResource("ms-graph",{resource:t&&new s.a(t).authority||G,claimsChallenge:a,...o?{useSpHttpDataSource:(0,O.i)(O.c)||H&&o}:{},...U?{}:{scopes:n},apiQosName:i})})())}getStrongAuthToken(e){return this._getTokenForResource("oAuth-SA",{resource:new s.a(this._pageContext.webAbsoluteUrl).authority,apiQosName:e.apiQosName||"MSAStrong",scopes:["onedrive_implicit_forceSA.access"]})}getLokiToken(e){const{apiQosName:t}=e;return this._getTokenForResource("ms-loki",{resource:"https://loki.delve.office.com",apiQosName:t})}getPushChannelToken(e){const{apiQosName:t}=e;return this._getTokenForResource("pushchannel",{resource:"https://pushchannel.1drv.ms",apiQosName:t})}getTeamsCMDToken(e){const{apiQosName:t}=e;return this._getTokenForResource("teams-cmd",{resource:"6bc3b958-689b-49f5-9006-36d165f30e00",apiQosName:t})}getMeetingCatchupToken(e){const{apiQosName:t}=e;return this._getTokenForResource("ms-mcu",{resource:"https://MeetingCatchup.substrate.office.com",apiQosName:t})}getFormsToken(e){const{apiQosName:t}=e;return this._getTokenForResource("ms-forms",{resource:"https://forms.office.com",apiQosName:t})}getOCPSToken(e){const{apiQosName:t}=e;return this._getTokenForResource("ocps",{resource:"https://clients.config.office.net",apiQosName:t})}getSPHomeToken(e){const{apiQosName:t}=e;return this._getTokenForResource("SPHome",{resource:e.resource,apiQosName:t})}getOfficeToken(e){const{apiQosName:t}=e;return this._getTokenForResource("ms-officeapps",{resource:"https://officeapps.live.com",apiQosName:t})}getSubstrateToken(e){const{tokenType:t=c.e.Default,skipCache:n,resourceType:a=c.d.Default,apiQosName:i,claimsChallenge:r,forceRefresh:o}=e;if(t===c.e.STI)return this._getTokenForResource("ms-substrate-sti",{resource:K,tokenType:"STI",skipCache:n,apiQosName:i});const s=(0,y.h)(this._pageContext?.env2);let d=this._pageContext?.substrateEndpointUrl||K,l="ms-substrate";return a===c.d.Search&&(s?(d=`${this._pageContext?.substrateEndpointUrl||"https://partner.outlook.cn"}/search`,l="ms-substrate-search"):!V&&(0,O.i)(O.f)&&(d="https://outlook.office.com/search",l="ms-substrate-search")),this._getTokenForResource(l,{resource:d,skipCache:n,apiQosName:i,claimsChallenge:r,forceRefresh:o})}getSubstrateTenantFeedbackToken(e){const{apiQosName:t}=e;return this._getTokenForResource("ms-substrate-tenant-feedback",{resource:"https://substrate.office.com/tenantfeedback",apiQosName:t})}getSubstrateTaigerServiceToken(e){const{apiQosName:t}=e;return this._getTokenForResource("ms-substrate-taiger-service",{resource:`${this._pageContext?.substrateEndpointUrl||K}/TaigerService`,apiQosName:t})}getMediaTAToken(e){const{endPoint:t,apiQosName:n}=e;return this._getTokenForResource("SharePoint-media",{resource:t,apiQosName:n})}getMediaTAGptToken(e){const{endpoint:t,claimsChallenge:n,apiQosName:a}=e;return T?r.c.resolve(this.resources.consumeAsync(u.a)).then(e=>e.fetchToken({resource:t,claims:n?.claims,apiQosName:a})).then(e=>({accessToken:e})):this._getTokenForResource("SharePoint-mediaGPT",{resource:t,claimsChallenge:n,apiQosName:a})}getAugloopToken(e){const{resource:t=q,apiQosName:n}=e;return this._getTokenForResource("ms-augloop",{resource:t,apiQosName:n})}getSharePointToken(e){const{webAbsoluteUrl:t,disallowSelfIssuedToken:n,forceRefresh:a,claimsChallenge:i,apiQosName:o}=e,c=new s.a(t).authority,d=/https:\/\/(.*).svc.ms/.test(t);if(this._isGraphEndpoint(t))return this._getTokenForResource("ms-graph",{resource:c,forceRefresh:a,claimsChallenge:i,apiQosName:o});if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||d){if(this._isGraphEndpoint(t)||d){const e=this._isGraphEndpoint(t)?"SharePoint-graph":d?"SharePoint-media":"SharePoint";return this._getTokenForResource(e,{resource:c,forceRefresh:a,claimsChallenge:i,apiQosName:o})}return T?r.c.resolve(this.resources.consumeAsync(u.a.bypass)).then(e=>e.fetchToken({tokenName:R?"SharePoint-bypass":void 0,resource:c,claims:i?.claims,apiQosName:o})).then(e=>({accessToken:e})):this._getTokenForResource("SharePoint_MSAL",{resource:c,apiQosName:o,claimsChallenge:i})}return n?this._getTokenForResource("SharePoint_MSAL",{resource:c,forceRefresh:a,claimsChallenge:i,apiQosName:o,...B?{tokenType:"SPO"}:{}}):j||(0,P.a)(c,{appPageContext:this._pageContext})?this._getTokenForResource("SharePoint_SelfIssued",{resource:c,forceRefresh:a,tokenType:"SPO",claimsChallenge:i,apiQosName:o}):this._getTokenForResource("oAuth",{resource:c,apiQosName:o,claimsChallenge:i})}getPowerBIToken(e){const{resource:t,apiQosName:n}=e;return this._getTokenForResource("power-bi",{resource:t,apiQosName:n})}getPowerPlatformToken(e){const{resource:t,apiQosName:n}=e;return this._getTokenForResource("power-platform",{resource:t,apiQosName:n})}getPhoneLinkToken(e){const{resource:t,apiQosName:n}=e;return this._getTokenForResource("your-phone",{resource:t,apiQosName:n})}getYammerToken(e){const{resource:t,apiQosName:n}=e;return this._getTokenForResource("yammer",{resource:t,apiQosName:n})}getAzNBToken(e){const{apiQosName:t}=e;return T?r.c.resolve(this.resources.consumeAsync(u.a.bypass)).then(e=>e.fetchToken({resource:W,apiQosName:t})).then(e=>({accessToken:e})):this._getTokenForResource("az-nb",{resource:W,apiQosName:t})}getOfficeHomeToken(e){const{resource:t,apiQosName:n}=e;return T?r.c.resolve(this.resources.consumeAsync(u.a.bypass)).then(e=>e.fetchToken({resource:t,tokenName:"OfficeHome",apiQosName:n})).then(e=>({accessToken:e})):this._getTokenForResource("office-home",{resource:t,apiQosName:n})}getAzRMSToken(e){const{resource:t,apiQosName:n}=e;return this._getTokenForResource("az-rms",{resource:t,apiQosName:n})}getOAuthSessionToken(e){const{endPoint:t,claimsChallenge:n,apiQosName:a}=e;return this._getTokenForResource("oAuth",{resource:t,claimsChallenge:n,...T?{}:{useSpHttpDataSource:Q.indexOf(t)>=0},apiQosName:a})}getFormDigest(e){const{url:t}=e;let n;return n=t?t.split("/_api")[0]+"/_api/contextInfo":this._getContextInfoUrl(),this._dataRequestor.getData({url:n,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(e=>e.d.GetContextWebInformation.FormDigestValue)}_getTokenForResource(e,t){return r.c.resolve((async()=>{if(!N&&this._cachingTokenFetcher&&!t.useSpHttpDataSource)return this._getTokenForResourceWithDelegatedCaching(e,t);const{resource:n,tokenType:a,claimsChallenge:i,scopes:o,forceRefresh:s,apiQosName:c}=t,d=p({tokenName:e,resource:n,tokenType:a,scopes:o}),l=this._promiseCache.get(d),m=this._prefetchPromiseCache?.get(d),_=e=>{const n=E(e),{access_token:a,correlationId:i}=e;return t.skipCache||this._cache.setValue(d,{value:a,expiration:n,correlationId:i}),{accessToken:a,tokenExpiry:n,correlationId:i}};if(i||s)await Promise.all([...l?[l.catch(e=>{})]:[],...m?[m.catch(e=>{})]:[]]),this._cache.setValue(d,void 0);else{const e=this._cache.getValue(d,Date.now());if(e)return{accessToken:e.value,tokenExpiry:e.expiration,correlationId:e.correlationId};if(l){const e=await l;if(e)return e}if(m){this._prefetchPromiseCache?.delete(d);const e=(async()=>{try{const e=await m;let t;if(new f.a(e.qos.start).end({...e.qos.end,resultType:e.qos.success?f.b.Success:f.b.Failure}),e.response){if(!e.response.ok)return;const n=await e.response.json();t=_({...n,correlationId:e.response.headers.get("SPRequestGuid")||""})}return t}catch(e){return}})();this._promiseCache.set(d,e);const t=await e;if(this._promiseCache.delete(d),t)return t}}if(F&&this._offlineDetection.offline)return r.c.resolve({accessToken:"nucleusOfflineToken",tokenExpiry:Date.now()+36e5});const h=async()=>{const t=await this.resources.consumeAsync(u.a.bypass),a=await t.fetchTokenData({resource:n,tokenName:R?e:void 0,claims:i?.claims,scopes:o,apiQosName:c});let r;const s=a.expiresOn?.getTime();return s&&(r=(s/1e3).toString()),{access_token:a.accessToken,expires_on:r}},b=(()=>t.useSpHttpDataSource?h():this._tokenFetcher.getToken({name:e,resource:n,url:n,tokenType:a,claimsChallenge:i,scopes:o,apiQosName:c}))().then(e=>{const t=_(e);return this._promiseCache.delete(d),t},e=>(this._promiseCache.delete(d),r.c.reject(e)));return this._promiseCache.set(d,b),await b})())}_getContextInfoUrl(){return this._apiUrlHelper.build().segment("contextInfo").toString()}_isGraphEndpoint(e){const t=`${this._pageContext.msGraphEndpointUrl}/`;return`${e}/`.slice(0,t.length)===t}async _getTokenForResourceWithDelegatedCaching(e,t){if(F&&this._offlineDetection.offline)return Promise.resolve({accessToken:"nucleusOfflineToken",tokenExpiry:Date.now()+36e5});const{resource:n,apiQosName:a,claimsChallenge:i,forceRefresh:r,scopes:s,skipCache:c,tokenType:d}=t,l=!c&&this._cachingTokenFetcher||this._tokenFetcher,u=await l.getToken({name:e,resource:n,url:n,apiQosName:a,claimsChallenge:i,expiration:r?{error:new o.a_({code:"ForceRefresh "})}:void 0,scopes:s,tokenType:d});return{accessToken:u.access_token,correlationId:u.correlationId,tokenExpiry:E({access_token:u.access_token,expires_on:u.expires_on})}}constructor(e={},t){super(e,t),this._pageContext=t.pageContext,this._dataRequestor=new d.a({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:this._pageContext}),this._cache=t.identityCache,this._promiseCache=new Map,this._prefetchPromiseCache=t.prefetchPromiseCache,this._apiUrlHelper=new l.a({webAbsoluteUrl:this._pageContext.webAbsoluteUrl}),this._tokenFetcher=t.tokenFetcher,this._cachingTokenFetcher=t.cachingTokenFetcher,this._offlineDetection=t.offlineDetection,this._getGraphTokenProviderOverride=t.graphTokenProviderOverride,this._getUserIdentity=t.getUserIdentity}}Y.dependencies={...a.a.dependencies,pageContext:i.a,tokenFetcher:h.a,cachingTokenFetcher:N?void 0:L,prefetchPromiseCache:_.optional,identityCache:x,offlineDetection:C.a,graphTokenProviderOverride:M.optional.lazy,getUserIdentity:v};const J=(0,o.C2)("IdentityDataSource",Y)}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>h,b:()=>L});var a=n(113),i=n("odsp.util_385"),r=n(56),o=n(60);const s=new i.OJ("pdfViewerEmbedOptions");var c=n(99),d=n(4),l=n(283),u=n(27),f=n(1),p=n(96),m=n(31);const _=(0,i.C2)("PdfDataSource",class extends class{canSave(e){return this.canSaveAsOriginal(e)}}{canSaveAsOriginal(e){const{item:t}=e;return!!t&&m.a.hasItemPermission(t,m.a.insertListItems)&&m.a.hasItemPermission(t,m.a.editListItems)&&!this._pageContext?.isAnonymousGuestUser&&!this._pageContext?.isEmailAuthenticationGuestUser}constructor(e,t){super(),this._pageContext=t.pageContext}},{pageContext:f.a.optional});var h,b,g,v=n(114),y=n(284),S=n(57),D=n(106),I=n(115),x=n(285);!function(e){e.GetDownloadUrl="GetDownloadUrl",e.GetDownloadToken="GetDownloadToken"}(h||(h={})),function(e){e.DownloadAspx="DownloadAspx",e.MeTATransform="Transform",e.VroomContent="VroomContent",e.Unknown="Unknown"}(b||(b={})),function(e){e.MipFetchTokenUserCancelled="MipFetchTokenUserCancelled",e.MipFetchTokenMonitorTimeout="MipFetchTokenMonitorTimeout",e.MipFetchTokenPostFailed="MipFetchTokenPostFailed",e.MipFetchTokenAccessDenied="MipFetchTokenAccessDenied",e.MipFetchTokenPopUpBlocked="MipFetchTokenPopUpBlocked",e.MipFetchTokenRequestPreviouslyFailed="MipFetchTokenRequestPreviouslyFailed",e.MipFetchTokenAnonymousUser="MipFetchTokenAnonymousUser",e.MipFetchTokenResourceNotAllowed="MipFetchTokenResourceNotAllowed",e.MipFetchTokenFailed="MipFetchTokenFailed"}(g||(g={}));const C=["user_canceled","user_cancelled"],O=".pdf",w=(0,d.jb)(d.R)?20971520:52428800,E=["ODBLightSpeedWebPack","TeamsODBFileBrowserWebPack","ODBUWP"];class A{static isWasmSupported(){if(void 0===A._isWasmSupported){let e=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){const t=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));t instanceof WebAssembly.Module&&(e=new WebAssembly.Instance(t)instanceof WebAssembly.Instance)}}catch(e){}A._isWasmSupported=e}return A._isWasmSupported}isNotEmbed(){return this._urlDataSource.getPageType(this._viewParams)!==c.a.Embed}isSameDomainEmbed(e){if(this.isNotEmbed())return;const t=this._getHostOriginFromQSP(),n=window.location.origin;return t?t===n&&n===new URL(e).origin:void 0}isSupportedFileType(e){const t=this._extension(e);return this._enablePdf&&(t===O||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)}isProgressiveLoadingEnabled(e){return!(!(0,d.jb)(d.u)&&!(0,y.a)(d.t.ECS)||!e.size||e.pdfConversion||!(0,d.jb)(d.Q)&&!(this._platformDetection.isMobile?e.size>10485760:e.size>w))}isODSPCopilotEnabled(e){return!!(0,d.jb)(d.i)}isMsPdfViewerSupported(){const e=this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer),t=this._isHostAppTeams()&&(0,y.a)(d.X.ECS),n=!this.isNotEmbed()&&(this._embedOptions?.useMsPdf||!1);return(e||t||n)&&this._isMsPdfViewerSupported()}isMsPdfViewerAvailable(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported()}isPdfEditAvailable(e){const t=!!e.size&&e.size<=S.w;return this.isMsPdfViewerAvailable(e)&&(this._enableEditPdf||!this.isNotEmbed())&&this._extension(e)===O&&t}isPdfExtractAvailable(e){const t=!!e.size&&e.size<=S.x;return this._hasBypassOrSyntexAccess()&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf&&this._extension(e)===O&&t}isPdfEncryptAvailable(e){return!!e.size&&e.size<=S.x&&this._enableEncryptPdf&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()}isWatermarkAvailable(e){return this._hasBypassOrSyntexAccess()&&this._enableWatermark&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()}isPdfCompressAvailable(e){const t=!!e.size&&e.size<=S.x;return this._enableCompressPdf&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._extension(e)===O&&t}isPdfExtractable(){return this._hasBypassOrSyntexAccess()&&this._enableExtractPdf}isPdfOutlineAvailable(e){return(0,d.jb)(d.J)&&this.isMsPdfViewerAvailable(e)}isPdfOutlineNextAvailable(e){return(0,d.jb)(d.I)&&this.isPdfOutlineAvailable(e)}isPdfEditable(e){return e.itemStatus!==a.b.ConditionalAccessViewOnly&&e.itemStatus!==a.b.ConditionalAccessBlocked&&this._pdfDataSource?.canSave({item:e})}isPdfPrintable(e){return!!(e&&e.extension&&e.openUrl&&e.itemStatus!==a.b.ConditionalAccessViewOnly&&e.itemStatus!==a.b.ConditionalAccessBlocked&&m.a.hasItemPermission(e,m.a.openItems))}isPdfPrintEnabled(){return!this.isNotEmbed()&&!(0,v.t)()&&(this._embedOptions?.enablePdfPrint??!1)}getWorkerManifestName(){if((0,v.y)()){const e=window._spModuleLink?.manifestName||"";return(0,d.jb)(d.x)&&-1!==E.indexOf(e)?"odbmspdfwebworker":"mspdfwebworker"}return this.isNotEmbed()?void 0:"embedmspdfwebworker"}getEmbedOptions(){return this._embedOptions}hasSyntexLicense(){return this._pageContext?.canUserUseSyntex||this._pageContext?.isUserSyntexV2Licensed||!1}isNoTempAuthEnabled(){return this._isMicroserviceEmbed()?!(0,y.b)(d.N.ECS)&&!!this._embedOptions?.hostHasTokenProvider:!(0,v.v)()}isTempAuthDeprecated(e){return this.isNotEmbed()?e?.downloadUrl?!(0,v.p)()&&this._enableDeprecateTempAuthForPrefetch:!(0,v.q)()&&this._enableDeprecateTempAuth:!((0,v.s)()||!e.urls||!e.urls[D.a.downloadUrlNoAuth])&&(this.isSameDomainEmbed(e.urls[D.a.downloadUrlNoAuth])?this._enableNoTempAuthForEmbedSameDomain:this._enableNoTempAuthForEmbedCrossDomain&&!!this._embedOptions?.hostHasTokenProvider)}getPdfSource(e){if(!e)return"DownloadAspx";const t=e.url;if(t){if((0,I.b)(t)){const{urlPath:e="",inputFormat:n=""}=(0,I.a)(t)||{};return`Transform_${e}_${n}`}return"Unknown"}return"VroomContent"}getTempAuthLogData(e){if(!(0,v.r)()&&e.url){const t=(0,x.a)(e.url);return void 0!==t?{isPdfNoTempAuth:!t,isPdfUseToken:!!e.token}:{isPdfUseToken:!!e.token}}}handleMipTokenError(e){let t=!1,n="MipFetchTokenFailed";const a=e?.message?.toLocaleLowerCase();return C.some(e=>a.includes(e))?(n="MipFetchTokenUserCancelled",t=!0):a.includes("monitor_window_timeout")?n="MipFetchTokenMonitorTimeout":a.includes("post_request_failed")?n="MipFetchTokenPostFailed":a.includes("access_denied")?n="MipFetchTokenAccessDenied":a.includes("popup_window_error")?n="MipFetchTokenPopUpBlocked":a.includes("token request previously failed")?n="MipFetchTokenRequestPreviouslyFailed":a.includes("anonymous or email authenticated guest user")?(n="MipFetchTokenAnonymousUser",t=!0):a.includes("resource is not allowed")&&(n="MipFetchTokenResourceNotAllowed"),new i.a_({code:n,message:e?.message,isExpected:t})}_hasBypassOrSyntexAccess(){return!!(0,d.jb)(d.S)||this.hasSyntexLicense()}_isMicroserviceEmbed(){return!this.isNotEmbed()&&"embedwebpack"===window.Flight?.manifest}_isHostAppTeams(){if(this.isNotEmbed())return!1;const e=this._getClientId();return!!e&&-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)}_isEnabledInOneUp(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)}_isMsPdfViewerSupported(){return A.isWasmSupported()}_extension(e){return e&&e.extension&&e.extension.toLowerCase()||""}_getClientId(){const e=this._pageContext?.authToken||"",t=(0,o.b)(e);return t&&t.app_displayname||this._getClientIdFromQSP()}_getClientIdFromQSP(){const e=window;return{...(0,i.pW)((e.location.search||"").slice(1)),...(0,i.pW)((e.location.hash||"").slice(1)),...e.PageContext?.scenarioContext.embed||{}}.client_id}_getHostOriginFromQSP(){const e=window,t=(0,i.pW)((e.location.hash||"").slice(1));if(t.origin)return t.origin;const n=(0,i.pW)((e.location.search||"").slice(1));if(n.embed)try{return JSON.parse(n.embed).o}catch(e){return}}constructor(e,t){this.isWorkerVersionMismatch=e=>{const t=window._spModuleLink?.buildNumber;return"dev"!==t&&!(!e||!t)&&e!==t},this._enablePdf=(0,d.jb)(d.tb),this._enableMsPdfviewer=(0,d.jb)(d.Y),this._enableEmbedMsPdfviewer=(0,d.jb)(d.e),this._enableEditPdf=(0,d.jb)(d.d),this._enableExtractPdf=(0,d.jb)(d.H),this._enableWatermark=(0,d.jb)(d.D),this._enableEncryptPdf=(0,d.jb)(d.G),this._enableCompressPdf=(0,d.jb)(d.F),this._enablePreviewTif=(0,d.jb)(d.Z),this._enableDeprecateTempAuth=(0,d.jb)(d.L),this._enableDeprecateTempAuthForPrefetch=(0,d.jb)(d.K),this._enableNoTempAuthForEmbedSameDomain=(0,d.jb)(d.O),this._enableNoTempAuthForEmbedCrossDomain=(0,d.jb)(d.M),this._enableHTML=(0,d.jb)(d._)&&((0,l.a)()||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._platformDetection=t.platformDetection,this._pageContext=t.pageContext,this._embedOptions=t.embedOptions}}A.dependencies={};const L=(0,i.C2)("PdfViewerHelper",A,{platformDetection:r.a,urlDataSource:p.a,navigation:u.a,pdfDataSource:_,pageContext:f.a.optional,embedOptions:s.optional})}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"platformDetection",factory:new a.zX(a.SW)})}
,(e,t,n)=>{"use strict";n.d(t,{A:()=>r,a:()=>A,b:()=>m,c:()=>h,d:()=>_,e:()=>D,f:()=>v,g:()=>c,h:()=>s,i:()=>o,j:()=>l,k:()=>u,l:()=>d,m:()=>f,n:()=>E,o:()=>O,p:()=>C,q:()=>I,r:()=>w,s:()=>x,t:()=>S,u:()=>y,v:()=>p,w:()=>g,x:()=>b,y:()=>i,z:()=>a});var a=.5,i=5,r=90,o=14,s=3,c=7,d=5,l=5,u=5,f=150,p=96,m=100,_=1,h=255,b=3e8,g=1e8,v=255,y="MsPdfViewer.GLOBAL_ZOOM_OPTION_STORE_KEY",S="MsPdfViewer.GLOBAL_OUTLINE_DEFAULT_OFF_STORE_KEY ",D="MsPdfViewer.CACHED_DISPLAY_INFO_ARRAY_STORE_KEY",I={r:0,g:81,b:186,a:1},x=1.12,C=-1,O=0,w="freeTextInitialAttributes",E=5242880,A="AbortError"}
,,,,,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>i,b:()=>a}),function(e){e.Start="start",e.Succeed="succeed",e.Fail="fail"}(a||(a={})),function(e){e.DocumentPreviewDone="DocumentPreviewDone",e.DocumentLoad="DocumentLoad",e.DocumentSave="DocumentSave",e.DocumentExtract="DocumentExtract",e.DocumentMerge="DocumentMerge",e.DocumentEncrypt="DocumentEncrypt",e.DocumentCompress="DocumentCompress",e.DocumentProgressiveLoad="DocumentProgressiveLoad",e.DocumentProgressiveLoadDownloadFullDocument="DocumentProgressiveLoadDownloadFullDocument",e.DocumentGetWatermark="DocumentGetWatermark",e.DocumentAddWatermark="DocumentAddWatermark",e.DocumentDeleteWatermark="DocumentDeleteWatermark",e.DocumentUpdateWatermark="DocumentUpdateWatermark",e.Copilot="Copilot",e.MipDocumentLoad="MipDocumentLoad"}(i||(i={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>f,b:()=>a,c:()=>u,d:()=>i,e:()=>l,f:()=>p});var a,i,r=n("tslib_145");!function(e){e.EventHandleFailed="EventHandleFailed",e.FileDownloadFailed="FileDownloadFailed",e.RangeDownloadSizeMismatch="RangeDownloadSizeMismatch",e.FontLoadFailed="FontLoadFailed",e.PrintFailed="PrintFailed",e.PrintNoPermission="PrintNoPermission",e.ShowThumbnailFailed="ShowThumbnailFailed",e.Unknown="Unknown",e.WasmModuleInitFailed="WasmModuleInitFailed",e.WasmModuleNotFound="WasmModuleNotFound",e.WasmRuntimeError="WasmRuntimeError",e.WasmCacheFailed="WasmCacheFailed",e.AnnotationAddFailed="AnnotationAddFailed",e.PdfJsPreviewFailed="PdfJsPreviewFailed",e.InvalidPDF="InvalidPDF",e.PDFWorkerMismatch="PDFWorkerMismatch",e.PreviewerFailToLoadTask="PreviewerFailToLoadTask",e.PreviewerFailToLoadPage="PreviewerFailToLoadPage",e.PreviewerFailToFetchFile="PreviewerFailToFetchFile",e.PreviewerUnmounted="PreviewerUnmounted",e.PdfLoadCanceled="PdfLoadCanceled",e.ViewContextNotInitialized="ViewContextNotInitialized",e.PreRenderError="PreRenderError",e.GetPdfStreamFailed="GetPdfStreamFailed",e.UploadFileDataFailed="UploadFileDataFailed",e.RangeDownLoadFailed="RangeDownLoadFailed",e.RangeDownloadFileSizeMismatch="RangeDownloadFileSizeMismatch",e.ProgressiveLoadFailed="ProgressiveLoadFailed",e.ProgressiveLoadFetchRangeFailed="ProgressiveLoadFetchRangeFailed",e.ProgressiveLoadParsingFailed="ProgressiveLoadParsingFailed",e.ProgressiveLoadFetchByStreamFailed="ProgressiveLoadFetchByStreamFailed",e.WatermarkOperationFailed="WatermarkOperationFailed",e.UndoFailed="UndoFailed",e.RedoFailed="RedoFailed",e.GetUndoRedoStatusFailed="GetUndoRedoStatusFailed",e.ClearRedoStackFailed="ClearRedoStackFailed"}(a||(a={})),function(e){e.PDFError="PDFError",e.PdfOpenError="PdfOpenError",e.PdfWorkerMismatchError="PdfWorkerMismatchError",e.NetworkError="NetworkError"}(i||(i={}));var o,s="MsPdfViewer",c=function(e,t,n,a){return{error:{name:e,message:t,stack:n},extraData:{location:s,code:a}}},d=function(e,t,n,a){return void 0===a&&(a=!1),{isExpected:a,code:e,error:{name:e,message:t,stack:n},extraData:{location:s}}},l=function(e){function t(n,a,i){var r=this;return void 0!==i&&(a=JSON.stringify({message:a,isExpected:i})),(r=e.call(this,a)||this).toCaughtError=function(){return c(r.name,r.message,r.stack)},Object.setPrototypeOf(r,t.prototype),r.name=n,r.isExpected=i,r}return(0,r.e2)(t,e),t.prototype.toQosError=function(){return d(this.name,this.message,this.stack,this.isExpected)},t.getParsedErrorData=function(e){var t=function(){try{return JSON.parse(e.message)}catch(e){return{}}}();return{isExpected:t.isExpected||!1,error:t.message||e.message||"Unknown error",code:e.name}},t}(Error),u=function(e){function t(n,a,r){void 0===r&&(r=!1);var o=e.call(this,a)||this;return o.toString=function(){return"[".concat(o.name,"] code: ").concat(o.code,", message: ").concat(o.message,", stack: ").concat(o.stack)},o.toCaughtError=function(){return c(o.name,o.message,o.stack,o.code)},Object.setPrototypeOf(o,t.prototype),o.name=i.PDFError,o.code=n,o.isExpected=r,o}return(0,r.e2)(t,e),t.prototype.toQosError=function(){return d(this.code||this.name,this.message,this.stack,this.isExpected)},Object.defineProperty(t.prototype,"errorCode",{get:function(){return this.code||a.Unknown},enumerable:!1,configurable:!0}),t}(Error),f=function(e){function t(n,a,o,c,d,l){var u=e.call(this,"".concat(n||a,".").concat(o||"GetFile"),c,l)||this;return u.toQosError=function(){return(0,r.q5)((0,r.q5)({},e.prototype.toQosError.call(u)),{extraData:{location:s,status:u.status,responseHeaders:u.responseHeaders}})},Object.setPrototypeOf(u,t.prototype),u.name=i.NetworkError,u.status=n,u.statusText=a,u.where=o,u.responseHeaders=d,u}return(0,r.e2)(t,e),t}(u),p=(o=u,(0,r.e2)(function e(t){var n=o.call(this,a.InvalidPDF,t,!0)||this;return Object.setPrototypeOf(n,e.prototype),n.name=i.PdfOpenError,n},o),function(e){function t(n){var r=e.call(this,a.PDFWorkerMismatch,n,!1)||this;return Object.setPrototypeOf(r,t.prototype),r.name=i.PdfWorkerMismatchError,r}return(0,r.e2)(t,e),t}(u))}
,,,,,,,(e,t,n)=>{"use strict";var a,i,r,o,s,c,d,l,u;n.d(t,{a:()=>c,b:()=>d,c:()=>r,d:()=>s,e:()=>a,f:()=>o,g:()=>u,h:()=>l,i:()=>i}),function(e){e.HighlightLink="HighlightLink",e.ClearHighlightLink="ClearHighlightLink",e.InkStrokesAdded="InkStrokesAdded",e.InkAdded="InkAdded",e.InkUpdated="InkUpdated",e.DocumentDirty="DocumentDirty",e.DocumentSaved="DocumentSaved",e.InvalidateRect="InvalidateRect",e.InvalidateRectForAnnot="InvalidateRectForAnnot",e.ShowFreeText="ShowFreeText",e.ShowTextField="ShowTextField",e.ScaleChanged="ScaleChanged",e.ResponsiveResize="ResponsiveResize",e.RotationChanged="RotationChanged",e.AnnotationChanged="AnnotationChanged",e.Scrolling="Scrolling",e.ZoomStart="ZoomStart",e.ZoomEnd="ZoomEnd",e.Pinching="Pinching",e.InitialDisplayInfoApplied="InitialDisplayInfoApplied",e.DocumentReloaded="DocumentReloaded",e.VisiblePagesLoaded="VisiblePagesLoaded",e.ShowEditableInk="ShowEditableInk",e.ShowErasableInk="ShowErasableInk",e.TriggerInkDrying="TriggerInkDrying",e.WatermarkVisible="WatermarkVisible",e.WatermarkSaved="WatermarkSaved",e.TouchDrawingStateChange="TouchDrawingStateChange",e.CanUndoRedoChanged="CanUndoRedoChanged",e.UndoStroke="UndoStroke",e.RedoStroke="RedoStroke",e.UndoRedoTriggered="UndoRedoTriggered",e.UndoRedoUpdated="UndoRedoUpdated"}(a||(a={})),function(e){e.FitSize="FitPageWithWindowSize",e.FitWidth="FitPageWithWindowWidth"}(i||(i={})),function(e){e.Default="default",e.Text="text",e.Link="pointer"}(r||(r={})),function(e){e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270"}(o||(o={})),function(e){e[e.Success=0]="Success",e[e.InvalidContentType=1]="InvalidContentType",e[e.InvalidContentDisposition=2]="InvalidContentDisposition",e[e.DocumentCancelled=4]="DocumentCancelled",e[e.PdfiumUnknown=5]="PdfiumUnknown",e[e.PdfiumFile=6]="PdfiumFile",e[e.PdfiumFormat=7]="PdfiumFormat",e[e.PdfiumUnsupportedSecurity=8]="PdfiumUnsupportedSecurity",e[e.PdfiumPage=9]="PdfiumPage",e[e.PdfiumXfaLoad=10]="PdfiumXfaLoad",e[e.PdfiumXfaLayout=11]="PdfiumXfaLayout",e[e.IncorrectPassword=12]="IncorrectPassword",e[e.IncorrectResponseStatus=13]="IncorrectResponseStatus",e[e.UnexpectedError=14]="UnexpectedError",e[e.IncorrectMIPAuth=15]="IncorrectMIPAuth",e[e.EmptyMIPAuth=16]="EmptyMIPAuth"}(s||(s={})),function(e){e[e.None=0]="None",e[e.Ink=1]="Ink",e[e.Erase=2]="Erase",e[e.Highlight=3]="Highlight",e[e.FreeText=4]="FreeText",e[e.PointErase=5]="PointErase",e[e.Watermark=6]="Watermark"}(c||(c={})),function(e){e.Form="Form"}(d||(d={})),function(e){e[e.None=0]="None",e[e.Saving=1]="Saving",e[e.Done=2]="Done",e[e.Failed=3]="Failed"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.EditsSaved=2]="EditsSaved",e[e.Deleted=3]="Deleted"}(u||(u={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>p,c:()=>l,d:()=>m,e:()=>f,f:()=>u,g:()=>c,h:()=>_,i:()=>i.a,j:()=>s,k:()=>o,l:()=>r});var a=n("odsp.util_385"),i=n(35);a.Ov.isActivated("ADD22FCF-682C-4C09-975D-664352383E72"),a.Ov.isActivated("B91F0E95-6979-43B3-AB45-EF0D38DCBA16");const r=window._spPageContextInfo,o=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,s=!r||"21"===r.webTemplate&&700===r.listBaseTemplate,c=(window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,a.Ov.isActivated("00aa15f3-56ad-456e-84e4-13a81c33c9b8"),{ODB:60798,ODC:"DownloadDebugLogs"}),d={Fallback:!a.Ov.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")},l=(a.Ov.isActivated("D5785406-7DE5-44D8-AC99-33F3E6A967F2"),a.Ov.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly."),(0,i.a)({ODB:61957}),{ODB:!a.Ov.isActivated("4EE5E12D-167E-4A66-BE5E-71E34C8291AA")&&62152}),u={ODB:!a.Ov.isActivated("4E60AAE1-23CA-4515-B68B-106C3B47DC34")&&62153},f={ODB:!a.Ov.isActivated("4CDEDDDC-D32E-48ED-8965-E3F03E7002E7")&&62187},p={ODB:!!a.Ov.isActivated("89BF4904-6D98-4D31-9E4C-B8894827B62B")||!a.Ov.isActivated("4C4C0B55-FF26-4263-8379-A7B39CC514EF")&&62659},m={ODB:s?60875:1408},_={ODB:1934};a.Ov.isActivated("6C1EAAAD-B308-4B7C-80EE-05531A74980A"),a.Ov.isActivated("935897F1-9D61-4770-896A-D5A1C0341C4E"),a.Ov.isActivated("78140CE2-6676-4C6F-9697-D067DA79B9E6")}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>v});var a=n("odsp.util_385"),i=n(96),r=n(288),o=n(97),s=n(9),c=n(95),d=n(41),l=n(225);const u=new a.OJ("forceAadTokenInSessionManagementProvider"),f=!a.Ov.isActivated("5190349E-1CFC-4163-AA2E-1494CEAFD7DF");class p{getToken(e){const{path:t,apiVersion:n,apiQosName:i,disallowSelfIssuedToken:o,useStrongAuthToken:c}=e,l=this._identityDataSource.getIdentity().type,u=new d.a(t).authority;if(l!==r.a.aad&&!this._forceAadTokenInSessionManagementProvider)return f&&u?this._identityDataSource.getSessionToken({resource:u,apiQosName:i}):this._identityDataSource.getSessionToken({apiQosName:i});if(c&&this._identityDataSource.getStrongAuthToken)return this._identityDataSource.getStrongAuthToken({apiQosName:i});if(t&&this._alwaysUseTokenFetcherForVroom){const e=new d.a(t).authority;return this._identityDataSource.getSharePointToken?.({webAbsoluteUrl:e,apiQosName:i,disallowSelfIssuedToken:o})}return this._microServiceDataSource?this._microServiceDataSource.getAuthData().then(e=>{if(e)return n&&"v2.1"===n?{accessToken:e.authTokenV21,proofToken:e.proofTokenV21,tokenUrl:e.tokenUrlV21}:{accessToken:e.authToken,proofToken:e.proofToken,tokenUrl:e.tokenUrl}},e=>s.c.resolve()):s.c.reject(new a.a_({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))}getFormDigest(e){const{url:t}=e;return this._identityDataSource.getFormDigest?.({url:t})}constructor(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource,this._alwaysUseTokenFetcherForVroom=t.alwaysUseTokenFetcherForVroom,this._forceAadTokenInSessionManagementProvider=t.forceAadTokenInSessionManagementProvider}}p.dependencies={identityDataSource:c.a,microServiceDataSource:o.a.optional,alwaysUseTokenFetcherForVroom:l.a,forceAadTokenInSessionManagementProvider:u.optional};const m=(0,a.C2)("SessionManagementProvider",p);var _=n(228),h=n(448),b=n(451);const g=new a.OJ({name:"VroomDataRequestor.isOfflineStatePromise",factory:{dependencies:{isOfflineStateObservable:h.a},create:e=>({instance:()=>s.c.resolve(e.isOfflineStateObservable.get())})}}),v=(0,a.C2)("VroomDataRequestor",_.a,{sessionManagementProvider:m.optional,urlDataSource:i.a.optional,cookieOrigin:b.a,isOffline:g})}
,,(e,t,n)=>{"use strict";var a,i,r;n.d(t,{a:()=>a,b:()=>i,c:()=>r}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={})),function(e){e.Focus="focus",e.Visible="visible",e.Hidden="hidden"}(i||(i={})),function(e){e.ExitEditMode="ExitEditMode",e.MetadataUpdated="MetadataUpdated"}(r||(r={}))}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>h,b:()=>_,c:()=>g,d:()=>p,e:()=>c,f:()=>u,g:()=>m,h:()=>l,i:()=>s,j:()=>i,k:()=>d,l:()=>b,m:()=>f,n:()=>o,o:()=>r});var a=n("odsp.util_385");n(1);const i=new a.OJ("ResourceKeys"),r=new a.OJ("ResourceKeys"),o=new a.OJ("ResourceKeys"),s=new a.OJ("ResourceKeys"),c=new a.OJ("ResourceKeys"),d=new a.OJ("ResourceKeys"),l=new a.OJ("ResourceKeys"),u=new a.OJ("ResourceKeys"),f=new a.OJ("ResourceKeys"),p=new a.OJ("getTextContentFallbackAsync"),m=new a.OJ("initTelemetryHandler"),_=new a.OJ("fastOneUpClientName"),h=new a.OJ("accountType"),b=new a.OJ("isPdfPremiumFeaturesEnabled"),g=new a.OJ("getOneUpFabCommands")}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>i});var a=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},e.prototype.midPointTo=function(t){return new e((this.x+t.x)/2,(this.y+t.y)/2)},e.prototype.symmetricMap=function(){return new e(-this.x,-this.y)},e.prototype.plus=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.scale=function(e){return this.x*=e,this.y*=e,this},e.prototype.round=function(){return Math.round(this.x),Math.round(this.y),this},e}(),i=function(){function e(e,t,n,i){this.origin=new a(e,t),this.size={width:n,height:i}}return e.create=function(t){return new e(t.origin.x,t.origin.y,t.size.width,t.size.height)},e.prototype.scale=function(e){return this.origin.scale(e),this.width*=e,this.height*=e,this},e.prototype.intersect=function(t){if(t){var n=Math.max(this.x,t.x),a=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return n<a&&i<r?new e(n,i,a-n,r-i):void 0}},e.prototype.area=function(){return this.width*this.height},e.prototype.ceil=function(){var e=this.right,t=this.bottom;return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.ceil(e)-this.x,this.height=Math.ceil(t)-this.y,this},e.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},e.prototype.toString=function(){return"(".concat(this.x,", ").concat(this.y,"), ").concat(this.width," * ").concat(this.height)},Object.defineProperty(e.prototype,"x",{get:function(){return this.origin.x},set:function(e){this.origin.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.origin.y},set:function(e){this.origin.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.size.width},set:function(e){this.size.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.size.height},set:function(e){this.size.height=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a,i,r=n("tslib_145");!function(e){e.MSPDF_LOG_VERBOSE="VERBOSE",e.MSPDF_LOG_INFO="INFO",e.MSPDF_LOG_WARNING="WARNING",e.MSPDF_LOG_ERROR="ERROR"}(a||(a={})),function(e){e.GREEN="green",e.CYAN="cyan"}(i||(i={}));var o=function(){function e(){}return e._format=function(e,t,n){return"[".concat("MSPDFKit-Web","] ").concat(e," | ").concat(t,": ").concat(n)},e._tint=function(e,t){return["%c".concat(e),"color:".concat(t)]},e.prototype.verbose=function(t,n){console.log(e._format(a.MSPDF_LOG_VERBOSE,t,n))},e.prototype.info=function(t,n){console.info.apply(console,(0,r.lt)([],(0,r.pM)(e._tint(e._format(a.MSPDF_LOG_INFO,t,n),i.GREEN)),!1))},e.prototype.warn=function(t,n){console.warn(e._format(a.MSPDF_LOG_WARNING,t,n))},e.prototype.error=function(t,n){console.error(e._format(a.MSPDF_LOG_ERROR,t,n.toString()))},e.prototype.time=function(e){console.time(e)},e.prototype.timeEnd=function(e){console.timeEnd(e)},e}(),s=function(){function e(){}return Object.defineProperty(e,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!1,configurable:!0}),e.initialize=function(t){e._logHandler=t},e.verbose=function(t,n){e.enabled&&e._logHandler.verbose(t,n)},e.info=function(t,n){e.enabled&&e._logHandler.info(t,n)},e.warn=function(t,n){e.enabled&&e._logHandler.warn(t,n)},e.error=function(t,n){e.enabled&&e._logHandler.error(t,n)},e.time=function(t){e.enabled&&e._logHandler.time&&e._logHandler.time(t)},e.timeEnd=function(t){e.enabled&&e._logHandler.timeEnd&&e._logHandler.timeEnd(t)},e._enabled=!1,e._logHandler=new o,e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l});var a=n("tslib_145"),i=n(63),r=n(301),o=function(){function e(e,t,n){var a=new r.d(e);t(a),this._id=a.payload.id,this._name=e.name,this._active=!0,this._startExtraData=e.extraData||{},this._logQosEnd=n}return e.prototype.stop=function(e){this._active&&this._logEnd(i.b.Succeed,e||{})},e.prototype.fail=function(e){this._active&&this._logEnd(i.b.Fail,(0,a.q5)({isExpected:!1},e))},e.prototype._logEnd=function(e,t){t.extraData=(0,a.q5)((0,a.q5)({},this._startExtraData),t.extraData);var n=new r.c(this._id,this._name,e,t);this._logQosEnd(n),this._active=!1},e}(),s="PDF:Telemetry".concat("undefined"==typeof window?" | Worker":""),c=function(){function e(){}return e.prototype.logQosStart=function(e){var t=e.payload;console.log("[".concat(s,"] [").concat(e.type,"]: ").concat(t.id," | ").concat(t.name,": ").concat(t.status,",\n        ").concat(t.startTime,", extraData: ").concat(JSON.stringify(t.extraData)))},e.prototype.logQosEnd=function(e){var t=e.payload,n="[".concat(s,"] [").concat(e.type,"]: ").concat(t.id," | ").concat(t.name,": ").concat(t.status,", ").concat(t.endTime,", ");switch(t.status){case i.b.Succeed:var a=t;n+="extraData: ".concat(JSON.stringify(a.extraData));break;case i.b.Fail:var r=t,o=r.error;n+="isExpected: ".concat(r.isExpected,", code: ").concat(r.code," error: { name: ").concat(o.name,", message: ").concat(o.message," }, extraData: ").concat(JSON.stringify(r.extraData))}console.log(n)},e.prototype.logEngagement=function(e){this._log(e)},e.prototype.logError=function(e){this._log(e)},e.prototype.logVerbose=function(e){this._log(e)},e.prototype._log=function(e){console.log("[".concat(s,"] [").concat(e.type,"]: ").concat(JSON.stringify(e.payload)))},e}(),d=function(){function e(){}return e.initialize=function(t){e._handler=t},e.createScenario=function(t){var n=e.handler,a=n.logQosStart,i=n.logQosEnd;return new o(t,a,i)},e.logEngagement=function(t){var n=new r.b(t);e.handler.logEngagement(n)},e.logError=function(t){var n=new r.a(t);e.handler.logError(n)},e.logVerbose=function(t){var n,a,i=new r.e(t);null===(a=(n=e.handler).logVerbose)||void 0===a||a.call(n,i)},Object.defineProperty(e,"handler",{get:function(){return e._handler},enumerable:!1,configurable:!0}),e._handler=new c,e}(),l=d.initialize}
,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("identity")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("urlLite")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("MicroServiceDataSource.key.microServiceDataSource")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("odsp.util_385"),i=n(287),r=n(35);const o=new a.OJ({name:"offlineDetection",factory:(0,r.a)({ODB:60362})?new a.zX(class{onChange(e){return this._detector.onChange(e)}get offline(){return this._detector.offline}constructor(){this._detector=(0,i.a)(!0)}}):new a.zX(class{onChange(){return()=>{}}get offline(){return!1}})})}
,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.Loading=0]="Loading",e[e.Files=1]="Files",e[e.FilePicker=2]="FilePicker",e[e.FolderPicker=3]="FolderPicker",e[e.Photos=4]="Photos",e[e.TextFileEditor=5]="TextFileEditor",e[e.AccountChooser=6]="AccountChooser",e[e.StorageInfo=7]="StorageInfo",e[e.StorageOptions=8]="StorageOptions",e[e.AppData=9]="AppData",e[e.Error=10]="Error",e[e.SyncOnboarding=11]="SyncOnboarding",e[e.Share=12]="Share",e[e.OneUp=14]="OneUp",e[e.PhotoPreferences=15]="PhotoPreferences",e[e.Embed=16]="Embed",e[e.SyncPlaceholders=17]="SyncPlaceholders",e[e.Restore=18]="Restore",e[e.ValidatePermission=20]="ValidatePermission",e[e.RansomwareDetection=21]="RansomwareDetection",e[e.Settings=22]="Settings",e[e.Unlock=23]="Unlock",e[e.MobileAppUpsell=24]="MobileAppUpsell",e[e.FileRequest=26]="FileRequest",e[e.CreateList=27]="CreateList",e[e.ManageVault=28]="ManageVault",e[e.RequestAccess=29]="RequestAccess",e[e.TraceMe=30]="TraceMe",e[e.FileBrowser=31]="FileBrowser",e[e.TagPreferences=32]="TagPreferences",e[e.PhotoStream=33]="PhotoStream",e[e.Convergence=34]="Convergence",e[e.DocumentOptions=35]="DocumentOptions",e[e.DeviceBackups=37]="DeviceBackups",e[e.Search=38]="Search",e[e.NotificationOptions=39]="NotificationOptions",e[e.ContentAssembly=40]="ContentAssembly",e[e.MetaOSAuthPopup=41]="MetaOSAuthPopup",e[e.CloudImport=42]="CloudImport",e[e.DigitalLegacy=43]="DigitalLegacy",e[e.SharingSettings=301]="SharingSettings",e[e.SyncSettings=302]="SyncSettings",e[e.StorageSettings=303]="StorageSettings",e[e.AccessPolicySettings=304]="AccessPolicySettings",e[e.ComplianceSettings=305]="ComplianceSettings",e[e.NotificationSettings=306]="NotificationSettings",e[e.GeoLocations=307]="GeoLocations"}(a||(a={}));const i=a}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f,b:()=>p,c:()=>u,d:()=>m,e:()=>_,f:()=>s,g:()=>b,h:()=>i,i:()=>h,j:()=>l,k:()=>d,l:()=>r,m:()=>o,n:()=>c,o:()=>g});var a=n(4);const i="OneUpLightSpeed.fastOneUp.boot",r="OneUpLightSpeed.fastOneUp.getSingleItem",o="OneUpLightSpeed.getSingleItem.preloadRLDSData",s="OneUpLightSpeed.getSingleItem.callRLDS_gListDataInvalid",c="OneUpLightSpeed.getSingleItem.race.callRLDS",d="OneUpLightSpeed.fastOneUp.getSingleItemFavoriteStatus",l="OneUpLightSpeed.getSingleItem.ensureParentItem",u=(0,a.Ib)()?5e3:3e5,f=(0,a.Ib)()?5e3:12e4,p=(0,a.Ib)()?5e3:12e4;var m,_;function h(e,t){const n=new Error(e);return n.name=t||e,n}function b(e){if(!e)return"NA";if(e<0)return"Unknown";const t=Math.log(e)/Math.LN2|0;return`${1<<t%10}-${1<<t%10+1}${t<10?" B":` ${"KMGTPEZY"[t/10-1|0]}iB`}`}function g(e){if(e)try{const t=JSON.stringify(e),n=new RegExp(/\"http[s]*:\/\/(.*?)\"/,"g");return t.replace(n,'"<sanitized>"')}catch(e){return"failed to sanitize raw error for logging"}return""}!function(e){e.rldsApiError="rldsApiError",e.viewerInitLoadingError="viewerInitLoadingError",e.genericViewerLoadingError="genericViewerLoadingError",e.actionError="actionError",e.reactRenderError="reactRenderError",e.processOneUpItemError="processOneUpItemError",e.rldsApiErrorNoAccess="rldsApiErrorNoAccess"}(m||(m={})),function(e){e.inlineOneUpFirstPage="inlineOneUpFirstPage",e.inlineOneUpSlide="inlineOneUpSlide",e.fastOneUp="fastOneUp"}(_||(_={}))}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>x,b:()=>C,c:()=>o,d:()=>d,e:()=>v,f:()=>r,g:()=>D,h:()=>i,i:()=>c,j:()=>y,k:()=>S,l:()=>s,m:()=>I,n:()=>_,o:()=>b,p:()=>f,q:()=>u,r:()=>m,s:()=>p,t:()=>E,u:()=>h,v:()=>l,w:()=>g,x:()=>O,y:()=>w});var a=n("odsp.util_385");const i=()=>a.Ov.isActivated("facbf24e-8794-4b51-9003-45d3abd49d9b","09/28/2023","Fix sharee can not save pdf change"),r=()=>a.Ov.isActivated("0e5640e9-b84f-4cd2-abf5-46e9e6177353","12/02/2023","Do not send version request for view only PDF"),o=()=>a.Ov.isActivated("5b9870f7-f2fd-4892-baf4-5cdf182ff84f","29/02/2024","Do not activate esign new design"),s=()=>a.Ov.isActivated("068F8934-7C5F-4B80-A3C6-6CB83E3E7188","02/27/2024","Send PDF full page load perf data"),c=()=>a.Ov.isActivated("3c48928f-2237-4566-bc7d-8eeb1da30f4a","01/09/2025","load Chinese traditional font"),d=()=>a.Ov.isActivated("EE02F3C9-6475-4A21-92FD-34501A13F529","07/11/2024","disable open in app on mobile"),l=()=>a.Ov.isActivated("afc23a17-7c59-482b-977e-03721de0334e","01/16/2025","Disable temp auth deprecation for all scenarios"),u=()=>a.Ov.isActivated("F8DA2D1F-DFA4-4517-9725-12E716766315","08/07/2024","Disable temp auth deprecation for legacy OneUp PDF viewer and new inline OneUp PDF viewer"),f=()=>a.Ov.isActivated("74E95D32-2C34-478C-812F-C3D8516E7845","08/07/2024","Disable temp auth deprecation for new fast OneUp PDF viewer where prefetches the download url"),p=()=>a.Ov.isActivated("67d4a9e9-0fd8-4493-88e7-a9866c728b0a","08/29/2024","Disable temp auth deprecation for the embedded OneUp PDF viewer"),m=()=>a.Ov.isActivated("e66ba878-0389-4296-9158-6f0fce24ae33","09/10/2024","Add RUMOne log for temp auth deprecation"),_=()=>a.Ov.isActivated("87c18969-8b19-468b-b5c2-03558ae814af","02/06/2025","Disable temp auth deprecation for PDF conversion"),h=()=>a.Ov.isActivated("ec9f89cd-e773-4158-ae47-68d5097f6e54","08/13/2024","Refactor the implmentation for versions API"),b=()=>a.Ov.isActivated("f65d78e0-eb8a-4de0-a500-a48ec644f91d","08/14/2024","Pdf copy the file content by chunks to reduce memory usage"),g=()=>a.Ov.isActivated("06cef174-4981-4e0e-9051-f82587e53a2b","10/02/2024","Prevent double render in PDF viewer"),v=()=>a.Ov.isActivated("31cda21c-8300-4326-b8c9-7c43106da470","12/02/2024","Disable print permission for not-allowed pdf"),y=()=>a.Ov.isActivated("0e5ca4e9-7964-4974-8ad5-e100b53f5d3a","01/06/2025","Log EvTrace events"),S=()=>a.Ov.isActivated("103f498e-12ee-4b29-b8eb-6db3dbb5338a","08/07/2025","Enable prefetching MIP token for PDF viewer"),D=()=>a.Ov.isActivated("d09b030f-0278-4aca-b639-2f341e5cf2b5","08/20/2025","Enable expose errorcode from parser to qos event for PDF viewer"),I=()=>a.Ov.isActivated("371d515c-de3d-45d6-b573-c655e6b005b6","08/29/2025","Skip paid check for PDF paid features"),x=()=>a.Ov.isActivated("734590f7-a90b-45da-a2ef-f7c9dc4e3a77","09/04/2025","Close right pane when entering PDF edit mode"),C=()=>a.Ov.isActivated("27bb7877-16ac-4d8d-ae40-e9c05d84f68e","09/26/2025","Close right pane when entering PDF extract mode"),O=()=>a.Ov.isActivated("9cc8f79a-00b4-4871-8d19-ea30eb16b815","09/28/2025","Support Ctrl+P for triggering the print functionality in PDF viewer"),w=()=>a.Ov.isActivated("356b083d-ccfb-468d-afa0-359aaa38deac","10/09/2025","Use new manifest for pdf web worker in embed scenarios"),E=()=>a.Ov.isActivated("9c51f2f7-36a0-4c35-99e0-80ceb73d598e","11/04/2025","Enable print functionality for PDF viewer")}
,(e,t,n)=>{"use strict";function a(e){return!!e?.match(/https?:\/\/[^\/]+\/transform\/.*/)}function i(e){const t=e.getResponseHeader("X-CorrelationId")||void 0,n=e.getResponseHeader("X-Onedrive-Thumbnailfailurereason")||e.getResponseHeader("X-ErrorCode")||void 0,a=e.getResponseHeader("X-OneDriveMeTA-Region")||void 0,i=e.getResponseHeader("X-OneDriveMeTA-Build")||void 0,r=e.getResponseHeader("X-Onedrivemeta-Version")||void 0;return{correlationId:t,errorCode:n,errorType:e.getResponseHeader("X-Errortype")||void 0,region:a,build:i,version:r,allResponseHeaders:e.getAllResponseHeaders()||void 0}}function r({headers:e}){const t=e.get("X-Correlationid")||void 0,n=e.get("X-Onedrive-Thumbnailfailurereason")||e.get("X-ErrorCode")||void 0,a=e.get("X-OneDriveMeTA-Region")||void 0,i=e.get("X-OneDriveMeTA-Build")||void 0,r=e.get("X-Onedrivemeta-Version")||void 0;return{correlationId:t,errorCode:n,errorType:e.get("X-Errortype")||void 0,region:a,build:i,version:r}}function o(e){if(e){const t=e.match(/https:\/\/([a-z0-9]+)-medias/),n=e.match(/\/transform\/([a-z]+)?/),a=e.match(/inputFormat=([a-z0-9]+)/);return{urlOrigin:t?.[1],urlPath:n?.[1],inputFormat:a?.[1]}}}n.d(t,{a:()=>o,b:()=>a,c:()=>r,d:()=>i})}
,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n("tslib_145"),i={UseBlobForStringLength:"510d7ace-c669-4a2c-b87c-17de82da37b3",CheckWorkerVersion:"4d99680d-88bd-4dff-99a1-7e3eebd51734",UseSizeObserver:"66c17183-e7b2-4755-a82e-a9a2c20f5d16",UseExternalCidFont:"dc778e1c-946e-42b2-a4f8-5fd70cde9539",EnableCJKInFormTextField:"f3fc69e6-5bdc-4f0f-a5c0-c070ead620ec",StoreFreeTextAttributeInLocalStorage:"24019b2e-df14-4d7f-9fb4-04dbe0ce8933",EnableICUConverter:"ce1c33bb-89ca-4343-9fb4-f2d1d1f101a2",EnableProgressiveDocumentHandler:"d3788b76-abcd-472d-8927-581f42e7a04c",AddOutlineCheck:"8b994226-443a-4593-bf91-ff9fe85c3195",EnableDynamicChunkRequestSize:"bcbadf30-a483-4a3f-9a69-b28997496071",SendMipTelemetryFromWorker:"a27f106d-c10b-4387-afaf-2078ab9775f6",CacheFontFile:"db703eee-5499-45e0-9a72-b1b4ebafb127",CacheMipWasm:"bd4a128d-2b4f-4fa0-8372-903fb1f03381",EnableFetchDataByRangeStream:"72c0dc1c-9a51-4194-806a-8bac708b0359",FRTWithPrerender:"f10f1d8e-ba31-45c1-abae-3d2808cb1714",EnableAddRedundance:"a3c345a1-515d-43bf-a076-66751a93622d",EnableDataCopyOptimization:"cfc335df-1dbf-4161-a064-f1af065f6c68",EnableMaxWithForContentWhenFitWidth:"637faf69-30c1-4474-9261-49e23412936d",EnableCalculateTabIndexForPages:"93f74e84-8c55-4d9e-bc7b-7ba5a20125f7",EnableBoundingRegionHighlighter:"6a3bf015-e844-4b5a-8cbb-9c66bb99a91a",FixMipInOtherClouds:"a49d15e1-9220-44fb-b03e-d47192b8658b",FixPreRenderFailAtNativeRender:"3d2c5a96-abcf-45e2-bdfa-431b1508e395",EnableSearchShortcut:"a453caa6-e880-4064-96bb-ae3c44746bf9",EnableContextMenuForSelection:"1ee4d89b-b13c-4e63-b9f1-ca6f239e670a",EnableShortDebounceForSelectedText:"99f34832-3967-4830-ba07-ecd40f3dab46",StoreZoomOptionInLocalStorage:"89052fb8-0b3a-4b59-b3e0-6080f93648e2",UseGetPreloadedPkgForDataFiles:"5c21b59d-928a-4380-bae1-40e5b837840a",ControllOutlineDefaultOn:"9bdd2522-14b5-4596-af41-46f373a91cb0"},r=function(){function e(){}return e.initialize=function(t){var n,r;e.activatedKillSwitches=[];try{for(var o=(0,a.BW)(Object.keys(i)),s=o.next();!s.done;s=o.next()){var c=s.value,d=i[c];t(d)&&e.activatedKillSwitches.push(d)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.isActivated=function(t){var n=i[t];return e.activatedKillSwitches.includes(n)},Object.defineProperty(e,"activatedKillSwitches",{get:function(){return e._activatedKillSwitches},set:function(t){e._activatedKillSwitches=t},enumerable:!1,configurable:!0}),e._activatedKillSwitches=[],e}(),o=r.initialize}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f,b:()=>c,c:()=>o,d:()=>l});var a=n("react-lib"),i=n("fui.util_939");let r=!1;const o=()=>{r||((0,i.fU)({icons:{PdfExtract:a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 15 17",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M4 0C2.89543 0 2 0.895431 2 2V12C2 13.1046 2.89543 14 4 14H5.20703C5.11588 13.6777 5.05337 13.3434 5.02242 13H4C3.44772 13 3 12.5523 3 12V2C3 1.44772 3.44772 1 4 1H10C10.5523 1 11 1.44772 11 2V7.02242C11.3434 7.05337 11.6777 7.11588 12 7.20703V2C12 0.89543 11.1046 0 10 0H4ZM3.5 15H5.59972C5.78261 15.3578 6.00354 15.6929 6.25717 16H3.5C1.567 16 0 14.433 0 12.5V4.00001C0 3.25973 0.402199 2.61339 1 2.26758V12.5C1 13.8807 2.11929 15 3.5 15ZM10.5 8C12.9853 8 15 10.0147 15 12.5C15 14.9853 12.9853 17 10.5 17C8.01472 17 6 14.9853 6 12.5C6 10.0147 8.01472 8 10.5 8ZM12.8532 12.854L12.8557 12.8514C12.9026 12.804 12.938 12.7495 12.9621 12.6914C12.9861 12.6333 12.9996 12.5697 13 12.503L13 12.5L13 12.497C12.9996 12.4303 12.9861 12.3667 12.9621 12.3086C12.9377 12.2496 12.9015 12.1944 12.8536 12.1464L10.8536 10.1464C10.6583 9.95118 10.3417 9.95118 10.1464 10.1464C9.95118 10.3417 9.95118 10.6583 10.1464 10.8536L11.2929 12H8.5C8.22386 12 8 12.2239 8 12.5C8 12.7761 8.22386 13 8.5 13H11.2929L10.1464 14.1464C9.95118 14.3417 9.95118 14.6583 10.1464 14.8536C10.3417 15.0488 10.6583 15.0488 10.8536 14.8536L12.8532 12.854Z",fill:"currentColor"})),PdfMerge:a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 15 10",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M0 0.5C0 0.223858 0.223858 0 0.5 0H2.1528C3.15253 0 4.10455 0.427517 4.76873 1.17473L6.97867 3.66091C7.45309 4.19463 8.1331 4.5 8.8472 4.5H13.2929L9.64645 0.853554C9.45118 0.658291 9.45118 0.341709 9.64645 0.146447C9.84171 -0.0488154 10.1583 -0.0488154 10.3536 0.146447L14.8536 4.64645C15.0488 4.84171 15.0488 5.15829 14.8536 5.35355L10.3536 9.85355C10.1583 10.0488 9.84171 10.0488 9.64645 9.85355C9.45118 9.65829 9.45118 9.34171 9.64645 9.14645L13.2929 5.5H8.8472C8.1331 5.5 7.45309 5.80537 6.97867 6.33909L4.76873 8.82527C4.10455 9.57248 3.15253 10 2.1528 10H0.5C0.223858 10 0 9.77614 0 9.5C0 9.22386 0.223858 9 0.5 9H2.1528C2.8669 9 3.54691 8.69463 4.02133 8.16091L6.23127 5.67473C6.46908 5.40718 6.7438 5.18062 7.0444 5C6.7438 4.81938 6.46908 4.59282 6.23127 4.32527L4.02133 1.83909C3.54691 1.30537 2.8669 1 2.1528 1H0.5C0.223858 1 0 0.776142 0 0.5Z",fill:"currentColor"}))}}),r=!0)};let s=!1;const c=()=>{s||((0,i.fU)({icons:{PdfEncryptLock:a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M7 11C7.55229 11 8 10.5523 8 10C8 9.44771 7.55229 9 7 9C6.44771 9 6 9.44771 6 10C6 10.5523 6.44771 11 7 11ZM3 4H4V3C4 1.34315 5.34315 0 7 0C8.65685 0 10 1.34315 10 3V4H11C12.6569 4 14 5.34315 14 7V13C14 14.6569 12.6569 16 11 16H3C1.34315 16 0 14.6569 0 13V7C0 5.34315 1.34315 4 3 4ZM7 1C5.89543 1 5 1.89543 5 3V4H9V3C9 1.89543 8.10457 1 7 1ZM13 7C13 5.89543 12.1046 5 11 5H3C1.89543 5 1 5.89543 1 7V13C1 14.1046 1.89543 15 3 15H11C12.1046 15 13 14.1046 13 13V7Z",fill:"currentColor"})),PdfEncryptUnlock:a.createElement("svg",{width:"15",height:"17",viewBox:"0 0 15 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M7 12C7.55229 12 8 11.5523 8 11C8 10.4477 7.55229 10 7 10C6.44771 10 6 10.4477 6 11C6 11.5523 6.44771 12 7 12ZM12 1C10.8954 1 10 1.89543 10 3V5H11C12.6569 5 14 6.34315 14 8V14C14 15.6569 12.6569 17 11 17H3C1.34315 17 0 15.6569 0 14V8C0 6.34315 1.34315 5 3 5H9V3C9 1.34315 10.3431 0 12 0C13.6569 0 15 1.34315 15 3V3.5C15 3.77614 14.7761 4 14.5 4C14.2239 4 14 3.77614 14 3.5V3C14 1.89543 13.1046 1 12 1ZM11 6H3C1.89543 6 1 6.89543 1 8V14C1 15.1046 1.89543 16 3 16H11C12.1046 16 13 15.1046 13 14V8C13 6.89543 12.1046 6 11 6Z",fill:"currentColor"}))}}),s=!0)};let d=!1;const l=()=>{d||((0,i.fU)({icons:{TextBulletListSquare:a.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M3.75 5C4.16421 5 4.5 4.66421 4.5 4.25C4.5 3.83579 4.16421 3.5 3.75 3.5C3.33579 3.5 3 3.83579 3 4.25C3 4.66421 3.33579 5 3.75 5ZM4.5 7.25C4.5 7.66421 4.16421 8 3.75 8C3.33579 8 3 7.66421 3 7.25C3 6.83579 3.33579 6.5 3.75 6.5C4.16421 6.5 4.5 6.83579 4.5 7.25ZM3.75 11C4.16421 11 4.5 10.6642 4.5 10.25C4.5 9.83579 4.16421 9.5 3.75 9.5C3.33579 9.5 3 9.83579 3 10.25C3 10.6642 3.33579 11 3.75 11ZM6 4.5C6 4.22386 6.22386 4 6.5 4H10.5C10.7761 4 11 4.22386 11 4.5C11 4.77614 10.7761 5 10.5 5H6.5C6.22386 5 6 4.77614 6 4.5ZM6.5 7C6.22386 7 6 7.22386 6 7.5C6 7.77614 6.22386 8 6.5 8H10.5C10.7761 8 11 7.77614 11 7.5C11 7.22386 10.7761 7 10.5 7H6.5ZM6 10.5C6 10.2239 6.22386 10 6.5 10H10.5C10.7761 10 11 10.2239 11 10.5C11 10.7761 10.7761 11 10.5 11H6.5C6.22386 11 6 10.7761 6 10.5ZM2.75 0H11.25C12.7688 0 14 1.23122 14 2.75V11.25C14 12.7688 12.7688 14 11.25 14H2.75C1.23122 14 0 12.7688 0 11.25V2.75C0 1.23122 1.23122 0 2.75 0ZM1 2.75V11.25C1 12.2165 1.7835 13 2.75 13H11.25C12.2165 13 13 12.2165 13 11.25V2.75C13 1.7835 12.2165 1 11.25 1H2.75C1.7835 1 1 1.7835 1 2.75Z",fill:"currentColor"})),TextBulletListSquareFill:a.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M0 2.75C0 1.23122 1.23122 0 2.75 0H11.25C12.7688 0 14 1.23122 14 2.75V11.25C14 12.7688 12.7688 14 11.25 14H2.75C1.23122 14 0 12.7688 0 11.25V2.75ZM3.75 5C4.16421 5 4.5 4.66421 4.5 4.25C4.5 3.83579 4.16421 3.5 3.75 3.5C3.33579 3.5 3 3.83579 3 4.25C3 4.66421 3.33579 5 3.75 5ZM4.5 7.25C4.5 6.83579 4.16421 6.5 3.75 6.5C3.33579 6.5 3 6.83579 3 7.25C3 7.66421 3.33579 8 3.75 8C4.16421 8 4.5 7.66421 4.5 7.25ZM3.75 11C4.16421 11 4.5 10.6642 4.5 10.25C4.5 9.83579 4.16421 9.5 3.75 9.5C3.33579 9.5 3 9.83579 3 10.25C3 10.6642 3.33579 11 3.75 11ZM6 4.5C6 4.77614 6.22386 5 6.5 5H10.5C10.7761 5 11 4.77614 11 4.5C11 4.22386 10.7761 4 10.5 4H6.5C6.22386 4 6 4.22386 6 4.5ZM6.5 7C6.22386 7 6 7.22386 6 7.5C6 7.77614 6.22386 8 6.5 8H10.5C10.7761 8 11 7.77614 11 7.5C11 7.22386 10.7761 7 10.5 7H6.5ZM6 10.5C6 10.7761 6.22386 11 6.5 11H10.5C10.7761 11 11 10.7761 11 10.5C11 10.2239 10.7761 10 10.5 10H6.5C6.22386 10 6 10.2239 6 10.5Z",fill:"currentColor"}))}}),d=!0)};let u=!1;const f=()=>{u||((0,i.fU)({icons:{PdfCompress:a.createElement("svg",{width:"13",height:"17",viewBox:"0 0 13 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M6.5 0C6.77614 0 7 0.223858 7 0.5V4.29289L8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645C9.04882 3.34171 9.04882 3.65829 8.85355 3.85355L6.85355 5.85355C6.65829 6.04882 6.34171 6.04882 6.14645 5.85355L4.14645 3.85355C3.95118 3.65829 3.95118 3.34171 4.14645 3.14645C4.34171 2.95118 4.65829 2.95118 4.85355 3.14645L6 4.29289V0.5C6 0.223858 6.22386 0 6.5 0ZM0.5 8.5C0.5 8.22386 0.723858 8 1 8H12C12.2761 8 12.5 8.22386 12.5 8.5C12.5 8.77614 12.2761 9 12 9H1C0.723858 9 0.5 8.77614 0.5 8.5ZM7 12.7071V16.5C7 16.7761 6.77614 17 6.5 17C6.22386 17 6 16.7761 6 16.5V12.7071L4.85355 13.8536C4.65829 14.0488 4.34171 14.0488 4.14645 13.8536C3.95118 13.6583 3.95118 13.3417 4.14645 13.1464L6.14645 11.1464C6.34171 10.9512 6.65829 10.9512 6.85355 11.1464L8.85355 13.1464C9.04882 13.3417 9.04882 13.6583 8.85355 13.8536C8.65829 14.0488 8.34171 14.0488 8.14645 13.8536L7 12.7071Z",fill:"currentColor"}))}}),u=!0)}}
,,,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.Files=0]="Files",e[e.Recent=1]="Recent",e[e.DocumentLibraries=2]="DocumentLibraries",e[e.SharedWithMe=3]="SharedWithMe",e[e.DocsInCommon=4]="DocsInCommon",e[e.RecycleBin=5]="RecycleBin",e[e.Photos=6]="Photos",e[e.Search=7]="Search",e[e.AllMyPhotos=8]="AllMyPhotos",e[e.AccountChooserPicker=9]="AccountChooserPicker",e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK",e[e.Popular=11]="Popular",e[e.RecentUnpopular=12]="RecentUnpopular",e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin",e[e.Apps=14]="Apps",e[e.Subsites=15]="Subsites",e[e.RecentActivity=18]="RecentActivity",e[e.ExternallyShared=19]="ExternallyShared",e[e.SharedByMe=20]="SharedByMe",e[e.Favorites=21]="Favorites",e[e.DetailsPane=22]="DetailsPane",e[e.Channels=24]="Channels",e[e.PhotoStream=25]="PhotoStream",e[e.PhoneLink=26]="PhoneLink",e[e.DefaultDocLib=27]="DefaultDocLib",e[e.ListSyncIssues=28]="ListSyncIssues",e[e.OneDriveHome=29]="OneDriveHome",e[e.TeamsDownloads=30]="TeamsDownloads",e[e.MyLists=31]="MyLists",e[e.Selection=32]="Selection",e[e.People=33]="People",e[e.Meetings=34]="Meetings",e[e.RecentLists=35]="RecentLists",e[e.MyOrganizationAssets=36]="MyOrganizationAssets",e[e.LargestFiles=37]="LargestFiles",e[e.StockImages=38]="StockImages",e[e.Bing=39]="Bing",e[e.Local=40]="Local",e[e.ChannelSharedList=41]="ChannelSharedList",e[e.SharedByUser=42]="SharedByUser",e[e.FromALink=43]="FromALink",e[e.Lists=44]="Lists"}(a||(a={}));const i=a}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>F,b:()=>P,c:()=>k,d:()=>M,e:()=>a.pW,f:()=>T,g:()=>f.b,h:()=>D,i:()=>U,j:()=>I});var a=n("odsp.util_385"),i=n(22),r=n(147),o=n(99),s=n(134),c=n(21),d=n(153),l=n(856),u=n(35),f=n(210),p=n(513);const m=!a.Ov.isActivated("303D5922-4E07-4EDD-80D5-786E09050BF3");var _=n(261),h=n(263),b=n(152);const g=!a.Ov.isActivated("5364DEEA-64D3-4E13-8CA5-11D9FAABABB9");var v=n(412),y=n(79),S=n(260);function D(e){const t=e[S.a];if(!t)return;const n=JSON.parse(`${t||""}`),{mp:a,rsf:i,rsi:r}=n;return{mountPoint:a,remoteSpFolderById:i,remoteSpItem:r}}function I(e){if(!e)return{};const{mountPoint:t,remoteSpFolderById:n,remoteSpItem:a}=e,i={mp:t,rsf:n,rsi:a};return{[S.a]:JSON.stringify(i)}}const x={ODB:60210},C={ODB:!a.Ov.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event.")},O=!a.Ov.isActivated("D583FA81-FDE5-486B-9BFC-5AFAF2252239"),w=!a.Ov.isActivated("25ABC593-FB06-42D5-AE05-E3F978701388"),E=(0,u.a)(C),A=!a.Ov.isActivated("FDB12575-D304-4940-9AEE-4AD11A9906F7"),L=!a.Ov.isActivated("09e512fc-b889-4b29-aa3c-eb0d8a5bf90a");function k(e){const{defaultRootItemId:t,viewParams:n,listUrl:i,viewId:o,key:u}=e,_=(0,a.pW)(u),h={...n};delete h[c.b.idParamKey],m&&(delete h[c.b.cid],delete h[c.b.mid],delete h[c.b.mcid],delete h[c.b.sortBy],delete h[c.b.sortDirection],delete h[d.a],delete h[l.i],delete h[l.o],delete h[l.l],delete h[l.c],delete h[l.m],v.a||(delete h[l.n],delete h[c.b.authKey])),O&&(delete h[c.b.contextualFilter],delete h[c.b.extensionFilter],delete h[c.b.searchConversationId],delete h[c.b.dateFilterType],delete h[c.b.beginDate],delete h[c.b.endDate],delete h[c.b.scope]),delete h[c.b.rootFolderParamKey],delete h[c.b.queryTypeParamKey],delete h[c.b.queryParamKey],delete h[c.b.listUrlKey],L&&(0,y.a)()&&(delete h[c.b.webUrlKey],delete h[c.b.routingKey],delete h[c.b.shareTokenKey]),a.Ov.isActivated("0405907e-3935-4959-bd2c-b5a5b89f8acb","09/09/2022","preserve search filters in oneUp and exiting oneUp in odb, return to search when exiting oneUp in odb/spo")||(delete h[c.b.dateFilterKey],delete h[c.b.userFiltersKey]),delete h[c.b.typeFiltersKey],delete h[c.b.remoteItem],delete h[c.b.sortFieldKey],A&&delete h[c.b.isAscendingKey],delete h[c.b.groupByKey],delete h[c.b.viewIdKey],delete h[c.b.personIdKey],delete h[c.b.meetingIdKey],delete h[c.b.emailIdKey];for(const e of Object.keys(n))c.c.test(e)&&delete h[e];return delete h[c.b.searchScopeKey],delete h[c.b.disableQueryAlterationKey],delete h[c.b.itemId],delete h[c.b.playlistLayout],(0,r.a)(h,_),delete h[c.b.parentIdParamKey],delete h[c.b.parentQueryTypeParamKey],delete h[c.b.pageParamKey],delete h[c.b.sharedLibraryCreated],_[c.b.idParamKey]===t&&(delete h[c.b.idParamKey],delete h[c.b.rootFolderParamKey]),a.Ov.isActivated("81A798A6-1C14-40C3-BD52-2A60351DCF87","11/8/2021","Only preserve view id when navigating within same list")&&(h[c.b.listUrlKey]===n[c.b.listUrlKey]&&(0,f.b)(_)===s.a.Files&&(o||"").replace("{","").replace("}","")!==h[c.b.viewIdKey]||delete h[c.b.viewIdKey],h[c.b.newTargetListUrlKey]===i&&(delete h[c.b.newTargetListUrlKey],delete h[c.b.viewPathKey])),delete h[c.b.uniqueParamKey],E&&(delete h[c.b.callerId],delete h[c.b.callerScenarioId]),delete h[p.a],h}function M(e,t){const n=Number(e[c.b.queryTypeParamKey])||s.a.Files,a={[c.b.idParamKey]:e[c.b.idParamKey]||t||"",[c.b.driveIdParamKey]:e[c.b.driveIdParamKey]||"",[c.b.driveEndpointParamKey]:e[c.b.driveEndpointParamKey]||"",[c.b.listUrlKey]:e[c.b.listUrlKey]||"",[c.b.queryTypeParamKey]:`${n||""}`,[c.b.queryParamKey]:e[c.b.queryParamKey]||"",[c.b.typeFiltersKey]:e[c.b.typeFiltersKey]||"",[c.b.userFiltersKey]:e[c.b.userFiltersKey]||"",[c.b.dateFilterKey]:e[c.b.dateFilterKey]||"",[c.b.uniqueParamKey]:e[c.b.uniqueParamKey]||"",[c.b.disableQueryAlterationKey]:(0,u.a)(x)&&e[c.b.disableQueryAlterationKey]||"",[c.b.metadataSearchIdKey]:e[c.b.metadataSearchIdKey]||""};return e[c.b.searchScopeKey]&&(a[c.b.searchScopeKey]=e[c.b.searchScopeKey]||""),m&&e[c.b.cid]&&(a[c.b.cid]=e[c.b.cid]||""),w&&(a[c.b.contextualFilter]=e[c.b.contextualFilter]||"",a[c.b.extensionFilter]=e[c.b.extensionFilter]||"",a[c.b.searchConversationId]=e[c.b.searchConversationId]||"",a[c.b.dateFilterType]=e[c.b.dateFilterType]||"",a[c.b.beginDate]=e[c.b.beginDate]||"",a[c.b.endDate]=e[c.b.endDate]||"",a[c.b.scope]=e[c.b.scope]||""),g&&(a[p.a]=e[p.a]||""),n===s.a.ChannelSharedList&&(a[c.b.channelIdKey]=e[c.b.channelIdKey]||"",a[c.b.groupIdKey]=e[c.b.groupIdKey]||""),(0,i.a)(a,void 0,!0)}function P(e){if(a.Ov.isActivated("2CFC06AF-7448-498E-ADB8-F185A6DE6D14")){let t;const n=e[c.b.parentIdParamKey],a=e[c.b.parentQueryTypeParamKey];return(n||a)&&(t={},t[c.b.idParamKey]=e[c.b.idParamKey],t[c.b.listUrlKey]=e[c.b.listUrlKey],a&&(t[c.b.queryTypeParamKey]=e[c.b.queryTypeParamKey])),t?(0,i.a)(t,void 0,!0):""}return function(e){let t;const n=e[_.a],a=e[h.a];return(n||a)&&(t={},t[b.b]=e[b.b],t[b.e]=e[b.e],a&&(t[h.b]=e[h.b])),t?(0,i.a)(t,void 0,!0):""}(e)}function T(e,t){const n=Number(e[c.b.pageParamKey]);switch(n){case o.a.FilePicker:case o.a.FileBrowser:case o.a.TextFileEditor:case o.a.Error:case o.a.Share:case o.a.Embed:case o.a.Restore:case o.a.Settings:case o.a.MobileAppUpsell:case o.a.FileRequest:return n}return P(e)&&t?o.a.OneUp:o.a.Files}function U(e){return e===s.a.RecycleBin||e===s.a.SecondStageRecycleBin}function F(){return window.location.protocol+"//"+window.location.host}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r,c:()=>a,d:()=>s,e:()=>o});const a="https://portal.office.com/",i="https://aadrm.com",r={Msa:"msa_auth:",Graph:"graph_auth:",MsaStrongAuth:"msa_strong_auth:",PhoneLink:"phone_link:",Substrate:"substrate_auth:"};var o,s;!function(e){e[e.STI=1]="STI",e[e.Default=2]="Default"}(o||(o={})),function(e){e[e.Default=1]="Default",e[e.Search=2]="Search"}(s||(s={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"isCopilotEnabled",factory:new a.Rn(()=>!1)})}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s,c:()=>d});var a=n(108);const i="text/plain",r={abap:i,ada:i,adp:i,ahk:i,as:i,as3:i,asc:i,ascx:"text/xml",asm:i,asp:i,awk:i,bash:i,bash_login:i,bash_logout:i,bash_profile:i,bashrc:i,bat:"text/x-bat",bib:i,bsh:"text/x-java",build:i,builder:i,c:"text/x-cpp","c++":"text/x-c++src",capfile:i,cc:"text/x-c++src",cfc:i,cfm:i,cfml:i,cl:i,clj:i,cls:i,cmake:i,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:i,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:i,db:i,ddl:i,di:i,dif:i,diff:i,disco:"text/xml",dml:i,dtd:"text/xml",dtml:"text/xml",el:i,emakefile:i,erb:i,erl:i,f:i,f90:i,f95:i,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:i,gemspec:"text/ruby",gitconfig:"text/x-ini",go:i,groovy:i,gvy:i,h:"text/x-cpp","h++":"text/x-c++hdr",haml:i,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:i,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:i,hs:i,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:i,inc:"text/html",inf:i,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:i,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:i,jsx:"text/javascript",l:i,less:"text/x-less",lhs:i,lisp:i,log:i,lst:i,ltx:i,lua:"text/x-lua",m:i,mak:i,make:i,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:i,mli:i,mll:i,mly:i,mm:i,mud:i,nfo:i,opml:"text/xml",osascript:i,osts:"text/javascript",out:i,p:i,pas:i,patch:i,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:i,plist:i,pm:i,pod:i,pp:i,profile:i,properties:i,ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:i,r:i,rake:i,rb:"text/ruby",rbx:i,rc:i,re:i,reg:i,rest:i,resw:"text/xml",resx:"text/xml",rhtml:i,rjs:i,rprofile:i,rpy:i,rss:"text/xml",rst:i,rxml:i,s:i,sass:"text/scss",scala:i,scm:i,sconscript:i,sconstruct:i,script:i,scss:"text/scss",sgml:"text/xml",sh:i,shtml:"text/html",sml:"text/xml",sql:i,sty:i,t:i,tcl:i,tex:i,text:i,textile:i,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:i,vb:"text/x-vb",vi:i,vim:i,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:i,xslt:i,yaml:i,yaws:i,yml:i,zsh:i};function o(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}function s(e,t){return!!e&&c(e,t)}function c(e,t){return function(e){return e=o(e),r.hasOwnProperty(e)}(e)&&(t===a.a.File||t===a.a.Media||t===a.a.Unknown)}function d(e){const t=o(e);return r.hasOwnProperty(t)?r[t]:void 0}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"SpHttpDataSource.async.key",loader:new a.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(71)]).then(n.bind(n,755)).then(e=>e.resourceKey))});new a.OJ({name:"SpHttpDataSource.async.key",loader:new a.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(71)]).then(n.bind(n,755)).then(e=>e.typeResourceKey))})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>p,b:()=>m});var a=n("tslib_145"),i=n(64),r=n(84);const o="0.16.15";var s=n(37),c=n(863),d=n(437),l=n(208),u=function(){function e(){}return e.dispose=function(){},e.retreive=function(e,t,n){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(a){return[2,(0,d.c)(e,t,n)]})})},e.update=function(e,t){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,(0,d.d)(e,t)];case 1:return n.sent(),[2]}})})},e}(),f="GetWasmAsset",p=function(){function e(){var e=this;this.wasmModuleInnerInitPromise={},this.initialize=function(t){if(void 0===t&&(t="Main"),!e.wasmModuleInnerInitPromise[t]){var n=s.a.wasmModuleInit.find(function(e){return e.type||"Main"===t});n&&(e.wasmModuleInnerInitPromise[t]=e.convertModuleInit(n))}},this.convertModuleInit=function(t){return(0,a.yv)(e,void 0,void 0,function(){var e,n,o,s,c,d,u,p;return(0,a.SO)(this,function(a){switch(a.label){case 0:if(e=t.wasmUrl,n=t.noCache,o=t.wasmJsUrlOrBlob,s=t.dataUrl,c=t.type,n)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getWasmBinaryFromCache(e,c)];case 2:return d=a.sent(),[3,4];case 3:return u=a.sent(),p=new i.c(i.b.WasmCacheFailed,"Fail to work on wasm cache, reason: ".concat(u)),r.a.logError(p.toCaughtError()),[3,4];case 4:return d?[3,6]:[4,(0,l.c)(e,{credentials:"same-origin"},f)];case 5:d=a.sent(),a.label=6;case 6:return 0===d.byteLength&&r.a.logError(new i.c(i.b.WasmModuleInitFailed,"The wasm binary is empty and the module instantiation will fail, wasmUrl=".concat(encodeURIComponent(e))).toCaughtError()),[2,{wasmBinary:d,wasmJsUrlOrBlob:o,dataUrl:s,type:c}]}})})}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getModuleInnerInit=function(e){return void 0===e&&(e="Main"),this.initialize(e),this.wasmModuleInnerInitPromise[e]},e.prototype.dispose=function(){var e;this.wasmModuleInnerInitPromise={},null===(e=this.wasmDataCache)||void 0===e||e.dispose()},e.prototype.getWasmBinaryFromCache=function(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,p,m,_,h;return(0,a.SO)(this,function(a){switch(a.label){case 0:return s.a.disableExternalWasmCache||!(0,c.a)()&&!(0,c.b)()?[3,2]:[4,this.setExternalWasmCache()];case 1:return a.sent(),[3,3];case 2:this.wasmDataCache=u,a.label=3;case 3:if(!this.wasmDataCache)throw"The wasmDataCache is not defined";n="".concat(t||"Main"),a.label=4;case 4:return a.trys.push([4,6,,7]),[4,this.wasmDataCache.retreive(d.a,n,o)];case 5:return(p=a.sent())&&0!==p.byteLength?(r.a.logVerbose({message:"PDF WASM Cache hit. key: ".concat(n)}),[2,p]):[3,7];case 6:return m=a.sent(),_=new i.c(i.b.WasmCacheFailed,"Fail to read from wasm cache, key: ".concat(n," error: ").concat(m)),r.a.logError(_.toCaughtError()),[3,7];case 7:return r.a.logVerbose({message:"PDF WASM Cache miss. key: ".concat(n)}),[4,(0,l.c)(e,{credentials:"same-origin"},f)];case 8:return h=a.sent(),this.wasmDataCache.update(d.a,{key:n,value:h,version:o}).catch(function(e){var t=new i.c(i.b.WasmCacheFailed,"Fail to update wasm cache, error: ".concat(e));r.a.logError(t.toCaughtError())}),"Main"===n&&this.deleteOldWasmCache().catch(function(e){var t=new i.c(i.b.WasmCacheFailed,"Fail to delete old wasm cache, error: ".concat(e));r.a.logError(t.toCaughtError())}),[2,h]}})})},e.prototype.setExternalWasmCache=function(){return(0,a.yv)(this,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,n.e(31).then(n.bind(n,461))];case 1:return e=t.sent(),this.wasmDataCache=e.ExternalWasmCache,[2]}})})},e.prototype.deleteOldWasmCache=function(){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(e){return[2,(0,d.b)(d.a,"".concat("Main","-"))]})})},e}(),m=p.getInstance().initialize}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>ve,b:()=>ye});var a=n("odsp.util_385"),i=n(27),r=n(514),o=n(13),s=n(22),c=n(39),d=n(16),l=n(106),u=n(107),f=n(72);const p=new a.OJ({name:"isOneDriveHomeEnabled",factory:new a.Rn(()=>!1)}),m=new a.OJ({name:"isPeopleEnabled",factory:new a.Rn(()=>!1)});var _=n(46),h=n(259),b=n(1),g=n(35);const v={ODB:62543},y={pageContext:b.a};let S=function(e){const{pageContext:t}=e,n=(0,g.a)(v)||!(0,h.a)()&&function(e,t){return!(1!==(0,_.c)(90115,e))}(t);return S=()=>n,n};const D=new a.OJ({name:"isExtraCommandsAvailableForSWM",factory:{dependencies:y,create:e=>({instance:()=>S(e)})}}),I=new a.OJ({name:"isOpenSharedFolderInPeopleEnabled.key",factory:new a.Rn(()=>!1)}),x=new a.OJ({name:"forceLoadAllFoldersInCurrentPage",factory:new a.Rn(!1)});var C=n(427),O=n(134),w=n(21),E=n(99);const A=[".aspx",".ascx",".master",".xsf",".xap",".swf",".jar",".asmx",".htc",".ashx",".json",".soap",".svc",".xamlx"];var L=n(143),k=n(147),M=n(137),P=n(515),T=n(56);const U=!a.Ov.isActivated("CDDAA141-CBD4-42B5-B007-A9A9340B8D9F"),F=new a.OJ({name:"addDefaultParentViewOnViewerOpenUrls.key",factory:new a.Rn(!1)}),H=!a.Ov.isActivated("960440C4-4144-497B-83AA-14E753E48334");var R=n(79);const N=new a.OJ("defaultGetOneUpUrl");var B=n(152);const j=a.Ov.isActivated("B5E93E94-1B94-4DAD-A80C-CEA0480476F6"),V=a.Ov.isActivated("19AD57B9-24E4-498D-87BC-9E654AB9BC6C"),z=a.Ov.isActivated("4649E01E-99EF-4594-B706-26503617CB32"),G=a.Ov.isActivated("a5e1d64c-8940-4ce7-9446-9ba2565085ed"),K=!a.Ov.isActivated("A5F231F5-952B-4C65-83F6-5C95EB21696A"),W=a.Ov.isActivated("abced38e-0985-46bf-aced-9b0a3588e876"),q=a.Ov.isActivated("af3aa13c-ce50-4c89-8096-1c364a522896"),Q="wopiframe.aspx",Y="doc.aspx",J={ODB:!0},X={ODB:!0},Z={ODB:1064},$={platformDetection:T.a,isOneDriveHomeEnabled:p,isPeopleEnabled:m,isInlineOneDriveSharedFolderEnabled:D.optional,isOpenSharedFolderInPeopleEnabled:I.optional,addDefaultParentViewOnViewerOpenUrls:F.optional,forceLoadAllFoldersInCurrentPage:x.optional,defaultGetOneUpUrl:N.optional},ee=new a.OJ({name:"GetDefaultClickUrl",factory:{dependencies:$,create:e=>{const{isPeopleEnabled:t,isInlineOneDriveSharedFolderEnabled:n,isOpenSharedFolderInPeopleEnabled:i,addDefaultParentViewOnViewerOpenUrls:r,forceLoadAllFoldersInCurrentPage:p}=e;return{instance:function(m){const{defaultRootItemId:_,pageContext:h,isDocSet:b,listId:v,listItemId:y,itemKey:S,itemType:D,itemList:I,itemOpenUrl:x,itemOpenInOfficeOnlineUrl:T,itemPreviewIFrameUrl:F,itemQueryType:H,itemOfficeBundle:N,itemContentTypeId:B,itemUrls:j,itemUrlHelper:V,itemSubsite:G,itemExtension:K,itemFSObjType:$,itemTranslationLanguages:ee,isUnifiedAppSupportedFile:ae,welcomePageCustomized:ie,viewParams:re,parentItemKey:oe,parentItemLink:se,supportsOneUp:ce,urlType:de="default",additionalViewParams:le,driveType:ue,isRootFolder:fe,isItemInOtherUsersOneDrive:pe,mySiteOwner:me,mainLinkInfo:_e,parentViewParams:he,routingKey:be}=m,{page:ge=(0,M.f)(re)}=m,ve=V.getItemUrlParts(S),ye=ve.serverRelativeWebUrl,Se=(0,M.e)(S),De=(0,M.c)({key:S,viewParams:re,defaultRootItemId:_}),Ie=re[w.b.parentQueryTypeParamKey];le&&(0,k.a)(De,le);const xe={...De},Ce={};(0,R.a)()&&_e?.ShareTokenString&&(ye&&!pe&&!re?.[w.b.remoteItem]&&xe[w.b.listUrlKey]&&(Ce[w.b.webUrlKey]=ye),be&&(Ce[w.b.routingKey]=be),Ce[w.b.shareTokenKey]=_e.ShareTokenString);const Oe=()=>m.getMediaUrl?.()||e.defaultGetOneUpUrl?.({...m,parentView:Ie})||te({itemKey:S,parentItemKey:oe,params:xe,supportsOneUp:ce,itemUrlHelper:V,page:ge,addDefaultParentViewOnViewerOpenUrls:r,itemExtension:K,parentView:Ie,parentViewParams:he,mainLinkViewParams:Ce}),we=!!f.j&&(0,g.a)(J),Ee=!f.j||(0,g.a)(X),Ae=ue===P.a.business;let Le;const ke=p||ge===E.a.FilePicker||ge===E.a.FileBrowser;ke&&(De[w.b.pageParamKey]=ge);const Me=Se[w.b.queryTypeParamKey];if((!Me||Number(Me)===O.a.Files)&&e.isOneDriveHomeEnabled()&&(De[w.b.queryTypeParamKey]=O.a.Files),ge===E.a.FilePicker&&D!==C.a.Folder)return"";if(H&&(0,M.i)(H)&&!(0,M.i)((0,M.g)(Se)))return"";const Pe="focus"===de&&!(N&&ve.isCrossDomain),Te=ve.fullItemUrl,Ue="current"===de?C.a.Folder:"external"===de?C.a.Unknown:D;if(delete De[w.b.noAuthRedirect],(0,M.b)(re)&&"existing"===de||Pe)Le=Oe();else if(ae)Le=T||"";else if(N&&N.enableDefaultClick)Le=Oe();else switch(Ue){case C.a.Media:Le=Oe();break;case C.a.Folder:const e=we,f=ve.geoRelation!==o.a.sameGeo;if(delete De[w.b.navParamKey],delete De[w.b.viewerKey],!ke&&G&&(f||G.isExternal)&&!e)return G.serverRelativeUrl;if(!ke&&I&&(f||I.isExternal)&&!e)return ve.fullItemUrl||"";if(b&&(!Ee||ie))return x||"";if(ke||!ve.isCrossList&&ve.siteRelation===o.d.sameSite||Number(h.webTemplate)===c.b.mySite&&h.isNoScriptEnabled&&ve.isCrossDomain&&!Ae&&(!f||e))fe&&me&&pe&&t()&&n?.()&&(De[w.b.emailIdKey]=me,De[w.b.queryTypeParamKey]=O.a.People),!W&&_e?.ShareTokenString&&ye&&(0,R.a)()&&De[w.b.listUrlKey]&&!pe&&(De[w.b.webUrlKey]=ye,De[w.b.shareTokenKey]=_e.ShareTokenString),Le=`#${(0,s.a)(De,void 0,!1)}`;else if(!pe||z&&!i?.())if(De[w.b.remoteItem])Le=`#${(0,s.a)(De)}`;else{if(x&&new d.a(x).getScheme()){Le=x;break}Le=u.a(ve.fullItemUrl||"")}else fe&&me&&t()&&n?.()&&(De[w.b.emailIdKey]=me,De[w.b.queryTypeParamKey]=O.a.People),!q&&_e?.ShareTokenString&&(0,R.a)()&&(be&&(De[w.b.routingKey]=be),De[w.b.shareTokenKey]=_e.ShareTokenString),Le=`#${(0,s.a)(De,void 0,!1)}`;break;case C.a.Shortcut:Le=j&&j[l.b.shortcutTarget]||x||"";break;case C.a.File:if(K&&(0,L.a)(K,Ue))Le=ge===E.a.TextFileEditor&&class{static isAllowed(e){return!(A.indexOf(e.toLocaleLowerCase())>=0)}}.isAllowed(K||"")?function(e){const{itemKey:t,parentItemKey:n,parentItemLink:i,viewParams:r,supportsOneUp:o,defaultRootItemId:c,addDefaultParentViewOnViewerOpenUrls:d}=e,l=(0,M.c)({key:t,viewParams:r,defaultRootItemId:c}),u=(0,a.pW)(n||"");let f=u[w.b.idParamKey];if("root"===f){const e=(0,a.pW)(t)[w.b.listUrlKey];e&&(f=e)}if(l[w.b.parentIdParamKey]=f,U){const e=d?O.a.Files:void 0,t=u[w.b.queryTypeParamKey]||e;void 0!==t&&(l[w.b.parentQueryTypeParamKey]=t)}else l[w.b.parentQueryTypeParamKey]=u[w.b.queryTypeParamKey];l[w.b.pageParamKey]=E.a.TextFileEditor,delete l[w.b.queryTypeParamKey];let p="";return!o&&i?(delete l[w.b.parentQueryTypeParamKey],p=i,`${i}?${(0,s.a)(l,void 0,!0)}`):(Number(r[w.b.pageParamKey])!==E.a.TextFileEditor&&(p=(0,M.a)()+window.location.pathname),`${p}#${(0,s.a)(l,void 0,!0)}`)}({itemKey:S,parentItemKey:oe,parentItemLink:se,viewParams:re,supportsOneUp:ce,defaultRootItemId:_,addDefaultParentViewOnViewerOpenUrls:r}):Oe();else if(ee&&ee.length>0||function(e){return!!e&&e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B")>-1}(B))if(x){const e=new d.a(x);e.setQueryParameter("stay","true"),Le=e.toString()}else Le="";else if((0,g.a)(Z)&&ne(x,Te)){if(".aspx"===`${K}`.toLowerCase()&&x)return x;Le=Oe()}else Le=x||S&&"#"+S;break;default:Le=(0,g.a)(Z)&&ne(x,Te)&&K?Oe():x||S&&"#"+S}if(v&&(Ue===C.a.File&&F&&(-1!==F.toLowerCase().indexOf(Q)||-1!==F.toLowerCase().indexOf(Y))||Ue===C.a.OneNote)){const e=new d.a(Le);e.getLastPathSegment().toLowerCase()!==Q&&e.getLastPathSegment().toLowerCase()!==Y||(e.setQueryParameter("1"===$?"IsFolder":"IsList","1"),e.setQueryParameter("ListId",v),e.setQueryParameter("ListItemId",y||""),Le=e.toString())}return Le=function(e){return e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),e}(Le),Le}}}}});function te(e){const{itemKey:t,parentItemKey:n,supportsOneUp:i,itemUrlHelper:r,page:o,addDefaultParentViewOnViewerOpenUrls:c,itemExtension:d,parentView:l,parentViewParams:u,mainLinkViewParams:f}=e;let p=e.params||{};if(!V&&p[w.b.parentDriveIdParamKey]&&t&&l){const e=(0,a.pW)(t)[B.b];p[B.b]=e,p[w.b.parentQueryTypeParamKey]=l}if(!i){const e=r.getItemUrlParts(t),n=e.serverRelativeItemUrl||"",a={[w.b.idParamKey]:n,[w.b.parentIdParamKey]:n.substring(0,n.lastIndexOf("/"))};return`${e.fullListUrl}?${(0,s.a)(a,void 0)}`}const m=(0,a.pW)(n||"");p[w.b.parentIdParamKey]=m[w.b.idParamKey],K&&u&&u[w.b.viewIdKey]&&(p[w.b.viewIdKey]=u[w.b.viewIdKey]);const _=(0,M.h)(p);if(_){const{mountPoint:e,remoteSpItem:t}=_;if(t){const n={mountPoint:e,remoteSpItem:{listFullUrl:t.listFullUrl,rootFolder:m[w.b.idParamKey],webAbsoluteUrl:t.webAbsoluteUrl}};(0,k.a)(p,(0,M.j)(n))}}if(U){const e=c?O.a.Files:void 0,t=m[w.b.queryTypeParamKey]||e;void 0!==t&&(p[w.b.parentQueryTypeParamKey]=t)}else p[w.b.parentQueryTypeParamKey]=m[w.b.queryTypeParamKey];!V&&p[w.b.parentDriveIdParamKey]&&t||(delete m[w.b.idParamKey],delete m[w.b.queryTypeParamKey]),!V&&p[w.b.parentDriveIdParamKey]&&p[w.b.parentIdParamKey]&&(delete m[w.b.parentIdParamKey],delete p[w.b.parentIdParamKey]),delete m[w.b.uniqueParamKey];for(const e in p){const t=p[e];(null==t||""===t&&e.indexOf("FilterValue")<0)&&delete p[e]}return o&&o!==E.a.Files&&(p[w.b.pageParamKey]=`${o}`),G||(p[w.b.shareTokenKey]&&delete p[w.b.shareTokenKey],(0,R.a)()&&p&&f&&(p={...p,...f})),j||".research"!==d||(p[w.b.navModeKey]=1),"#"+(0,s.a)(p,m,!1)}function ne(e,t){return H?function(e,t){if(H){if(!e||!t)return!1;try{if((0,r.a)(e)===t)return!0}catch(e){}try{if(e===t||e===(0,r.a)(t))return!0}catch(e){}return!1}return e===(t&&u.a(t))}(e,t):!(!e||!t||(0,r.a)(e)!==(0,r.a)(t))}function ae(e){const t=function(e,t){const n=e.appMap?e.appMap.toLowerCase():void 0;return"ms-powerpoint"===n||"ms-word"===n||"ms-visio"===n||"ms-excel"===n||!1}(e);return t&&function(e){return!!(e&&e.openUrl&&e.appMap)}(e)&&!a.JW.isFeatureEnabled({ODB:826,OneDrive:!0})}new Set(["WacFailed.DocumentIsIRMProtected","WacFailed.5243086","WacFailed.5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"]);var ie=n(15),re=n(31),oe=n(264),se=n(516);const ce=se.b.protocolCommand;var de=n(518),le=n(80),ue=n(109),fe=n(265),pe=n(17),me=n(110);const _e=a.Ov.isActivated("a5e1d64c-8940-4ce7-9446-9ba2565085ed"),he=a.Ov.isActivated("c8636355-f925-4b6c-932c-70b5008f78eb"),be=a.Ov.isActivated("a3745abe-801e-48b9-ba8d-a05e8ecd7e7e");class ge{getDefaultClickUrlForOneUp(e,t){if(!e||!e.key)return"";const n=this._navigation.viewParams,a=n[w.b.parentQueryTypeParamKey],i=t?.parentItem,r=(0,M.f)(n),o=this._itemUrlHelper.getItemUrlParts("").serverRelativeItemUrl||"",s=(0,M.c)({key:e.key,viewParams:n,defaultRootItemId:o}),d={};if((0,R.a)()&&e.mainLinkInfo?.ShareTokenString){const t=(0,fe.a)({oneUpProps:this._oneUpStore.getOneUpProperties(),appPageContext:this._pageContext,item:e});if(!_e&&t?.webServerRelativeUrl&&n[w.b.listUrlKey]&&!n?.[w.b.remoteItem]){const e=t&&Number(t.webTemplate)===c.b.mySite,n=!(0,me.a)(this._pageContext);e&&!t.isMySiteOwner&&n&&!be||(d[w.b.webUrlKey]=t.webServerRelativeUrl)}!he&&this._pageContext.isCommonDomainRequestContext&&t?.routingKey&&(d[w.b.routingKey]=t.routingKey),d[w.b.shareTokenKey]=e.mainLinkInfo.ShareTokenString}const l={itemKey:e.key,viewParams:n,itemUrlHelper:this._itemUrlHelper,pageContext:this._pageContext,isDocSet:e.isDocSet,listId:this._pageContext.listId,listItemId:e.properties&&e.properties.ID,itemType:e.type,itemList:e.list,itemOpenUrl:e.openUrl,itemPreviewIFrameUrl:e.previewIFrameUrl,itemQueryType:e.queryType,itemOfficeBundle:e.officeBundle,itemContentTypeId:e.contentTypeId,itemUrls:e.urls,itemSubsite:void 0,itemExtension:e.extension,itemFSObjType:e.properties?.FSObjType,itemTranslationLanguages:e.properties?._SPTranslatedLanguages,isUnifiedAppSupportedFile:ae(e),welcomePageCustomized:e.properties?.WelcomePageCustomized,getMediaUrl:()=>te({itemKey:e.key,parentItemKey:i?.key,params:s,supportsOneUp:!0,itemUrlHelper:this._itemUrlHelper,page:r,addDefaultParentViewOnViewerOpenUrls:this._addDefaultParentViewOnViewerOpenUrls,parentView:a,parentViewParams:t?.parentViewParams,mainLinkViewParams:d}),parentItemKey:i&&i.key,supportsOneUp:!0,urlType:t?.urlType,defaultRootItemId:o,page:r,mainLinkInfo:e.mainLinkInfo,parentViewParams:t?.parentViewParams};let u=this._getDefaultClickUrl(l);return this._isFastOneUp&&(u=u.replace("#","?")),u}getOpenInOfficeClientUrl(e,t,n){const a=e.appMap,i=e.properties&&e.properties.path||this.getItemUrl(e.key),r=e.extension||"",o=-1!==[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"].indexOf(r.toLowerCase()),s=e.queryType===O.a.SharedWithMe&&("ms-word"===e.appMap||"ms-powerpoint"===e.appMap);return function(e,t,n,a,i,r){let o=se.a.none;return i&&(o=se.a.encodeCommand),se.b.createProtocolHandlerUrl(e,t,n,"",o,r)}(a,i,re.a.hasItemPermission(e,re.a.editListItems)&&!o&&(!oe.c(e)||oe.b(e,this._pageContext.userId))||s?ce.Edit:ce.View,0,this._platform?.isChrome&&this._platform?.isMac,this._pageContext.isSPO)}getKey(e){return(0,M.d)(e)}getItemUrl(e=""){const t=this._itemUrlHelper.getItemUrlParts(e);return u.a(t?.fullItemUrl||"")}getOpenInOfficeOnlineUrl(e,t){const n=e;let a;return a=ae(e)?de.a.GetWopiDocEditUrl(n,t||"",this._pageContext.env):de.a.GetWopiFrameEditUrl(n),this._ensureLayouts15(a||e.openUrl||"")}getApiBaseUrl(e){const t="v2.1"===e?.apiVersion?e.apiVersion:"v2.0";return`${(0,ue.b)(this._pageContext)}/_api/${t}`}getKeyParams(e){return(0,M.e)(e)}getPageType(e){return(0,M.f)(e)}getQueryType(e=this._navigation.viewParams){return(0,M.g)(e)}_ensureLayouts15(e){return e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),e}constructor(e,t){this._pageContext=t.pageContext,this._navigation=t.navigation,this._itemUrlHelper=t.itemUrlHelper,this._getDefaultClickUrl=t.getDefaultClickUrl,this._platform=t.platform,this._isFastOneUp=t.isFastOneUp,this._addDefaultParentViewOnViewerOpenUrls=t.addDefaultParentViewOnViewerOpenUrls,this._oneUpStore=t.oneUpStore}}ge.dependencies={navigation:i.a,pageContext:b.a,resources:a.sp,itemUrlHelper:ie.c,getDefaultClickUrl:ee,platform:T.a,isFastOneUp:le.j.optional,addDefaultParentViewOnViewerOpenUrls:F.optional,oneUpStore:pe.b};const ve=ge,ye=(0,a.C2)("OneUpUrlDataSource",ge)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>a,c:()=>d,d:()=>i,e:()=>r,f:()=>u,g:()=>m,h:()=>c,i:()=>f,j:()=>o,k:()=>p,l:()=>l});const a="id",i="listId",r="listurl",o="viewid",s="groupBy",c="sortField",d="isAscending",l="weburl",u="searchid",f="typeFilters",p="viewpath",m="q"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a="action"}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s});var a=n("odsp.util_385");const i=a.JW.isFeatureEnabled,r={ODB:61286},o={ODB:62524},s=new a.OJ({name:"isOneUpTempAuthDeprecationEnabled",factory:{dependencies:{},create:()=>({instance:i(r)})}}),c=new a.OJ({name:"isMeTATempAuthDeprecationEnabled",factory:{dependencies:{isOneUpTempAuthDeprecationEnabled:s},create:e=>({instance:e.isOneUpTempAuthDeprecationEnabled&&i(o)})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)({name:"shouldTreatCidAsClickId",factory:{dependencies:{},create:()=>({instance:!1})}})}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>g,c:()=>b});var a=n("odsp.util_385"),i=n(113),r=n(143),o=n(56),s=n(1);const c=new a.OJ({name:"isZipPreviewerEnabled.key",factory:new a.Rn(!0)});var d,l=n(50),u=n(286),f=n(4),p=n(291),m=n(116);!function(e){e.Error="Error",e.WAC="WAC",e.Html="Html",e.MSPdf="MSPdf",e.Pdf="Pdf",e.OnePlayerVideo="OnePlayerVideo",e.OnePlayerAudio="OnePlayerAudio",e.Panorama="Panorama",e.Image360="Image360",e.Zip="Zip",e.ThreeD="3d",e.TextFile="TextFile",e.Photo="Photo",e.Thumbnail="Thumbnail",e.FileHandler="FileHandler",e.Copilot="Copilot",e.Other="Other",e.Unknown="Unknown"}(d||(d={}));const _=[".opus",".url",".mht",".mhtml",".xltx",".xlt",".xltm"],h=[{extension:".opus"},{extension:".url"},{extension:".mht",originalViewer:"Html"},{extension:".mhtml",originalViewer:"Html"},{extension:".xltx",originalViewer:"WAC"},{extension:".xlt",originalViewer:"WAC"},{extension:".xltm",originalViewer:"WAC"}];(0,f.Lb)()||(_.push(".aspx"),h.push({extension:".aspx"}));const b=new a.OJ({name:"ViewerTypeHelper",factory:{dependencies:{platformDetection:o.a,pdfViewerHelper:l.b,fileHandlerHelper:u.a,pageContext:s.a,isZipPreviewerEnabled:c},create:({platformDetection:e,pdfViewerHelper:t,fileHandlerHelper:n,pageContext:a,isZipPreviewerEnabled:o})=>{const s=!e.isMobile;return{instance:{getValidViewerTypes:function(e){if(!e||e.isPlaceholder)return"Unknown";const c=function(e){if((0,f.pc)()){if((0,f.$b)()&&e.extension&&g(e).length>0)return"Other"}else if((0,f.$b)()&&e.extension&&-1!==_.indexOf(e.extension))return"Other"}(e);return c||(e.error?"Error":e.folder||e.itemStatus===i.b.ConditionalAccessBlocked||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected||(0,f.Pb)()&&"OneNote.Notebook"===e?.properties?.ProgId?"Other":e.officeBundle||e.wopiFrameUrl?"WAC":e.htmlConversion?"Html":t.isSupportedFileType(e)?"MSPdf":e.video?"OnePlayerVideo":e.audio?"OnePlayerAudio":e.panorama?"Panorama":s&&e.image360?"Image360":e.model3d?"3d":o&&e.zip?"Zip":function(e,t){return(0,f.Kb)(t)&&!!e.extension&&(e.extension===p.e||e.extension===p.d||(0,m.b)(e.extension))}(e,a)?"Copilot":function(e){return!!e.extension&&(0,r.b)(e.extension,e.type)}(e)?"TextFile":e.photo?"Photo":e.thumbnail?"Thumbnail":n.hasFileHandler(e)?"FileHandler":"Other")}}}}}});function g(e){return h.filter(t=>t.extension===e.extension)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>S});var a=n("odsp.util_385"),i=n(41),r=n(15),o=n(45),s=n(74),c=n(1),d=n(151),l=n(155),u=n(226),f=n(289),p=n(238),m=n(290),_=n(543);const h={ODB:620},b=!a.Ov.isActivated("763D3497-0EC0-46CC-AD63-596FE4F157E0","02/24/2025","Fetch common domain download url"),g=27e5;class v{async getItemCurrentVersion(e,t){const n=this.getItemUrl(e,t),a=`${n}/versions?$select=id`,{value:i}=await this._sendVroomRequest(n,a,e,t||{},"versions",{});return i.length>0?i[0].id:""}async getDownloadUrl(e,t={}){const n=this._urlCache;if(!t.forceRefresh){const t=n.get(e.key),{url:i,time:r}=t||{};if(!a.Ov.isActivated("BCD7B9B4-8CA3-4350-87D0-90643D190FE6","11/01/2023","Enable download url cache")&&i&&r>Date.now()-g)return i}if(t.excludeTempAuth&&e.downloadUrlNoAuth)return e.downloadUrlNoAuth;if(e.downloadUrl&&""!==e.downloadUrl&&e.itemGeneratedTimeStamp&&Date.now()-e.itemGeneratedTimeStamp<g)return e.downloadUrl;const i=t.excludeTempAuth?{Prefer:"pactoken=N"}:void 0,r=this.getItemUrl(e,t),o=b&&this._pageContext.isCommonDomainRequestContext?`${r}?select=id,@content.downloadUrl,content.unifiedDomainDownloadUrlNoAuth`:`${r}?select=id,@content.downloadUrl`;return this._sendVroomRequest(r,o,e,t,"itemDownloadUrl",i).then(t=>{const a=(b&&this._pageContext.isCommonDomainRequestContext&&t["@content.unifiedDomainDownloadUrlNoAuth"]||t["@content.downloadUrl"]).replace(/[?&]ApiVersion=[^&]+/,"");return n.set(e.key,{url:a,time:Date.now()}),a})}async getThumbnailUrl(e,t={}){const n=this.getItemUrl(e,t),{width:a,height:i}=t.size||{},r=`${n}/thumbnails/0/${a&&i?`c${Math.ceil(a)}x${Math.ceil(i)}`:"large"}/content?prefer=noredirect,closestavailablesize`,o=e=>{const{response:t}=e;return{blobUrl:URL.createObjectURL(t)}};try{return await this._sendVroomRequest(n,r,e,t,"thumbnailUrl",{},"blob",o)}catch(e){return"code"in e&&(e.code=`${e.code}: VroomFetchError`),{error:e}}}async getDownloadToken(e){const{url:t,item:n,apiName:a}=e;if(t&&this._pageContext.webAbsoluteUrl){const e=new i.a(t).authority;return e!==new i.a(this._pageContext.webAbsoluteUrl).authority?this._identityDataSource.getSharePointToken({webAbsoluteUrl:e,apiQosName:a??"GraphDataSource"}).then(e=>{const{accessToken:t,isBadger:n}=e;return`${n?"badger":"bearer"} ${t}`}):void 0}const r=this._itemUrlHelper.getItemUrlParts(n.key);if(r.isCrossDomain)return this._identityDataSource.getSharePointToken({webAbsoluteUrl:new i.a(r.fullItemUrl).authority,apiQosName:a??"GraphDataSource"}).then(e=>{const{accessToken:t,isBadger:n}=e;return`${n?"badger":"bearer"} ${t}`})}async getAuthenticationParams(e,t){const{apiVersion:n=this._metaVroomVersion}=t||{},a=await this.getAccessToken(e,{...t,apiVersion:n});return this._getAuthenticationParamsSync(a)}getItemUrl(e,t={}){const{useDirectEndpoint:n=!this._pageContext.isSPO,isPath:a=!1,apiVersion:i="v2.0",allowCookies:r=!1}=t,o=this._getGraphBaseUrl(e,{useDirectEndpoint:n,apiVersion:i,allowCookies:r}),{graph:s}=e;if(s&&s.driveId&&"root"!==s.itemId){const{driveId:e="me",itemId:t="root"}=s;return`${o}/drives/${encodeURIComponent(e)}${"root"===t?"/root":`/items/${encodeURIComponent(t)}`}${a?":":""}`}{const t=e.graph;let n;const i=t&&t.driveId;if(i&&(n=`${o}/drives/${encodeURIComponent(i)}`),!n)return"";const r=this._itemUrlHelper.getItemUrlParts(e.key),{listRelativeItemUrl:s}=this._itemUrlHelper.getUrlParts({path:r.serverRelativeItemUrl,listUrl:r.serverRelativeListUrl});return`${n}/root${s?`:/${encodeURI(s)}${a?"":":"}`:a?":":""}`}}async getAccessToken(e,t={}){const{apiVersion:n,forceRefresh:a=!1,apiName:r="GraphDataSource"}=t,o=this._getAccessTokenFromItem(e,{apiVersion:n});if(o){const{accessToken:e,proofToken:t,tokenExpiry:n}=o,i=3e5;if(!a&&!(0,l.a)((0,u.default)({authToken:e},{proofToken:u.optional(t),expiry:u.optional(n?new Date(n):void 0)}),i))return o}const s=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;return await this._identityDataSource.getSharePointToken({webAbsoluteUrl:new i.a(s).authority,forceRefresh:a,apiQosName:r})}async getMetaPac(e,t,n={}){const{apiVersion:a=this._metaVroomVersion,forceRefresh:i=!1}=n,r=this._getAccessTokenFromItem(t,{apiVersion:a});if(r){const{metaPac:e}=r,t=3e5;if(!i&&e&&!(0,l.a)({authToken:e},t))return r}const o=await e.consumeAsync(m.a),s=await(o?.refreshAuthToken());if(s){const{driveAccessCode:e,driveAccessCodeV21:t}=s;if(e&&"v2.0"===a)return{metaPac:e};if(t&&"v2.1"===a)return{metaPac:t}}throw new Error("Cannot find valid MeTA access code")}async redeemSharingLink(e,t){const n=this.getItemUrl(e),a=(0,_.a)(t);return this._sendVroomRequest(n,a,e,void 0,"redeemSharingLink",{Prefer:"redeemSharingLink"})}_getAccessTokenFromItem(e,t={}){const{apiVersion:n}=t;return"v2.1"===n?e.graph?.sessionTokenV21:e.graph?.sessionToken}_getAuthenticationParamsSync(e){if(e){const{accessToken:t,proofToken:n}=e,a={};return t&&(a.access_token=t),n&&(a.prooftoken=n),a}return{}}_getGraphBaseUrl(e,t){const{useDirectEndpoint:n,apiVersion:a}=t,r=this._itemUrlHelper.getItemUrlParts(e.key),o=r.fullListUrl;if(n){if(o)return`${new i.a(o).authority}/_api/${a}`;if(r.isCrossDomain||r.isCrossList){const t=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;return`${new i.a(t).authority}/_api/${a}`}return this._urlDataSource.getApiBaseUrl({apiVersion:a})}return"https://graph.microsoft.com/v1.0"}_sendVroomRequest(e,t,n,a={},r,o,s,c){const d=this._itemUrlHelper.getItemUrlParts(n.key),{isCrossDomain:l}=d;a.apiName&&(r=`${a.apiName}.${r}`);const u=!l;return(u?Promise.resolve(void 0):this._identityDataSource.getSharePointToken({webAbsoluteUrl:new i.a(e).authority,apiQosName:r})).then(e=>{const n=u?void 0:e;return this._vroomDataRequestor.send({apiName:r,path:`${t}`,accessToken:n,qosExtraData:a.qosExtraData,allowCookies:u,headers:o,responseType:s,parseResponse:c})})}get _metaVroomVersion(){return a.JW.isFeatureEnabled(h)?"v2.1":"v2.0"}constructor(e,t){this._urlDataSource=t.urlDataSource,this._itemUrlHelper=t.itemUrlHelper,this._pageContext=t.pageContext,this._urlCache=new Map,this._vroomDataRequestor=t.vroomDataRequestor,this._identityDataSource=t.identityDataSource}}v.dependencies={urlDataSource:d.b,itemUrlHelper:r.c,pageContext:c.a,vroomDataRequestor:s.a,identityDataSource:o.resourceKey};const y=p.legacyGraphDataSourceKey,S=f.a?y:(0,a.C2)("oneup-lightspeed/GraphDataSource",v)}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(73);const i=(0,n(292).a)(),r=class extends(a.a.withManager(i)){}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=n("odsp.util_385").Ov.isActivated("8F5B46F5-FE0A-4975-A57F-C047F6A9896F")}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_145"),i=/\{(\d+)\}/g;function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(i,function(e,n){var a=t[Number(n)];return null!==a?"".concat(a):""})}var o=function(){function e(e){this._strings=e}return Object.defineProperty(e.prototype,"strings",{get:function(){return this._strings},set:function(e){this._strings=e},enumerable:!1,configurable:!0}),e.prototype.get=function(e,t){if(!this._strings)return"";var n=this._strings[e];return t?r.apply(void 0,(0,a.lt)([n],(0,a.pM)(t),!1)):n},e}()}
,,,,,,,,,,(e,t,n)=>{"use strict";var a,i;function r(){a=self._pdfSessionPerfMarks=[]}function o(){return void 0===i&&(i=void 0!==typeof performance&&!!performance&&"function"==typeof performance.mark&&"function"==typeof performance.clearMarks&&"function"==typeof performance.now),i}function s(){return"undefined"!=typeof MSPDF_PERF_LAB&&MSPDF_PERF_LAB}n.d(t,{a:()=>c});var c=function(){function e(){}return e.initialize=function(t){var n=t.markNamePrefix;e._markNamePrefix=n||"",r()},e.mark=function(t){e._mark(t)},e.debugMark=function(t){s()&&e._mark(t)},e.getMarkerTime=function(t,n){if(void 0===n&&(n=!0),!o())return NaN;var a=n?e.addPrefix(t):t,i=performance.getEntriesByName(a,"mark");return(null==i?void 0:i.length)>0?Math.round(i[0].startTime):NaN},e.getDurationBetweenMarks=function(t,n){return e.getMarkerTime(n)-e.getMarkerTime(t)},e.enterPerfTestSession=function(e){s()&&(this._curSessionName=e,this._sessionId+=1)},e.sessionMark=function(t,n){if(s()){var i={stage:t,startTime:o()?performance.now():Date.now(),extraData:n},r=e.sessionMarkName,c=a,d=c.find(function(e){return e.name===r});d?d.data.push(i):c.push({name:r,data:[i]})}},e.getSessionMarkerData=function(){var t=e.sessionMarkName,n=a.find(function(e){return e.name===t});return null==n?void 0:n.data},e.clearMarks=function(t){if(o()){var n=[];t&&(n=t.map(e.addPrefix)),performance.getEntriesByType("mark").filter(function(t){return n.length>0?n.indexOf(t.name)>=0:0===t.name.lastIndexOf(e.namePrefix,0)}).forEach(function(e){performance.clearMarks(e.name)}),r()}},e.addPrefix=function(t){var n=e.namePrefix;return 0===t.lastIndexOf(n,0)?t:n+t},e._mark=function(t){if(o()){var n=e.addPrefix(t);performance.mark(n)}},Object.defineProperty(e,"namePrefix",{get:function(){return e._markNamePrefix+"MsPdf."},enumerable:!1,configurable:!0}),Object.defineProperty(e,"sessionMarkName",{get:function(){return e.addPrefix("".concat(e._curSessionName,"_").concat(this._sessionId))},enumerable:!1,configurable:!0}),e._markNamePrefix="",e._curSessionName="Unknown",e._sessionId=-1,e}()}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>o});const a="rgba(31,31,31,.88)",i="#141414",r={themePrimary:"#0F6CBD",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#ffffff",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",redDark:"#F1707B",whiteTranslucent40:a,orange:"#E38585"},o={semanticColors:{bodyBackground:a,bodyStandoutBackground:r.neutralLight,buttonText:r.black,buttonTextPressed:r.neutralDark,buttonTextHovered:r.neutralPrimary,bodySubtext:r.neutralSecondary,disabledBackground:r.neutralQuaternaryAlt,errorText:r.redDark,inputBackgroundChecked:r.themePrimary,menuBackground:r.neutralLighter,menuItemBackgroundHovered:r.neutralQuaternaryAlt,menuItemBackgroundPressed:r.neutralQuaternary,menuDivider:r.neutralTertiaryAlt,menuIcon:r.themeDarkAlt,menuHeader:r.black,menuItemText:r.neutralPrimary,menuItemTextHovered:r.neutralDark,messageText:r.neutralPrimary,buttonBackground:a,buttonBackgroundHovered:"#424242",buttonBackgroundPressed:"#000000",primaryButtonBackground:r.themeTertiary,primaryButtonBackgroundHovered:r.themeLight,primaryButtonBackgroundPressed:r.themeLighter,primaryButtonText:r.black,primaryButtonTextHovered:r.black,primaryButtonTextPressed:r.black,primaryButtonTextDisabled:"#605e5c",buttonBorder:"#808080",variantBorder:r.neutralQuaternary,infoBackground:r.neutralQuaternaryAlt,infoIcon:r.neutralPrimaryAlt,errorIcon:r.redDark,warningIcon:r.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B",inputBorder:"#525252"},palette:r,isInverted:!0}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a=n("odsp.util_385"),i=n(10),r=n(31),o=n(1),s=n(621),c=n(45);const d=!a.Ov.isActivated("F7F844A1-C5CA-40D4-A9F1-D446600D3D5F"),l={oneUpStateStore:i.f,pageContext:o.a,getExecutor:s.a.async.lazy,identityDataSource:c.resourceKey},u=new a.OJ({name:"SaveAction",factory:{dependencies:l,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const n=!!t.oneUpStateStore.getViewerState(e.item.key)?.saveData?.fileUpload&&r.a.hasItemPermission(e.item,r.a.editListItems),a=t.pageContext;return{isAvailable:n,id:"SaveAction",onExecute:async n=>(await t.getExecutor()).executeSave({item:e.item,parentItem:e.parentItem,fileUpload:n.fileUpload,pageContext:a,oneUpStateStore:t.oneUpStateStore,saveascopy:n.saveascopy||!1,identityDataSource:t.identityDataSource,qosEvent:n.qosEvent}),customerPromise:d?{startSchema:{pillar:"Edit"},computeVeto:()=>"Save Failure"}:void 0}})}}}}})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>m});var a=n("odsp.util_385"),i=n(0),r=n(17),o=n(10),s=n(341),c=n(1),d=n(265),l=n(340),u=n(365);const f={oneUpStore:r.b,oneUpStateStore:o.f,getExecutor:u.a.async.lazy,canOpenCopilot:l.a,appPageContext:c.a},p=e=>t=>({isAvailable:e.canOpenCopilot.isCopilotSupportedForItem(t.item),id:"OpenCopilotPaneAction",onExecute:async()=>{const n=new a.Zd,r=(0,d.a)({oneUpProps:e.oneUpStore.getOneUpProperties(),appPageContext:e.appPageContext,item:t.item}),o=(0,s.a)({item:t.item,currentPageContext:r,appPageContext:e.appPageContext}),c={currentPageContext:r,loadConversationHistory:!!(window.event&&window.event instanceof MouseEvent&&window.event.shiftKey),fileConstraint:o,onLoadSuccess:()=>{n.resolve({resultType:i.b.Success})},onLoadError:e=>{n.reject(e)}};return(await e.getExecutor()).showCopilotPane(c),n.promise}}),m=new a.OJ({name:"openCopilotPaneAction",factory:{dependencies:f,create:e=>({instance:{evaluateAction:p(e)}})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(184),i=n(366);const r=()=>{const e=a.b,{palette:t,semanticColors:n}=e,r=`${n.buttonBackground} !important`,o=`${n.buttonBorder} !important`,s={background:r,paddingLeft:"8px",paddingRight:"8px",margin:"auto 6px auto 6px",color:t.black,height:"32px",width:"auto",border:`1px solid ${o}`,".ms-Button-menuIcon":{marginTop:"2px",color:t.black},".ms-Button-flexContainer":{backgroundColor:"transparent !important"}};return(0,i.a)(s)}}
,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>l,b:()=>x,c:()=>d,d:()=>s,e:()=>c,f:()=>I,g:()=>o,h:()=>i,i:()=>Ne,j:()=>Ge,k:()=>Be,l:()=>Ve,m:()=>je,n:()=>ze,o:()=>ie});var a=n("fui.core_136");const i="data-tabster",r=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]","details > summary","audio[controls]","video[controls]"].join(", "),o={Source:0,Target:1},s={Both:0,Vertical:1,Horizontal:2,Grid:3,GridLinear:4},c={ArrowUp:1,ArrowDown:2,ArrowLeft:3,ArrowRight:4,PageUp:5,PageDown:6,Home:7,End:8},d={Unlimited:0,Limited:1,LimitedTrapFocus:2},l={Enter:1,Escape:2};function u(e,t){var n;return null===(n=e.storageEntry(t))||void 0===n?void 0:n.tabster}function f(e,t,n){var a,r;const o=n||e._noop?void 0:t.getAttribute(i);let s,c=e.storageEntry(t);if(o){if(o===(null===(a=null==c?void 0:c.attr)||void 0===a?void 0:a.string))return;try{const e=JSON.parse(o);if("object"!=typeof e)throw new Error(`Value is not a JSON object, got '${o}'.`);s={string:o,object:e}}catch(e){}}else if(!c)return;c||(c=e.storageEntry(t,!0)),c.tabster||(c.tabster={});const d=c.tabster||{},l=(null===(r=c.attr)||void 0===r?void 0:r.object)||{},u=(null==s?void 0:s.object)||{};for(const n of Object.keys(l))if(!u[n]){if("root"===n){const t=d[n];t&&e.root.onRoot(t,!0)}switch(n){case"deloser":case"root":case"groupper":case"modalizer":case"restorer":case"mover":const a=d[n];a&&(a.dispose(),delete d[n]);break;case"observed":delete d[n],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete d[n]}}for(const n of Object.keys(u)){const a=u.sys;switch(n){case"deloser":d.deloser?d.deloser.setProps(u.deloser):e.deloser&&(d.deloser=e.deloser.createDeloser(t,u.deloser));break;case"root":d.root?d.root.setProps(u.root):d.root=e.root.createRoot(t,u.root,a),e.root.onRoot(d.root);break;case"modalizer":d.modalizer?d.modalizer.setProps(u.modalizer):e.modalizer&&(d.modalizer=e.modalizer.createModalizer(t,u.modalizer,a));break;case"restorer":d.restorer?d.restorer.setProps(u.restorer):e.restorer&&u.restorer&&(d.restorer=e.restorer.createRestorer(t,u.restorer));break;case"focusable":d.focusable=u.focusable;break;case"groupper":d.groupper?d.groupper.setProps(u.groupper):e.groupper&&(d.groupper=e.groupper.createGroupper(t,u.groupper,a));break;case"mover":d.mover?d.mover.setProps(u.mover):e.mover&&(d.mover=e.mover.createMover(t,u.mover,a));break;case"observed":e.observedElement&&(d.observed=u.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":d.uncontrolled=u.uncontrolled;break;case"outline":e.outline&&(d.outline=u.outline);break;case"sys":d.sys=u.sys;break;default:console.error(`Unknown key '${n}' in data-tabster attribute value.`)}}s?c.attr=s:(0===Object.keys(d).length&&(delete c.tabster,delete c.attr),e.storageEntry(t,!1))}const p="tabster:mover:movefocus",m="tabster:mover:memorized-element",_="tabster:groupper:movefocus",h="tabster:restorer:restore-focus",b="undefined"!=typeof CustomEvent?CustomEvent:function(){};class g extends b{constructor(e,t){super(e,{bubbles:!0,cancelable:!0,composed:!0,detail:t}),this.details=t}}class v extends g{constructor(e){super("tabster:focusin",e)}}class y extends g{constructor(e){super("tabster:focusout",e)}}class S extends g{constructor(e){super("tabster:movefocus",e)}}class D extends g{constructor(e){super("tabster:mover:state",e)}}class I extends g{constructor(e){super(p,e)}}class x extends g{constructor(e){super(_,e)}}class C extends g{constructor(e){super("tabster:modalizer:active",e)}}class O extends g{constructor(e){super("tabster:modalizer:inactive",e)}}class w extends g{constructor(){super(h)}}class E extends g{constructor(e){super("tabster:root:focus",e)}}class A extends g{constructor(e){super("tabster:root:blur",e)}}const L={createMutationObserver:e=>new MutationObserver(e),createTreeWalker:(e,t,n,a)=>e.createTreeWalker(t,n,a),getParentNode:e=>e?e.parentNode:null,getParentElement:e=>e?e.parentElement:null,nodeContains:(e,t)=>!(!t||!(null==e?void 0:e.contains(t))),getActiveElement:e=>e.activeElement,querySelector:(e,t)=>e.querySelector(t),querySelectorAll:(e,t)=>Array.prototype.slice.call(e.querySelectorAll(t),0),getElementById:(e,t)=>e.getElementById(t),getFirstChild:e=>(null==e?void 0:e.firstChild)||null,getLastChild:e=>(null==e?void 0:e.lastChild)||null,getNextSibling:e=>(null==e?void 0:e.nextSibling)||null,getPreviousSibling:e=>(null==e?void 0:e.previousSibling)||null,getFirstElementChild:e=>(null==e?void 0:e.firstElementChild)||null,getLastElementChild:e=>(null==e?void 0:e.lastElementChild)||null,getNextElementSibling:e=>(null==e?void 0:e.nextElementSibling)||null,getPreviousElementSibling:e=>(null==e?void 0:e.previousElementSibling)||null,appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,n)=>e.insertBefore(t,n),getSelection:e=>{var t;return(null===(t=e.ownerDocument)||void 0===t?void 0:t.getSelection())||null},getElementsByName:(e,t)=>e.ownerDocument.getElementsByName(t)};let k;const M="undefined"!=typeof DOMRect?DOMRect:class{constructor(e,t,n,a){this.left=e||0,this.top=t||0,this.right=(e||0)+(n||0),this.bottom=(t||0)+(a||0)}};let P=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),k=!1}catch(e){k=!0}function T(e){const t=e();let n=t.__tabsterInstanceContext;return n||(n={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=n),n}class U{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||!(!t&&W(e._target.ownerDocument,e._target))&&(delete e._target,!0)}}class F{constructor(e,t,n){const a=T(e);let i;a.WeakRef?i=new a.WeakRef(t):(i=new U(t),a.fakeWeakRefs.push(i)),this._ref=i,this._data=n}get(){const e=this._ref;let t;return e&&(t=e.deref(),t||delete this._ref),t}getData(){return this._data}}function H(e,t){const n=T(e);n.fakeWeakRefs=n.fakeWeakRefs.filter(e=>!U.cleanup(e,t))}function R(e){const t=T(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=function(e){return e.basics.WeakRef}(t)),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout(()=>{t.fakeWeakRefsTimer=void 0,H(e),R(e)},12e4))}function N(e,t,n){if(t.nodeType!==Node.ELEMENT_NODE)return;const a=k?n:{acceptNode:n};return L.createTreeWalker(e,t,NodeFilter.SHOW_ELEMENT,a,!1)}function B(e,t){let n=t.__tabsterCacheId;const a=T(e),i=n?a.containerBoundingRectCache[n]:void 0;if(i)return i.rect;const r=t.ownerDocument&&t.ownerDocument.documentElement;if(!r)return new M;let o=0,s=0,c=r.clientWidth,d=r.clientHeight;if(t!==r){const e=t.getBoundingClientRect();o=Math.max(o,e.left),s=Math.max(s,e.top),c=Math.min(c,e.right),d=Math.min(d,e.bottom)}const l=new M(o<c?o:-1,s<d?s:-1,o<c?c-o:0,s<d?d-s:0);return n||(n="r-"+ ++a.lastContainerBoundingRectCacheId,t.__tabsterCacheId=n),a.containerBoundingRectCache[n]={rect:l,element:t},a.containerBoundingRectCacheTimer||(a.containerBoundingRectCacheTimer=window.setTimeout(()=>{a.containerBoundingRectCacheTimer=void 0;for(const e of Object.keys(a.containerBoundingRectCache))delete a.containerBoundingRectCache[e].element.__tabsterCacheId;a.containerBoundingRectCache={}},50)),l}function j(e,t,n){const a=V(t);if(!a)return!1;const i=B(e,a),r=t.getBoundingClientRect(),o=r.height*(1-n),s=Math.max(0,i.top-r.top)+Math.max(0,r.bottom-i.bottom);return 0===s||s<=o}function V(e){const t=e.ownerDocument;if(t){for(let t=L.getParentElement(e);t;t=L.getParentElement(t))if(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)return t;return t.documentElement}return null}function z(e){return!!e.__shouldIgnoreFocus}function G(e,t){const n=T(e);let a=t.__tabsterElementUID;return a||(a=t.__tabsterElementUID=function(e){const t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=4294967295*Math.random();const n=[];for(let e=0;e<t.length;e++)n.push(t[e].toString(36));return n.push("|"),n.push((++P).toString(36)),n.push("|"),n.push(Date.now().toString(36)),n.join("")}(e())),!n.elementByUId[a]&&W(t.ownerDocument,t)&&(n.elementByUId[a]=new F(e,t)),a}function K(e,t){const n=T(e);for(const e of Object.keys(n.elementByUId)){const a=n.elementByUId[e],i=a&&a.get();i&&t&&!L.nodeContains(t,i)||delete n.elementByUId[e]}}function W(e,t){return L.nodeContains(null==e?void 0:e.body,t)}function q(e,t){const n=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return n&&n.call(e,t)}let Q=0;class Y{constructor(e,t,n){const a=e.getWindow;this._tabster=e,this._element=new F(a,t),this._props={...n},this.id="i"+ ++Q}getElement(){return this._element.get()}getProps(){return this._props}setProps(e){this._props={...e}}}class J{constructor(e,t,n,i,r){var o;this._focusIn=e=>{if(this._fixedTarget){const e=this._fixedTarget.get();return void(e&&(0,a.RMr)(e))}const t=this.input;if(this.onFocusIn&&t){const n=e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,n),n)}},this._focusOut=e=>{if(this._fixedTarget)return;this.useDefaultAction=!1;const t=this.input;if(this.onFocusOut&&t){const n=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,n),n)}};const s=e(),c=s.document.createElement("i");c.tabIndex=0,c.setAttribute("role","none"),c.setAttribute("data-tabster-dummy",""),c.setAttribute("aria-hidden","true");const d=c.style;d.position="fixed",d.width=d.height="1px",d.opacity="0.001",d.zIndex="-1",d.setProperty("content-visibility","hidden"),function(e){e.__shouldIgnoreFocus=!0}(c),this.input=c,this.isFirst=n.isFirst,this.isOutside=t,this._isPhantom=null!==(o=n.isPhantom)&&void 0!==o&&o,this._fixedTarget=r,c.addEventListener("focusin",this._focusIn),c.addEventListener("focusout",this._focusOut),c.__tabsterDummyContainer=i,this._isPhantom&&(this._disposeTimer=s.setTimeout(()=>{delete this._disposeTimer,this.dispose()},0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(s.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var e;this._clearDisposeTimeout&&this._clearDisposeTimeout();const t=this.input;t&&(delete this._fixedTarget,delete this.onFocusIn,delete this.onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),delete t.__tabsterDummyContainer,null===(e=L.getParentNode(t))||void 0===e||e.removeChild(t))}setTopLeft(e,t){var n;const a=null===(n=this.input)||void 0===n?void 0:n.style;a&&(a.top=`${e}px`,a.left=`${t}px`)}_isBackward(e,t,n){return e&&!n?!this.isFirst:!!(n&&t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING)}}class X{constructor(e,t,n,a,i,r){this._element=t,this._instance=new $(e,t,this,n,a,i,r)}_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}moveOut(e){var t;null===(t=this._instance)||void 0===t||t.moveOut(e)}moveOutWithDefaultAction(e,t){var n;null===(n=this._instance)||void 0===n||n.moveOutWithDefaultAction(e,t)}getHandler(e){return e?this._onFocusIn:this._onFocusOut}setTabbable(e){var t;null===(t=this._instance)||void 0===t||t.setTabbable(this,e)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static moveWithPhantomDummy(e,t,n,i,r){const o=new J(e.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(o){let s,c;if("BODY"===t.tagName)s=t,c=n&&i||!n&&!i?L.getFirstElementChild(t):null;else{let a,r;n&&(!i||i&&!e.focusable.isFocusable(t,!1,!0,!0))?(s=t,c=i?t.firstElementChild:null):(s=L.getParentElement(t),c=n&&i||!n&&!i?t:L.getNextElementSibling(t));do{a=n&&i||!n&&!i?L.getPreviousElementSibling(c):c,r=ae(a),r===t?c=n&&i||!n&&!i?a:L.getNextElementSibling(a):r=null}while(r)}(null==s?void 0:s.dispatchEvent(new S({by:"root",owner:s,next:null,relatedEvent:r})))&&(L.insertBefore(s,o,c),(0,a.RMr)(o))}}static addPhantomDummyWithTarget(e,t,n,a){const i=new J(e.getWindow,!0,{isPhantom:!0,isFirst:!0},void 0,new F(e.getWindow,a)).input;if(i){let e,a;t.querySelector(r)&&!n?(e=t,a=L.getFirstElementChild(t)):(e=L.getParentElement(t),a=n?t:L.getNextElementSibling(t)),e&&L.insertBefore(e,i,a)}}}class Z{constructor(e){this._updateQueue=new Set,this._lastUpdateQueueTime=0,this._changedParents=new WeakSet,this._dummyElements=[],this._dummyCallbacks=new WeakMap,this._domChanged=e=>{var t;this._changedParents.has(e)||(this._changedParents.add(e),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null===(t=this._win)||void 0===t?void 0:t.call(this).setTimeout(()=>{delete this._updateDummyInputsTimer;for(const e of this._dummyElements){const t=e.get();if(t){const e=this._dummyCallbacks.get(t);if(e){const n=L.getParentNode(t);n&&!this._changedParents.has(n)||e()}}}this._changedParents=new WeakSet},100)))},this._win=e}add(e,t){!this._dummyCallbacks.has(e)&&this._win&&(this._dummyElements.push(new F(this._win,e)),this._dummyCallbacks.set(e,t),this.domChanged=this._domChanged)}remove(e){this._dummyElements=this._dummyElements.filter(t=>{const n=t.get();return n&&n!==e}),this._dummyCallbacks.delete(e),0===this._dummyElements.length&&delete this.domChanged}dispose(){var e;const t=null===(e=this._win)||void 0===e?void 0:e.call(this);this._updateTimer&&(null==t||t.clearTimeout(this._updateTimer),delete this._updateTimer),this._updateDummyInputsTimer&&(null==t||t.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummyCallbacks=new WeakMap,this._dummyElements=[],this._updateQueue.clear(),delete this.domChanged,delete this._win}updatePositions(e){this._win&&(this._updateQueue.add(e),this._lastUpdateQueueTime=Date.now(),this._scheduledUpdatePositions())}_scheduledUpdatePositions(){var e;this._updateTimer||(this._updateTimer=null===(e=this._win)||void 0===e?void 0:e.call(this).setTimeout(()=>{if(delete this._updateTimer,this._lastUpdateQueueTime+100<=Date.now()){const e=new Map,t=[];for(const n of this._updateQueue)t.push(n(e));this._updateQueue.clear();for(const e of t)e();e.clear()}else this._scheduledUpdatePositions()},100))}}class ${constructor(e,t,n,i,r,o,s){this._wrappers=[],this._isOutside=!1,this._transformElements=new Set,this._onFocusIn=(e,t,n)=>{this._onFocus(!0,e,t,n)},this._onFocusOut=(e,t,n)=>{this._onFocus(!1,e,t,n)},this.moveOut=e=>{var t;const n=this._firstDummy,i=this._lastDummy;if(n&&i){this._ensurePosition();const r=n.input,o=i.input,s=null===(t=this._element)||void 0===t?void 0:t.get();if(r&&o&&s){let t;e?(r.tabIndex=0,t=r):(o.tabIndex=0,t=o),t&&(0,a.RMr)(t)}}},this.moveOutWithDefaultAction=(e,t)=>{var n;const i=this._firstDummy,r=this._lastDummy;if(i&&r){this._ensurePosition();const o=i.input,s=r.input,c=null===(n=this._element)||void 0===n?void 0:n.get();if(o&&s&&c){let n;e?!i.isOutside&&this._tabster.focusable.isFocusable(c,!0,!0,!0)?n=c:(i.useDefaultAction=!0,o.tabIndex=0,n=o):(r.useDefaultAction=!0,s.tabIndex=0,n=s),n&&c.dispatchEvent(new S({by:"root",owner:c,next:null,relatedEvent:t}))&&(0,a.RMr)(n)}}},this.setTabbable=(e,t)=>{var n,a;for(const n of this._wrappers)if(n.manager===e){n.tabbable=t;break}const i=this._getCurrent();if(i){const e=i.tabbable?0:-1;let t=null===(n=this._firstDummy)||void 0===n?void 0:n.input;t&&(t.tabIndex=e),t=null===(a=this._lastDummy)||void 0===a?void 0:a.input,t&&(t.tabIndex=e)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout(()=>{delete this._addTimer,this._ensurePosition(),this._addTransformOffsets()},0))},this._addTransformOffsets=()=>{this._tabster._dummyObserver.updatePositions(this._computeTransformOffsets)},this._computeTransformOffsets=e=>{var t,n;const a=(null===(t=this._firstDummy)||void 0===t?void 0:t.input)||(null===(n=this._lastDummy)||void 0===n?void 0:n.input),i=this._transformElements,r=new Set;let o=0,s=0;const c=this._getWindow();for(let t=a;t&&t.nodeType===Node.ELEMENT_NODE;t=L.getParentElement(t)){let n=e.get(t);if(void 0===n){const a=c.getComputedStyle(t).transform;a&&"none"!==a&&(n={scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),e.set(t,n||null)}n&&(r.add(t),i.has(t)||t.addEventListener("scroll",this._addTransformOffsets),o+=n.scrollTop,s+=n.scrollLeft)}for(const e of i)r.has(e)||e.removeEventListener("scroll",this._addTransformOffsets);return this._transformElements=r,()=>{var e,t;null===(e=this._firstDummy)||void 0===e||e.setTopLeft(o,s),null===(t=this._lastDummy)||void 0===t||t.setTopLeft(o,s)}};const c=t.get();if(!c)throw new Error("No element");this._tabster=e,this._getWindow=e.getWindow,this._callForDefaultAction=s;const d=c.__tabsterDummy;if((d||this)._wrappers.push({manager:n,priority:i,tabbable:!0}),d)return d;c.__tabsterDummy=this;const l=null==r?void 0:r.dummyInputsPosition,u=c.tagName;this._isOutside=l?2===l:(o||"UL"===u||"OL"===u||"TABLE"===u)&&!("LI"===u||"TD"===u||"TH"===u),this._firstDummy=new J(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new J(this._getWindow,this._isOutside,{isFirst:!1},t);const f=this._firstDummy.input;f&&e._dummyObserver.add(f,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs()}dispose(e,t){var n,a,i,r;if(0===(this._wrappers=this._wrappers.filter(n=>n.manager!==e&&!t)).length){delete(null===(n=this._element)||void 0===n?void 0:n.get()).__tabsterDummy;for(const e of this._transformElements)e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements.clear();const e=this._getWindow();this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer);const t=null===(a=this._firstDummy)||void 0===a?void 0:a.input;t&&this._tabster._dummyObserver.remove(t),null===(i=this._firstDummy)||void 0===i||i.dispose(),null===(r=this._lastDummy)||void 0===r||r.dispose()}}_onFocus(e,t,n,a){var i;const r=this._getCurrent();!r||t.useDefaultAction&&!this._callForDefaultAction||null===(i=r.manager.getHandler(e))||void 0===i||i(t,n,a)}_getCurrent(){return this._wrappers.sort((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority),this._wrappers[0]}_ensurePosition(){var e,t,n;const a=null===(e=this._element)||void 0===e?void 0:e.get(),i=null===(t=this._firstDummy)||void 0===t?void 0:t.input,r=null===(n=this._lastDummy)||void 0===n?void 0:n.input;if(a&&i&&r)if(this._isOutside){const e=L.getParentNode(a);if(e){const t=L.getNextSibling(a);t!==r&&L.insertBefore(e,r,t),L.getPreviousElementSibling(a)!==i&&L.insertBefore(e,i,a)}}else{L.getLastElementChild(a)!==r&&L.appendChild(a,r);const e=L.getFirstElementChild(a);e&&e!==i&&e.parentNode&&L.insertBefore(e.parentNode,i,e)}}}function ee(e){let t=null;for(let n=L.getLastElementChild(e);n;n=L.getLastElementChild(n))t=n;return t||void 0}function te(e,t,n,a){const i=e.storageEntry(t,!0);let r=!1;if(!i.aug){if(void 0===a)return r;i.aug={}}if(void 0===a){if(n in i.aug){const e=i.aug[n];delete i.aug[n],null===e?t.removeAttribute(n):t.setAttribute(n,e),r=!0}}else{let e;n in i.aug||(e=t.getAttribute(n)),void 0!==e&&e!==a&&(i.aug[n]=e,null===a?t.removeAttribute(n):t.setAttribute(n,a),r=!0)}return void 0===a&&0===Object.keys(i.aug).length&&(delete i.aug,e.storageEntry(t,!1)),r}function ne(e){return"INPUT"===e.tagName&&!!e.name&&"radio"===e.type}function ae(e){var t;return(null===(t=null==e?void 0:e.__tabsterDummyContainer)||void 0===t?void 0:t.get())||null}function ie(e,t){const n=JSON.stringify(e);return!0===t?n:{[i]:n}}class re extends X{constructor(e,t,n,i){super(e,t,1,i,void 0,!0),this._onDummyInputFocus=e=>{var t;if(e.useDefaultAction)this._setFocused(!1);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);const n=this._element.get();if(n){this._setFocused(!0);const t=this._tabster.focusedElement.getFirstOrLastTabbable(e.isFirst,{container:n,ignoreAccessibility:!0});if(t)return void(0,a.RMr)(t)}null===(t=e.input)||void 0===t||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=n}}class oe extends Y{constructor(e,t,n,i,r){super(e,t,i),this._isFocused=!1,this._setFocused=e=>{var t;if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;const n=this._element.get();n&&(e?(this._isFocused=!0,null===(t=this._dummyManager)||void 0===t||t.setTabbable(!1),n.dispatchEvent(new E({element:n}))):this._setFocusedTimer=this._tabster.getWindow().setTimeout(()=>{var e;delete this._setFocusedTimer,this._isFocused=!1,null===(e=this._dummyManager)||void 0===e||e.setTabbable(!0),n.dispatchEvent(new A({element:n}))},0))},this._onFocusIn=e=>{const t=this._tabster.getParent,n=this._element.get();let a=e.composedPath()[0];do{if(a===n)return void this._setFocused(!0);a=a&&t(a)}while(a)},this._onFocusOut=()=>{this._setFocused(!1)},this._onDispose=n;const o=e.getWindow;this.uid=G(o,t),this._sys=r,(e.controlTab||e.rootDummyInputs)&&this.addDummyInputs();const s=o().document;s.addEventListener(a.TsF,this._onFocusIn),s.addEventListener(a.PHG,this._onFocusOut),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new re(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var e;this._onDispose(this);const t=this._tabster.getWindow(),n=t.document;n.removeEventListener(a.TsF,this._onFocusIn),n.removeEventListener(a.PHG,this._onFocusOut),this._setFocusedTimer&&(t.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null===(e=this._dummyManager)||void 0===e||e.dispose(),this._remove()}moveOutWithDefaultAction(e,t){const n=this._dummyManager;if(n)n.moveOutWithDefaultAction(e,t);else{const n=this.getElement();n&&re.moveWithPhantomDummy(this._tabster,n,!0,e,t)}}_add(){}_remove(){}}class se{constructor(e,t){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._autoRootCreate=()=>{var e;const t=this._win().document,n=t.body;if(n){this._autoRootUnwait(t);const a=this._autoRoot;if(a)return function(e,t,n){let a;{const t=e.getAttribute(i);if(t)try{a=JSON.parse(t)}catch(e){}}a||(a={}),function(e,t){for(const n of Object.keys(t)){const a=t[n];a?e[n]=a:delete e[n]}}(a,t),Object.keys(a).length>0?e.setAttribute(i,ie(a,!0)):e.removeAttribute(i)}(n,{root:a}),f(this._tabster,n),null===(e=u(this._tabster,n))||void 0===e?void 0:e.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,t.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._autoRoot=t,e.queueInit(()=>{this._autoRoot&&this._autoRootCreate()})}_autoRootUnwait(e){e.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){const e=this._win();this._autoRootUnwait(e.document),delete this._autoRoot,Object.keys(this._roots).forEach(e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])}),this.rootById={}}createRoot(e,t,n){const a=new oe(this._tabster,e,this._onRootDispose,t,n);return this._roots[a.id]=a,this._forceDummy&&a.addDummyInputs(),a}addDummyInputs(){this._forceDummy=!0;const e=this._roots;for(const t of Object.keys(e))e[t].addDummyInputs()}static getRootByUId(e,t){const n=e().__tabsterInstance;return n&&n.root.rootById[t]}static getTabsterContext(e,t,n){var a,i,r,o;if(void 0===n&&(n={}),!t.ownerDocument)return;const{checkRtl:s,referenceElement:c}=n,d=e.getParent;let l,f,p,m;e.drainInitQueue();let _,h,b,g,v=!1,y=c||t;const S={};for(;y&&(!l||s);){const n=u(e,y);if(s&&void 0===b){const e=y.dir;e&&(b="rtl"===e.toLowerCase())}if(!n){y=d(y);continue}const o=y.tagName;(n.uncontrolled||"IFRAME"===o||"WEBVIEW"===o)&&e.focusable.isVisible(y)&&(g=y),m||!(null===(a=n.focusable)||void 0===a?void 0:a.excludeFromMover)||p||(v=!0);const c=n.modalizer,D=n.groupper,I=n.mover;!f&&c&&(f=c),p||!D||f&&!c||(f?(!D.isActive()&&D.getProps().tabbability&&f.userId!==(null===(i=e.modalizer)||void 0===i?void 0:i.activeId)&&(f=void 0,p=D),h=D):p=D),m||!I||f&&!c||D&&y===t||!y.contains(t)||(m=I,_=!!p&&p!==D),n.root&&(l=n.root),(null===(r=n.focusable)||void 0===r?void 0:r.ignoreKeydown)&&Object.assign(S,n.focusable.ignoreKeydown),y=d(y)}if(!l){const n=e.root;n._autoRoot&&(null===(o=t.ownerDocument)||void 0===o?void 0:o.body)&&(l=n._autoRootCreate())}return p&&!m&&(_=!0),l?{root:l,modalizer:f,groupper:p,mover:m,groupperBeforeMover:_,modalizerInGroupper:h,rtl:s?!!b:void 0,uncontrolled:g,excludedFromMover:v,ignoreKeydown:e=>!!S[e.key]}:void 0}static getRoot(e,t){var n;const a=e.getParent;for(let i=t;i;i=a(i)){const t=null===(n=u(e,i))||void 0===n?void 0:n.root;if(t)return t}}onRoot(e,t){t?delete this.rootById[e.uid]:this.rootById[e.uid]=e}}class ce{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(e){const t=this._callbacks;t.indexOf(e)<0&&t.push(e)}subscribeFirst(e){const t=this._callbacks,n=t.indexOf(e);n>=0&&t.splice(n,1),t.unshift(e)}unsubscribe(e){const t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)}setVal(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))}getVal(){return this._val}trigger(e,t){this._callCallbacks(e,t)}_callCallbacks(e,t){this._callbacks.forEach(n=>n(e,t))}}class de{constructor(e){this._tabster=e}dispose(){}getProps(e){const t=u(this._tabster,e);return t&&t.focusable||{}}isFocusable(e,t,n,a){return!(!q(e,r)||!t&&-1===e.tabIndex)&&(n||this.isVisible(e))&&(a||this.isAccessible(e))}isVisible(e){if(!e.ownerDocument||e.nodeType!==Node.ELEMENT_NODE)return!1;if(function(e){var t,n;const a=e.ownerDocument,i=null===(t=a.defaultView)||void 0===t?void 0:t.getComputedStyle(e);if(null===e.offsetParent&&a.body!==e&&"fixed"!==(null==i?void 0:i.position))return!0;if("hidden"===(null==i?void 0:i.visibility))return!0;if("fixed"===(null==i?void 0:i.position)){if("none"===i.display)return!0;if(null===(null===(n=e.parentElement)||void 0===n?void 0:n.offsetParent)&&a.body!==e.parentElement)return!0}return!1}(e))return!1;const t=e.ownerDocument.body.getBoundingClientRect();return 0!==t.width||0!==t.height}isAccessible(e){var t;for(let n=e;n;n=L.getParentElement(n)){const e=u(this._tabster,n);if(this._isHidden(n))return!1;if(!(null===(t=null==e?void 0:e.focusable)||void 0===t?void 0:t.ignoreAriaDisabled)&&this._isDisabled(n))return!1}return!0}_isDisabled(e){return e.hasAttribute("disabled")}_isHidden(e){var t;const n=e.getAttribute("aria-hidden");return!(!n||"true"!==n.toLowerCase()||(null===(t=this._tabster.modalizer)||void 0===t?void 0:t.isAugmented(e)))}findFirst(e,t){return this.findElement({...e},t)}findLast(e,t){return this.findElement({isBackward:!0,...e},t)}findNext(e,t){return this.findElement({...e},t)}findPrev(e,t){return this.findElement({...e,isBackward:!0},t)}findDefault(e,t){return this.findElement({...e,acceptCondition:t=>this.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault},t)||null}findAll(e){return this._findElements(!0,e)||[]}findElement(e,t){const n=this._findElements(!1,e,t);return n?n[0]:n}_findElements(e,t,n){var a,i,r;const{container:o,currentElement:s=null,includeProgrammaticallyFocusable:c,useActiveModalizer:d,ignoreAccessibility:l,modalizerId:u,isBackward:f,onElement:p}=t;n||(n={});const m=[];let{acceptCondition:_}=t;const h=!!_;if(!o)return null;_||(_=e=>this.isFocusable(e,c,!1,l));const b={container:o,modalizerUserId:void 0===u&&d?null===(a=this._tabster.modalizer)||void 0===a?void 0:a.activeId:u||(null===(r=null===(i=se.getTabsterContext(this._tabster,o))||void 0===i?void 0:i.modalizer)||void 0===r?void 0:r.userId),from:s||o,isBackward:f,isFindAll:e,acceptCondition:_,hasCustomCondition:h,includeProgrammaticallyFocusable:c,ignoreAccessibility:l,cachedGrouppers:{},cachedRadioGroups:{}},g=N(o.ownerDocument,o,e=>this._acceptElement(e,b));if(!g)return null;const v=t=>{var a,i;const r=null!==(a=b.foundElement)&&void 0!==a?a:b.foundBackward;return r&&m.push(r),e?!(r&&(b.found=!1,delete b.foundElement,delete b.foundBackward,delete b.fromCtx,b.from=r,p&&!p(r))||!r&&!t):(r&&n&&(n.uncontrolled=null===(i=se.getTabsterContext(this._tabster,r))||void 0===i?void 0:i.uncontrolled),!(!t||r))};if(s||(n.outOfDOMOrder=!0),s&&L.nodeContains(o,s))g.currentNode=s;else if(f){const e=ee(o);if(!e)return null;if(this._acceptElement(e,b)===NodeFilter.FILTER_ACCEPT&&!v(!0))return b.skippedFocusable&&(n.outOfDOMOrder=!0),m;g.currentNode=e}do{f?g.previousNode():g.nextNode()}while(v());return b.skippedFocusable&&(n.outOfDOMOrder=!0),m.length?m:null}_acceptElement(e,t){var n,a,i;if(t.found)return NodeFilter.FILTER_ACCEPT;const r=t.foundBackward;if(r&&(e===r||!L.nodeContains(r,e)))return t.found=!0,t.foundElement=r,NodeFilter.FILTER_ACCEPT;const o=t.container;if(e===o)return NodeFilter.FILTER_SKIP;if(!L.nodeContains(o,e))return NodeFilter.FILTER_REJECT;if(ae(e))return NodeFilter.FILTER_REJECT;if(L.nodeContains(t.rejectElementsFrom,e))return NodeFilter.FILTER_REJECT;const s=t.currentCtx=se.getTabsterContext(this._tabster,e);if(!s)return NodeFilter.FILTER_SKIP;if(z(e))return this.isFocusable(e,void 0,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_SKIP;if(!t.hasCustomCondition&&("IFRAME"===e.tagName||"WEBVIEW"===e.tagName))return this.isVisible(e)&&(null===(n=s.modalizer)||void 0===n?void 0:n.userId)===(null===(a=this._tabster.modalizer)||void 0===a?void 0:a.activeId)?(t.found=!0,t.rejectElementsFrom=t.foundElement=e,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT;if(!t.ignoreAccessibility&&!this.isAccessible(e))return this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_REJECT;let c,d=t.fromCtx;d||(d=t.fromCtx=se.getTabsterContext(this._tabster,t.from));const l=null==d?void 0:d.mover;let u=s.groupper,f=s.mover;if(c=null===(i=this._tabster.modalizer)||void 0===i?void 0:i.acceptElement(e,t),void 0!==c&&(t.skippedFocusable=!0),void 0===c&&(u||f||l)){const n=null==u?void 0:u.getElement(),a=null==l?void 0:l.getElement();let i=null==f?void 0:f.getElement();if(i&&L.nodeContains(a,i)&&L.nodeContains(o,a)&&(!n||!f||L.nodeContains(a,n))&&(f=l,i=a),n)if(n!==o&&L.nodeContains(o,n)){if(!L.nodeContains(n,e))return NodeFilter.FILTER_REJECT}else u=void 0;if(i)if(L.nodeContains(o,i)){if(!L.nodeContains(i,e))return NodeFilter.FILTER_REJECT}else f=void 0;u&&f&&(i&&n&&!L.nodeContains(n,i)?f=void 0:u=void 0),u&&(c=u.acceptElement(e,t)),f&&(c=f.acceptElement(e,t))}if(void 0===c&&(c=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,c===NodeFilter.FILTER_SKIP&&this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0)),c===NodeFilter.FILTER_ACCEPT&&!t.found){if(!t.isFindAll&&ne(e)&&!e.checked){const n=e.name;let a=t.cachedRadioGroups[n];if(a||(a=function(e){if(!ne(e))return;const t=e.name;let n,a=Array.from(L.getElementsByName(e,t));return a=a.filter(e=>!!ne(e)&&(e.checked&&(n=e),!0)),{name:t,buttons:new Set(a),checked:n}}(e),a&&(t.cachedRadioGroups[n]=a)),(null==a?void 0:a.checked)&&a.checked!==e)return NodeFilter.FILTER_SKIP}t.isBackward?(t.foundBackward=e,c=NodeFilter.FILTER_SKIP):(t.found=!0,t.foundElement=e)}return c}}const le="Enter",ue="Escape",fe="Home",pe="ArrowLeft",me="ArrowUp",_e="ArrowRight",he="ArrowDown",be={2:0,3:1,1:2};class ge extends ce{constructor(e,t){super(),this._init=()=>{const e=this._win(),t=e.document;t.addEventListener(a.TsF,this._onFocusIn,!0),t.addEventListener(a.PHG,this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0);const n=L.getActiveElement(t);n&&n!==t.body&&this._setFocusedElement(n),this.subscribe(this._onChanged)},this._onFocusIn=e=>{const t=e.composedPath()[0];t&&this._setFocusedElement(t,e.detail.relatedTarget,e.detail.isFocusedProgrammatically)},this._onFocusOut=e=>{var t;this._setFocusedElement(void 0,null===(t=e.detail)||void 0===t?void 0:t.originalEvent.relatedTarget)},this._validateFocusedElement=e=>{},this._onKeyDown=e=>{if("Tab"!==e.key||e.ctrlKey)return;const t=this.getVal();if(!t||!t.ownerDocument||"true"===t.contentEditable)return;const n=this._tabster,i=n.controlTab,r=se.getTabsterContext(n,t);if(!r||r.ignoreKeydown(e))return;const o=e.shiftKey,s=ge.findNextTabbable(n,r,void 0,t,void 0,o,!0),c=r.root.getElement();if(!c)return;const d=null==s?void 0:s.element,l=function(e,t){var n;const a=e.getParent;let i=t;do{const t=null===(n=u(e,i))||void 0===n?void 0:n.uncontrolled;if(t&&e.uncontrolled.isUncontrolledCompletely(i,!!t.completely))return i;i=a(i)}while(i)}(n,t);if(d){const u=s.uncontrolled;if(r.uncontrolled||L.nodeContains(u,t)){if(!s.outOfDOMOrder&&u===r.uncontrolled||l&&!L.nodeContains(l,d))return;return void X.addPhantomDummyWithTarget(n,t,o,d)}if(u&&n.focusable.isVisible(u)||"IFRAME"===d.tagName&&n.focusable.isVisible(d))return void(c.dispatchEvent(new S({by:"root",owner:c,next:d,relatedEvent:e}))&&X.moveWithPhantomDummy(n,null!=u?u:d,!1,o,e));(i||(null==s?void 0:s.outOfDOMOrder))&&c.dispatchEvent(new S({by:"root",owner:c,next:d,relatedEvent:e}))&&(e.preventDefault(),e.stopImmediatePropagation(),(0,a.RMr)(d))}else!l&&c.dispatchEvent(new S({by:"root",owner:c,next:null,relatedEvent:e}))&&r.root.moveOutWithDefaultAction(o,e)},this._onChanged=(e,t)=>{var n,a;if(e)e.dispatchEvent(new v(t));else{const e=null===(n=this._lastVal)||void 0===n?void 0:n.get();if(e){const n={...t},i=se.getTabsterContext(this._tabster,e),r=null===(a=null==i?void 0:i.modalizer)||void 0===a?void 0:a.userId;r&&(n.modalizerId=r),e.dispatchEvent(new y(n))}}},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){super.dispose();const e=this._win(),t=e.document;t.removeEventListener(a.TsF,this._onFocusIn,!0),t.removeEventListener(a.PHG,this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged);const n=this._asyncFocus;n&&(e.clearTimeout(n.timeout),delete this._asyncFocus),delete ge._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var n,a;let i=ge._lastResetElement,r=i&&i.get();r&&L.nodeContains(t,r)&&delete ge._lastResetElement,r=null===(a=null===(n=e._nextVal)||void 0===n?void 0:n.element)||void 0===a?void 0:a.get(),r&&L.nodeContains(t,r)&&delete e._nextVal,i=e._lastVal,r=i&&i.get(),r&&L.nodeContains(t,r)&&delete e._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var e;let t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!W(t.ownerDocument,t))&&(this._lastVal=t=void 0),t}focus(e,t,n,a){return!!this._tabster.focusable.isFocusable(e,t,!1,n)&&(e.focus({preventScroll:a}),!0)}focusDefault(e){const t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)}getFirstOrLastTabbable(e,t){var n;const{container:a,ignoreAccessibility:i}=t;let r;if(a){const t=se.getTabsterContext(this._tabster,a);t&&(r=null===(n=ge.findNextTabbable(this._tabster,t,a,void 0,void 0,!e,i))||void 0===n?void 0:n.element)}return r&&!L.nodeContains(a,r)&&(r=void 0),r||void 0}_focusFirstOrLast(e,t){const n=this.getFirstOrLastTabbable(e,t);return!!n&&(this.focus(n,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}focusLast(e){return this._focusFirstOrLast(!1,e)}resetFocus(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{const t=e.getAttribute("tabindex"),n=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),ge._lastResetElement=new F(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",t),this._setOrRemoveAttribute(e,"aria-hidden",n)}return!0}requestAsyncFocus(e,t,n){const a=this._tabster.getWindow(),i=this._asyncFocus;if(i){if(be[e]>be[i.source])return;a.clearTimeout(i.timeout)}this._asyncFocus={source:e,callback:t,timeout:a.setTimeout(()=>{this._asyncFocus=void 0,t()},n)}}cancelAsyncFocus(e){const t=this._asyncFocus;(null==t?void 0:t.source)===e&&(this._tabster.getWindow().clearTimeout(t.timeout),this._asyncFocus=void 0)}_setOrRemoveAttribute(e,t,n){null===n?e.removeAttribute(t):e.setAttribute(t,n)}_setFocusedElement(e,t,n){var a,i;if(this._tabster._noop)return;const r={relatedTarget:t};if(e){const t=null===(a=ge._lastResetElement)||void 0===a?void 0:a.get();if(ge._lastResetElement=void 0,t===e||z(e))return;r.isFocusedProgrammatically=n;const o=se.getTabsterContext(this._tabster,e),s=null===(i=null==o?void 0:o.modalizer)||void 0===i?void 0:i.userId;s&&(r.modalizerId=s)}const o=this._nextVal={element:e?new F(this._win,e):void 0,detail:r};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===o&&this.setVal(e,r),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new F(this._win,e))}static findNextTabbable(e,t,n,a,i,r,o){const s=n||t.root.getElement();if(!s)return null;let c=null;const d=ge._isTabbingTimer,l=e.getWindow();d&&l.clearTimeout(d),ge.isTabbing=!0,ge._isTabbingTimer=l.setTimeout(()=>{delete ge._isTabbingTimer,ge.isTabbing=!1},0);const u=t.modalizer,f=t.groupper,p=t.mover,m=t=>{if(c=t.findNextTabbable(a,i,r,o),a&&!(null==c?void 0:c.element)){const i=t!==u&&L.getParentElement(t.getElement());if(i){const s=se.getTabsterContext(e,a,{referenceElement:i});if(s){const a=t.getElement(),d=r?a:a&&ee(a)||a;d&&(c=ge.findNextTabbable(e,s,n,d,i,r,o),c&&(c.outOfDOMOrder=!0))}}}};if(f&&p)m(t.groupperBeforeMover?f:p);else if(f)m(f);else if(p)m(p);else if(u)m(u);else{const t={container:s,currentElement:a,referenceElement:i,ignoreAccessibility:o,useActiveModalizer:!0},n={},d=e.focusable[r?"findPrev":"findNext"](t,n);c={element:d,outOfDOMOrder:n.outOfDOMOrder,uncontrolled:n.uncontrolled}}return c}}ge.isTabbing=!1;class ve extends X{constructor(e,t,n,i){super(n,e,4,i,!0),this._setHandlers((i,r,o)=>{var s,c;const d=e.get(),l=i.input;if(d&&l){const e=se.getTabsterContext(n,l);if(e){let u;u=null===(s=t.findNextTabbable(o||void 0,void 0,r,!0))||void 0===s?void 0:s.element,u||(u=null===(c=ge.findNextTabbable(n,e,void 0,i.isOutside?l:function(e,t){let n=e,a=null;for(;n&&!a;)a=t?L.getPreviousElementSibling(n):L.getNextElementSibling(n),n=L.getParentElement(n);return a||void 0}(d,!r),void 0,r,!0))||void 0===c?void 0:c.element),u&&(0,a.RMr)(u)}}})}}class ye extends Y{constructor(e,t,n,a,i){super(e,t,a),this._shouldTabInside=!1,this.makeTabbable(!1),this._onDispose=n,e.controlTab||(this.dummyManager=new ve(this._element,this,e,i))}dispose(){var e;this._onDispose(this),this._element.get(),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,delete this._first}findNextTabbable(e,t,n,a){const i=this.getElement();if(!i)return null;const r=ae(e)===i;if(!this._shouldTabInside&&e&&L.nodeContains(i,e)&&!r)return{element:void 0,outOfDOMOrder:!0};const o=this.getFirst(!0);if(!e||!L.nodeContains(i,e)||r)return{element:o,outOfDOMOrder:!0};const s=this._tabster;let c,l=null,u=!1;if(this._shouldTabInside&&o){const r={container:i,currentElement:e,referenceElement:t,ignoreAccessibility:a,useActiveModalizer:!0},o={};l=s.focusable[n?"findPrev":"findNext"](r,o),u=!!o.outOfDOMOrder,l||this._props.tabbability!==d.LimitedTrapFocus||(l=s.focusable[n?"findLast":"findFirst"]({container:i,ignoreAccessibility:a,useActiveModalizer:!0},o),u=!0),c=o.uncontrolled}return{element:l,uncontrolled:c,outOfDOMOrder:u}}makeTabbable(e){this._shouldTabInside=e||!this._props.tabbability}isActive(e){var t;const n=this.getElement()||null;let a=!0;for(let e=L.getParentElement(n);e;e=L.getParentElement(e)){const n=null===(t=u(this._tabster,e))||void 0===t?void 0:t.groupper;n&&(n._shouldTabInside||(a=!1))}let i=a?!!this._props.tabbability&&this._shouldTabInside:void 0;if(i&&e){const e=this._tabster.focusedElement.getFocusedElement();e&&(i=e!==this.getFirst(!0))}return i}getFirst(e){var t;const n=this.getElement();let a;if(n){if(e&&this._tabster.focusable.isFocusable(n))return n;a=null===(t=this._first)||void 0===t?void 0:t.get(),a||(a=this._tabster.focusable.findFirst({container:n,useActiveModalizer:!0})||void 0,a&&this.setFirst(a))}return a}setFirst(e){e?this._first=new F(this._tabster.getWindow,e):delete this._first}acceptElement(e,t){const n=t.cachedGrouppers,a=L.getParentElement(this.getElement()),i=a&&se.getTabsterContext(this._tabster,a),r=null==i?void 0:i.groupper,o=(null==i?void 0:i.groupperBeforeMover)?r:void 0;let s;const c=e=>{let t,a=n[e.id];return a?t=a.isActive:(t=this.isActive(!0),a=n[e.id]={isActive:t}),t};if(o&&(s=o.getElement(),!c(o)&&s&&t.container!==s&&L.nodeContains(t.container,s)))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;const d=c(this),l=this.getElement();if(l&&!0!==d){if(l===e&&r&&(s||(s=r.getElement()),s&&!c(r)&&L.nodeContains(t.container,s)&&s!==t.container))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;if(l!==e&&L.nodeContains(l,e))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;const a=n[this.id];let i;if(i="first"in a?a.first:a.first=this.getFirst(!0),i&&t.acceptCondition(i))return t.rejectElementsFrom=l,t.skippedFocusable=!0,i!==t.from?(t.found=!0,t.foundElement=i,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT}}}class Se{constructor(e,t){this._current={},this._grouppers={},this._init=()=>{const e=this._win();this._tabster.focusedElement.subscribeFirst(this._onFocus);const t=e.document,n=L.getActiveElement(t);n&&this._onFocus(n),t.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(_,this._onMoveFocus)},this._onGroupperDispose=e=>{delete this._grouppers[e.id]},this._onFocus=e=>{e&&this._updateCurrent(e)},this._onMouseDown=e=>{let t=e.target;for(;t&&!this._tabster.focusable.isFocusable(t);)t=this._tabster.getParent(t);t&&this._updateCurrent(t)},this._onKeyDown=e=>{if(e.key!==le&&e.key!==ue)return;if(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const t=this._tabster.focusedElement.getFocusedElement();t&&this.handleKeyPress(t,e)},this._onMoveFocus=e=>{var t;const n=e.composedPath()[0],a=null===(t=e.detail)||void 0===t?void 0:t.action;n&&void 0!==a&&!e.defaultPrevented&&(a===l.Enter?this._enterGroupper(n):this._escapeGroupper(n),e.stopImmediatePropagation())},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){const e=this._win();this._tabster.focusedElement.cancelAsyncFocus(1),this._current={},this._updateTimer&&(e.clearTimeout(this._updateTimer),delete this._updateTimer),this._tabster.focusedElement.unsubscribe(this._onFocus),e.document.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),e.removeEventListener(_,this._onMoveFocus),Object.keys(this._grouppers).forEach(e=>{this._grouppers[e]&&(this._grouppers[e].dispose(),delete this._grouppers[e])})}createGroupper(e,t,n){const a=this._tabster,i=new ye(a,e,this._onGroupperDispose,t,n);this._grouppers[i.id]=i;const r=a.focusedElement.getFocusedElement();return r&&L.nodeContains(e,r)&&!this._updateTimer&&(this._updateTimer=this._win().setTimeout(()=>{delete this._updateTimer,r===a.focusedElement.getFocusedElement()&&this._updateCurrent(r)},0)),i}forgetCurrentGrouppers(){this._current={}}_updateCurrent(e){var t;this._updateTimer&&(this._win().clearTimeout(this._updateTimer),delete this._updateTimer);const n=this._tabster,a={};for(let i=n.getParent(e);i;i=n.getParent(i)){const r=null===(t=u(n,i))||void 0===t?void 0:t.groupper;if(r){a[r.id]=!0,this._current[r.id]=r;const t=r.isActive()||e!==i&&(!r.getProps().delegated||r.getFirst(!1)!==e);r.makeTabbable(t)}}for(const e of Object.keys(this._current)){const t=this._current[e];t.id in a||(t.makeTabbable(!1),t.setFirst(void 0),delete this._current[e])}}_enterGroupper(e,t){const n=this._tabster,a=se.getTabsterContext(n,e),i=(null==a?void 0:a.groupper)||(null==a?void 0:a.modalizerInGroupper),r=null==i?void 0:i.getElement();if(i&&r&&(e===r||i.getProps().delegated&&e===i.getFirst(!1))){const a=n.focusable.findNext({container:r,currentElement:e,useActiveModalizer:!0});if(a&&(!t||t&&r.dispatchEvent(new S({by:"groupper",owner:r,next:a,relatedEvent:t}))))return t&&(t.preventDefault(),t.stopImmediatePropagation()),a.focus(),a}return null}_escapeGroupper(e,t,n){const a=this._tabster,i=se.getTabsterContext(a,e);let r=(null==i?void 0:i.groupper)||(null==i?void 0:i.modalizerInGroupper);const o=null==r?void 0:r.getElement();if(r&&o&&L.nodeContains(o,e)){let i;if(e!==o||n)i=r.getFirst(!0);else{const e=L.getParentElement(o),t=e?se.getTabsterContext(a,e):void 0;r=null==t?void 0:t.groupper,i=null==r?void 0:r.getFirst(!0)}if(i&&(!t||t&&o.dispatchEvent(new S({by:"groupper",owner:o,next:i,relatedEvent:t}))))return r&&r.makeTabbable(!1),i.focus(),i}return null}moveFocus(e,t){return t===l.Enter?this._enterGroupper(e):this._escapeGroupper(e)}handleKeyPress(e,t,n){const a=this._tabster,i=se.getTabsterContext(a,e);if(i&&((null==i?void 0:i.groupper)||(null==i?void 0:i.modalizerInGroupper))){if(a.focusedElement.cancelAsyncFocus(1),i.ignoreKeydown(t))return;if(t.key===le)this._enterGroupper(e,t);else if(t.key===ue){const i=a.focusedElement.getFocusedElement();a.focusedElement.requestAsyncFocus(1,()=>{(i===a.focusedElement.getFocusedElement()||(!n||i)&&n)&&this._escapeGroupper(e,t,n)},0)}}}}class De extends ce{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,a.jUr)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,a.SMr)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(e){var t;null===(t=this._keyborg)||void 0===t||t.setVal(e)}isNavigatingWithKeyboard(){var e;return!!(null===(e=this._keyborg)||void 0===e?void 0:e.isNavigatingWithKeyboard())}}let Ie=0;const xe="aria-hidden";class Ce extends X{constructor(e,t,n){super(t,e,2,n),this._setHandlers((n,i)=>{var r,o;const s=e.get(),c=s&&(null===(r=se.getRoot(t,s))||void 0===r?void 0:r.getElement()),d=n.input;let l;if(c&&d){const e=ae(d),n=se.getTabsterContext(t,e||d);n&&(l=null===(o=ge.findNextTabbable(t,n,c,d,void 0,i,!0))||void 0===o?void 0:o.element),l&&(0,a.RMr)(l)}})}}class Oe extends Y{constructor(e,t,n,a,i,r){super(e,t,a),this._wasFocused=0,this.userId=a.id,this._onDispose=n,this._activeElements=r,e.controlTab||(this.dummyManager=new Ce(this._element,e,i))}makeActive(e){if(this._isActive!==e){this._isActive=e;const t=this.getElement();if(t){const n=this._activeElements,a=n.map(e=>e.get()).indexOf(t);e?a<0&&n.push(new F(this._tabster.getWindow,t)):a>=0&&n.splice(a,1)}this._dispatchEvent(e)}}focused(e){return e||(this._wasFocused=++Ie),this._wasFocused}setProps(e){e.id&&(this.userId=e.id),this._props={...e}}dispose(){var e;this.makeActive(!1),this._onDispose(this),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,this._activeElements=[],this._remove()}isActive(){return!!this._isActive}contains(e){return L.nodeContains(this.getElement(),e)}findNextTabbable(e,t,n,a){var i,r;if(!this.getElement())return null;const o=this._tabster;let s,c=null,d=!1;const l=e&&(null===(i=se.getRoot(o,e))||void 0===i?void 0:i.getElement());if(l){const i={container:l,currentElement:e,referenceElement:t,ignoreAccessibility:a,useActiveModalizer:!0},u={};c=o.focusable[n?"findPrev":"findNext"](i,u),!c&&this._props.isTrapped&&(null===(r=o.modalizer)||void 0===r?void 0:r.activeId)?(c=o.focusable[n?"findLast":"findFirst"]({container:l,ignoreAccessibility:a,useActiveModalizer:!0},u),null===c&&(c=e),d=!0):d=!!u.outOfDOMOrder,s=u.uncontrolled}return{element:c,uncontrolled:s,outOfDOMOrder:d}}_dispatchEvent(e,t){const n=this.getElement();let a=!1;if(n){const i=t?this._activeElements.map(e=>e.get()):[n];for(const t of i)if(t){const i={id:this.userId,element:n},r=e?new C(i):new O(i);t.dispatchEvent(r),r.defaultPrevented&&(a=!0)}}return a}_remove(){}}class we{constructor(e,t,n){this._onModalizerDispose=e=>{const t=e.id,n=e.userId,a=this._parts[n];if(delete this._modalizers[t],a&&(delete a[t],0===Object.keys(a).length)){delete this._parts[n];const e=this._activationHistory,t=[];let a;for(let i=e.length;i--;){const r=e[i];r!==n&&r!==a&&(a=r,(r||t.length>0)&&t.unshift(r))}if(this._activationHistory=t,this.activeId===n){const e=t[0],n=e?Object.values(this._parts[e])[0]:void 0;this.setActive(n)}}},this._onKeyDown=e=>{var t;if(e.key!==ue)return;const n=this._tabster,a=n.focusedElement.getFocusedElement();if(a){const i=se.getTabsterContext(n,a),r=null==i?void 0:i.modalizer;if(i&&!i.groupper&&(null==r?void 0:r.isActive())&&!i.ignoreKeydown(e)){const a=r.userId;if(a){const i=this._parts[a];if(i){const a=Object.keys(i).map(e=>{var t;const a=i[e],r=a.getElement();let o;return r&&(o=null===(t=u(n,r))||void 0===t?void 0:t.groupper),a&&r&&o?{el:r,focusedSince:a.focused(!0)}:{focusedSince:0}}).filter(e=>e.focusedSince>0).sort((e,t)=>e.focusedSince>t.focusedSince?-1:e.focusedSince<t.focusedSince?1:0);if(a.length){const i=a[0].el;i&&(null===(t=n.groupper)||void 0===t||t.handleKeyPress(i,e,!0))}}}}}},this._onFocus=(e,t)=>{var n;const a=this._tabster,i=e&&se.getTabsterContext(a,e);if(!i||!e)return;const r=this._augMap;for(let t=e;t;t=L.getParentElement(t))r.has(t)&&(r.delete(t),te(a,t,xe));let o=i.modalizer;const s=u(a,e),c=null==s?void 0:s.modalizer;if(c&&(c.focused(),c.userId===this.activeId&&s.groupper)){const t=a.getParent(e),i=t&&(null===(n=se.getTabsterContext(a,t))||void 0===n?void 0:n.modalizer);if(!i)return void this.setActive(void 0);o=i}if(null==o||o.focused(),(null==o?void 0:o.userId)!==this.activeId)if(t.isFocusedProgrammatically||this.currentIsOthersAccessible||(null==o?void 0:o.getProps().isAlwaysAccessible))this.setActive(o);else{const t=this._win();t.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=t.setTimeout(()=>this._restoreModalizerFocus(e),100)}else this.currentIsOthersAccessible=null==o?void 0:o.getProps().isOthersAccessible},this._tabster=e,this._win=e.getWindow,this._modalizers={},this._parts={},this._augMap=new WeakMap,this._aug=[],this._alwaysAccessibleSelector=t,this._accessibleCheck=n,this._activationHistory=[],this.activeElements=[],e.controlTab||e.root.addDummyInputs(),this._win().addEventListener("keydown",this._onKeyDown,!0),e.queueInit(()=>{this._tabster.focusedElement.subscribe(this._onFocus)})}dispose(){const e=this._win();e.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._modalizers).forEach(e=>{this._modalizers[e]&&(this._modalizers[e].dispose(),delete this._modalizers[e])}),e.clearTimeout(this._restoreModalizerFocusTimer),e.clearTimeout(this._hiddenUpdateTimer),this._parts={},delete this.activeId,this.activeElements=[],this._augMap=new WeakMap,this._aug=[],this._tabster.focusedElement.unsubscribe(this._onFocus)}createModalizer(e,t,n){var a;const i=new Oe(this._tabster,e,this._onModalizerDispose,t,n,this.activeElements),r=i.id,o=t.id;this._modalizers[r]=i;let s=this._parts[o];s||(s=this._parts[o]={}),s[r]=i;const c=null!==(a=this._tabster.focusedElement.getFocusedElement())&&void 0!==a?a:null;return e!==c&&L.nodeContains(e,c)&&(o!==this.activeId?this.setActive(i):i.makeActive(!0)),i}isAugmented(e){return this._augMap.has(e)}hiddenUpdate(){this._hiddenUpdateTimer||(this._hiddenUpdateTimer=this._win().setTimeout(()=>{delete this._hiddenUpdateTimer,this._hiddenUpdate()},250))}setActive(e){const t=null==e?void 0:e.userId,n=this.activeId;if(n===t)return;if(this.activeId=t,n){const e=this._parts[n];if(e)for(const t of Object.keys(e))e[t].makeActive(!1)}if(t){const e=this._parts[t];if(e)for(const t of Object.keys(e))e[t].makeActive(!0)}this.currentIsOthersAccessible=null==e?void 0:e.getProps().isOthersAccessible,this.hiddenUpdate();const a=this._activationHistory;a[0]!==t&&(void 0!==t||a.length>0)&&a.unshift(t)}focus(e,t,n){const a=this._tabster,i=se.getTabsterContext(a,e),r=null==i?void 0:i.modalizer;if(r){this.setActive(r);const e=r.getProps(),i=r.getElement();if(i){if(void 0===t&&(t=e.isNoFocusFirst),!t&&a.keyboardNavigation.isNavigatingWithKeyboard()&&a.focusedElement.focusFirst({container:i}))return!0;if(void 0===n&&(n=e.isNoFocusDefault),!n&&a.focusedElement.focusDefault(i))return!0;a.focusedElement.resetFocus(i)}}return!1}activate(e){var t;const n=e?null===(t=se.getTabsterContext(this._tabster,e))||void 0===t?void 0:t.modalizer:void 0;return!(e&&!n||(this.setActive(n),0))}acceptElement(e,t){var n;const a=t.modalizerUserId,i=null===(n=t.currentCtx)||void 0===n?void 0:n.modalizer;if(a)for(const t of this.activeElements){const n=t.get();if(n&&(L.nodeContains(e,n)||n===e))return NodeFilter.FILTER_SKIP}const r=a===(null==i?void 0:i.userId)||!a&&(null==i?void 0:i.getProps().isAlwaysAccessible)?void 0:NodeFilter.FILTER_SKIP;return void 0!==r&&(t.skippedFocusable=!0),r}_hiddenUpdate(){var e;const t=this._tabster,n=t.getWindow().document.body,a=this.activeId,i=this._parts,r=[],o=[],s=this._alwaysAccessibleSelector,c=s?Array.from(L.querySelectorAll(n,s)):[],d=[];for(const e of Object.keys(i)){const t=i[e];for(const n of Object.keys(t)){const i=t[n],s=i.getElement(),l=i.getProps().isAlwaysAccessible;s&&(e===a?(d.push(s),this.currentIsOthersAccessible||r.push(s)):l?c.push(s):o.push(s))}}const l=this._augMap,u=r.length>0?[...r,...c]:void 0,f=[],p=new WeakMap,m=(e,n)=>{var a;const i=e.tagName;if("SCRIPT"===i||"STYLE"===i)return;let r=!1;l.has(e)?n?r=!0:(l.delete(e),te(t,e,xe)):n&&!(null===(a=this._accessibleCheck)||void 0===a?void 0:a.call(this,e,d))&&te(t,e,xe,"true")&&(l.set(e,!0),r=!0),r&&(f.push(new F(t.getWindow,e)),p.set(e,!0))},_=e=>{var n;for(let a=L.getFirstElementChild(e);a;a=L.getNextElementSibling(a)){let e=!1,i=!1,r=!1;if(u){const o=t.getParent(a);for(const t of u){if(a===t){e=!0;break}if(L.nodeContains(a,t)){i=!0;break}L.nodeContains(t,o)&&(r=!0)}i||(null===(n=a.__tabsterElementFlags)||void 0===n?void 0:n.noDirectAriaHidden)?_(a):e||r||m(a,!0)}else m(a,!1)}};u||c.forEach(e=>m(e,!1)),o.forEach(e=>m(e,!0)),n&&_(n),null===(e=this._aug)||void 0===e||e.map(e=>e.get()).forEach(e=>{e&&!p.get(e)&&m(e,!1)}),this._aug=f,this._augMap=p}_restoreModalizerFocus(e){var t;const n=null==e?void 0:e.ownerDocument;if(!e||!n)return;const a=this._tabster.focusedElement.getFocusedElement(),i=a&&(null===(t=se.getTabsterContext(this._tabster,a))||void 0===t?void 0:t.modalizer);if(!a||a&&(null==i?void 0:i.userId)===this.activeId)return;const r=this._tabster,o=se.getTabsterContext(r,e),s=null==o?void 0:o.modalizer,c=this.activeId;if(!s&&!c||s&&c===s.userId)return;const d=null==o?void 0:o.root.getElement();if(d){let t=r.focusable.findFirst({container:d,useActiveModalizer:!0});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&(t=r.focusable.findLast({container:d,useActiveModalizer:!0}),!t))throw new Error("Something went wrong.");return void r.focusedElement.focus(t)}}e.blur()}}const Ee=["input","textarea","*[contenteditable]"].join(", ");class Ae extends X{constructor(e,t,n,i){super(t,e,3,i),this._onFocusDummyInput=e=>{var t,n;const i=this._element.get(),r=e.input;if(i&&r){const o=se.getTabsterContext(this._tabster,i);let s;o&&(s=null===(t=ge.findNextTabbable(this._tabster,o,void 0,r,void 0,!e.isFirst,!0))||void 0===t?void 0:t.element);const c=null===(n=this._getMemorized())||void 0===n?void 0:n.get();c&&this._tabster.focusable.isFocusable(c)&&(s=c),s&&(0,a.RMr)(s)}},this._tabster=t,this._getMemorized=n,this._setHandlers(this._onFocusDummyInput)}}class Le extends Y{constructor(e,t,n,a,i){var r;super(e,t,a),this._visible={},this._onIntersection=e=>{for(const t of e){const e=t.target,n=G(this._win,e);let a,i=this._fullyVisible;if(t.intersectionRatio>=.25?(a=t.intersectionRatio>=.75?2:1,2===a&&(i=n)):a=0,this._visible[n]!==a){void 0===a?(delete this._visible[n],i===n&&delete this._fullyVisible):(this._visible[n]=a,this._fullyVisible=i);const t=this.getState(e);t&&e.dispatchEvent(new D(t))}}},this._win=e.getWindow,this.visibilityTolerance=null!==(r=a.visibilityTolerance)&&void 0!==r?r:.8,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=n,e.controlTab||(this.dummyManager=new Ae(this._element,e,()=>a.memorizeCurrent?this._current:void 0,i))}dispose(){var e;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);const t=this._win();this._setCurrentTimer&&(t.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(t.clearTimeout(this._updateTimer),delete this._updateTimer),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager}setCurrent(e){this._current=e?new F(this._win,e):void 0,!this._props.trackState&&!this._props.visibilityAware||this._setCurrentTimer||(this._setCurrentTimer=this._win().setTimeout(()=>{var e;delete this._setCurrentTimer;const t=[];this._current!==this._prevCurrent&&(t.push(this._current),t.push(this._prevCurrent),this._prevCurrent=this._current);for(const n of t){const t=null==n?void 0:n.get();if(t&&(null===(e=this._allElements)||void 0===e?void 0:e.get(t))===this){const e=this._props;if(t&&(void 0!==e.visibilityAware||e.trackState)){const e=this.getState(t);e&&t.dispatchEvent(new D(e))}}}}))}getCurrent(){var e;return(null===(e=this._current)||void 0===e?void 0:e.get())||null}findNextTabbable(e,t,n,a){const i=this.getElement(),r=i&&ae(e)===i;if(!i)return null;let o,s=null,c=!1;if(this._props.tabbable||r||e&&!L.nodeContains(i,e)){const r={currentElement:e,referenceElement:t,container:i,ignoreAccessibility:a,useActiveModalizer:!0},d={};s=this._tabster.focusable[n?"findPrev":"findNext"](r,d),c=!!d.outOfDOMOrder,o=d.uncontrolled}return{element:s,uncontrolled:o,outOfDOMOrder:c}}acceptElement(e,t){var n,a;if(!ge.isTabbing)return(null===(n=t.currentCtx)||void 0===n?void 0:n.excludedFromMover)?NodeFilter.FILTER_REJECT:void 0;const{memorizeCurrent:i,visibilityAware:r,hasDefault:o=!0}=this._props,s=this.getElement();if(s&&(i||r||o)&&(!L.nodeContains(s,t.from)||ae(t.from)===s)){let e;if(i){const n=null===(a=this._current)||void 0===a?void 0:a.get();n&&t.acceptCondition(n)&&(e=n)}if(!e&&o&&(e=this._tabster.focusable.findDefault({container:s,useActiveModalizer:!0})),!e&&r&&(e=this._tabster.focusable.findElement({container:s,useActiveModalizer:!0,isBackward:t.isBackward,acceptCondition:e=>{var n;const a=G(this._win,e),i=this._visible[a];return s!==e&&!!(null===(n=this._allElements)||void 0===n?void 0:n.get(e))&&t.acceptCondition(e)&&(2===i||1===i&&(1===r||!this._fullyVisible))}})),e)return t.found=!0,t.foundElement=e,t.rejectElementsFrom=s,t.skippedFocusable=!0,NodeFilter.FILTER_ACCEPT}}_observeState(){const e=this.getElement();if(this._unobserve||!e||"undefined"==typeof MutationObserver)return;const t=this._win(),n=this._allElements=new WeakMap,a=this._tabster.focusable;let i=this._updateQueue=[];const r=L.createMutationObserver(e=>{for(const t of e){const e=t.target,n=t.removedNodes,a=t.addedNodes;if("attributes"===t.type)"tabindex"===t.attributeName&&i.push({element:e,type:2});else{for(let e=0;e<n.length;e++)i.push({element:n[e],type:3});for(let e=0;e<a.length;e++)i.push({element:a[e],type:1})}}l()}),o=(e,t)=>{var a,i;const r=n.get(e);r&&t&&(null===(a=this._intersectionObserver)||void 0===a||a.unobserve(e),n.delete(e)),r||t||(n.set(e,this),null===(i=this._intersectionObserver)||void 0===i||i.observe(e))},s=e=>{const t=a.isFocusable(e);n.get(e)?t||o(e,!0):t&&o(e)},c=e=>{const{mover:n}=f(e);if(n&&n!==this){if(n.getElement()!==e||!a.isFocusable(e))return;o(e)}const i=N(t.document,e,e=>{const{mover:t,groupper:n}=f(e);if(t&&t!==this)return NodeFilter.FILTER_REJECT;const i=null==n?void 0:n.getFirst(!0);return n&&n.getElement()!==e&&i&&i!==e?NodeFilter.FILTER_REJECT:(a.isFocusable(e)&&o(e),NodeFilter.FILTER_SKIP)});if(i)for(i.currentNode=e;i.nextNode(););},d=e=>{n.get(e)&&o(e,!0);for(let t=L.getFirstElementChild(e);t;t=L.getNextElementSibling(t))d(t)},l=()=>{!this._updateTimer&&i.length&&(this._updateTimer=t.setTimeout(()=>{delete this._updateTimer;for(const{element:e,type:t}of i)switch(t){case 2:s(e);break;case 1:c(e);break;case 3:d(e)}i=this._updateQueue=[]},0))},f=e=>{const t={};for(let n=e;n;n=L.getParentElement(n)){const e=u(this._tabster,n);if(e&&(e.groupper&&!t.groupper&&(t.groupper=e.groupper),e.mover)){t.mover=e.mover;break}}return t};i.push({element:e,type:1}),l(),r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{r.disconnect()}}getState(e){const t=G(this._win,e);if(t in this._visible){const n=this._visible[t]||0;return{isCurrent:this._current?this._current.get()===e:void 0,visibility:n}}}}class ke{constructor(e,t){this._init=()=>{const e=this._win();e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(p,this._onMoveFocus),e.addEventListener(m,this._onMemorizedElement),this._tabster.focusedElement.subscribe(this._onFocus)},this._onMoverDispose=e=>{delete this._movers[e.id]},this._onFocus=e=>{var t;let n=e,a=e;for(let i=L.getParentElement(e);i;i=L.getParentElement(i)){const e=null===(t=u(this._tabster,i))||void 0===t?void 0:t.mover;e&&(e.setCurrent(a),n=void 0),!n&&this._tabster.focusable.isFocusable(i)&&(n=a=i)}},this._onKeyDown=async e=>{var t;if(this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1),e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const n=e.key;let a;if(n===he?a=c.ArrowDown:n===_e?a=c.ArrowRight:n===me?a=c.ArrowUp:n===pe?a=c.ArrowLeft:"PageDown"===n?a=c.PageDown:"PageUp"===n?a=c.PageUp:n===fe?a=c.Home:"End"===n&&(a=c.End),!a)return;const i=this._tabster.focusedElement.getFocusedElement();i&&!await this._isIgnoredInput(i,n)&&this._moveFocus(i,a,e)},this._onMoveFocus=e=>{var t;const n=e.composedPath()[0],a=null===(t=e.detail)||void 0===t?void 0:t.key;n&&void 0!==a&&!e.defaultPrevented&&(this._moveFocus(n,a),e.stopImmediatePropagation())},this._onMemorizedElement=e=>{var t;const n=e.composedPath()[0];let a=null===(t=e.detail)||void 0===t?void 0:t.memorizedElement;if(n){const t=se.getTabsterContext(this._tabster,n),i=null==t?void 0:t.mover;i&&(a&&!L.nodeContains(i.getElement(),a)&&(a=void 0),i.setCurrent(a),e.stopImmediatePropagation())}},this._tabster=e,this._win=t,this._movers={},e.queueInit(this._init)}dispose(){var e;const t=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),null===(e=this._ignoredInputResolve)||void 0===e||e.call(this,!1),this._ignoredInputTimer&&(t.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener(p,this._onMoveFocus),t.removeEventListener(m,this._onMemorizedElement),Object.keys(this._movers).forEach(e=>{this._movers[e]&&(this._movers[e].dispose(),delete this._movers[e])})}createMover(e,t,n){const a=new Le(this._tabster,e,this._onMoverDispose,t,n);return this._movers[a.id]=a,a}moveFocus(e,t){return this._moveFocus(e,t)}_moveFocus(e,t,n){var i,r;const o=this._tabster,d=se.getTabsterContext(o,e,{checkRtl:!0});if(!d||!d.mover||d.excludedFromMover||n&&d.ignoreKeydown(n))return null;const l=d.mover,f=l.getElement();if(d.groupperBeforeMover){const e=d.groupper;if(!e||e.isActive(!0))return null;for(let t=L.getParentElement(e.getElement());t&&t!==f;t=L.getParentElement(t))if(null===(r=null===(i=u(o,t))||void 0===i?void 0:i.groupper)||void 0===r?void 0:r.isActive(!0))return null}if(!f)return null;const p=o.focusable,m=l.getProps(),_=m.direction||s.Both,h=_===s.Both,b=h||_===s.Vertical,g=h||_===s.Horizontal,v=_===s.GridLinear,y=v||_===s.Grid,D=m.cyclic;let I,x,C,O=0,w=0;if(y&&(C=e.getBoundingClientRect(),O=Math.ceil(C.left),w=Math.floor(C.right)),d.rtl&&(t===c.ArrowRight?t=c.ArrowLeft:t===c.ArrowLeft&&(t=c.ArrowRight)),t===c.ArrowDown&&b||t===c.ArrowRight&&(g||y))if(I=p.findNext({currentElement:e,container:f,useActiveModalizer:!0}),I&&y){const e=Math.ceil(I.getBoundingClientRect().left);!v&&w>e&&(I=void 0)}else!I&&D&&(I=p.findFirst({container:f,useActiveModalizer:!0}));else if(t===c.ArrowUp&&b||t===c.ArrowLeft&&(g||y))if(I=p.findPrev({currentElement:e,container:f,useActiveModalizer:!0}),I&&y){const e=Math.floor(I.getBoundingClientRect().right);!v&&e>O&&(I=void 0)}else!I&&D&&(I=p.findLast({container:f,useActiveModalizer:!0}));else if(t===c.Home)y?p.findElement({container:f,currentElement:e,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{var n;if(!p.isFocusable(t))return!1;const a=Math.ceil(null!==(n=t.getBoundingClientRect().left)&&void 0!==n?n:0);return t!==e&&O<=a||(I=t,!1)}}):I=p.findFirst({container:f,useActiveModalizer:!0});else if(t===c.End)y?p.findElement({container:f,currentElement:e,useActiveModalizer:!0,acceptCondition:t=>{var n;if(!p.isFocusable(t))return!1;const a=Math.ceil(null!==(n=t.getBoundingClientRect().left)&&void 0!==n?n:0);return t!==e&&O>=a||(I=t,!1)}}):I=p.findLast({container:f,useActiveModalizer:!0});else if(t===c.PageUp){if(p.findElement({currentElement:e,container:f,useActiveModalizer:!0,isBackward:!0,acceptCondition:e=>!(!p.isFocusable(e)||j(this._win,e,l.visibilityTolerance)&&(I=e,1))}),y&&I){const e=Math.ceil(I.getBoundingClientRect().left);p.findElement({currentElement:I,container:f,useActiveModalizer:!0,acceptCondition:t=>{if(!p.isFocusable(t))return!1;const n=Math.ceil(t.getBoundingClientRect().left);return O<n||e>=n||(I=t,!1)}})}x=!1}else if(t===c.PageDown){if(p.findElement({currentElement:e,container:f,useActiveModalizer:!0,acceptCondition:e=>!(!p.isFocusable(e)||j(this._win,e,l.visibilityTolerance)&&(I=e,1))}),y&&I){const e=Math.ceil(I.getBoundingClientRect().left);p.findElement({currentElement:I,container:f,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{if(!p.isFocusable(t))return!1;const n=Math.ceil(t.getBoundingClientRect().left);return O>n||e<=n||(I=t,!1)}})}x=!0}else if(y){const n=t===c.ArrowUp,a=O,i=Math.ceil(C.top),r=w,o=Math.floor(C.bottom);let s,d,l=0;p.findAll({container:f,currentElement:e,isBackward:n,onElement:e=>{const t=e.getBoundingClientRect(),c=Math.ceil(t.left),u=Math.ceil(t.top),f=Math.floor(t.right),p=Math.floor(t.bottom);if(n&&i<p||!n&&o>u)return!0;const m=Math.ceil(Math.min(r,f))-Math.floor(Math.max(a,c)),_=Math.ceil(Math.min(r-a,f-c));if(m>0&&_>=m){const t=m/_;t>l&&(s=e,l=t)}else if(0===l){const t=function(e,t,n,a,i,r,o,s){const c=n<i?i-n:o<e?e-o:0,d=a<r?r-a:s<t?t-s:0;return 0===c?d:0===d?c:Math.sqrt(c*c+d*d)}(a,i,r,o,c,u,f,p);(void 0===d||t<d)&&(d=t,s=e)}else if(l>0)return!1;return!0}}),I=s}return I&&(!n||n&&f.dispatchEvent(new S({by:"mover",owner:f,next:I,relatedEvent:n})))?(void 0!==x&&function(e,t,n){const a=V(t);if(a){const i=B(e,a),r=t.getBoundingClientRect();a.scrollTop+=n?r.top-i.top:r.bottom-i.bottom}}(this._win,I,x),n&&(n.preventDefault(),n.stopImmediatePropagation()),(0,a.RMr)(I),I):null}async _isIgnoredInput(e,t){if("true"===e.getAttribute("aria-expanded")&&e.hasAttribute("aria-activedescendant"))return!0;if(q(e,Ee)){let n,a=0,i=0,r=0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){const n=e.type,o=e.value;if(r=(o||"").length,"email"===n||"number"===n){if(r){const n=L.getSelection(e);if(n){const e=n.toString().length,a=t===pe||t===me;if(n.modify("extend",a?"backward":"forward","character"),e!==n.toString().length)return n.modify("extend",a?"forward":"backward","character"),!0;r=0}}}else{const t=e.selectionStart;if(null===t)return"hidden"===n;a=t||0,i=e.selectionEnd||0}}else"true"===e.contentEditable&&(n=new(function(e){const t=T(e);if(t.basics.Promise)return t.basics.Promise;throw new Error("No Promise defined.")}(this._win))(t=>{this._ignoredInputResolve=e=>{delete this._ignoredInputResolve,t(e)};const n=this._win();this._ignoredInputTimer&&n.clearTimeout(this._ignoredInputTimer);const{anchorNode:o,focusNode:s,anchorOffset:c,focusOffset:d}=L.getSelection(e)||{};this._ignoredInputTimer=n.setTimeout(()=>{var t,n,l;delete this._ignoredInputTimer;const{anchorNode:u,focusNode:f,anchorOffset:p,focusOffset:m}=L.getSelection(e)||{};if(u===o&&f===s&&p===c&&m===d){if(a=p||0,i=m||0,r=(null===(n=e.textContent)||void 0===n?void 0:n.length)||0,u&&f&&L.nodeContains(e,u)&&L.nodeContains(e,f)&&u!==e){let t=!1;const n=e=>{if(e===u)t=!0;else if(e===f)return!0;const r=e.textContent;if(r&&!L.getFirstChild(e)){const e=r.length;t?f!==u&&(i+=e):(a+=e,i+=e)}let o=!1;for(let t=L.getFirstChild(e);t&&!o;t=t.nextSibling)o=n(t);return o};n(e)}null===(l=this._ignoredInputResolve)||void 0===l||l.call(this,!0)}else null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1)},0)}));if(n&&!await n)return!0;if(a!==i)return!0;if(a>0&&(t===pe||t===me||t===fe))return!0;if(a<r&&(t===_e||t===he||"End"===t))return!0}return!1}}class Me{constructor(e){this._isUncontrolledCompletely=e}isUncontrolledCompletely(e,t){var n;const a=null===(n=this._isUncontrolledCompletely)||void 0===n?void 0:n.call(this,e,t);return void 0===a?t:a}}class Pe extends Y{constructor(e,t,n){var a;if(super(e,t,n),this._hasFocus=!1,this._onFocusOut=e=>{var t;const n=null===(t=this._element)||void 0===t?void 0:t.get();n&&null===e.relatedTarget&&n.dispatchEvent(new w),n&&!L.nodeContains(n,e.relatedTarget)&&(this._hasFocus=!1)},this._onFocusIn=()=>{this._hasFocus=!0},this._props.type===o.Source){const e=null===(a=this._element)||void 0===a?void 0:a.get();null==e||e.addEventListener("focusout",this._onFocusOut),null==e||e.addEventListener("focusin",this._onFocusIn),this._hasFocus=L.nodeContains(e,e&&L.getActiveElement(e.ownerDocument))}}dispose(){var e;if(this._props.type===o.Source){const t=null===(e=this._element)||void 0===e?void 0:e.get();null==t||t.removeEventListener("focusout",this._onFocusOut),null==t||t.removeEventListener("focusin",this._onFocusIn),this._hasFocus&&this._tabster.getWindow().document.body.dispatchEvent(new w)}}}class Te{constructor(e){this._stack=[],this._getWindow=e}push(e){var t;(null===(t=this._stack[this._stack.length-1])||void 0===t?void 0:t.get())!==e&&(this._stack.length>Te.DEPTH&&this._stack.shift(),this._stack.push(new F(this._getWindow,e)))}pop(e){var t;void 0===e&&(e=()=>!0);const n=this._getWindow().document;for(let a=this._stack.length-1;a>=0;a--){const a=null===(t=this._stack.pop())||void 0===t?void 0:t.get();if(a&&L.nodeContains(n.body,L.getParentElement(a))&&e(a))return a}}}Te.DEPTH=10;class Ue{constructor(e){this._onRestoreFocus=e=>{var t,n;this._focusedElementState.cancelAsyncFocus(2);const a=e.composedPath()[0];if(a){const e=null===(n=null===(t=u(this._tabster,a))||void 0===t?void 0:t.restorer)||void 0===n?void 0:n.getProps().id;this._focusedElementState.requestAsyncFocus(2,()=>this._restoreFocus(a,e),0)}},this._onFocusIn=e=>{var t;if(!e)return;const n=u(this._tabster,e);(null===(t=null==n?void 0:n.restorer)||void 0===t?void 0:t.getProps().type)===o.Target&&this._history.push(e)},this._restoreFocus=(e,t)=>{var n;const a=this._getWindow().document;if(L.getActiveElement(a)!==a.body)return;if(!this._keyboardNavState.isNavigatingWithKeyboard()&&L.nodeContains(a.body,e))return;const i=e=>{var t,n;const a=null===(n=null===(t=u(this._tabster,e))||void 0===t?void 0:t.restorer)||void 0===n?void 0:n.getProps();return a?a.id:null};null===(n=this._history.pop(e=>t===i(e)))||void 0===n||n.focus()},this._tabster=e,this._getWindow=e.getWindow,this._getWindow().addEventListener(h,this._onRestoreFocus),this._history=new Te(this._getWindow),this._keyboardNavState=e.keyboardNavigation,this._focusedElementState=e.focusedElement,this._focusedElementState.subscribe(this._onFocusIn)}dispose(){const e=this._getWindow();this._focusedElementState.unsubscribe(this._onFocusIn),this._focusedElementState.cancelAsyncFocus(2),e.removeEventListener(h,this._onRestoreFocus)}createRestorer(e,t){const n=new Pe(this._tabster,e,t);return t.type===o.Target&&L.getActiveElement(e.ownerDocument)===e&&this._history.push(e),n}}class Fe{static _overrideAttachShadow(e){const t=e.Element.prototype.attachShadow;t.__origAttachShadow||(Element.prototype.attachShadow=function(e){const n=t.call(this,e);for(const e of Fe._shadowObservers)e._addSubObserver(n);return n},Element.prototype.attachShadow.__origAttachShadow=t)}constructor(e){this._isObserving=!1,this._callbackWrapper=(e,t)=>{for(const t of e)if("childList"===t.type){const e=t.removedNodes,n=t.addedNodes;for(let t=0;t<e.length;t++)this._walkShadows(e[t],!0);for(let e=0;e<n.length;e++)this._walkShadows(n[e])}this._callback(e,t)},this._callback=e,this._observer=new MutationObserver(this._callbackWrapper),this._subObservers=new Map}_addSubObserver(e){if(this._options&&this._callback&&!this._subObservers.has(e)&&this._options.subtree&&function(e,t){var n,a;if(!e||!t)return!1;let i=t;for(;i;){if(i===e)return!0;i="function"!=typeof i.assignedElements&&(null===(n=i.assignedSlot)||void 0===n?void 0:n.parentNode)?null===(a=i.assignedSlot)||void 0===a?void 0:a.parentNode:i.nodeType===document.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode}return!1}(this._root,e)){const t=new MutationObserver(this._callbackWrapper);this._subObservers.set(e,t),this._isObserving&&t.observe(e,this._options),this._walkShadows(e)}}disconnect(){this._isObserving=!1,delete this._options,Fe._shadowObservers.delete(this);for(const e of this._subObservers.values())e.disconnect();this._subObservers.clear(),this._observer.disconnect()}observe(e,t){const n=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument,a=null==n?void 0:n.defaultView;n&&a&&(Fe._overrideAttachShadow(a),Fe._shadowObservers.add(this),this._root=e,this._options=t,this._isObserving=!0,this._observer.observe(e,t),this._walkShadows(e))}_walkShadows(e,t){const n=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument;if(n){if(e===n)e=n.body;else{const t=e.shadowRoot;if(t)return void this._addSubObserver(t)}n.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{if(e.nodeType===Node.ELEMENT_NODE)if(t){const t=this._subObservers.get(e);t&&(t.disconnect(),this._subObservers.delete(e))}else{const t=e.shadowRoot;t&&this._addSubObserver(t)}return NodeFilter.FILTER_SKIP}}).nextNode()}}takeRecords(){const e=this._observer.takeRecords();for(const t of this._subObservers.values())e.push(...t.takeRecords());return e}}Fe._shadowObservers=new Set;class He{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}}class Re{constructor(e,t){var n,a;this._forgetMemorizedElements=[],this._wrappers=new Set,this._initQueue=[],this._version="8.5.5",this._noop=!1,this.getWindow=()=>{if(!this._win)throw new Error("Using disposed Tabster.");return this._win},this._storage=function(e){const t=e.__tabsterInstanceContext;return new((null==t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;const r=this.getWindow;(null==t?void 0:t.DOMAPI)&&function(e){for(const t of Object.keys(e))L[t]=e[t]}({...t.DOMAPI}),this.keyboardNavigation=new De(r),this.focusedElement=new ge(this,r),this.focusable=new de(this),this.root=new se(this,null==t?void 0:t.autoRoot),this.uncontrolled=new Me((null==t?void 0:t.checkUncontrolledCompletely)||(null==t?void 0:t.checkUncontrolledTrappingFocus)),this.controlTab=null===(n=null==t?void 0:t.controlTab)||void 0===n||n,this.rootDummyInputs=!!(null==t?void 0:t.rootDummyInputs),this._dummyObserver=new Z(r),this.getParent=null!==(a=null==t?void 0:t.getParent)&&void 0!==a?a:L.getParentNode,this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){const t=r().document;this._unobserve=function(e,t,n,a){if("undefined"==typeof MutationObserver)return()=>{};const r=t.getWindow;let o;function s(t,n){o||(o=T(r).elementByUId),c(t,n);const a=N(e,t,e=>c(e,n));if(a)for(;a.nextNode(););}function c(e,a){var s;if(!e.getAttribute)return NodeFilter.FILTER_SKIP;const c=e.__tabsterElementUID;return c&&o&&(a?delete o[c]:null!==(s=o[c])&&void 0!==s||(o[c]=new F(r,e))),(u(t,e)||e.hasAttribute(i))&&n(t,e,a),NodeFilter.FILTER_SKIP}const d=L.createMutationObserver(e=>{var a,r,o,c,d;const l=new Set;for(const d of e){const e=d.target,u=d.removedNodes,f=d.addedNodes;if("attributes"===d.type)d.attributeName===i&&(l.has(e)||n(t,e));else{for(let n=0;n<u.length;n++){const i=u[n];l.add(i),s(i,!0),null===(r=(a=t._dummyObserver).domChanged)||void 0===r||r.call(a,e)}for(let n=0;n<f.length;n++)s(f[n]),null===(c=(o=t._dummyObserver).domChanged)||void 0===c||c.call(o,e)}}l.clear(),null===(d=t.modalizer)||void 0===d||d.hiddenUpdate()});return a&&s(r().document.body),d.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[i]}),()=>{d.disconnect()}}(t,this,f,e)}}},R(r),this.queueInit(()=>{this.internal.resumeObserver(!0)})}_mergeProps(e){var t;e&&(this.getParent=null!==(t=e.getParent)&&void 0!==t?t:this.getParent)}createTabster(e,t){const n=new He(this);return e||this._wrappers.add(n),this._mergeProps(t),n}disposeTabster(e,t){t?this._wrappers.clear():this._wrappers.delete(e),0===this._wrappers.size&&this.dispose()}dispose(){var e,t,n,a,i,r,o,s;this.internal.stopObserver();const c=this._win;null==c||c.clearTimeout(this._initTimer),delete this._initTimer,this._initQueue=[],this._forgetMemorizedElements=[],c&&this._forgetMemorizedTimer&&(c.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null===(e=this.outline)||void 0===e||e.dispose(),null===(t=this.crossOrigin)||void 0===t||t.dispose(),null===(n=this.deloser)||void 0===n||n.dispose(),null===(a=this.groupper)||void 0===a||a.dispose(),null===(i=this.mover)||void 0===i||i.dispose(),null===(r=this.modalizer)||void 0===r||r.dispose(),null===(o=this.observedElement)||void 0===o||o.dispose(),null===(s=this.restorer)||void 0===s||s.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose(),function(e){const t=T(e);t.fakeWeakRefsStarted=!1,t.fakeWeakRefsTimer&&(e().clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefsTimer=void 0,t.fakeWeakRefs=[])}(this.getWindow),K(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),c&&(function(e){const t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext)}(c),delete c.__tabsterInstance,delete this._win)}storageEntry(e,t){const n=this._storage;let a=n.get(e);return a?!1===t&&0===Object.keys(a).length&&n.delete(e):!0===t&&(a={},n.set(e,a)),a}forceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout(()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())K(this.getWindow,e),ge.forgetMemorized(this.focusedElement,e)},0),H(this.getWindow,!0)))}queueInit(e){var t;this._win&&(this._initQueue.push(e),this._initTimer||(this._initTimer=null===(t=this._win)||void 0===t?void 0:t.setTimeout(()=>{delete this._initTimer,this.drainInitQueue()},0)))}drainInitQueue(){if(!this._win)return;const e=this._initQueue;this._initQueue=[],e.forEach(e=>e())}}function Ne(e,t){let n=function(e){return e.__tabsterInstance}(e);return n?n.createTabster(!1,t):(n=new Re(e,t),e.__tabsterInstance=n,n.createTabster())}function Be(e){const t=e.core;return t.groupper||(t.groupper=new Se(t,t.getWindow)),t.groupper}function je(e){const t=e.core;return t.mover||(t.mover=new ke(t,t.getWindow)),t.mover}function Ve(e,t,n){const a=e.core;return a.modalizer||(a.modalizer=new we(a,t,n)),a.modalizer}function ze(e){const t=e.core;return t.restorer||(t.restorer=new Ue(t)),t.restorer}function Ge(e,t){e.core.disposeTabster(e,t)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l,c:()=>f,d:()=>u,e:()=>c});var a=n("tslib_145"),i=n("react-lib"),r=n(200),o=n(37),s=n(71),c=function(e){var t=i.useRef();return i.useEffect(function(){t.current=e}),t.current};function d(e){var t=i.useRef(e);t.current=e;var n=i.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.current;return a.apply(null,e)})}var l=function(e,t){var n=i.useRef(!1);i.useEffect(function(){if(t){var a=function(){n.current=!0},i=function(){n.current?n.current=!1:t()};return e.on(s.e.ResponsiveResize,a),e.on(s.e.ScaleChanged,i),e.on(s.e.RotationChanged,t),function(){e.off(s.e.ResponsiveResize,a),e.off(s.e.ScaleChanged,i),e.off(s.e.RotationChanged,t)}}},[e,t])},u=function(e){var t=(0,a.pM)(i.useState(!1),2),n=t[0],r=t[1];return i.useEffect(function(){var t=function(){r(!0)},n=function(){r(!1)};return e.on(s.e.ZoomStart,t),e.on(s.e.ZoomEnd,n),function(){e.off(s.e.ZoomStart,t),e.off(s.e.ZoomEnd,n)}},[e]),n},f=function(e){var t,n=(0,r.b)().enablePreRender,c=function(e){var t=(0,a.pM)(i.useState(!1),2),n=t[0],r=t[1];return i.useEffect(function(){var t=function(){r(!0)},n=function(){r(!1)};return e.on(s.e.Pinching,t),e.on(s.e.ZoomEnd,n),function(){e.off(s.e.Pinching,t),e.off(s.e.ZoomEnd,n)}},[e]),n}(e);return(null===(t=o.a.features)||void 0===t?void 0:t.enableOptimizedPinch)&&n&&c}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_145"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t)=>{"use strict";var n,a,i,r;if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var d=null,l=null,u=function(){if(null!==d)try{var e=t.unstable_now();d(!0,e),d=null}catch(e){throw setTimeout(u,0),e}};n=function(e){null!==d?setTimeout(n,0,e):(d=e,setTimeout(u,0))},a=function(e,t){l=setTimeout(e,t)},i=function(){clearTimeout(l)},t.unstable_shouldYield=function(){return!1},r=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var m=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var _=!1,h=null,b=-1,g=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},r=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):g=0<e?Math.floor(1e3/e):5};var y=new MessageChannel,S=y.port2;y.port1.onmessage=function(){if(null!==h){var e=t.unstable_now();v=e+g;try{h(!0,e)?S.postMessage(null):(_=!1,h=null)}catch(e){throw S.postMessage(null),e}}else _=!1},n=function(e){h=e,_||(_=!0,S.postMessage(null))},a=function(e,n){b=f(function(){e(t.unstable_now())},n)},i=function(){p(b),b=-1}}function D(e,t){var n=e.length;e.push(t);e:for(;;){var a=n-1>>>1,i=e[a];if(!(void 0!==i&&0<C(i,t)))break e;e[a]=t,e[n]=i,n=a}}function I(e){return void 0===(e=e[0])?null:e}function x(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,i=e.length;a<i;){var r=2*(a+1)-1,o=e[r],s=r+1,c=e[s];if(void 0!==o&&0>C(o,n))void 0!==c&&0>C(c,o)?(e[a]=c,e[s]=n,a=s):(e[a]=o,e[r]=n,a=r);else{if(!(void 0!==c&&0>C(c,n)))break e;e[a]=c,e[s]=n,a=s}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var O=[],w=[],E=1,A=null,L=3,k=!1,M=!1,P=!1;function T(e){for(var t=I(w);null!==t;){if(null===t.callback)x(w);else{if(!(t.startTime<=e))break;x(w),t.sortIndex=t.expirationTime,D(O,t)}t=I(w)}}function U(e){if(P=!1,T(e),!M)if(null!==I(O))M=!0,n(F);else{var t=I(w);null!==t&&a(U,t.startTime-e)}}function F(e,n){M=!1,P&&(P=!1,i()),k=!0;var r=L;try{for(T(n),A=I(O);null!==A&&(!(A.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=A.callback;if("function"==typeof o){A.callback=null,L=A.priorityLevel;var s=o(A.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?A.callback=s:A===I(O)&&x(O),T(n)}else x(O);A=I(O)}if(null!==A)var c=!0;else{var d=I(w);null!==d&&a(U,d.startTime-n),c=!1}return c}finally{A=null,L=r,k=!1}}var H=r;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){M||k||(M=!0,n(F))},t.unstable_getCurrentPriorityLevel=function(){return L},t.unstable_getFirstCallbackNode=function(){return I(O)},t.unstable_next=function(e){switch(L){case 1:case 2:case 3:var t=3;break;default:t=L}var n=L;L=t;try{return e()}finally{L=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=H,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=L;L=e;try{return t()}finally{L=n}},t.unstable_scheduleCallback=function(e,r,o){var s=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:E++,callback:r,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>s?(e.sortIndex=o,D(w,e),null===I(O)&&e===I(w)&&(P?i():P=!0,a(U,o-s))):(e.sortIndex=c,D(O,e),M||k||(M=!0,n(F))),e},t.unstable_wrapCallback=function(e){var t=L;return function(){var n=L;L=t;try{return e.apply(this,arguments)}finally{L=n}}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>c,c:()=>s});var a=n("tslib_145"),i=n("react-lib"),r=i.createContext(void 0),o=i.createContext(function(){}),s=function(){return i.useContext(r)},c=function(){var e=i.useContext(o);return{updateSaveFreeText:i.useCallback(function(t){e(function(e){return(0,a.q5)((0,a.q5)({},e),{saveFreeText:t})})},[e]),updateEnableAutoSizerHeightGrowing:i.useCallback(function(t){e(function(e){return(0,a.q5)((0,a.q5)({},e),{enableAutoSizerHeightGrowing:t})})},[e])}},d=function(e){var t=e.children,n=e.enableFreeText,s=e.freeTextHandler,c=e.freeTextContainer,d=e.setInitialFontAttributes,l=(0,a.pM)(i.useState({saveFreeText:function(){},enableAutoSizerHeightGrowing:function(){}}),2),u=l[0],f=l[1],p=(0,a.q5)((0,a.q5)({},u),{enableFreeText:n,freeTextHandler:s,freeTextContainer:c,setInitialFontAttributes:d});return i.createElement(o.Provider,{value:f},i.createElement(r.Provider,{value:p},t))}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f,b:()=>a,c:()=>l,d:()=>u});var a,i=n("tslib_145"),r=n("react-lib");!function(e){e.Hidden="hidden",e.Running="running",e.Success="success",e.Error="error",e.Info="info"}(a||(a={}));var o=function(e,t){switch(t.type){case a.Hidden:return{type:t.type,text:"",link:"",linkText:"",percentComplete:0};case a.Success:return{type:t.type,text:t.text,link:t.link,linkText:t.linkText,disableAutoHide:t.disableAutoHide,percentComplete:1,onClickButton:t.onClickClose};case a.Error:return{type:t.type,text:t.text,link:"",linkText:"",percentComplete:0,onClickButton:t.onClickClose};case a.Info:return{type:t.type,text:t.text,infoIconName:t.infoIconName,shouldAutoFocus:t.shouldAutoFocus,onClickButton:t.onClickClose};default:case a.Running:return{type:t.type,text:t.text,link:"",linkText:"",percentComplete:t.percentComplete,onClickButton:t.onClickExpand}}},s={type:a.Hidden,text:"",link:"",linkText:"",percentComplete:0,onClickButton:function(){}},c=r.createContext(s),d=r.createContext(function(){}),l=function(){return r.useContext(c)},u=function(){return r.useContext(d)},f=function(e){var t=e.children,n=(0,i.pM)(r.useReducer(o,s),2),a=n[0],l=n[1];return r.createElement(c.Provider,{value:a},r.createElement(d.Provider,{value:l},t))}}
,(e,t,n)=>{var a=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,l=c||d||Function("return this")(),u=Object.prototype.toString,f=Math.max,p=Math.min,m=function(){return l.Date.now()};function _(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function h(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(_(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=_(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=r.test(e);return n||o.test(e)?s(e.slice(2),n?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var a,i,r,o,s,c,d=0,l=!1,u=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var n=a,r=i;return a=i=void 0,d=t,o=e.apply(r,n)}function v(e){return d=e,s=setTimeout(S,t),l?g(e):o}function y(e){var n=e-c;return void 0===c||n>=t||n<0||u&&e-d>=r}function S(){var e=m();if(y(e))return D(e);s=setTimeout(S,function(e){var n=t-(e-c);return u?p(n,r-(e-d)):n}(e))}function D(e){return s=void 0,b&&a?g(e):(a=i=void 0,o)}function I(){var e=m(),n=y(e);if(a=arguments,i=this,c=e,n){if(void 0===s)return v(c);if(u)return s=setTimeout(S,t),g(c)}return void 0===s&&(s=setTimeout(S,t)),o}return t=h(t)||0,_(n)&&(l=!!n.leading,r=(u="maxWait"in n)?f(h(n.maxWait)||0,t):r,b="trailing"in n?!!n.trailing:b),I.cancel=function(){void 0!==s&&clearTimeout(s),d=0,a=c=i=s=void 0},I.flush=function(){return void 0===s?o:D(m())},I}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>l});var a=n(104),i=n(20),r=n(0),o=n("odsp.util_385"),s=n(1);const c="UserLicensedForCopilot",d="UserNotLicensedForCopilot",l=new o.OJ({name:"isUserCopilotLicensed",factory:{dependencies:{pageContext:s.a.optional},create:({pageContext:e})=>{let t=!1;const n=(0,a.a)();return window.sessionStorage.getItem("_isRunningTABTest")?(n.availability.isLicenseCheckBypassed=!0,t=!0):(t=!!e?.canUserUseSPCopilot,new r.a({name:t?c:d}).end({resultType:r.b.Success}),i.a.logData({name:t?c:d})),n.availability.isLicensed=t,n.availability.siteSubscriptionId=e?.siteSubscriptionId,{instance:()=>t}}}})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>l,c:()=>d,d:()=>u,e:()=>f});var a=n("tslib_145"),i=n(64),r=n(83),o=n(57),s="Fetch",c=3;function d(e,t,n){return(0,a.yv)(this,void 0,void 0,function(){var r,s,c,d,l,u,f,p,m,_;return(0,a.SO)(this,function(a){switch(a.label){case 0:r=0,s="inferredExtension=".concat(function(e){var t;return null===(t=e.split(/[#?]/)[0].split(".").pop())||void 0===t?void 0:t.trim()}(e)),a.label=1;case 1:return a.trys.push([1,7,,8]),[4,fetch(e,t)];case 2:if(c=a.sent(),r=1,d=c.ok,l=c.status,u=c.statusText,f=c.headers,r=2,!d)throw new i.a(l,u,n,"Unexpected HTTP status ".concat(l," from fetch, ").concat(s," stage: ").concat(r),f);r=3,a.label=3;case 3:return a.trys.push([3,5,,6]),[4,c.arrayBuffer()];case 4:if(p=a.sent(),r=4,0===p.byteLength)throw new i.a(void 0,"EmptyFile",n,"Empty response from fetch ".concat(s," stage: ").concat(r),f,!0);return r=5,[2,p];case 5:throw(m=a.sent()).name===o.a||"NetworkError"===m.name?m:new i.a(void 0,"FailToReadResponse",n,"Failed to read response from fetch, ".concat(s," stage: ").concat(r," ").concat(m.name," ").concat(m.message),f);case 6:return[3,8];case 7:throw(_=a.sent()).name===o.a||"NetworkError"===_.name?_:new i.a(void 0,_.name,n,"".concat(_.message,", ").concat(s," stage: ").concat(r));case 8:return[2]}})})}function l(e,t,n,d,l){return(0,a.yv)(this,void 0,void 0,function(){function u(o){return(0,a.yv)(this,void 0,void 0,function(){var c,d,u,p,m,h,b;return(0,a.SO)(this,function(g){switch(g.label){case 0:return o?(c=(t||{}).headers,d=void 0===c?{}:c,u=(0,a.q5)((0,a.q5)({},t),{headers:(0,a.q5)((0,a.q5)({},d),{Range:"bytes=".concat(o.start,"-").concat(o.end-1)})}),[4,fetch(e,u)]):[2];case 1:if((p=g.sent()).ok)return[3,2];throw m=new i.a(p.status,p.statusText,l,"Fetch request by range failed. fileSize: ".concat(n)),r.a.error(s,m),m;case 2:return[4,p.arrayBuffer()];case 3:h=g.sent(),_+=h.byteLength,b=new Uint8Array(h),f.set(b,o.start),g.label=4;case 4:return[2]}})})}var f,p,m,_,h,b,g,v;return(0,a.SO)(this,function(e){switch(e.label){case 0:for(f=new Uint8Array(n),p=[],m=Math.ceil(n/c),_=0,h=0,b=m;p.length<c;)p.push({start:h,end:b}),h=b,b=Math.min(b+m,n);e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(p.map(u))];case 2:if(e.sent(),r.a.verbose(s,"Download by range completed"),_!==n)throw g=new i.c(i.b.RangeDownloadSizeMismatch,"Download by range failed. Incorrect size. fileSize: ".concat(n,", downloaded length: ").concat(_)),r.a.error(s,g),g;return[2,f.buffer];case 3:throw v=e.sent(),r.a.error(s,new i.c(i.b.FileDownloadFailed,"Download by range failed. e: ".concat(v,", fileSize: ").concat(n))),v.name!==o.a&&d(),v;case 4:return[2]}})})}function u(e,t,n,i,r,o,s){return(0,a.yv)(this,void 0,void 0,function(){var c,l,u;return(0,a.SO)(this,function(a){switch(a.label){case 0:return c=i.signal,u={credentials:"same-origin",signal:c},[4,f(t,n,o,s)];case 1:return u.headers=a.sent(),[4,d(e,u,r)];case 2:return l=a.sent(),[2,new Uint8Array(l)]}})})}function f(e,t,n,i){return(0,a.yv)(this,void 0,void 0,function(){var r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return r={},void 0!==e&&void 0!==t&&(r.Range="bytes=".concat(e,"-").concat(t)),i?[4,i()]:[3,2];case 1:a.sent().forEach(function(e){r[e.name]=e.value}),a.label=2;case 2:return n&&(r.Authorization=n),[2,r]}})})}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n(141),i=n(21);function r(e){let t=e[i.b.queryTypeParamKey];return t||(t=e[i.b.parentQueryTypeParamKey]),t?Number(t):a.a.Files}const o=r}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("itemComment")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)({name:"dataRequestNoRedirect.key.dataRequestNoRedirect",factory:{dependencies:{},create:()=>({instance:void 0})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a=n("tslib_145"),i=n(180),r=n("react-lib"),o=n(37),s=n(333),c=n(469),d=n(229),l="dynamic-print-style",u=r.forwardRef(function(e,t){var n,u,f=e.filename,p=e.url,m=e.enablePrint,_=void 0===m||m,h=e.onDocumentLoaded,b=e.onFirstRenderVisible,g=r.useRef(null),v=r.useRef(void 0),y=(0,a.pM)(r.useState(!0),2),S=y[0],D=y[1],I=(0,a.pM)(r.useState(!0),2),x=I[0],C=I[1],O=(0,a.pM)(r.useState(!0),2),w=O[0],E=O[1],A=r.useRef(!1);r.useImperativeHandle(t,function(){return{getFilename:function(){return void 0===f?(0,s.a)(p):f},getViewer:function(){return g.current}}},[f,p]),r.useEffect(function(){i.a.mark("Start")},[]),r.useEffect(function(){var e=document.getElementById(l);if(w&&_)e&&document.head.removeChild(e);else if(!e){var t=document.createElement("style");t.id=l,t.innerHTML="\n            @media print {\n              * {\n                display: none !important;\n              }\n            }\n          ",document.head.appendChild(t)}},[w,_]);var L=r.useCallback(function(e){D(e.isFormFieldAllowed),C(e.isAnnotAllowed),E(e.isPrintAllowed),null==h||h(e)},[h]),k=r.useCallback(function(){A.current||(i.a.mark("FirstRenderCompleted"),null==b||b(),A.current=!0)},[b]);return r.createElement(c.a,{isAnnotationEnabled:!!e.enableEdit&&x,isFormFillingEnabled:!!e.enableEdit&&!!(null===(n=o.a.features)||void 0===n?void 0:n.enableFormFilling)&&S,isFreeTextEnabled:!!e.enableEdit&&!!(null===(u=o.a.features)||void 0===u?void 0:u.enableFreeText)&&x},r.createElement(d.a,(0,a.q5)({key:p,componentRef:g},e,{defaultPageNumber:v.current||e.defaultPageNumber,defaultScale:e.defaultScale,onDocumentLoaded:L,onFirstRenderVisible:k})))})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>i,c:()=>a}),(0,n("fui.util_939").ZW)([{rawString:".page_363c865a{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);background-color:rgba(0,0,0,0)}.pageText_363c865a{position:absolute;width:100%;height:100%}.formOverlay_363c865a{position:absolute;width:100%;height:100%}"}]);const a="page_363c865a",i="pageText_363c865a",r="formOverlay_363c865a"}
,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>a}),function(e){e.Reset="Reset",e.Add="Add",e.Delete="Delete",e.Unknown="Unknown"}(a||(a={}))}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s,c:()=>d,d:()=>c,e:()=>r,f:()=>u,g:()=>f,h:()=>l,i:()=>i,j:()=>m});var a=n("odsp.util_385");const i="copilot1",r="copilot2",o="copilot3",s="copilot5",c="copilot7",d="copilot8",l="copilot9",u="copilot10",f="copilot11",p=!a.Ov.isActivated("5ee2b528-6fb0-4d67-9f0f-3abdeb6b9b6f");function m(e){return e===i||e===r||e===o||"copilot4"===e||p&&(e===s||"copilot6"===e||e===c||e===d||e===l||e===u||e===f||"copilot12"===e||"copilot13"===e)}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>l});var a=n(110),i=n("odsp.util_385"),r=n(1),o=n(35);const s={ODB:-1434},c={pageContext:r.a};let d=function(e){const{pageContext:t}=e,n=!(0,a.a)(t)&&!(0,o.a)(s);return d=()=>n,n};const l=new i.OJ({name:"isFavoritesEnabled",factory:{dependencies:c,create:e=>({instance:()=>d(e)})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"alwaysUseTokenFetcherForVroom",factory:new a.Rn(!1)})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n(13),i=n(6);const r=n("odsp.util_385").Ov.isActivated("4F1CD7E0-DB72-441F-B805-84BDF8650728");function o(e,t){const{appPageContext:n}=t;return!(!r&&!new i.a(e).authority)&&new a.b({context:n}).getUrlParts({path:e}).geoRelation!==a.a.unknown}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>kt});var a,i,r,o,s=n("tslib_145"),c=(n(866),n(181)),d=n(12),l=n(334),u=n(302),f=n(82),p=n(239),m=n.n(p),_=n(335),h=n(64);(o=a||(a={})).MipFileSizeExceeded="MipFileSizeExceeded",o.MipWasmLoadFailed="MipWasmLoadFailed",o.MipFetchTokenFailed="MipFetchTokenFailed",o.MipInitializationFailed="MipInitializationFailed",o.MipDecryptionFailed="MipDecryptionFailed",o.MipFetchTokenNotSupported="MipFetchTokenNotSupported",o.MipFetchTokenUnknownError="MipFetchTokenUnknownError",o.MipUnknownError="MipUnknownError",o.MipBadInputError="MipBadInputError",o.MipInsufficientBufferError="MipInsufficientBufferError",o.MipFileIOError="MipFileIOError",o.MipNetworkError="MipNetworkError",o.MipInternalError="MipInternalError",o.MipJustificationRequired="MipJustificationRequired",o.MipNotSupportedOperation="MipNotSupportedOperation",o.MipPrivilegedRequired="MipPrivilegedRequired",o.MipAccessDenied="MipAccessDenied",o.MipConsentDenied="MipConsentDenied",o.MipNoPermissions="MipNoPermissions",o.MipNoAuthToken="MipNoAuthToken",o.MipDisabledService="MipDisabledService",o.MipProxyAuthError="MipProxyAuthError",o.MipNoPolicy="MipNoPolicy",o.MipOperationCancelled="MipOperationCancelled",o.MipAdhocProtectionRequired="MipAdhocProtectionRequired",o.MipDeprecatedApi="MipDeprecatedApi",o.MipTemplateNotFound="MipTemplateNotFound",o.MipLabelNotFound="MipLabelNotFound",o.MipLabelDisabled="MipLabelDisabled",o.MipDoubleKeyDisabled="MipDoubleKeyDisabled",o.MipLicenseNotRegistered="MipLicenseNotRegistered",o.MipContentFormatNotSupported="MipContentFormatNotSupported",o.MipTemplateArchived="MipTemplateArchived",o.MipCustomerKeyUnavailable="MipCustomerKeyUnavailable",o.MipDelegateResponse="MipDelegateResponse",o.MipCount="MipCount",(r=i||(i={})).Trace="Trace",r.Info="Info",r.Warning="Warning",r.Error="Error",r.UnKnown="UnKnown";var b=n(336),g=n(128),v=n(83),y=n(180),S=n(84),D=n(63),I=n(576),x=n(864);const C=Symbol("Comlink.proxy"),O=Symbol("Comlink.endpoint"),w=Symbol("Comlink.releaseProxy"),E=Symbol("Comlink.thrown"),A=e=>"object"==typeof e&&null!==e||"function"==typeof e,L=new Map([["proxy",{canHandle:e=>A(e)&&e[C],serialize(e){const{port1:t,port2:n}=new MessageChannel;return k(e,t),[n,[n]]},deserialize:e=>(e.start(),P(e))}],["throw",{canHandle:e=>A(e)&&E in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function k(e,t=self){t.addEventListener("message",function n(a){if(!a||!a.data)return;const{id:i,type:r,path:o}=Object.assign({path:[]},a.data),s=(a.data.argumentList||[]).map(N);let c;try{const t=o.slice(0,-1).reduce((e,t)=>e[t],e),n=o.reduce((e,t)=>e[t],e);switch(r){case"GET":c=n;break;case"SET":t[o.slice(-1)[0]]=N(a.data.value),c=!0;break;case"APPLY":c=n.apply(t,s);break;case"CONSTRUCT":c=function(e){return Object.assign(e,{[C]:!0})}(new n(...s));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;k(e,n),c=function(e,t){return H.set(e,t),e}(t,[t])}break;case"RELEASE":c=void 0;break;default:return}}catch(e){c={value:e,[E]:0}}Promise.resolve(c).catch(e=>({value:e,[E]:0})).then(e=>{const[a,o]=R(e);t.postMessage(Object.assign(Object.assign({},a),{id:i}),o),"RELEASE"===r&&(t.removeEventListener("message",n),M(t))})}),t.start&&t.start()}function M(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function P(e,t){return U(e,[],t)}function T(e){if(e)throw new Error("Proxy has been released and is not useable")}function U(e,t=[],n=function(){}){let a=!1;const i=new Proxy(n,{get(n,r){if(T(a),r===w)return()=>B(e,{type:"RELEASE",path:t.map(e=>e.toString())}).then(()=>{M(e),a=!0});if("then"===r){if(0===t.length)return{then:()=>i};const n=B(e,{type:"GET",path:t.map(e=>e.toString())}).then(N);return n.then.bind(n)}return U(e,[...t,r])},set(n,i,r){T(a);const[o,s]=R(r);return B(e,{type:"SET",path:[...t,i].map(e=>e.toString()),value:o},s).then(N)},apply(n,i,r){T(a);const o=t[t.length-1];if(o===O)return B(e,{type:"ENDPOINT"}).then(N);if("bind"===o)return U(e,t.slice(0,-1));const[s,c]=F(r);return B(e,{type:"APPLY",path:t.map(e=>e.toString()),argumentList:s},c).then(N)},construct(n,i){T(a);const[r,o]=F(i);return B(e,{type:"CONSTRUCT",path:t.map(e=>e.toString()),argumentList:r},o).then(N)}});return i}function F(e){const t=e.map(R);return[t.map(e=>e[0]),(n=t.map(e=>e[1]),Array.prototype.concat.apply([],n))];var n}const H=new WeakMap;function R(e){for(const[t,n]of L)if(n.canHandle(e)){const[a,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:a},i]}return[{type:"RAW",value:e},H.get(e)||[]]}function N(e){switch(e.type){case"HANDLER":return L.get(e.name).deserialize(e.value);case"RAW":return e.value}}function B(e,t,n){return new Promise(a=>{const i=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),a(n.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)})}var j,V=n("react-lib"),z=n(57),G=n(71),K=function(e,t){void 0===t&&(t=1);var n=e.map(function(e){return e.height*t}),a=e.map(function(e){return e.width*t}),i=e.length;return{width:Math.max.apply(Math,(0,s.lt)([],(0,s.pM)(n),!1))+(z.j+z.k)*t,height:(z.h+(i-1)*z.i+z.g)*t+a.reduce(function(e,t){return e+t},0)}},W=function(){function e(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=!0),void 0===s&&(s=!0),void 0===c&&(c=!0),void 0===d&&(d=!0),void 0===l&&(l=!0),void 0===u&&(u=!0),void 0===f&&(f=!0),this._isMipDecrypted=!1,this._isFileEncrypted=!1,this._isAnnotAllowed=!0,this._isFormFieldAllowed=!0,this._isCopyAllowed=!0,this._isEditAllowed=!0,this._isPrintAllowed=!0,this._isCopyAccessibleAllowed=!0,this._isSignAllowed=!0,this._scale=1,this._rotation=G.f.Degree0,this._originalLayoutSize=e,this._layoutSize=e,this._pageCount=t,this._originalPageSizes=n,this._pageSizes=n,v.a.verbose("PdfMetadata","Page count ".concat(t,", layout size (").concat(e.width,", ").concat(e.height,")")),this._mip=!!a,this._isMipDecrypted=i,this._isFileEncrypted=r,this._isSigned=p,this._isAnnotAllowed=o,this._isFormFieldAllowed=s,this._isCopyAllowed=c,this._isEditAllowed=d,this._isPrintAllowed=l,this._isCopyAccessibleAllowed=u,this._isSignAllowed=f,this._hasOutline=m,this._isOutlineDefaultOff=!this._hasOutline}return e.prototype.updateOriginalLayoutForProgressiveLoading=function(e,t){var n=this,a=this.inverted?t.map(function(e){var t=e.width;return{width:e.height,height:t}}):t,i=e.width!==this.originalLayoutSize.width||e.height!==this.originalLayoutSize.height||a.length!==this.originalPageSizes.length||a.some(function(e,t){var a=e.width,i=e.height;return a!==n._originalPageSizes[t].width||i!==n._originalPageSizes[t].height});return i&&(this._originalPageSizes=a,this._originalLayoutSize=this.inverted?K(this.originalPageSizes):e,this._originalLayoutSize=this.inverted?K(t):e,this.updateSizes()),i},e.prototype.addRotation=function(e){this._rotation=(this._rotation+e)%(G.f.Degree270+1),this.updateSizes()},Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e,this.updateSizes()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return this._pageCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalLayoutSize",{get:function(){return this._originalLayoutSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layoutSize",{get:function(){return this._layoutSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalPageSizes",{get:function(){return this._originalPageSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageSizes",{get:function(){return this._pageSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inverted",{get:function(){return this.rotation===G.f.Degree90||this.rotation===G.f.Degree270},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mip",{get:function(){return this._mip},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMipDecrypted",{get:function(){return this._isMipDecrypted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFileEncrypted",{get:function(){return this._isFileEncrypted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSigned",{get:function(){return this._isSigned},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasOutline",{get:function(){return this._hasOutline},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAnnotAllowed",{get:function(){return this._isAnnotAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFormFieldAllowed",{get:function(){return this._isFormFieldAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCopyAllowed",{get:function(){return this._isCopyAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEditAllowed",{get:function(){return this._isEditAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPrintAllowed",{get:function(){return this._isPrintAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCopyAccessibleAllowed",{get:function(){return this._isCopyAccessibleAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSignAllowed",{get:function(){return this._isSignAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOutlineDefaultOff",{get:function(){return this._isOutlineDefaultOff},set:function(e){this._isOutlineDefaultOff=e},enumerable:!1,configurable:!0}),e.prototype.getDocPermissions=function(){return[{type:"Annot",isAllowed:this.isAnnotAllowed},{type:"Copy",isAllowed:this.isCopyAllowed},{type:"CopyAccessible",isAllowed:this.isCopyAccessibleAllowed},{type:"Edit",isAllowed:this.isEditAllowed},{type:"FormField",isAllowed:this.isFormFieldAllowed},{type:"Print",isAllowed:this.isPrintAllowed},{type:"Sign",isAllowed:this.isSignAllowed}]},e.prototype.updateSizes=function(){this.updatePageSizes(),this.updateLayoutSize()},e.prototype.updatePageSizes=function(){var e=this;this._pageSizes=this.originalPageSizes.map(function(t){var n=t.width*e.scale,a=t.height*e.scale,i=!e.inverted;return{width:i?n:a,height:i?a:n}})},e.prototype.updateLayoutSize=function(){this._layoutSize=this.inverted?K(this.originalPageSizes,this.scale):{width:this.originalLayoutSize.width*this.scale,height:this.originalLayoutSize.height*this.scale}},e}(),q=n(37),Q=function(e){return(0,s.yv)(void 0,void 0,void 0,function(){var t,n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return t=void 0,(null===(i=q.a.features)||void 0===i?void 0:i.enableEncrypt)?[4,e.hasSignature()]:[3,2];case 1:t=!!r.sent(),r.label=2;case 2:return n=void 0,g.a.isActivated("AddOutlineCheck")?[3,4]:[4,e.hasOutline()];case 3:n=!!r.sent(),r.label=4;case 4:return[4,e.getDocumentMetaData()];case 5:return a=r.sent(),[2,new W(a.layoutSize,a.pageCount,a.pagesSize,a.isMip,a.isMipDecrypted,a.isFileEncrypted,a.isAnnotAllowed,a.isFormFieldAllowed,a.isCopyAllowed,a.isEditAllowed,a.isPrintAllowed,a.isCopyAccessibleAllowed,a.isSignAllowed,t,n)]}})})},Y=function(){function e(e,t,n){this._viewHandler=e,this._inputEvtHandler=t,this._metadata=n}return e.getInstance=function(t,n){return(0,s.yv)(this,void 0,void 0,function(){var a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return a=e.bind,i=[void 0,t,n],[4,Q(t)];case 1:return[2,new(a.apply(e,i.concat([r.sent()])))]}})})},e.prototype.dispose=function(){this._viewHandler.dispose()},e.prototype.initMetadata=function(){return(0,s.yv)(this,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){switch(t.label){case 0:return e=this,[4,Q(this.viewHandler)];case 1:return e._metadata=t.sent(),[2]}})})},e.prototype.getOutlineData=function(){return(0,s.yv)(this,void 0,void 0,function(){return(0,s.SO)(this,function(e){return[2,this._viewHandler.getOutlineData()]})})},e.prototype.updateOriginalLayoutForProgressiveLoading=function(){return(0,s.yv)(this,void 0,void 0,function(){var e,t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return[4,this._viewHandler.getDocumentLayoutSize()];case 1:return e=n.sent(),[4,this._viewHandler.getPageSizes()];case 2:return t=n.sent(),[2,this._metadata.updateOriginalLayoutForProgressiveLoading(e,t)]}})})},Object.defineProperty(e.prototype,"viewHandler",{get:function(){return this._viewHandler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputEvtHandler",{get:function(){return this._inputEvtHandler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),e}(),J=n(766),X=n(205),Z=n.n(X),$=n(424),ee=n(577),te=n(410),ne=g.a.isActivated("EnableShortDebounceForSelectedText")?500:50,ae=function(e){function t(t,n,a,i,r,o,c,d,u){var p=e.call(this,t)||this;return p.isSelecting=!1,p.scrollIntoView=Z()(function(){if(p.searchScrollPayload){var e=p.searchScrollPayload,t=e.page,n=e.x,a=e.y,i=e.width,r=e.height,o=p.metadata,s=o.originalPageSizes,c=o.rotation,d=o.scale,l=(0,$.d)(new f.b(n,a,i,r),s[t],d,c).origin;p.goToPageFn(t,l,!0)}},500),p.handleTextSelected=Z()(function(){var e;if(p.selectedText&&""!==p.selectedText){l.a.read(p.l10n.get("textSelectedAria",[p.selectedText]));var t=p.selectionEndPoint;p.selectionBeginPoint&&t&&p.selectionBeginPoint.y<t.y&&(t=p.selectionBeginPoint),null===(e=p.onTextSelected)||void 0===e||e.call(p,p.selectedText,t)}},ne),p.onKeyDown=function(e){return(0,s.yv)(p,void 0,void 0,function(){return(0,s.SO)(this,function(t){switch(t.label){case 0:if(!e.ctrlKey)return[3,5];switch(e.code){case"KeyA":return[3,1];case"KeyC":return[3,3]}return[3,4];case 1:return e.preventDefault(),[4,this.viewHandler.selectAll()];case 2:return t.sent(),[3,5];case 3:return this.copyToClipboard(),[3,5];case 4:return[3,5];case 5:return[2]}})})},p.copyToClipboard=function(){p.selectedText&&window.navigator.clipboard.writeText(p.selectedText)},p.getPageText=function(e){return(0,s.yv)(p,void 0,void 0,function(){return(0,s.SO)(this,function(t){return[2,this.viewHandler.getPageText(e)]})})},p.renderRect=function(e,t){return(0,s.yv)(p,void 0,void 0,function(){var n,a,i,r,o,c,d=this;return(0,s.SO)(this,function(s){switch(s.label){case 0:return n=this.metadata.layoutSize,a=(0,_.a)(),i=e.scale(a),r=g.a.isActivated("EnableAddRedundance")?0:Math.ceil(a),i.x-=r,i.y-=r,i.width+=2*r,i.height+=2*r,[4,this.viewHandler.selectRender(i,{width:(0,_.b)(n.width),height:(0,_.b)(n.height)})];case 1:return(o=s.sent())&&(c=(0,ee.a)(o),requestAnimationFrame(function(){d.setStatesFn(c),null==t||t()})),[2]}})})},p.pointerDown=!1,p.layoutManager=n,p.l10n=a,p.setStatesFn=i,p.goToPageFn=r,p.scrollViewerFn=o,p.onTextSelected=c,p.onTextDeselected=d,p.refreshViewPortForProgressiveLoadingFn=u,p}return(0,s.e2)(t,e),t.prototype.onNotification=function(e){var t;return(0,s.yv)(this,void 0,void 0,function(){var n,a,i,r,o,c,d;return(0,s.SO)(this,function(s){switch(s.label){case 0:switch(e.name){case 13:return[3,1];case 4:return[3,2];case 2:return[3,6];case 7:return[3,8]}return[3,9];case 1:return this.selectedText=e.payload,!this.pointerDown&&this.isSelecting&&this.handleTextSelected(),[3,10];case 2:return n=e.payload,a=n.left,i=n.top,r=n.right,o=n.bottom,c=(0,ee.b)(a,i,r,o,this.metadata.scale),[4,null===(t=this.refreshViewPortForProgressiveLoadingFn)||void 0===t?void 0:t.call(this)];case 3:return s.sent()?[3,5]:[4,this.renderRect(c)];case 4:s.sent(),s.label=5;case 5:return[3,10];case 6:return d=this.layoutManager.viewportRectRelativeToDocument,[4,this.renderRect(d)];case 7:return s.sent(),[3,10];case 8:return this.searchScrollPayload=e.payload,this.scrollIntoView(),[3,10];case 9:return[3,10];case 10:return[2]}})})},t.prototype.onPointerDown=function(e){0===e.button&&(this.pointerDown=!0,this.selectionBeginPoint=e?new f.a(e.clientX,e.clientY):void 0,this.deselectText(),this.isSelecting=!0)},t.prototype.onPointerMove=function(e){this.pointerDown&&this.trySelectionAutoScroll(e)},t.prototype.onPointerUp=function(e){this.pointerDown&&(this.selectionEndPoint=e?new f.a(e.clientX,e.clientY):void 0,this.pointerDown=!1,this.cancelSelectionScrollTimer(),this.selectText(),this.isSelecting=!1)},t.prototype.selectText=function(){this.handleTextSelected()},t.prototype.deselectText=function(){var e,t=this.selectedText;this.selectedText="",t&&!this.selectedText&&(null===(e=this.onTextDeselected)||void 0===e||e.call(this,t))},t.prototype.onGripperMove=function(e){this.trySelectionAutoScroll(e)},t.prototype.onGirpperUp=function(){this.cancelSelectionScrollTimer()},t.prototype.hasTextSelected=function(){return!!this.selectedText},t.prototype.trySelectionAutoScroll=function(e){var t=this;this.cancelSelectionScrollTimer();var n=this.layoutManager.rootRect,a=n.y,i=a+n.getClientHeight(),r=e.y<=a,o=e.y>=i;if(!r&&!o)return!1;var s,c,d=r?e.y-a:e.y-i;return this.selectionAutoScrollTimerId=(s=function(){var e;null===(e=t.scrollViewerFn)||void 0===e||e.call(t,0,Math.min(z.c,d*z.d))},c=z.b,s(),window.setInterval(s,c)),!0},t.prototype.cancelSelectionScrollTimer=function(){this.selectionAutoScrollTimerId&&(window.clearInterval(this.selectionAutoScrollTimerId),this.selectionAutoScrollTimerId=void 0)},t}(te.a),ie=n(208),re=n(333),oe="PdfDocumentLoader",se=function(){function e(e,t,n,a,i,r){void 0===n&&(n=0),void 0===a&&(a=!1),this.url=e,this.token=i,this._filename=void 0===t?(0,re.a)(this.url):t,this._fileSize=n,this._enableRanges=a,this.abortController=new AbortController,this.getAuthHeaders=r}return e.prototype.dispose=function(){this.abortController.abort()},e.prototype.fetch=function(){return(0,s.yv)(this,void 0,void 0,function(){var e,t,n,a,i,r,o,c,d,l,u,f=this;return(0,s.SO)(this,function(s){switch(s.label){case 0:this.abortController.abort(),e=this._enableRanges&&0!==this._fileSize,s.label=1;case 1:return s.trys.push([1,8,,9]),t=(this.abortController=new AbortController).signal,n={},this.getAuthHeaders?[4,this.getAuthHeaders()]:[3,3];case 2:s.sent().forEach(function(e){n[e.name]=e.value}),s.label=3;case 3:return this.token&&(n.Authorization=this.token),a={credentials:"same-origin",signal:t,headers:n},e?[4,(0,ie.b)(this.url,a,this._fileSize,function(){f.abortController.abort()},"GetDocument")]:[3,5];case 4:return r=s.sent(),[3,7];case 5:return[4,(0,ie.c)(this.url,a,"GetDocument")];case 6:r=s.sent(),s.label=7;case 7:return i=r,v.a.verbose(oe,"The document is fetched"),o=new Uint8Array(i,0,i.byteLength),this._fileSize=o.byteLength,[2,o];case 8:if((c=s.sent()).name===z.a)return v.a.info(oe,"Aborted the document fetching request"),[2];throw d="NetworkError"===c.name?c.status:void 0,l=I.a.getTempAuthLogFields(this.url,this.token),u=new h.c(h.b.FileDownloadFailed,"Fail to download the PDF file, \n          status: ".concat(d,", \n          downloadByRange?: ").concat(e,", \n          fileSize: ").concat(this._fileSize,", \n          noTempAuth: ").concat(l.noTempAuth,", \n          useToken: ").concat(l.useToken)),S.a.logError(u.toCaughtError()),c;case 9:return[2]}})})},Object.defineProperty(e.prototype,"filename",{get:function(){return this._filename},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fileSize",{get:function(){return this._fileSize},enumerable:!1,configurable:!0}),e}(),ce=function(){function e(e){this.noFailedAttempt=!0,this.onNeedPassword=e}return e.prototype.tryOpen=function(e,t){var n;return void 0===e&&(e=""),(0,s.yv)(this,void 0,void 0,function(){return(0,s.SO)(this,function(a){switch(a.label){case 0:return this._viewHandler?[4,this._viewHandler.openDocument(e)]:[2,!1];case 1:return a.sent()?[2,!0]:(this.noFailedAttempt?(null===(n=this.onNeedPassword)||void 0===n||n.call(this),this.noFailedAttempt=!1):null==t||t(),[2,!1])}})})},e.prototype.reOpenDocumentWithOwnerPassword=function(e,t,n,a){return(0,s.yv)(this,void 0,void 0,function(){var i,r;return(0,s.SO)(this,function(o){switch(o.label){case 0:if(!this._viewHandler)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._viewHandler.reloadUnchangedFileWithOwnerPassword(e,a)];case 2:return(i=o.sent())?null==t||t():i||null==n||n(),[3,4];case 3:return r=o.sent(),v.a.error("PdfDocumentOpener",r),[3,4];case 4:return[2]}})})},Object.defineProperty(e.prototype,"viewHandler",{set:function(e){this._viewHandler=e},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.noFailedAttempt=!0},e}(),de=function(){function e(e){this.dispatchEventFn=e}return e.prototype.onNotification=function(e){return(0,s.yv)(this,void 0,void 0,function(){var t,n,a,i,r,o,c,d,l,u,p;return(0,s.SO)(this,function(s){switch(e.name){case 26:t=e.payload,n=t.pageIndex,a=t.left,i=t.top,r=t.right,o=t.bottom,c=t.text,d=t.fontSize,l=t.isMultiLine,u=new f.b(a,i,r-a,o-i),p={pageIndex:n,rect:u,text:c,fontSize:d,isMultiLine:l},this.dispatchEventFn(G.e.ShowTextField,p);break;case 27:this.dispatchEventFn(G.e.ShowTextField,void 0)}return[2]})})},e}(),le="PdfFreeTextService",ue=function(e){function t(t,n,a){var i=e.call(this,t)||this;return i.setInitialFontAttributes=function(e){i.initialFontAttribute=e},i.getAccDataInPage=function(e){return(0,s.yv)(i,void 0,void 0,function(){return(0,s.SO)(this,function(t){return[2,this.viewHandler.getAccDataInPage(e)]})})},i.applyFreeTextAttributes=function(){if(!g.a.isActivated("StoreFreeTextAttributeInLocalStorage"))try{var e=window.localStorage.getItem(z.r);if(e){var t=JSON.parse(e);i.setInitialFontAttributes(t)}}catch(e){v.a.error(le,e)}},i.originalPageRects=n,i.dispatchEventFn=a,i.initialFontAttribute={fontSize:14,fontColor:z.q},i.applyFreeTextAttributes(),i}return(0,s.e2)(t,e),t.prototype.onNotification=function(e){return(0,s.yv)(this,void 0,void 0,function(){var t,n,a,i,r,o,c,d,l,f,p;return(0,s.SO)(this,function(m){if(0===this.originalPageRects.length)return[2];switch(t={},e.name){case 18:n=e.payload,a=n.position,i=n.pageIndex,t={pageIndex:i,id:0,boundingBox:{left:a.x,top:a.y,right:0,bottom:0},text:"",textColor:this.initialFontAttribute.fontColor,fontSize:this.initialFontAttribute.fontSize,lineHeight:14*z.s/10,characterSpacing:z.o,newCreated:!0},(0,u.a)()&&(t.boundingBox.right=-(this.originalPageRects[i].width-a.x)),this.dispatchEventFn(G.e.ShowFreeText,t);break;case 19:r=e.payload.freeText,o=r.boundingBox,c=o.left,d=o.top,l=o.right,f=o.bottom,p={left:c,top:d,right:c+(l-c),bottom:d+(f-d)},(0,u.a)()&&(p.right=-(this.originalPageRects[r.pageIndex].width-l),p.left=-(this.originalPageRects[r.pageIndex].width-c)),r.boundingBox=p,t=(0,s.q5)((0,s.q5)({},r),{newCreated:!1}),this.dispatchEventFn(G.e.ShowFreeText,t);break;case 20:this.dispatchEventFn(G.e.AnnotationChanged)}return[2]})})},t.prototype.storeFreeTextAttribute=function(){if(!g.a.isActivated("StoreFreeTextAttributeInLocalStorage"))try{var e=JSON.stringify(this.initialFontAttribute);window.localStorage.setItem(z.r,e)}catch(e){v.a.error(le,e)}},t}(te.a),fe=n(578),pe=n(579),me=n(439),_e=function(e){switch(e){case"Content":return 0;case"Cursor":return 1;case"Link":return 2;case"Search":return 3;case"Ink":return 4;case"Font":return 12;case"Document":return 5;case"Gripper":return 9;case"RangeRequest":return 10;case"FreeText":return 6;case"Watermark":return 7;case"Form":return 8;case"UpdateViewport":return 11;case"UndoRedo":return 13;default:return 14}},he=function(e){switch(e){case"DocumentSaved":return 0;case"InkStrokesAdded":return 1;case"InvalidateRect":return 4;case"InvalidateAll":return 2;case"DocumentSizeUpdated":return 3;case"SetDocumentDirty":return 8;case"ScrollIntoView":return 7;case"UpdateCursor":return 9;case"UpdateNumberOfFindResults":return 11;case"UpdateSelectedFindResult":return 12;case"UpdateLinkRect":return 10;case"UpdateSelectedText":return 13;case"NavigateTo":return 5;case"NavigateToDest":return 6;case"GripperPositionChanged":return 14;case"SendRangeRequest":return 15;case"DocumentReady":return 17;case"DocumentDownLoadComplete":return 16;case"ShowNewFreeText":return 18;case"ShowEditableFreeText":return 19;case"FreeTextChanged":return 20;case"WatermarkAdded":return 21;case"WatermarkEditsSaved":return 22;case"WatermarkDeleted":return 23;case"GetWatermarkInfos":return 24;case"SetWatermarkVisible":return 25;case"TextFieldFocused":return 26;case"TextFieldBlur":return 27;case"VisiblePagesLoaded":return 28;case"MissingFont":return 29;case"CanUndoRedoChanged":return 30;default:return 32}},be=function(e){e.preventDefault()},ge=function(){function e(e){this.element=e}return e.prototype.activate=function(){this.element.addEventListener("touchmove",be,{passive:!1})},e.prototype.deactivate=function(){this.element.removeEventListener("touchmove",be)},e}(),ve=function(e){function t(t,n,a,i,r){var o=e.call(this,t)||this;return o.onLongPress=function(){o.isGripperPosValid&&(o.isLongPress=!0,o.toggleGripperFn(!0),o.isGripperShown=!0)},o.onTouchMove=function(e,t){return(0,s.yv)(o,void 0,void 0,function(){var n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return this.isGripperMoving?(e.preventDefault(),n=new f.a(e.touches[0].clientX,e.touches[0].clientY),this.contentService.onGripperMove(n),[4,this.inputEvtHandler.onPointerMove(t)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},o.onTouchEnd=function(){return(0,s.yv)(o,void 0,void 0,function(){var e,t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return this.isGripperMoving||this.isLongPress?(this.contentService.onGirpperUp(),null===(t=this.contentService)||void 0===t||t.selectText()):(null===(e=this.contentService)||void 0===e||e.deselectText(),this.toggleGripperFn(!1),this.isGripperShown=!1),this.isGripperMoving?[4,this.inputEvtHandler.onPointerUp(new f.a(0,0))]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isGripperMoving=!1,this.isLongPress=!1,[2]}})})},o.onGripperTouchStart=function(e){return(0,s.yv)(o,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return this.isGripperMoving=!0,t=e?this.originalGripperPos.right:this.originalGripperPos.left,n=e?this.originalGripperPos.left:this.originalGripperPos.right,[4,this.inputEvtHandler.onPointerDown(t)];case 1:return a.sent(),[4,this.inputEvtHandler.onPointerMove(n)];case 2:return a.sent(),[2]}})})},o.gripperDeSelectText=function(){return(0,s.yv)(o,void 0,void 0,function(){return(0,s.SO)(this,function(e){switch(e.label){case 0:return[4,this.inputEvtHandler.onPointerUp(new f.a(0,0))];case 1:return e.sent(),[4,this.inputEvtHandler.onPointerDown(new f.a(0,0))];case 2:return e.sent(),[4,this.inputEvtHandler.onPointerUp(new f.a(0,0))];case 3:return e.sent(),[2]}})})},o.layoutManager=n,o.contentService=a,o.originalGripperPos={left:new f.a(0,0),right:new f.a(0,0)},o.isGripperMoving=!1,o.isLongPress=!1,o.isGripperPosValid=!1,o._isGripperShown=!1,o.toggleGripperFn=i,o.updateGripperPositionFn=r,o}return(0,s.e2)(t,e),t.prototype.onNotification=function(e){if(9===e.type&&14===e.name){var t=e.payload,n=t.leftGripperBoundingRect,a=t.rightGripperBoungdingRect;if(this.isGripperPosValid=n.right-n.left>0||a.right-a.left>0,!this.isGripperPosValid)return;var i=function(e){return new f.a(e.left,(e.bottom+e.top)/2)};this.originalGripperPos.left=i(n),this.originalGripperPos.right=i(a),this.updateGripperPositionFn({left:(0,$.b)(n,!0,this.layoutManager.documentLeftToContent,this.layoutManager.scale,this.layoutManager.rotation),right:(0,$.b)(a,!0,this.layoutManager.documentLeftToContent,this.layoutManager.scale,this.layoutManager.rotation)})}},Object.defineProperty(t.prototype,"isGripperShown",{get:function(){return this._isGripperShown},set:function(e){this._isGripperShown=e},enumerable:!1,configurable:!0}),t}(te.a),ye="InputEvtService",Se=function(e){function t(t,n,a,i,r,o,c,d,l,u,p,m,_,h,b){var g=e.call(this,t)||this;return g._isFormFocused=!1,g.setMode=function(e){var t,n;e!==g.mode&&(g.mode=e,g.isEraseMode()?(g.updateCursor("Eraser"),null===(t=g.preventDefaultOnTouchMove)||void 0===t||t.activate()):g.isFreeTextMode()?g.updateCursor("FreeText"):(g.updateCursorFn(G.c.Default),null===(n=g.preventDefaultOnTouchMove)||void 0===n||n.deactivate()))},g.triggerPointerUp=function(e){return(0,s.yv)(g,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return t=this.layoutManager.convertPointFromClientToOriginalDocument(e),[4,null===(n=this.inputEvtHandler)||void 0===n?void 0:n.onPointerUp(t)];case 1:return a.sent(),[2]}})})},g.onPointerDown=function(e){return(0,s.yv)(g,void 0,void 0,function(){var t,n,a;return(0,s.SO)(this,function(i){switch(i.label){case 0:return this.shouldHandlePointerEvt(e.pointerType)?(this.gripperService.toggleGripperFn(!1),this.isDisplayMode()&&(null===(n=this.contentService)||void 0===n||n.onPointerDown(e)),t=this,[4,null===(a=this.inputEvtHandler)||void 0===a?void 0:a.onPointerDown(this.getCursorInOriginDocument(new f.a(e.x,e.y)))]):[2];case 1:return t.isFormFocused=i.sent(),[2]}})})},g.onPointerMove=function(e){var t=e.x,n=e.y,a=e.pointerType;return(0,s.yv)(g,void 0,void 0,function(){var e,i,r,o,c;return(0,s.SO)(this,function(s){switch(s.label){case 0:return this.shouldHandlePointerEvt(a)?(e=new f.a(t,n),(i=this.getCursorType())&&(r=this.layoutManager.convertPointFromClientToDocument(e),(null===(o=this.layoutManager.pageManager)||void 0===o?void 0:o.isPointInVisiblePages(r))?this.updateCursor(i):this.updateCursorFn(G.c.Default)),[4,null===(c=this.inputEvtHandler)||void 0===c?void 0:c.onPointerMove(this.getCursorInOriginDocument(e))]):[2];case 1:return s.sent(),[2]}})})},g.getCursorType=function(){switch(g.mode){case G.a.Erase:return"Eraser";case G.a.FreeText:return"FreeText";default:return null}},g.onPointerUp=function(e){return(0,s.yv)(g,void 0,void 0,function(){var t,n,a;return(0,s.SO)(this,function(i){switch(i.label){case 0:return this.shouldHandlePointerEvt(e.pointerType)?(this.isDisplayMode()&&(null===(n=this.contentService)||void 0===n||n.onPointerUp(e)),t=this,[4,null===(a=this.inputEvtHandler)||void 0===a?void 0:a.onPointerUp(this.getCursorInOriginDocument(new f.a(e.x,e.y)))]):[2];case 1:return t.isFormFocused=i.sent(),[2]}})})},g.onClick=function(e){return(0,s.yv)(g,void 0,void 0,function(){var t,n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return t=e.type,n=e.detail,"click"===t&&n>1&&n<4?(a=this,[4,null===(i=this.inputEvtHandler)||void 0===i?void 0:i.onMultiTapped(this.getCursorInOriginDocument(new f.a(e.x,e.y)),n)]):[3,2];case 1:a.isFormFocused=r.sent(),r.label=2;case 2:return[2]}})})},g.onTouchStart=function(e){return(0,s.yv)(g,void 0,void 0,function(){var t,n,a=this;return(0,s.SO)(this,function(i){switch(i.label){case 0:return e.touches.length>1?[2]:(t=new f.a(e.touches[0].clientX,e.touches[0].clientY),this.touchDownPoint=t,this.isFreeTextMode()?[2]:(n=this.getCursorInOriginDocument(t),this.isDisplayMode()&&(this.pressTimer=window.setTimeout(function(){return(0,s.yv)(a,void 0,void 0,function(){return(0,s.SO)(this,function(e){switch(e.label){case 0:return[4,this.inputEvtHandler.onMultiTapped(n,2)];case 1:return e.sent(),this.gripperService.onLongPress(),this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=void 0),[2]}})})},500)),this.gripperService.isGripperShown?[3,2]:[4,this.inputEvtHandler.onPointerDown(n)]));case 1:i.sent(),i.label=2;case 2:return[2]}})})},g.onTouchMove=function(e){return(0,s.yv)(g,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return this.isDisplayMode()?(t=new f.a(e.touches[0].clientX,e.touches[0].clientY),n=this.getCursorInOriginDocument(t),this.resetTimer(),[4,this.gripperService.onTouchMove(e,n)]):[2];case 1:return a.sent(),[2]}})})},g.onTouchEnd=function(e){return(0,s.yv)(g,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return e.changedTouches.length>1?[2]:(t=new f.a(e.changedTouches[0].clientX,e.changedTouches[0].clientY),!this.gripperService.isGripperShown&&this.isTouchMoving(t)?[2]:(n=this.getCursorInOriginDocument(t),this.resetTimer(),this.gripperService.isGripperShown?[4,this.gripperService.onTouchEnd()]:[3,2]));case 1:return a.sent(),[3,4];case 2:return[4,this.inputEvtHandler.onPointerUp(n)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},g.onGripperTouchStart=function(e){return(0,s.yv)(g,void 0,void 0,function(){return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,this.gripperService.onGripperTouchStart(e)];case 1:return t.sent(),[2]}})})},g.gripperDeSelectText=function(){return(0,s.yv)(g,void 0,void 0,function(){return(0,s.SO)(this,function(e){switch(e.label){case 0:return[4,this.gripperService.gripperDeSelectText()];case 1:return e.sent(),[2]}})})},g.pasteTextIntoFormField=function(){return(0,s.yv)(g,void 0,void 0,function(){var e,t;return(0,s.SO)(this,function(n){switch(n.label){case 0:e="",n.label=1;case 1:return n.trys.push([1,4,,5]),[4,window.navigator.clipboard.readText()];case 2:return 0===(e=n.sent()).length?[2]:[4,this.inputEvtHandler.pasteIntoFormField(e)];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),v.a.error(ye,t),[2];case 5:return[2]}})})},g.formCopyAndCut=function(e,t){return(0,s.yv)(g,void 0,void 0,function(){var n,a,i,r,o,c,d,l,u;return(0,s.SO)(this,function(s){switch(s.label){case 0:return[4,this.inputEvtHandler.getFormSelectedText()];case 1:n=s.sent(),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,window.navigator.clipboard.writeText(n)];case 3:return s.sent(),[3,5];case 4:return a=s.sent(),v.a.error(ye,a),[2];case 5:return"KeyX"===e&&n?null!==(d=this.inputEvtHandler)&&void 0!==d?[3,6]:(i=void 0,[3,9]):[3,11];case 6:return o=(r=d).onKeyDown,[4,null===(l=this.inputEvtHandler)||void 0===l?void 0:l.getVirtualKeyFromEvt("Delete")];case 7:return c=[s.sent()],[4,null===(u=this.inputEvtHandler)||void 0===u?void 0:u.getModifierKeyFromEvt("None")];case 8:i=o.apply(r,c.concat([s.sent(),t])),s.label=9;case 9:return[4,i];case 10:s.sent(),s.label=11;case 11:return[2]}})})},g.onKeyDown=function(e,t){return(0,s.yv)(g,void 0,void 0,function(){return(0,s.SO)(this,function(n){switch(n.label){case 0:return this.isDisplayMode()&&!this.isFormFocused&&e.ctrlKey?[4,this.contentService.onKeyDown(e)]:[3,2];case 1:return n.sent(),[2];case 2:return this.isFormFillingEnabledFn()&&(0,me.b)()?[4,this.handleKeyDownForForm(e,t)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}})})},g.isFormFillingEnabledFn=h,g.mode=G.a.None,g.layoutManager=n,g.l10n=a,g.contentService=i,g.gripperService=new ve(t,n,i,r,o),g.pressTimer=void 0,g.updateCursorFn=m,b&&(g.preventDefaultOnTouchMove=new ge(b)),g.goToPageFn=c,g.scrollByFn=d,g.scrollToFn=l,g.focusOnVirtualForwardFormFn=u,g.focusOnVirtualBackwardFormFn=p,g.onFormFocusFn=_,g}return(0,s.e2)(t,e),t.prototype.dispose=function(){var e;null===(e=this.preventDefaultOnTouchMove)||void 0===e||e.deactivate()},t.prototype.onNotification=function(e){switch(e.type){case 1:9===e.name&&this.isDisplayMode()&&this.updateCursorFn(function(e){switch(e){case"Text":return G.c.Text;case"Link":return G.c.Link;default:return G.c.Default}}(e.payload));break;case 9:this.gripperService.onNotification(e)}},t.prototype.isTouchMoving=function(e){var t=this.touchDownPoint&&e.distanceTo(this.touchDownPoint)>5;return this.touchDownPoint=void 0,t},t.prototype.resetTimer=function(){"number"==typeof this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=void 0)},t.prototype.getCursorInOriginDocument=function(e){return this.layoutManager.convertPointFromClientToOriginalDocument(e)},t.prototype.isDisplayMode=function(){return this.mode===G.a.None},t.prototype.isEraseMode=function(){return this.mode===G.a.Erase||this.mode===G.a.PointErase},t.prototype.isFreeTextMode=function(){return this.mode===G.a.FreeText},t.prototype.shouldHandlePointerEvt=function(e){return!e||"mouse"===e||!this.isDisplayMode()},t.prototype.isFormValidChars=function(e){return 1===e.length||e===pe.a.Enter},t.prototype.updateCursor=function(e){return(0,s.yv)(this,void 0,void 0,function(){var t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return[4,this.getCustomCursor(e)];case 1:return(t=n.sent())&&this.updateCursorFn(t),[2]}})})},t.prototype.getCustomCursor=function(e){return(0,s.yv)(this,void 0,void 0,function(){var t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return this.cursorHelper?[3,2]:(t=this,[4,(0,fe.a)()]);case 1:t.cursorHelper=n.sent(),n.label=2;case 2:switch(e){case"Eraser":return[2,this.cursorHelper.getEraserCursor()];case"FreeText":return[2,this.cursorHelper.getFreeTextCursor()];default:return[2,void 0]}return[2]}})})},Object.defineProperty(t.prototype,"isFormFocused",{get:function(){return this._isFormFocused},set:function(e){this.onFormFocusFn(e),this._isFormFocused=e},enumerable:!1,configurable:!0}),t.prototype.handleKeyDownForForm=function(e,t){var n,a,i,r,o,c,d;return(0,s.yv)(this,void 0,void 0,function(){var u,f,p,m,_,h,b,g,v,y,S,D,I,x,C;return(0,s.SO)(this,function(s){switch(s.label){case 0:return u=e.key,Object.values(pe.a).includes(u)&&e.preventDefault(),this.isFormValidChars(u)&&this.isFormFocused&&e.preventDefault(),(f=1!==u.length)?[4,null===(n=this.inputEvtHandler)||void 0===n?void 0:n.getVirtualKeyFromEvt(u)]:[3,2];case 1:f=0===s.sent(),s.label=2;case 2:return f?[2]:e.ctrlKey?"KeyC"!==e.code&&"KeyX"!==e.code?[3,4]:[4,this.formCopyAndCut(e.code,t)]:[3,6];case 3:return s.sent(),[2];case 4:return"KeyV"!==e.code?[3,6]:[4,this.pasteTextIntoFormField()];case 5:return s.sent(),[2];case 6:return!this.isFormValidChars(u)||e.ctrlKey?[3,12]:(m=void 0,u!==pe.a.Enter?[3,8]:[4,null===(a=this.inputEvtHandler)||void 0===a?void 0:a.getVirtualKeyFromEvt(u)]);case 7:return m=s.sent(),[3,9];case 8:m=u.charCodeAt(0),s.label=9;case 9:return h=(_=this.inputEvtHandler).onChar,b=[m],[4,null===(i=this.inputEvtHandler)||void 0===i?void 0:i.getModifierKeyFromEvt("None")];case 10:return[4,h.apply(_,b.concat([s.sent()]))];case 11:return p=s.sent(),u!==pe.a.Space||p||this.goToPageFn(t+1),[2];case 12:return(S=e.shiftKey)?[4,null===(r=this.inputEvtHandler)||void 0===r?void 0:r.getModifierKeyFromEvt("Shift")]:[3,14];case 13:S=s.sent(),s.label=14;case 14:return(y=S)?[3,17]:(D=e.ctrlKey)?[4,null===(o=this.inputEvtHandler)||void 0===o?void 0:o.getModifierKeyFromEvt("Control")]:[3,16];case 15:D=s.sent(),s.label=16;case 16:y=D,s.label=17;case 17:return(v=y)?[3,19]:[4,null===(c=this.inputEvtHandler)||void 0===c?void 0:c.getModifierKeyFromEvt("None")];case 18:v=s.sent(),s.label=19;case 19:return g=v,null!==(d=this.inputEvtHandler)&&void 0!==d?[3,20]:(I=void 0,[3,22]);case 20:return C=(x=d).onKeyDown,[4,this.inputEvtHandler.getVirtualKeyFromEvt(u)];case 21:I=C.apply(x,[s.sent(),g,t]),s.label=22;case 22:return[4,I];case 23:if(p=s.sent(),u===pe.a.Tab&&(this.isFormFocused=p),p)u===pe.a.Tab&&l.a.read(this.l10n.get("formFieldAria"));else switch(u){case pe.a.Home:this.scrollToFn(0,0);break;case pe.a.End:this.scrollToFn(0,this.layoutManager.documentSize.height);break;case pe.a.ArrowDown:this.scrollByFn(0,100);break;case pe.a.ArrowUp:this.scrollByFn(0,-100);break;case pe.a.ArrowLeft:this.scrollByFn(-100,0);break;case pe.a.ArrowRight:this.scrollByFn(100,0);break;case pe.a.Tab:e.shiftKey?this.focusOnVirtualBackwardFormFn(t):this.focusOnVirtualForwardFormFn(t)}return[2]}})})},t.prototype.addFreeText=function(){var e,t;return(0,s.yv)(this,void 0,void 0,function(){var n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return n=new f.a(document.documentElement.clientWidth/2,document.documentElement.clientHeight/2),[4,null===(e=this.inputEvtHandler)||void 0===e?void 0:e.onPointerDown(this.layoutManager.convertPointFromClientToOriginalDocument(n))];case 1:return a.sent(),[4,null===(t=this.inputEvtHandler)||void 0===t?void 0:t.onPointerUp(this.layoutManager.convertPointFromClientToOriginalDocument(n))];case 2:return a.sent(),l.a.read(this.l10n.get("freeTextAdded")),[2]}})})},t}(te.a),De=function(e){function t(t,n,a,i){var r=e.call(this,t)||this;return r.onNotification=function(e){switch(e.name){case 10:var t=e.payload,n=t.left,a=t.top,i=t.right,o=t.bottom;if(n===i||a===o)r.dispatchEventFn(G.e.ClearHighlightLink);else{var s=(0,ee.b)(n,a,i,o,r.metadata.scale),c=r.layoutManager.viewportRectRelativeToContent.origin.symmetricMap();s.origin=s.origin.plus(c),r.dispatchEventFn(G.e.HighlightLink,s)}break;case 5:var d=e.payload;r.navigateToWebLink(d);break;case 6:r.dispatchEventFn(G.e.ClearHighlightLink);var l=e.payload,u=l.page,p=l.x,m=l.y;r.navigateToDocumentLink(u,new f.a(p,m))}},r.getLinkInfosInPage=function(e,t){return(0,s.yv)(r,void 0,void 0,function(){return(0,s.SO)(this,function(n){return[2,this.viewHandler.getLinkInfosInPage(e,t?1:this.metadata.scale)]})})},r.layoutManager=n,r.goToPageFn=a,r.dispatchEventFn=i,r}return(0,s.e2)(t,e),t.prototype.navigateToDocumentLink=function(e,t){t.scale(this.metadata.scale),this.goToPageFn(e,t)},t.prototype.navigateToWebLink=function(e){(0,re.b)(e)?this.navigateToUrlViaATag(e):v.a.warn("PdfLinkService","Unsupported web link")},t.prototype.navigateToUrlViaATag=function(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),t.click()},t}(te.a),Ie=function(e){return(0,s.yv)(void 0,void 0,void 0,function(){var t,n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.target.apply(null,e.args)];case 1:return t=r.sent(),e.isCancelled?[2,!1]:(null===(a=e.onsuccess)||void 0===a||a.call(e,t),[2,!0]);case 2:return n=r.sent(),null===(i=e.onerror)||void 0===i||i.call(e,n),[2,!1];case 3:return[2]}})})},xe=function(){function e(){var e=this;this.internalRun=function(){return(0,s.yv)(e,void 0,void 0,function(){var e,t,n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return this.running=!0,(e=this.pickTask())?(t=e.type,n=e.task,[4,Ie(n)]):(this.running=!1,[2]);case 1:switch((a=r.sent())||v.a.error("AsyncTaskQueue",new Error("Failed to execute task of type ".concat(t))),t){case"Micro":i=this.microQueue.findIndex(function(e){return e===n}),this.microQueue.splice(0,i+1);break;case"Normal":this.queue.shift();break;case"PreRender":g.a.isActivated("FixPreRenderFailAtNativeRender")&&!a||(this.preRenderTask=void 0)}return this.internalRun(),[2]}})})},this.microQueue=[],this.queue=[],this.running=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.add=function(e,t){t?this.microQueue.push(e):this.queue.push(e),this.running||this.run()},e.prototype.poll=function(e){return e?this.microQueue.shift():this.queue.shift()},e.prototype.setPreRenderTask=function(e){this.preRenderTask=e,this.running||this.run()},e.prototype.cancelPreRenderTask=function(){var e,t;(e=this.preRenderTask)&&(null===(t=e.oncancel)||void 0===t||t.call(e),e.isCancelled=!0,e=void 0)},e.prototype.run=function(){this.internalRun()},e.prototype.clear=function(){this.cancelPreRenderTask(),e.instance=void 0},e.prototype.pickTask=function(){if(this.preRenderTask&&this.preRenderTask.isPageVisible())return{type:"PreRender",task:this.preRenderTask};if(this.microQueue.length>=1){var e=this.microQueue.length;return{type:"Micro",task:this.microQueue[e-1]}}return this.queue.length>=1?{type:"Normal",task:this.queue[0]}:this.preRenderTask?{type:"PreRender",task:this.preRenderTask}:void 0},e}();!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Up=2]="Up",e[e.Down=3]="Down"}(j||(j={}));var Ce=function(e){function t(t,n,a,i){var r=e.call(this,t)||this;return r.firstRender=!0,r.itemQueue=[],r.msgQueue=xe.getInstance(),r.setStatesFn=n,r.handleErrorFn=a,r.onInitialMetadataUpdated=i,r.viewHandler.setDPR((0,_.a)()),r}return(0,s.e2)(t,e),t.prototype.clear=function(){this.itemQueue=[],this.viewHandler.clearRender()},t.prototype.render=function(e){var t,n,a=function(e,t){if(e){var n=e.rect;return t&&n.x!==t.x&&n.y!==t.y?[{rect:new f.b(t.x,n.y,n.width,n.height),layoutSize:e.layoutSize},e]:[e]}}(function(e){var t=e.layoutSize;if(t.width*t.height!=0){var n=new f.b(0,0,t.width,t.height),a=e.rect.intersect(n);return a?(0,s.q5)((0,s.q5)({},e),{rect:a,layoutSize:{width:(0,_.b)(t.width),height:(0,_.b)(t.height)}}):void 0}}(e),null===(n=this.lastItemInQueue)||void 0===n?void 0:n.rect);a&&0!==a.length&&((t=this.itemQueue).push.apply(t,(0,s.lt)([],(0,s.pM)(a),!1)),this.updateMetadata(e.triggerType),this.itemQueue.length===a.length&&this.doRender(a[0]),this.internalRender())},t.prototype.updateMetadata=function(e){var t=this;if(this.lastItemInQueue){var n=this.lastItemInQueue,a=n.rect,i=n.layoutSize,r=n.rotation,o=f.b.create(a);this.msgQueue.add({target:this.viewHandler.setRenderingMetadata,args:[o.scale((0,_.a)()),i,r],onsuccess:function(){var n;"Init"===e&&(null===(n=t.onInitialMetadataUpdated)||void 0===n||n.call(t))},onerror:this.handleErrorFn},!0)}},t.prototype.internalRender=function(){for(;this.itemQueue.length>=2;)this.doRender(this.itemQueue[1],this.itemQueue[0]),this.itemQueue.shift()},t.prototype.doRender=function(e,t){var n=this,a=f.b.create(e.rect),i="Scroll"===e.triggerType,r=void 0;if(i&&t){var o=t.rect,s=a.intersect(o);if(s)if(a.y!==o.y){var c=a.y<o.y;r=c?j.Up:j.Down,a.height-=s.height,a.y=c?a.y:o.y+o.height}else if(a.x!==o.x){var d=a.x<o.x;r=d?j.Left:j.Right,a.width-=s.width,a.x=d?a.x:o.x+o.width}}a.scale((0,_.a)()),v.a.verbose("PdfRenderService","Rect to render: ".concat(a.toString(),", in layout(").concat(e.layoutSize.width,", ").concat(e.layoutSize.height)),this.msgQueue.add({target:this.viewHandler.scrollRender,args:[a,e.layoutSize,e.rotation,i,r],onsuccess:function(t){var a,i=!1;if(t){var r=t.layoutSize,o=t.rotation;if(t&&(!r||r.width===(0,_.b)(n.metadata.layoutSize.width))&&(void 0===o||o===n.metadata.rotation)){t.triggerType=e.triggerType;var s=(0,ee.a)(t);n.firstRender?(s.firstRender=!0,n.firstRender=!1):s.originRelativeToDoc=s.origin,n.setStatesFn(s),i=!0}}null===(a=e.onCompleted)||void 0===a||a.call(e,i)},onerror:function(t){var a;e.onError?e.onError(t):null===(a=n.handleErrorFn)||void 0===a||a.call(n,t)}})},Object.defineProperty(t.prototype,"lastItemInQueue",{get:function(){return this.itemQueue.length>=1?this.itemQueue[this.itemQueue.length-1]:void 0},enumerable:!1,configurable:!0}),t}(te.a),Oe=function(e){function t(t){return e.call(this,t)||this}return(0,s.e2)(t,e),t.prototype.onNotification=function(e){var t,n;return(0,s.yv)(this,void 0,void 0,function(){var a,i,r,o;return(0,s.SO)(this,function(s){switch(s.label){case 0:switch(e.name){case 11:return[3,1];case 12:return[3,4]}return[3,5];case 1:return a=e.payload,i=a.totalResultCount,r=a.isFinalResult,0!==i?[3,3]:[4,this.stopSearch()];case 2:s.sent(),s.label=3;case 3:return null===(t=this.callbacks)||void 0===t||t.onTotalResultUpdate(i,r),[3,6];case 4:return o=e.payload,null===(n=this.callbacks)||void 0===n||n.onHitIndexUpdate(o),[3,6];case 5:return[3,6];case 6:return[2]}})})},t.prototype.startSearch=function(e,t,n,a){return(0,s.yv)(this,void 0,void 0,function(){return(0,s.SO)(this,function(i){switch(i.label){case 0:return a&&(this.callbacks=a),[4,this.viewHandler.startSearch(e,t,n)];case 1:return i.sent(),[2]}})})},t.prototype.goToNextSearchResult=function(e){return(0,s.yv)(this,void 0,void 0,function(){return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,this.viewHandler.goToNextSearchResult(e)];case 1:return t.sent(),[2]}})})},t.prototype.stopSearch=function(){return(0,s.yv)(this,void 0,void 0,function(){return(0,s.SO)(this,function(e){switch(e.label){case 0:return[4,this.viewHandler.stopSearch()];case 1:return e.sent(),[2]}})})},t}(te.a),we=n(430),Ee=function(){function e(){}return e.computeNewScale=function(e,t){var n=3*this.normalizeDelta(e),a=Math.pow(1.1,Math.ceil(Math.abs(n)));return we.a.normalizeScale(n>=0?t*a:t/a,2)},e.normalizeDelta=function(e){var t=e.deltaX,n=e.deltaY,a=Math.atan2(n,t),i=-45*Math.PI/180,r=135*Math.PI/180,o=Math.sqrt(t*t+n*n);switch(i<a&&a<r&&(o=-o),e.deltaMode){case WheelEvent.DOM_DELTA_PIXEL:return o/900;case WheelEvent.DOM_DELTA_LINE:return o/30;default:return o}},e}(),Ae=function(e,t,n){return(e-1)*(t-n)},Le=function(e){function t(t,n,a,i,r,o,s){var c=e.call(this,t)||this;return c.unfinishedZoomingList=[],c.throttledWheelZoom=m()(function(e){var t=Ee.computeNewScale(e,c.metadata.scale);c.isValidScale(t)&&(c.curZoomOpt=void 0,c.blurZoom(t),c.debouncedRender())},100),c.debouncedRender=Z()(function(){c.render()},200),c.blurZoom=function(e,t){var n;if(!c.isValidScale(e))return!1;c.dispatchEventFn(G.e.ZoomStart),c.lastZoomSnapshot||c.refreshLastZoomSnapshot();var a=c.layoutManager.rootRect;t?c.metadata.layoutSize.width*e<=a.getClientWidth()&&(t.x=a.getClientWidth()/2):t=new f.a(a.getClientWidth()/2,a.getClientHeight()/2),v.a.verbose("PdfZoomService","newScale: ".concat(e,", anchor: (").concat(t.x,", ").concat(t.y,")"));var i=new f.a(a.getScrollLeft(),a.getScrollTop()),r=c.getViewportScrollVector(i,e/c.metadata.scale,t),o=c.lastZoomSnapshot,s=o.scale,d=o.visibleDocumentOrigin,l=e/(c.blurred?s:c.metadata.scale),u=c.getScaledVisibleDocumentOrigin(c.blurred?d:c.getCurrentVisibleDocumentOrigin(),l,t);c.scale=e,c.layoutManager.resetContentSize(),c.layoutManager.scrollPosition=new f.a(c.layoutManager.isDocumentWiderThanViewport()?Math.min(r.x,c.metadata.layoutSize.width-a.getClientWidth()):0,c.layoutManager.isDocumentHigherThanViewport()?Math.min(r.y,c.metadata.layoutSize.height-a.getClientHeight()):0);var p=Math.abs(i.x-a.getScrollLeft())<1&&(Math.abs(i.y-a.getScrollTop())<1||c.metadata.layoutSize.height<=a.getClientHeight());return c.triggerBlurDraw(u,l,p),c.blurred=!0,p||null===(n=c.preventScrollFn)||void 0===n||n.call(c),!0},c.render=function(){var e;c.unfinishedZoomingList.length>0&&c.unfinishedZoomingList[c.unfinishedZoomingList.length-1]===c.metadata.scale||((null===(e=c.lastZoomSnapshot)||void 0===e?void 0:e.scale)!==c.metadata.scale||0!==c.unfinishedZoomingList.length?(c.unfinishedZoomingList.push(c.metadata.scale),requestAnimationFrame(function(){var e={scale:c.metadata.scale,visibleDocumentOrigin:c.getCurrentVisibleDocumentOrigin()};c.renderFn("Zoom").then(function(t){var n=c.unfinishedZoomingList.findIndex(function(t){return t===e.scale});c.unfinishedZoomingList.splice(n,1),0===c.unfinishedZoomingList.length&&c.dispatchEventFn(G.e.ZoomEnd),t&&(c.blurred=!1,c.refreshLastZoomSnapshot(e))})})):c.dispatchEventFn(G.e.ZoomEnd))},c.layoutManager=n,c.renderFn=a,c.setStatesFn=i,c.dispatchEventFn=r,c.preventScrollFn=o,c.onScaleUpdated=s,we.a.setMinMaxScale(c.minScale,c.maxScale),c}return(0,s.e2)(t,e),t.prototype.initScale=function(e){void 0===e&&(e=G.i.FitSize),this.updateZoomOpt(e),this.scale=this.getZoomScale(e)},t.prototype.isResponsiveZoomValid=function(){return!!this.curZoomOpt&&this.isValidScale(this.curZoomOpt)},t.prototype.responsiveZoom=function(e){if(!this.curZoomOpt)return!1;if(e){var t=this.getZoomScale(this.curZoomOpt);return!!this.isValidScale(t)&&(this.scale=t,!0)}return this.zoom(this.curZoomOpt)},t.prototype.zoom=function(e,t){var n=this.getZoomScale(e);if(!this.isValidScale(n))return!1;this.updateZoomOpt(e);var a=this.blurZoom(n,t);return this.debouncedRender(),a},t.prototype.wheelZoom=function(e){this.throttledWheelZoom(e)},t.prototype.isValidScale=function(e){var t=this.getZoomScale(e);return t>=this.minScale&&t<=this.maxScale&&t!==this.metadata.scale},Object.defineProperty(t.prototype,"minScale",{get:function(){return Math.min(z.z,this.getZoomScale(G.i.FitWidth),this.getZoomScale(G.i.FitSize))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScale",{get:function(){return Math.max(z.y,this.getZoomScale(G.i.FitWidth),this.getZoomScale(G.i.FitSize))},enumerable:!1,configurable:!0}),t.prototype.getZoomOpt=function(){return this.curZoomOpt},Object.defineProperty(t.prototype,"scale",{set:function(e){var t;this.metadata.scale=e,null===(t=this.onScaleUpdated)||void 0===t||t.call(this,e,this.curZoomOpt)},enumerable:!1,configurable:!0}),t.prototype.refreshLastZoomSnapshot=function(e){this.lastZoomSnapshot=e||{scale:this.metadata.scale,visibleDocumentOrigin:this.getCurrentVisibleDocumentOrigin()}},t.prototype.updateZoomOpt=function(e){this.curZoomOpt="number"==typeof e?void 0:e},t.prototype.getZoomScale=function(e){var t=this.convertScaleToNumber(e);return we.a.normalizeScale(t,2)},t.prototype.convertScaleToNumber=function(e){var t;if("number"==typeof e)return e;var n=this.layoutManager.rootRect,a=this.metadata.scale;if(e===G.i.FitWidth)return(n.getClientWidth()-10)/(this.metadata.layoutSize.width/a);var i=(null===(t=this.layoutManager.pageManager)||void 0===t?void 0:t.getCurrentPage())||0,r=this.metadata.pageSizes[i],o=r.width,s=r.height,c=(n.getClientHeight()+20)/(s/a),d=(n.getClientWidth()-10)/(o/a+2*z.l);return Math.min(c,d)},t.prototype.getViewportScrollVector=function(e,t,n){var a=new f.a(this.layoutManager.documentLeftToViewport,0),i=(a.y+e.y)*(t-1)+Ae(t,n.y,a.y),r=Math.max(0,e.y+i),o=Ae(t,n.x,a.x),s=o>a.x?o-a.x:e.x;return new f.a(s,r)},t.prototype.triggerBlurDraw=function(e,t,n){var a=this,i=this.getCurrentVisibleDocumentOrigin(),r=n?new f.a(0,0):new f.a(e.x-i.x,e.y-i.y);requestAnimationFrame(function(){a.setStatesFn({prevOrigin:r,ratio:t})})},t.prototype.getScaledVisibleDocumentOrigin=function(e,t,n){return new f.a(e.x-Ae(t,n.x,e.x),e.y-Ae(t,n.y,e.y))},t.prototype.getCurrentVisibleDocumentOrigin=function(){return new f.a(this.layoutManager.visibleDocumentLeftToViewport,0)},t}(te.a),ke=function(){function e(){this.element=document.body}return e.prototype.initialize=function(e){this.element=e},e.prototype.setWidth=function(e){var t=this;requestAnimationFrame(function(){t.element.style.width="".concat(e,"px")})},e.prototype.getClientWidth=function(){return this.element.clientWidth},e.prototype.getWidth=function(){return this.element.getBoundingClientRect().width},e.prototype.setHeight=function(e){var t=this;requestAnimationFrame(function(){t.element.style.height="".concat(e,"px")})},e.prototype.getClientHeight=function(){return this.element.clientHeight},e.prototype.getHeight=function(){return this.element.getBoundingClientRect().height},e.prototype.setSize=function(e,t){this.setHeight(t),this.setWidth(e)},e.prototype.setScrollLeft=function(e){var t=this;requestAnimationFrame(function(){t.element.scrollLeft=e,t.element===document.body&&(document.documentElement.scrollLeft=e)})},e.prototype.getScrollLeft=function(){return Math.round(this.element.scrollLeft)||0},e.prototype.setScrollTop=function(e){var t=this;requestAnimationFrame(function(){t.element.scrollTop=e,t.element===document.body&&(document.documentElement.scrollTop=e)})},e.prototype.getScrollTop=function(){return Math.round(this.element.scrollTop)||0},e.prototype.setScrollLocation=function(e){this.setScrollLeft(e.x),this.setScrollTop(e.y)},Object.defineProperty(e.prototype,"x",{get:function(){return this.element.getBoundingClientRect().x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.element.getBoundingClientRect().y},enumerable:!1,configurable:!0}),e}(),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.e2)(t,e),t.prototype.setScrollLeft=function(t){this.scrollLeft=t,e.prototype.setScrollLeft.call(this,this.scrollLeft)},t.prototype.getScrollLeft=function(){return void 0===this.scrollLeft&&(this.scrollLeft=e.prototype.getScrollLeft.call(this)),this.scrollLeft},t.prototype.setScrollTop=function(t){this.scrollTop=t,e.prototype.setScrollTop.call(this,this.scrollTop)},t.prototype.getScrollTop=function(){return void 0===this.scrollTop&&(this.scrollTop=e.prototype.getScrollTop.call(this)),this.scrollTop},t.prototype.clear=function(){this.scrollTop=void 0,this.scrollLeft=void 0},t.prototype.reset=function(){this.setScrollTop(0),this.setScrollLeft(0),this.clear()},t}(ke),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.e2)(t,e),t.prototype.setWidth=function(t){var n,a=(null===(n=this.element.parentElement)||void 0===n?void 0:n.clientWidth)||0;this.width=t>a?t:a,e.prototype.setWidth.call(this,this.width)},t.prototype.getWidth=function(){return void 0===this.width&&(this.width=e.prototype.getWidth.call(this)),this.width},t.prototype.setHeight=function(t){this.height=t,e.prototype.setHeight.call(this,t)},t.prototype.getHeight=function(){return void 0===this.height&&(this.height=e.prototype.getHeight.call(this)),this.height},t.prototype.clear=function(){this.width=void 0,this.height=void 0},t.prototype.reset=function(){this.setHeight(0),this.setWidth(0),this.clear()},t}(ke),Te=function(e,t,n){return 1-(Math.max(0,t-n.y)+Math.max(0,n.y+n.height-t-e))/n.height},Ue=function(){function e(e,t){var n=this;this.isPageVisible=function(e){var t=n.getYPosOfPage(e),a=n.rootRect.getScrollTop();return t+n.metadata.pageSizes[e].height>a&&t<a+n.rootRect.getClientHeight()},this.getScaledOriginalPageRects=function(e){var t,a;void 0===e&&(e=n.metadata.scale);var i=[],r=n.metadata.originalPageSizes,o=z.i*e,c=n.metadata.originalLayoutSize.width*e,d=z.h*e;try{for(var l=(0,s.BW)(r),u=l.next();!u.done;u=l.next()){var p=u.value,m=p.width*e,_=p.height*e;i.push(new f.b((c-m)/2,d,m,_)),d+=_+o}}catch(e){t={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(t)throw t.error}}return i},this.getScaledOriginalPageRectByIndex=function(e,t){void 0===t&&(t=n.metadata.scale);var a=n.metadata.pageSizes,i=t/n.metadata.scale,r=z.i*t,o=a.slice(0,e).reduce(function(e,t){return e+t.height*i+r},z.h*t),s=a[e],c=s.width*i,d=s.height*i,l=(n.metadata.layoutSize.width-s.width)/2*i;return new f.b(l,o,c,d)},this.metadata=e,this.rootRect=t,this._currentIndex=this.getCurrentPage()}return e.prototype.getVisiblePageRects=function(){return this.getVisiblePages().map(function(e){return e.rect})},e.prototype.getAccessiblePages=function(e,t){var n;void 0===t&&(t=1);var a=this.getVisiblePages().filter(function(t){return e.includes(t.index)});if(0===a.length||0===t)return a;t=Math.abs(t);for(var i=[],r=this.metadata.pageSizes,o=this.metadata.pageCount,c=a[0].index,d=a[0].rect.y,l=c-1;l>=c-t&&!(l<0);l--){var u=r[l],p=u.width,m=u.height;d=d-this.pageGap-m,i.push({index:l,rect:new f.b(0,d,p,m)})}(n=i.reverse()).push.apply(n,(0,s.lt)([],(0,s.pM)(a),!1));var _=a[a.length-1].index;d=a[a.length-1].rect.y;for(var h=_;h<_+t&&!(h>=o-1);h++){d=d+r[h].height+this.pageGap;var b=r[h+1];p=b.width,m=b.height,i.push({index:h+1,rect:new f.b(0,d,p,m)})}return i},e.prototype.isPointInVisiblePages=function(e){var t,n,a=e.x,i=e.y,r=this.getVisiblePages(),o=-1;try{for(var c=(0,s.BW)(r),d=c.next();!d.done;d=c.next()){var l=d.value,u=l.index,f=l.rect;if(i>=f.y&&i<=f.bottom&&a>=f.x&&a<=f.right){o=u;break}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return!(o<0)},e.prototype.getPageIndexFromPointInOriginalLayout=function(e){var t,n,a=e.x,i=e.y,r=-1,o=this.metadata.originalLayoutSize.width,c=z.h;try{for(var d=(0,s.BW)(this.metadata.originalPageSizes),l=d.next();!l.done;l=d.next()){var u=l.value,p=u.width,m=u.height;r++;var _=new f.b((o-p)/2,c,p,m);if(i>=_.y&&i<=_.bottom&&a>=_.x&&a<=_.right)return r;c+=m+z.i}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return r},e.prototype.getCurrentPage=function(){var e=this.getVisiblePages();if(0===e.length)return 0;if(1===e.length)return e[0].index;var t=this.rootRect.getClientHeight(),n=this.rootRect.getScrollTop();return Te(t,n,e[0].rect)>=Te(t,n,e[1].rect)?e[0].index:e[1].index},e.prototype.getYPosOfPage=function(e){var t=this.metadata.pageCount;if(e<0||e>=t)return-1;for(var n=this.metadata.pageSizes,a=this.pageGap,i=z.h*this.metadata.scale,r=0;r<e;r++)i+=n[r].height+a;return i},e.prototype.getOriginalPageRects=function(){var e,t,n=z.h,a=[],i=this.metadata.originalLayoutSize.width;try{for(var r=(0,s.BW)(this.metadata.originalPageSizes),o=r.next();!o.done;o=r.next()){var c=o.value;a.push(new f.b((i-c.width)/2,n,c.width,c.height)),n+=c.height+z.i}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return a},e.prototype.getVisiblePages=function(){for(var e=[],t=this.metadata.pageSizes,n=this.metadata.layoutSize.width,a=this.rootRect.getScrollTop(),i=a+this.rootRect.getClientHeight(),r=z.h*this.metadata.scale,o=0;o<t.length;o++){var s=t[o],c=s.width,d=s.height;if(r<a&&r+d>a||r>=a&&r<i)e.push({index:o,rect:new f.b((n-c)/2,r,c,d)});else if(r>=i)break;r+=d+this.pageGap}return e},Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this._currentIndex},set:function(e){this._currentIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageGap",{get:function(){return z.i*this.metadata.scale},enumerable:!1,configurable:!0}),e}(),Fe=function(){function e(){var e=this;this.convertPointFromClientToOriginalDocument=function(t){var n,a=e.convertPointFromClientToDocument(t);return a.scale(1/((null===(n=e._metadata)||void 0===n?void 0:n.scale)||1)),a},this.convertPointFromOriginalDocumentToClient=function(t){var n,a=new f.a(t.x,t.y);return e.convertPointFromClientToDocument(a.scale((null===(n=e._metadata)||void 0===n?void 0:n.scale)||1),!0)},this.getDistToViewportCenter=function(t){if(e.pageManager&&e._metadata){var n=e.pageManager.getYPosOfPage(t)+e._metadata.pageSizes[t].height/2,a=e.rootRect.getScrollTop()+e.rootRect.getClientHeight()/2;return Math.abs(a-n)}},this._rootRect=new Me,this._contentRect=new Pe}return e.prototype.initialize=function(e,t,n){this._rootRect.initialize(e),this._contentRect.initialize(t),this._onScrollPositionUpdated=n},Object.defineProperty(e.prototype,"metadata",{set:function(e){this._metadata=e,this._pageManager=e?new Ue(e,this._rootRect):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollPosition",{set:function(e){var t;this.rootRect.setScrollLocation(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,e.x,e.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollLeft",{set:function(e){var t;this.rootRect.setScrollLeft(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,e,this.rootRect.getScrollTop())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollTop",{set:function(e){var t;this.rootRect.setScrollTop(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,this.rootRect.getScrollLeft(),e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentSize",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.layoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rootRect",{get:function(){return this._rootRect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageManager",{get:function(){return this._pageManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentScrollPosition",{get:function(){return new f.a(this.rootRect.getScrollLeft(),this.rootRect.getScrollTop())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.scale)||1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.rotation)||0},enumerable:!1,configurable:!0}),e.prototype.resetContentSize=function(){this.contentRect.setSize(this.documentSize.width,this.documentSize.height)},e.prototype.scrollRootByPage=function(e,t,n){var a,i;void 0===t&&(t=new f.a(0,0)),void 0===n&&(n=!1);var r=(null===(a=this._metadata)||void 0===a?void 0:a.pageCount)||0;if(e<0||e>=r)return!1;var o=null===(i=this.pageManager)||void 0===i?void 0:i.getYPosOfPage(e);if(void 0===o)return!1;var s=new f.a(t.x,o+t.y),c=this.rootRect;return(!n||s.y<c.getScrollTop()||s.y>c.getScrollTop()+c.getClientHeight())&&(this.scrollTop=s.y),(!n||0!==c.getScrollLeft()&&0!==s.x&&(s.x<c.getScrollLeft()||s.x>c.getScrollLeft()+c.getClientWidth()))&&(this.scrollLeft=s.x),!0},e.prototype.convertPointFromClientToDocument=function(e,t){void 0===t&&(t=!1);var n=t?1:-1,a=new f.a(n*+this.rootRect.x,n*+this.rootRect.y);return this.convertPointFromViewportToDocument(e.plus(a),t)},e.prototype.isDocumentWiderThanViewport=function(){return this.documentSize.width>this.rootRect.getClientWidth()},e.prototype.isDocumentHigherThanViewport=function(){return this.documentSize.height>this.rootRect.getClientHeight()},Object.defineProperty(e.prototype,"viewportRectRelativeToContent",{get:function(){return new f.b(this.rootRect.getScrollLeft(),this.rootRect.getScrollTop(),this.rootRect.getClientWidth(),this.rootRect.getClientHeight())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportRectRelativeToDocument",{get:function(){var e=this.convertPointFromViewportToDocument(new f.a(0,0));return new f.b(e.x,e.y,this.rootRect.getClientWidth(),this.rootRect.getClientHeight())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentRectRelativeToContent",{get:function(){return new f.b(this.visibleDocumentLeftToContent,this.rootRect.getScrollTop(),this.visibleDocumentWidth,this.visibleDocumentHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentWidth",{get:function(){return this.isDocumentWiderThanViewport()?this.rootRect.getClientWidth():this.documentSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentHeight",{get:function(){return this.rootRect.getClientHeight()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentLeftToContent",{get:function(){return this.isDocumentWiderThanViewport()?this.rootRect.getScrollLeft():(this.rootRect.getClientWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentLeftToViewport",{get:function(){return this.isDocumentWiderThanViewport()?0:(this.rootRect.getClientWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentLeftToViewport",{get:function(){return(this.contentRect.getWidth()-this.documentSize.width)/2-this.rootRect.getScrollLeft()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentLeftToContent",{get:function(){return this.documentSize.width>this.contentRect.getWidth()?0:(this.contentRect.getWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),e.prototype.getDocumentInitialScrollLeft=function(){return(this.contentRect.getWidth()-this.rootRect.getClientWidth())/2},e.prototype.convertPointFromViewportToDocument=function(e,t){void 0===t&&(t=!1);var n=t?-1:1,a=new f.a(n*this.rootRect.getScrollLeft(),n*this.rootRect.getScrollTop()).plus(this.contentOffsetFromDocument.scale(n));return e.plus(a)},Object.defineProperty(e.prototype,"contentOffsetFromDocument",{get:function(){return new f.a(this.isDocumentWiderThanViewport()?0:(this.documentSize.width-this.rootRect.getClientWidth())/2,0)},enumerable:!1,configurable:!0}),e}(),He=n(145),Re=n(417),Ne=n(469),Be=n(431),je=n(202),Ve=n(425),ze=n(419),Ge=n(452),Ke=n(200),We="DisplayHelper",qe=function(e){return e instanceof DOMException&&"QuotaExceededError"===e.name},Qe=function(){try{var e=window.localStorage.getItem(z.e);return e?JSON.parse(e):[]}catch(e){return v.a.error(We,e),[]}},Ye=function(e){window.localStorage.setItem(z.e,JSON.stringify(e))},Je=function(){function e(e,t,n,a,i){var r=this;this.storeInfoInLocalStorage=function(e){if(r.shouldCacheDisplayInfo&&r.uniqueId)try{var t={uniqueId:r.uniqueId,pos:e.pos,scale:e.scale,rotation:e.rotation},n=Qe(),a=n.findIndex(function(e){return e.uniqueId===r.uniqueId});-1!==a&&n.splice(a,1),n.unshift(t),n.length>30&&n.pop();try{Ye(n)}catch(e){!function(e,t){qe(e)?t.length>0&&(t.pop(),function(e){var t=1,n=function(e){try{Ye(e)}catch(a){if(qe(a)&&t<3){if(e.pop(),0===e.length)return;t++,n(e)}else v.a.error(We,a)}};n(e)}(t)):v.a.error(We,e)}(e,Qe())}}catch(e){v.a.error(We,e)}},this.applyInfoInLocalStorage=function(){if(r.shouldUseCachedGlobalZoomOption&&r.applyGlobalZoomOptFromLocalStorage(),r.shouldCacheDisplayInfo&&r.uniqueId)try{var e=Qe(),t=e.findIndex(function(e){return e.uniqueId===r.uniqueId});if(-1!==t){var n=e[t],a=n.pos,i=n.scale,o=n.rotation;void 0!==a&&void 0!==i&&void 0!==o&&(r.renderInfo={pos:a,scale:i,rotation:o})}}catch(e){v.a.error(We,e)}},this.uniqueId=t,this.layoutManager=e,this.defaultPageNumber=a,this.shouldCacheDisplayInfo=!(a||i)&&n,this.shouldUseCachedGlobalZoomOption=!g.a.isActivated("StoreZoomOptionInLocalStorage")&&!i&&n,this.renderInfo={scale:i}}return e.prototype.storeGlobalZoomOptInLocalStorage=function(e){if(this.shouldUseCachedGlobalZoomOption)try{localStorage.setItem(z.u,e.toString())}catch(e){v.a.error(We,e)}},Object.defineProperty(e.prototype,"initialRenderOptions",{get:function(){return this.renderInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initialPos",{get:function(){var e;if(this.renderInfo.pos)return this.renderInfo.pos;var t=this.layoutManager.getDocumentInitialScrollLeft(),n=(null===(e=this.layoutManager.pageManager)||void 0===e?void 0:e.getYPosOfPage(this.defaultPageNumber?this.defaultPageNumber-1:0))||0;return new f.a(t,n)},enumerable:!1,configurable:!0}),e.prototype.applyGlobalZoomOptFromLocalStorage=function(){try{var e=localStorage.getItem(z.u);e!==G.i.FitSize&&e!==G.i.FitWidth||(this.renderInfo.scale=e)}catch(e){v.a.error(We,e)}},e}(),Xe=n("fui.util_939");(0,Xe.ZW)([{rawString:".pdfOuter_526606d6{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%}.pdfViewer_526606d6{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0;overflow:auto;width:100%;height:100%;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.pdfContent_526606d6{position:relative;overflow:hidden;min-width:100%;min-height:100%}.fitWidth_526606d6{max-width:100%;min-width:unset}.fillSize_526606d6{width:100%;height:100%}.hidden_526606d6{visibility:hidden}"}]);const Ze="pdfOuter_526606d6";var $e=n(85),et=n(215);(0,Xe.ZW)([{rawString:".root_26f9d840{width:100%;height:100%}.link_26f9d840{position:absolute}.link_26f9d840 a{display:inline-block;width:100%;height:100%;vertical-align:top}.link_26f9d840 a:hover{background-color:rgba(255,255,0,.2)}"}]);var tt="_blank",nt=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"".concat(e.x,"px"),top:"".concat(e.y,"px")}},at=function(e){e.stopPropagation()},it=V.memo(function(e){var t=e.pageIndex,n=e.originalPageSize,a=e.scale,i=e.rotation,r=e.getLinkInfosFn,o=e.goToPageFn,c=e.toggleGripperFn,d=(0,s.pM)(V.useState(),2),u=d[0],p=d[1],m=(0,Re.d)().getPageTabIndex,_=V.useCallback(function(e){null==c||c(!1),e.stopPropagation()},[c]);V.useEffect(function(){var e=!0;return null==r||r(t,!0).then(function(n){if(e){var a=[];null==n||n.forEach(function(e,n){var i=e.type,r=e.rect,o=e.text,s=e.url,c=e.targetPageIndex,d=e.targetOffset,l=function(e,t){return"Link-".concat(e,"-").concat(t)}(t,n);a.push({id:l,rect:f.b.create(r),text:o,href:1===i&&s?s:"",displayTarget:1===i?tt:void 0,docTargetInfo:0===i?{pageIndex:void 0!==c?c:-1,offset:d&&new f.a(d.x,d.y)}:void 0})}),p(a)}}).catch(function(){v.a.warn("VirtualLinks","Fail to get link infos")}),function(){e=!1}},[t,r]);var h=V.useCallback(function(e){var t=e.pageIndex,n=e.offset;null==o||o(t,n)},[o]),b=V.useCallback(function(e,t){e.stopPropagation(),t&&"Enter"===e.key&&(e.preventDefault(),h(t))},[h]),g=V.useCallback(function(e,t){e.stopPropagation(),t&&(e.preventDefault(),h(t))},[h]),y=V.useCallback(function(e){l.a.read(e)},[]),S=V.useMemo(function(){var e=[];return null==u||u.forEach(function(t){var r=t.rect,o=t.docTargetInfo;e.push((0,s.q5)((0,s.q5)({},t),{rect:(0,$.c)(r.origin,n,a,i,r.size),docTargetInfo:o&&{pageIndex:o.pageIndex,offset:o.offset&&(0,$.c)(o.offset,n,a,i).origin}}))}),e},[u,n,i,a]);return V.createElement("div",{className:"root_26f9d840"},S.map(function(e){var n=e.id,a=e.rect,i=e.text,r=e.href,o=e.displayTarget,s=e.docTargetInfo;return V.createElement("div",{key:n,className:"link_26f9d840",style:nt(a)},V.createElement("a",{tabIndex:m(t),href:r,target:o,rel:o===tt?"noopener noreferrer":void 0,onPointerDown:_,onPointerMove:at,onKeyDown:function(e){b(e,s)},onClick:function(e){g(e,s)},onFocus:function(){y(i)}}))}))}),rt=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),top:"".concat(e.y,"px")}},ot=function(e){return void 0===e||e===G.a.None},st=function(){return!g.a.isActivated("EnableCJKInFormTextField")},ct=V.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(27)]).then(n.bind(n,805)).then(function(e){return{default:e.VirtualAnnots}})}),dt=function(e){return V.createElement(V.Suspense,{fallback:V.createElement("div",null)},V.createElement(ct,(0,s.q5)({},e)))},lt=V.lazy(function(){return n.e(26).then(n.bind(n,806)).then(function(e){return{default:e.VirtualFormOverlay}})}),ut=V.memo(V.forwardRef(function(e,t){var n=e.scale,a=e.rotation,i=e.mode,r=e.getPageTextFn,o=e.getLinkInfosFn,c=e.goToPageFn,d=e.toggleGripperFn,u=(0,ze.d)(),f=(0,Re.c)().ariaHidden,p=V.useMemo(function(){return a%2==0},[a]),m=(0,s.pM)(V.useState(),2),_=m[0],h=m[1],b=(0,s.pM)(V.useState([]),2),v=b[0],y=b[1],S=(0,je.c)().enableFreeText,D=(0,Ke.b)(),I=D.eventBus,x=D.pageManager,C=(0,Be.b)(),O=C.enableFormFilling,w=C.formHandler,E=V.useRef([]),A=V.useRef([]),L=V.useRef([]),k=V.useMemo(function(){return ot(i)||S&&i===G.a.FreeText},[S,i]),M=V.useCallback(function(e){return function(t){E.current[e]=t}},[]),P=V.useCallback(function(e){return function(t){A.current[e]=t}},[]),T=V.useCallback(function(e){return function(t){L.current[e]=t}},[]),U=V.useCallback(function(e,t){if(t&&0!==t.length){var n=t.map(function(t){var n=t.index;return g.a.isActivated("EnableCalculateTabIndexForPages")||e?{index:n,tabIndex:f?-1:0}:{index:n,tabIndex:f||n!==(null==x?void 0:x.getCurrentPage())?-1:0}});y(n)}},[f,x]);V.useEffect(function(){var e=function(e){var t=null==x?void 0:x.getAccessiblePages(e);h(t),U(!1,t)};return I.on(G.e.VisiblePagesLoaded,e),function(){I.off(G.e.VisiblePagesLoaded,e)}},[I,x,U]);var F=V.useCallback(function(e){return(0,s.yv)(void 0,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return[4,null==r?void 0:r(e)];case 1:return t=a.sent(),l.a.read(t||""),st()?[4,null===(n=L.current[e])||void 0===n?void 0:n.setHasFormOnPage()]:[3,3];case 2:return a.sent(),[3,5];case 3:return[4,null==w?void 0:w.onFocusFormOverlay(e)];case 4:a.sent(),a.label=5;case 5:return[2]}})})},[w,r]),H=V.useCallback(function(){return(0,s.yv)(void 0,void 0,void 0,function(){return(0,s.SO)(this,function(e){switch(e.label){case 0:return st()?[3,2]:[4,null==w?void 0:w.killFormFocus()];case 1:e.sent(),e.label=2;case 2:return[2]}})})},[w]);V.useImperativeHandle(t,function(){return{focusOnVirtualForwardForm:function(e){st()?L.current[e].focusOnVirtualForwardForm():A.current[e].focus()},focusOnVirtualBackwardForm:function(e){var t;null===(t=E.current)||void 0===t||t[e].focus()}}});var R=V.useCallback(function(e){var t=v.find(function(t){return t.index===e});return t?t.tabIndex:-1},[v]);return V.createElement(Re.b,{getPageTabIndex:R},V.createElement("div",{onFocus:function(){return U(!0,_)},onBlur:function(){return U(!1,_)}},null==_?void 0:_.map(function(e){var t=e.index,r=e.rect;return V.createElement("div",{key:t,ref:M(t),className:et.c,style:rt(r),tabIndex:R(t),"aria-label":u.get("currentPageNumberAria",[t+1])},V.createElement("div",{className:et.b,tabIndex:R(t),role:"paragraph",onFocus:function(){F(t)},onBlur:H}),O&&!st()&&V.createElement("div",{ref:P(t),className:"vform",tabIndex:R(t)}),O&&st()&&V.createElement(V.Suspense,{fallback:V.createElement("div",null)},V.createElement(lt,{ref:T(t),index:t,scale:n,pageRect:r,rotation:a})),ot(i)&&V.createElement(it,{pageIndex:t,originalPageSize:{width:(p?r.width:r.height)/n,height:(p?r.height:r.width)/n},scale:n,rotation:a,getLinkInfosFn:o,goToPageFn:c,toggleGripperFn:d}),k&&V.createElement(dt,{pageIndex:t,originalPageWidth:(p?r.width:r.height)/n,originalPageHeight:(p?r.height:r.width)/n,scale:n,rotation:a,mode:i}))})))})),ft=n(432),pt=n(453),mt=n(216),_t=V.lazy(function(){return n.e(30).then(n.bind(n,807)).then(function(e){return{default:e.GripperContainer}})}),ht=V.lazy(function(){return n.e(30).then(n.bind(n,756)).then(function(e){return{default:e.ContextMenu}})}),bt=V.memo(V.forwardRef(function(e,t){var n=e.showForGripper,a=e.rotation,i=e.gripperPos,r=e.enableCopilot,o=e.onRequestCopilot,c=(0,s.pM)(V.useState({text:"",position:void 0}),2),d=c[0],l=c[1],u=(0,s.pM)(V.useState(!1),2),f=u[0],p=u[1];return V.useImperativeHandle(t,function(){return{updateContextualMenuForMouse:function(e,t){l({text:e,position:t}),p(!0)}}}),V.createElement(V.Fragment,null,n&&V.createElement(V.Suspense,{fallback:V.createElement("div",null)},V.createElement(_t,{rotation:a,gripperPos:i,enableCopilot:r,onRequestCopilot:o})),!g.a.isActivated("EnableContextMenuForSelection")&&!n&&f&&V.createElement(V.Suspense,{fallback:V.createElement("div",null)},V.createElement(ht,{text:d.text,position:d.position,enableCopilot:r,onRequestCopilot:o,onFocusPdfViewer:e.onFocusPdfViewer})))}));bt.displayName="ContextMenuContainer";var gt=n(199);(0,Xe.ZW)([{rawString:".root_d3fbf39d{width:100%}.page_d3fbf39d{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);-webkit-box-shadow:0 .3px .9px 0 rgba(0,0,0,.1),0 1.6px 3.6px 0 rgba(0,0,0,.13);box-shadow:0 .3px .9px 0 rgba(0,0,0,.1),0 1.6px 3.6px 0 rgba(0,0,0,.13)}.page_d3fbf39d .childWrapper_d3fbf39d{width:100%;height:100%}"}]);var vt="PreRenderImgs",yt=function(e){var t=e.renderPreRenderList,n=function(e){var t=e.visiblePages,n=e.pageCount,a=e.rotation,i=e.renderTargetPageRectByIndex,r=e.getPageSize,o=e.getPredictedMemUsage,c=e.getDistToViewportCenter,d=e.isPageVisible,l=(0,s.pM)(V.useState({}),2),u=l[0],p=l[1],m=V.useRef({}),_=(0,gt.e)(t),b=function(){var e=(0,s.pM)(V.useState(!1),2),t=e[0],n=e[1],a=(0,Ke.b)().eventBus;return V.useEffect(function(){var e=function(){n(!0)};return a.on(G.e.InitialDisplayInfoApplied,e),function(){a.off(G.e.InitialDisplayInfoApplied,e)}},[a]),t}(),g=(0,gt.e)(b),y=V.useRef([]),D=V.useRef(0),I=V.useRef(xe.getInstance()),x=(0,gt.a)(function(e){var t,n=m.current[e];n&&(null===(t=n.dispose)||void 0===t||t.call(n),delete m.current[e])}),C=(0,gt.a)(function(e){var t,n;try{for(var a=(0,s.BW)(e),i=a.next();!i.done;i=a.next()){var r=i.value;x(r)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}p(function(t){var n,a,i={};try{for(var r=(0,s.BW)(Object.entries(t)),o=r.next();!o.done;o=r.next()){var c=(0,s.pM)(o.value,2),d=c[0],l=c[1];e.includes(d)||(i[d]=l)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=r.return)&&a.call(r)}finally{if(n)throw n.error}}return v.a.verbose(vt,"removeInvalidatedPagesFromCache, pages=".concat(JSON.stringify(e)," | setCachedImgMap to ").concat(JSON.stringify(Object.keys(i)))),i})}),O=function(e){var t=(0,s.pM)(V.useState(!1),2),n=t[0],a=t[1],i=(0,Ke.b)(),r=i.eventBus,o=i.pageManager,c=V.useRef(!1),d=V.useRef([]);return V.useEffect(function(){var e=function(){c.current=!0},t=function(e){var t=e.left,n=e.top;if(c.current&&o){c.current=!1;var a=o.getPageIndexFromPointInOriginalLayout(new f.a(t,n)),i="".concat(a);d.current.includes(i)||d.current.push(i)}};return r.on(G.e.DocumentDirty,e),r.on(G.e.InvalidateRect,t),function(){r.off(G.e.DocumentDirty,e),r.off(G.e.InvalidateRect,t)}},[r,o]),V.useEffect(function(){var t=function(){0!==d.current.length&&(e(d.current),a(!0),d.current=[])};return r.on(G.e.Scrolling,t),function(){r.off(G.e.Scrolling,t)}},[r,e]),{isInvalidateRendering:n,setIsInvalidateRendering:a}}(C),w=O.isInvalidateRendering,E=O.setIsInvalidateRendering,A=(0,gt.a)(function(e,t){return(0,s.yv)(void 0,void 0,void 0,function(){var n,i;return(0,s.SO)(this,function(r){return t?(n=document.createElement("canvas"),i=n.getContext("2d"),n.width=t.width,n.height=t.height,null==i||i.putImageData(t,0,0),v.a.verbose(vt,"completed for ".concat(e)),[2,new Promise(function(t,i){try{n.toBlob(function(n){if(n){var r=URL.createObjectURL(n),o="".concat(e);m.current[o]={usedMemory:n.size,rotation:a,dispose:function(){URL.revokeObjectURL(r)}},p(function(e){var t,n,a,i,c,d={};try{for(var l=(0,s.BW)(Object.entries(e)),u=l.next();!u.done;u=l.next()){var f=(0,s.pM)(u.value,2),p=f[0],_=f[1];d[p]=_}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return d[o]=(a=r,i={width:"100%",height:"100%"},!(c=function(){return void 0!==m.current[o]})||c()?V.createElement("img",{src:a,style:i}):V.createElement(V.Fragment,null)),d}),t()}else i(new h.c(h.b.PreRenderError,"canvas.toBlob returns null"))})}catch(e){i(new h.c(h.b.PreRenderError,"Fail in canvas.toBlob: ".concat(e)))}})]):[2]})})}),L=V.useCallback(function(){return Object.keys(m.current).map(function(e){return parseInt(e)})},[]),k=V.useCallback(function(){var e,t=-1;return L().forEach(function(n){var a=null==c?void 0:c(n);void 0!==a&&(void 0===e||a>e)&&(e=a,t=n)}),{maxDTV:e,indexWithMaxDTV:"".concat(t)}},[L,c]),M=V.useCallback(function(){var e=D.current=D.current+1,a=(0,s.pM)([Math.max.apply(Math,(0,s.lt)([],(0,s.pM)(t),!1))+e,Math.min.apply(Math,(0,s.lt)([],(0,s.pM)(t),!1))-e],2),i=a[0],r=a[1];i<n&&y.current.push(i),r>=0&&y.current.push(r)},[n,t]),P=(0,gt.a)(function(e){return(0,s.yv)(void 0,void 0,void 0,function(){var t,n,a,r,l,u;return(0,s.SO)(this,function(f){return t=Object.values(m.current).map(function(e){return e.usedMemory}).reduce(function(e,t){return e+t},0),n=o(e)||0,v.a.verbose(vt,"tryRenderTargetPage ".concat(e,", usedMemMap=").concat(JSON.stringify(m.current),", predictedIncomingMemUsage=").concat(n)),t+n<10485760?(y.current.shift(),[2,new Promise(function(t,n){I.current.setPreRenderTask({target:i,args:[e],isPageVisible:function(){return(null==d?void 0:d(e))||!1},onsuccess:function(n){A(e,n).catch(function(e){v.a.error(vt,e)}).finally(function(){t(!0)})},onerror:function(){var t="Failed to prerender page ".concat(e);v.a.error(vt,new Error(t)),n(t)},oncancel:function(){v.a.verbose(vt,"cancel pre-render for ".concat(e)),t(!1)}})})]):(a=null==c?void 0:c(e),r=k(),l=r.maxDTV,u=r.indexWithMaxDTV,void 0!==a&&void 0!==l&&a<l?(x(u),p(function(e){var t,n,a={};try{for(var i=(0,s.BW)(Object.entries(e)),r=i.next();!r.done;r=i.next()){var o=(0,s.pM)(r.value,2),c=o[0],d=o[1];c!==u&&(a[c]=d)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return v.a.verbose(vt,"setCachedImgMap - ".concat(JSON.stringify(Object.keys(a)))),a}),[2,P(e)]):(y.current=[],D.current=0,[2,!1]))})})}),T=(0,gt.a)(function(){if(0===y.current.length&&(M(),0===y.current.length))return Promise.resolve(!1);var e=y.current[0];return L().includes(e)?(v.a.verbose(vt,"doRender return, page ".concat(e," hits the cache")),y.current.shift(),Promise.resolve(!0)):P(e)}),U=(0,gt.a)(function(e){return(0,s.yv)(void 0,void 0,void 0,function(){return(0,s.SO)(this,function(t){return e||v.a.verbose(vt,"renderInLoop"),[2,T().then(function(e){return e?U(!0):void v.a.verbose(vt,"The render loop is ended")},function(e){var t=new h.c(h.b.PreRenderError,"Exit render loop, reason: ".concat(e));S.a.logError(t.toCaughtError())})]})})});V.useEffect(function(){(w||!g&&b||0!==t.length&&JSON.stringify(t)!==JSON.stringify(_))&&b&&(y.current=t.slice(),D.current=0,I.current.cancelPreRenderTask(),v.a.verbose(vt,"isInvalidateRendering=".concat(w,", visiblePages=").concat(JSON.stringify(t),", waitingList=").concat(JSON.stringify(y.current))),U(),E(!1))},[t,_,U,w,E,b,g]),V.useEffect(function(){var e=I.current;return function(){e.cancelPreRenderTask()}},[]);var F=(0,gt.a)(function(e,t){var n,a,i={};try{for(var r=(0,s.BW)(Object.entries(u)),o=r.next();!o.done;o=r.next()){var c=(0,s.pM)(o.value,2),d=c[0],l=c[1],f=m.current[d];if(f){var _=e-f.rotation,h=_%2==0,b=t(parseInt(d)),g=b.width,v=b.height,y=(0,s.pM)(h?["100%","100%",0]:["".concat(v,"px"),"".concat(g,"px"),(v-g)/2],3),S=y[0],D=y[1],I=y[2],x={width:S,height:D,transform:"translate(".concat(-I,"px, ").concat(I,"px) rotate(").concat(_*z.A,"deg)")};i[d]=V.cloneElement(l,{style:x})}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=r.return)&&a.call(r)}finally{if(n)throw n.error}}p(i)});return V.useEffect(function(){F(a,r)},[r,F,a]),u}((0,s.dc)(e,["renderPreRenderList"]));return V.createElement(V.Fragment,null,t(function(e){return n[e]}))},St=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),top:"".concat(e.y,"px")}},Dt=V.memo(function(e){var t=e.pageInfos,n=e.metadata,a=e.curPageIndex,i=e.getScaledOriginalPageRectByIndex,r=e.getDistToViewportCenter,o=e.isPageVisible,c=(0,Ke.b)(),d=c.viewHandler,l=c.dpr,u=c.eventBus,f=c.onFirstRenderVisibleFn,p=c.enablePreRender,m=(0,s.pM)(V.useState(0),2),_=m[0],h=m[1];V.useEffect(function(){var e=function(){h(function(e){return e+1})};return u.on(G.e.DocumentReloaded,e),function(){u.off(G.e.DocumentReloaded,e)}},[u]);var b=V.useMemo(function(){var e=null==t?void 0:t.map(function(e){return e.index});return r&&e?e.sort(function(e,t){return(r(e)||0)-(r(t)||0)}):e||[]},[r,t]),v=V.useMemo(function(){var e;if(p){var i=null===(e=null==t?void 0:t.find(function(e){return e.index===a}))||void 0===e?void 0:e.rect;if(i&&void 0!==a){var r=n.pageSizes[a],o=r.width,c=r.height,d=(0,s.pM)([o/n.scale,c/n.scale],2),u=d[0],f=d[1],m=Math.min(l,3),_=Math.min(i.height/2,900)/f*m;return Math.round(_*u)/u}}},[a,l,p,n.pageSizes,n.scale,t]),y=V.useCallback(function(e){if(void 0!==v){var t=n.originalPageSizes[e],a=t.width,i=t.height;return a*v*i*v*.5}},[n.originalPageSizes,v]),S=(0,gt.a)(function(e){var t=null==i?void 0:i(e,v),a=n.layoutSize,r=a.width,o=a.height;return d&&t&&void 0!==v?d.render(t,{width:r/n.scale*v,height:o/n.scale*v}):Promise.resolve(void 0)}),D=V.useRef(!0),I=(0,gt.a)(function(e,t){var n=null==t?void 0:t(e);return!g.a.isActivated("FRTWithPrerender")&&n&&D.current&&(null==f||f(),D.current=!1),n}),x=(0,gt.d)(u),C=(0,gt.c)(u),O=(0,gt.a)(function(e){return V.createElement("div",{className:"root_d3fbf39d"},null==t?void 0:t.map(function(t){var n=t.index,a=t.rect;return V.createElement("div",{key:n,className:"page_d3fbf39d",style:(0,s.q5)((0,s.q5)({},St(a)),{backgroundColor:"#ffffff"})},V.createElement("div",{className:"childWrapper_d3fbf39d",style:{visibility:x&&!C?"hidden":"visible"}},I(n,e)))}))}),w=V.useCallback(function(e){return n.pageSizes[e]},[n.pageSizes]);return V.createElement(V.Fragment,null,p?V.createElement(yt,{key:_,renderPreRenderList:O,visiblePages:b,pageCount:n.pageCount,rotation:n.rotation,renderTargetPageRectByIndex:S,getPredictedMemUsage:y,getDistToViewportCenter:r,isPageVisible:o,getPageSize:w}):O())});(0,Xe.ZW)([{rawString:".root_4eb6d5c3{position:absolute}.root_4eb6d5c3 canvas{position:absolute;width:100%;height:100%}.canvasFixingExtraWhitePage_4eb6d5c3{left:0px}"}]);var It=function(e,t){var n;if(e.width&&e.height){var a=document.createElement("canvas");return a.width=e.width,a.height=e.height,null===(n=a.getContext("2d"))||void 0===n||n.drawImage(e,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0),a}},xt=function(e){var t=e.width,n=e.height,a=e.top,i=e.left,r=e.renderResult,o=e.blurRenderResult,s=e.getViewportRectRelativeToContentOffset,c=(0,_.a)()*t,d=(0,_.a)()*n,l=(0,Ke.b)(),u=l.eventBus,p=l.onFirstRenderVisibleFn,m=(0,gt.e)({left:i,top:a})||{left:i,top:a},h=V.useRef(null),b=V.useRef();V.useLayoutEffect(function(){if(h.current&&t*n!=0&&!o){var e=new f.a(m.left-i,m.top-a).scale((0,_.a)()),r=It(h.current,e),s=h.current.getContext("2d");null==s||s.clearRect(0,0,c,d),r&&(null==s||s.drawImage(r,0,0))}},[a,i,t,n,o,m.left,m.top,c,d]),V.useLayoutEffect(function(){var e,t=h.current;if(t){var n=t.getContext("2d");if(r){var a=r.image,i=r.originRelativeToDoc,o=r.origin;if(null===(e=q.a.features)||void 0===e?void 0:e.enableCalculateOffsetAtDrawTimeFix){var l=null==s?void 0:s();l&&(o=r.origin.plus(l))}o.scale((0,_.a)()),null==n||n.clearRect(o.x,o.y,a.width,a.height),null==n||n.drawImage(function(e){var t,n=document.createElement("canvas");return n.width=e.width,n.height=e.height,null===(t=n.getContext("2d"))||void 0===t||t.putImageData(e,0,0),n}(a),o.x,o.y),"Zoom"===r.triggerType?y.a.sessionMark("End",{rect:JSON.stringify({x:o.x*(0,_.a)(),y:o.y*(0,_.a)(),width:a.width,height:a.height})}):"Scroll"===r.triggerType&&i&&y.a.sessionMark("End",{rect:JSON.stringify({x:i.x,y:i.y,width:a.width,height:a.height})}),r.firstRender&&(null==p||p()),b.current=It(t,new f.a(0,0))}else null==n||n.clearRect(0,0,c,d)}},[d,c,r,p]);var g=(0,gt.c)(u);V.useLayoutEffect(function(){if(!g&&h.current&&b.current&&o){var e=h.current.getContext("2d");null==e||e.clearRect(0,0,c,d);var t=o.prevOrigin;t.scale((0,_.a)()).round();var n=b.current.width*(o.ratio||1);null==e||e.drawImage(b.current,0,0,b.current.width,b.current.height,t.x,t.y,n,n*b.current.height/b.current.width),y.a.sessionMark("RenderBlur")}},[o,g,d,c]);var v={width:"".concat(t,"px"),height:"".concat(n,"px"),left:"".concat(i,"px"),top:"".concat(a,"px")};return V.createElement("div",{style:v,className:"root_4eb6d5c3"},V.createElement("canvas",{width:c,height:d,ref:h,style:{visibility:g?"hidden":"visible"},className:"canvasFixingExtraWhitePage_4eb6d5c3"}))},Ct=V.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(27)]).then(n.bind(n,803)).then(function(e){return{default:e.AnnotationOverlays}})}),Ot=V.lazy(function(){return n.e(39).then(n.bind(n,804)).then(function(e){return{default:e.HighlightBoundingRegionCanvas}})}),wt=V.forwardRef(function(e,t){var n,a,i,r,o,c,d=e.enableAnnotation,l=e.visibleDocumentRect,u=e.viewportRenderResult,p=e.getViewportRectRelativeToContentOffset,m=e.viewportBlurRenderResult,_=e.curPageIndex,h=e.visiblePageInfos,b=e.metadata,v=e.annotHandler,y=e.annotParams,S=e.viewHandler,D=e.contentRef,I=e.getScaledOriginalPageRectByIndex,x=e.getDistToViewportCenter,C=e.isPageVisible,O=e.onEditStateChanged,w=e.getPageTextFn,E=e.getLinkInfosFn,A=e.goToPageFn,L=e.enableCopilot,k=e.onRequestCopilot,M=e.toggleGripperFn,P=e.renderRectFn,T=e.renderViewportFn,U=e.syncModeFn,F=e.zoomOpt,H=e.highlightCanvasRect,R=e.highlightBoundingRegions,N=e.visibleDocumentLeftOffsetRelativeToContent,B=e.onFocusPdfViewer,j=(y||{}).mode,z=(0,pt.b)(),K=z.editState,W=z.dispatchEditAction,q=(0,Ke.b)().eventBus,Q=(0,$e.a)(),Y=(0,s.pM)(V.useState(!1),2),J=Y[0],X=Y[1],Z=(0,s.pM)(V.useState({left:new f.a(0,0),right:new f.a(0,0)}),2),$=Z[0],ee=Z[1],te=V.useRef(null),ne=(0,Ve.b)().deSelectText,ae=V.useRef(),ie=V.useRef(null),re=V.useCallback(function(){W({type:mt.a.Reset})},[W]);V.useEffect(function(){ae.current=O},[O]),V.useEffect(function(){var e;null===(e=ae.current)||void 0===e||e.call(ae,K)},[K]),V.useEffect(function(){re()},[re]),V.useEffect(function(){var e=function(e){W({type:mt.a.Unknown,payload:{annotType:null==e?void 0:e.annotationType}})};return q.on(G.e.DocumentDirty,e),function(){q.off(G.e.DocumentDirty,e)}},[q,W]),V.useEffect(function(){void 0!==j&&(null==v||v.setAnnotationMode(j),null==U||U(j))},[j,v,U]);var oe=V.useCallback(function(){return(0,s.yv)(void 0,void 0,void 0,function(){return(0,s.SO)(this,function(e){switch(e.label){case 0:return q.dispatch(G.e.DocumentReloaded),re(),[4,null==S?void 0:S.rotate(b.rotation)];case 1:return e.sent(),[4,null==T?void 0:T("Init")];case 2:return e.sent(),[2]}})})},[q,b.rotation,T,re,S]);V.useImperativeHandle(t,function(){return{reloadCurrentDocument:function(e){return(0,s.yv)(void 0,void 0,void 0,function(){return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,null==S?void 0:S.reloadCurrentDocument(e)];case 1:return t.sent(),[4,oe()];case 2:return t.sent(),[2]}})})},discardEdits:function(){return(0,s.yv)(void 0,void 0,void 0,function(){return(0,s.SO)(this,function(e){switch(e.label){case 0:return[4,null==S?void 0:S.dropAllChanges()];case 1:return e.sent(),[4,oe()];case 2:return e.sent(),[2]}})})},focusOnVirtualForwardForm:function(e){var t;null===(t=te.current)||void 0===t||t.focusOnVirtualForwardForm(e)},focusOnVirtualBackwardForm:function(e){var t;null===(t=te.current)||void 0===t||t.focusOnVirtualBackwardForm(e)},updateGripperPosition:function(e){ee(e)},toggleGripper:function(e){return(0,s.yv)(void 0,void 0,void 0,function(){return(0,s.SO)(this,function(t){switch(t.label){case 0:return e===J?[3,3]:J?[4,null==ne?void 0:ne()]:[3,2];case 1:t.sent(),t.label=2;case 2:X(e),t.label=3;case 3:return[2]}})})},updateSelectedTextInfo:function(e,t){var n;null===(n=ie.current)||void 0===n||n.updateContextualMenuForMouse(e,t)}}},[ne,J,oe,S]);var se=!g.a.isActivated("EnableMaxWithForContentWhenFitWidth")&&F===G.i.FitWidth;return V.createElement("div",{className:"".concat("pdfContent_526606d6"," ").concat(se?"fitWidth_526606d6":""),ref:D,style:{backgroundColor:Q.semanticColors.bodyBackground}},V.createElement(Dt,{pageInfos:h,metadata:b,curPageIndex:_,getScaledOriginalPageRectByIndex:I,getDistToViewportCenter:x,isPageVisible:C}),V.createElement(xt,{width:l.width,height:l.height,left:l.x,top:l.y,renderResult:u,getViewportRectRelativeToContentOffset:p,blurRenderResult:m}),!g.a.isActivated("EnableBoundingRegionHighlighter")&&function(e){return!(!e||!Array.isArray(e)||0===e.length)&&e.some(function(e){return e&&e.polygon&&Array.isArray(e.polygon)&&8===e.polygon.length&&"number"==typeof e.pageNumber&&e.pageNumber>0})}(R)&&V.createElement(V.Suspense,{fallback:V.createElement("div",null)},V.createElement(Ot,{width:null!==(n=null==H?void 0:H.width)&&void 0!==n?n:0,height:null!==(a=null==H?void 0:H.height)&&void 0!==a?a:0,top:null!==(i=null==H?void 0:H.y)&&void 0!==i?i:0,left:null!==(r=null==H?void 0:H.x)&&void 0!==r?r:0,boundingRegions:R,scrollLeft:null!==(o=null==H?void 0:H.x)&&void 0!==o?o:0,scrollTop:null!==(c=null==H?void 0:H.y)&&void 0!==c?c:0,scale:b.scale,visibleDocumentLeftOffsetRelativeToContent:null!=N?N:0})),V.createElement(ut,{ref:te,scale:b.scale,rotation:b.rotation,mode:j,getPageTextFn:w,getLinkInfosFn:E,goToPageFn:A,toggleGripperFn:M}),d&&V.createElement(V.Suspense,{fallback:V.createElement("div",null)},V.createElement(ft.a,{metadata:b,annotHandler:v},V.createElement(Ct,(0,s.q5)({pageInfos:h,renderRectFn:P,getPageRectFn:I},y)))),V.createElement(bt,{showForGripper:J,rotation:b.rotation,gripperPos:$,enableCopilot:L,onRequestCopilot:k,onFocusPdfViewer:B,ref:ie}))});wt.displayName="PdfViewerRendererInner";var Et=V.memo(V.forwardRef(function(e,t){return V.createElement("div",null,V.createElement(pt.a,null,V.createElement(wt,(0,s.q5)({},e,{ref:t}))))}));Et.displayName="PdfViewerRenderer";var At={visibleDocumentRect:new f.b(0,0,0,0),metadata:new W({width:0,height:0},0,[]),viewportRenderResult:void 0,viewportBlurRenderResult:void 0,cursorType:G.c.Default,dpr:(0,_.a)(),fileReady:!1},Lt="PdfViewer",kt=function(e){function t(t){var n=e.call(this,t)||this;return n.updateCurrentIndex=m()(function(){var e,t,a=n.pageManager;if(a){var i=a.getCurrentPage();i!==a.currentIndex&&(null===(t=(e=n.props).onCurrentPageChanged)||void 0===t||t.call(e,i),a.currentIndex=i)}n.eventBus.dispatch(G.e.Scrolling)},150),n.extract=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return[4,this.getCurrentFileData()];case 1:return(t=a.sent())?[4,this.getManipulatorHandler()]:[2];case 2:return[2,null===(n=a.sent())||void 0===n?void 0:n.extract(t,e)]}})})},n.merge=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return[4,this.getManipulatorHandler()];case 1:return[2,null===(t=n.sent())||void 0===t?void 0:t.merge(e)]}})})},n.encrypt=function(e,t,a){return(0,s.yv)(n,void 0,void 0,function(){var n,i,r;return(0,s.SO)(this,function(o){switch(o.label){case 0:return[4,this.getCurrentFileData()];case 1:return n=o.sent(),(null===(i=q.a.features)||void 0===i?void 0:i.enableEncrypt)&&n?[4,this.getManipulatorHandler()]:[2];case 2:return[2,null===(r=o.sent())||void 0===r?void 0:r.encrypt(n,e,t,a)]}})})},n.compress=function(e,t){return(0,s.yv)(n,void 0,void 0,function(){var n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return[4,this.getCurrentFileData()];case 1:return n=r.sent(),(null===(a=q.a.features)||void 0===a?void 0:a.enableCompress)&&n?[4,this.getManipulatorHandler()]:[2];case 2:return[2,null===(i=r.sent())||void 0===i?void 0:i.compress(n,e,t)]}})})},n.focus=function(){var e;null===(e=n.rootRef.current)||void 0===e||e.focus()},n.onOwnerPasswordValid=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t=this;return(0,s.SO)(this,function(n){return[2,function(){return(0,s.yv)(t,void 0,void 0,function(){return(0,s.SO)(this,function(t){switch(t.label){case 0:return this.disposeForReload(),this.preventScrollRender=!1,[4,this.initDocument()];case 1:return t.sent(),null==e||e(),[2]}})})}]})})},n.reOpenDocumentWithOwnerPassword=function(e,t,a,i){return(0,s.yv)(n,void 0,void 0,function(){var n,r,o;return(0,s.SO)(this,function(s){switch(s.label){case 0:return r=(n=this.docOpener).reOpenDocumentWithOwnerPassword,o=[e],[4,this.onOwnerPasswordValid(t)];case 1:return[4,r.apply(n,o.concat([s.sent(),a,i]))];case 2:return s.sent(),[2]}})})},n.verifyPassword=function(e,t){return(0,s.yv)(n,void 0,void 0,function(){return(0,s.SO)(this,function(n){switch(n.label){case 0:return v.a.verbose(Lt,"Verifying password"),[4,this.tryOpenDocument(e,t)];case 1:return n.sent(),[2]}})})},n.startSearch=function(e,t,a,i){return void 0===t&&(t=n.currentIndex),(0,s.yv)(n,void 0,void 0,function(){var n;return(0,s.SO)(this,function(r){switch(r.label){case 0:return[4,null===(n=this.searchService)||void 0===n?void 0:n.startSearch(e,t,a,i)];case 1:return r.sent(),[2]}})})},n.goToNextSearchResult=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return[4,null===(n=this.searchService)||void 0===n?void 0:n.goToNextSearchResult(e)];case 1:return a.sent(),this.props.onScrollPositionUpdated&&(t=this.currentScrollPosition,this.props.onScrollPositionUpdated(t.x,t.y)),[2]}})})},n.stopSearch=function(){return(0,s.yv)(n,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.searchService)||void 0===e?void 0:e.stopSearch()];case 1:return t.sent(),[2]}})})},n.scrollBy=function(e,t){var a;null===(a=n.rootRef.current)||void 0===a||a.scrollBy(e,t)},n.scrollTo=function(e,t,a){var i;null===(i=n.rootRef.current)||void 0===i||i.scrollTo({top:t,left:e,behavior:a})},n.goToPage=function(e,t,a,i){if(e<0)l.a.read(n.l10n.get("firstPagePrompt"));else if(e>=n.pageCount)l.a.read(n.l10n.get("lastPagePrompt"));else{var r=n.layoutManager.scrollRootByPage(e,t,a);e!==n.currentIndex&&r&&(i?l.a.read(i):l.a.read(n.l10n.get("currentPageNumberAria",[e+1])))}},n.zoom=function(e){var t,a,i;v.a.verbose(Lt,"Received zoom evt"),y.a.sessionMark("Start"),(null===(t=n.zoomService)||void 0===t?void 0:t.isValidScale(e))&&(n.clearViewport(),null===(a=n.zoomService)||void 0===a||a.zoom(e),g.a.isActivated("StoreZoomOptionInLocalStorage")||e!==G.i.FitSize&&e!==G.i.FitWidth||null===(i=n.displayHelper)||void 0===i||i.storeGlobalZoomOptInLocalStorage(e))},n.rotate=function(e){return void 0===e&&(e=z.A),(0,s.yv)(n,void 0,void 0,function(){var t,n,a,i=this;return(0,s.SO)(this,function(r){switch(r.label){case 0:return v.a.verbose(Lt,"Received rotate evt"),this.clearViewport(),this.rotateService||!this.viewContext?[3,2]:[4,(0,J.e)()];case 1:t=r.sent(),this.rotateService=new t(this.viewContext,this.layoutManager,this.l10n,this.renderViewport),r.label=2;case 2:return[4,null===(n=this.rotateService)||void 0===n?void 0:n.rotate(e,function(){var e,t,n;null===(e=i.zoomService)||void 0===e||e.responsiveZoom(!0),i.eventBus.dispatch(G.e.RotationChanged),null===(n=(t=i.props).onRotationChanged)||void 0===n||n.call(t)})];case 3:return r.sent(),null===(a=this.viewerRendererRef)||void 0===a||a.toggleGripper(!1),[2]}})})},n.print=function(e,t,a){return(0,s.yv)(n,void 0,void 0,function(){var n,i,r,o,c;return(0,s.SO)(this,function(s){switch(s.label){case 0:if(v.a.verbose(Lt,"Received print evt"),!(null===(r=this.viewContext)||void 0===r?void 0:r.metadata.isPrintAllowed))throw n=new h.c(h.b.PrintNoPermission,"Has no print permission!"),S.a.logError(n.toCaughtError()),n;return this.printService?[3,2]:[4,(0,J.c)()];case 1:i=s.sent(),this.printService=new i(this.getCurrentFileData),s.label=2;case 2:return this.pageManager&&this.viewContext&&(null===(o=this.printService)||void 0===o||o.initPagesPrinter(this.viewContext,this.pageManager.getScaledOriginalPageRects)),[4,null===(c=this.printService)||void 0===c?void 0:c.print(e,t,a,this.docNeedPassword)];case 3:return s.sent(),[2]}})})},n.cancelPrint=function(){var e;v.a.verbose(Lt,"Received cancelPrint evt"),null===(e=n.printService)||void 0===e||e.cancel()},n.renderThumbnail=function(e,t,a,i){return void 0===i&&(i=!1),(0,s.yv)(n,void 0,void 0,function(){var n,r;return(0,s.SO)(this,function(o){switch(o.label){case 0:return v.a.verbose(Lt,"Received renderThumbnail evt"),!this.thumbnailService&&this.viewContext&&this.pageManager?[4,(0,J.f)()]:[3,2];case 1:n=o.sent(),this.thumbnailService=new n(this.viewContext,this.pageManager.getScaledOriginalPageRectByIndex),o.label=2;case 2:return[2,null===(r=this.thumbnailService)||void 0===r?void 0:r.renderThumbnail(e,t,a,i)]}})})},n.clearThumbnailCache=function(){var e;v.a.verbose(Lt,"Received clear thumbnail evt"),null===(e=n.thumbnailService)||void 0===e||e.dispose()},n.getCurrentFileData=function(){return(0,s.yv)(n,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){return this.triggerInkDrying(),[2,null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler.getCurrentFileData()]})})},n.getTelemetryData=function(){return(0,s.yv)(n,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){return[2,null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler.getTelemetryData()]})})},n.hasSignature=function(){return(0,s.yv)(n,void 0,void 0,function(){var e,t,n;return(0,s.SO)(this,function(a){return[2,null===(n=null===(e=this.viewContext)||void 0===e?void 0:(t=e.viewHandler).hasSignature)||void 0===n?void 0:n.call(t)]})})},n.reloadCurrentDocument=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.viewerRendererRef)||void 0===t?void 0:t.reloadCurrentDocument(e)];case 1:return n.sent(),[2]}})})},n.discardEdits=function(){return(0,s.yv)(n,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.viewerRendererRef)||void 0===e?void 0:e.discardEdits()];case 1:return t.sent(),[2]}})})},n.triggerInkDrying=function(){n.eventBus.dispatch(G.e.TriggerInkDrying)},n.getEventHandlers=function(){return{onClick:n.onClick,onKeyDown:n.onKeyDown,onPointerDown:function(e){n.onPointerDown(e)},onPointerMove:function(e){n.onPointerMove(e)},onPointerUp:function(e){n.onPointerUp(e)},onTouchStart:function(e){n.onTouchStart(e)},onTouchMove:function(e){n.onTouchMove(e)},onTouchEnd:function(e){n.onTouchEnd(e)},onWheel:n.onWheel}},n.getEventBus=function(){return n.eventBus},n.getPageText=function(e){var t;return(null===(t=n.contentService)||void 0===t?void 0:t.getPageText(e))||Promise.resolve("")},n.getWorkerPerfMarks=function(){return n.viewWorker.getPerfMarks()},n.getCurrentPageIndex=function(){var e;return(null===(e=n.pageManager)||void 0===e?void 0:e.getCurrentPage())||0},n.getDocumentLeftToViewport=function(){var e;return null===(e=n.layoutManager)||void 0===e?void 0:e.visibleDocumentLeftToViewport},n.addFreeText=function(){return(0,s.yv)(n,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.inputEvtService)||void 0===e?void 0:e.addFreeText()];case 1:return t.sent(),[2]}})})},n.getWatermarkInfos=function(){return(0,s.yv)(n,void 0,void 0,function(){var e,t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return[4,this.getWatermarkService()];case 1:return[4,null==(e=n.sent())?void 0:e.getWatermarkInfos()];case 2:return t=n.sent(),[2,JSON.stringify(t||[])]}})})},n.getWatermarkService=function(){return(0,s.yv)(n,void 0,void 0,function(){var e,t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return(null===(t=q.a.features)||void 0===t?void 0:t.enableWatermark)&&!this.watermarkService&&this.viewContext?[4,(0,J.h)()]:[3,2];case 1:e=n.sent(),this.watermarkService=new e(this.viewContext,this.eventBus.dispatch.bind(this.eventBus),this.watermarkHandler),n.label=2;case 2:return[2,this.watermarkService]}})})},n.getOutlineData=function(){return(0,s.yv)(n,void 0,void 0,function(){var e,t;return(0,s.SO)(this,function(n){return[2,null===(t=null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler)||void 0===t?void 0:t.getOutlineData()]})})},n.getDocPermissions=function(){var e;return(null===(e=n.viewContext)||void 0===e?void 0:e.metadata.getDocPermissions())||[]},n.undo=function(){return(0,s.yv)(n,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.undoRedoService)||void 0===e?void 0:e.undo()];case 1:return t.sent(),[2]}})})},n.redo=function(){return(0,s.yv)(n,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.undoRedoService)||void 0===e?void 0:e.redo()];case 1:return t.sent(),[2]}})})},n.storeDisplayInfo=function(){var e,t,a;if(n.displayHelper||n.freeTextService){var i={pos:n.currentScrollPosition,scale:(null===(e=n.zoomService)||void 0===e?void 0:e.getZoomOpt())||n.scale,rotation:n.rotation};null===(t=n.displayHelper)||void 0===t||t.storeInfoInLocalStorage(i),null===(a=n.freeTextService)||void 0===a||a.storeFreeTextAttribute()}},n.setViewerRendererRef=function(e){n.viewerRendererRef=e},n.onScroll=function(){n.preventScrollRender?n.preventScrollRender=!1:(n.renderViewport(),n.updateCurrentIndex())},n.onResize=function(){var e;v.a.verbose(Lt,"Received resize evt"),n.resizeViewer(),null===(e=n.viewerRendererRef)||void 0===e||e.toggleGripper(!1)},n.onWheel=function(e){var t,a;e.ctrlKey&&(e.preventDefault(),null===(t=n.renderService)||void 0===t||t.clear(),null===(a=n.zoomService)||void 0===a||a.wheelZoom(e))},n.onKeyDown=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onKeyDown(this.getNativeEvt(e),this.currentIndex)];case 1:return n.sent(),[2]}})})},n.onPointerDown=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return t=this.getNativeEvt(e),null===(a=null===(n=this.pinchable)||void 0===n?void 0:n.onPointerDown)||void 0===a||a.call(n,t),[4,null===(i=this.inputEvtService)||void 0===i?void 0:i.onPointerDown(t)];case 1:return r.sent(),[2]}})})},n.onPointerMove=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return t=this.getNativeEvt(e),null===(a=null===(n=this.pinchable)||void 0===n?void 0:n.onPointerMove)||void 0===a||a.call(n,t),[4,null===(i=this.inputEvtService)||void 0===i?void 0:i.onPointerMove(t)];case 1:return r.sent(),[2]}})})},n.onPointerUp=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return t=this.getNativeEvt(e),null===(a=null===(n=this.pinchable)||void 0===n?void 0:n.onPointerUp)||void 0===a||a.call(n,t),[4,null===(i=this.inputEvtService)||void 0===i?void 0:i.onPointerUp(t)];case 1:return r.sent(),[2]}})})},n.onPointerCancel=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){return null===(n=null===(t=this.pinchable)||void 0===t?void 0:t.onPointerUp)||void 0===n||n.call(t,this.getNativeEvt(e)),[2]})})},n.onPointerOut=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){return null===(n=null===(t=this.pinchable)||void 0===t?void 0:t.onPointerUp)||void 0===n||n.call(t,this.getNativeEvt(e)),[2]})})},n.onPointerLeave=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){return null===(n=null===(t=this.pinchable)||void 0===t?void 0:t.onPointerUp)||void 0===n||n.call(t,this.getNativeEvt(e)),[2]})})},n.onTouchStart=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n,a;return(0,s.SO)(this,function(i){switch(i.label){case 0:return t=this.getNativeEvt(e),null===(n=this.pinchable)||void 0===n||n.onTouchStart(t),[4,null===(a=this.inputEvtService)||void 0===a?void 0:a.onTouchStart(t)];case 1:return i.sent(),[2]}})})},n.onTouchMove=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return null===(t=this.pinchable)||void 0===t||t.onTouchMove(this.getNativeEvt(e)),[4,null===(n=this.inputEvtService)||void 0===n?void 0:n.onTouchMove(e)];case 1:return a.sent(),[2]}})})},n.onTouchEnd=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n,a;return(0,s.SO)(this,function(i){switch(i.label){case 0:return t=this.getNativeEvt(e),null===(n=this.pinchable)||void 0===n||n.onTouchEnd(t),[4,null===(a=this.inputEvtService)||void 0===a?void 0:a.onTouchEnd(t)];case 1:return i.sent(),[2]}})})},n.onClick=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onClick(this.getNativeEvt(e))];case 1:return n.sent(),[2]}})})},n.onContextMenu=function(e){e.preventDefault()},n.onGlobalMouseMove=function(e){var t;n.isEvtInsideViewer(e)||null===(t=n.contentService)||void 0===t||t.onPointerMove(new f.a(e.clientX,e.clientY))},n.onGlobalMouseUp=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return(null===(t=this.props.annotParams)||void 0===t?void 0:t.mode)!==G.a.None||this.isEvtInsideViewer(e)?[2]:[4,null===(n=this.inputEvtService)||void 0===n?void 0:n.onPointerUp(e)];case 1:return a.sent(),[2]}})})},n.onBeforePageUnload=function(){S.a.logVerbose({name:D.a.DocumentLoad,message:"Before PDF Page Unload"}),n.pageLoaded=!1,n.storeDisplayInfo()},n.onPageUnload=function(){S.a.logVerbose({name:D.a.DocumentLoad,message:"PDF Page Unload"}),n.pageLoaded=!1},n.onWorkerMessage=function(e){return(0,s.yv)(n,void 0,void 0,function(){var t,n,a,i,r,o,c,d,l,u,f,p,m,_,b,g,v,y,D,I,x,C=this;return(0,s.SO)(this,function(s){switch(s.label){case 0:switch(O=e.data,(t={type:_e(O.type),name:he(O.name),payload:O.payload}).type){case 0:return[3,1];case 1:case 9:return[3,7];case 2:return[3,8];case 3:return[3,9];case 4:case 5:return[3,10];case 6:return[3,11];case 7:return[3,13];case 8:return[3,16];case 11:return[3,18];case 10:return[3,19];case 12:return[3,21];case 13:return[3,22]}return[3,24];case 1:return 3!==t.name?[3,3]:[4,null===(u=this.progressiveLoadingService)||void 0===u?void 0:u.onNotification(t)];case 2:return s.sent(),[3,25];case 3:return(n=4===t.name)&&this.eventBus.dispatch(G.e.InvalidateRect,t.payload),a=(null===(f=this.props.annotParams)||void 0===f?void 0:f.mode)||G.a.None,n&&(a===G.a.Highlight||a===G.a.Ink||(null===(p=q.a.features)||void 0===p?void 0:p.enableEnhancedInk)&&a===G.a.PointErase)?(this.eventBus.dispatch(G.e.InvalidateRectForAnnot,t.payload),[3,6]):[3,4];case 4:return[4,null===(m=this.contentService)||void 0===m?void 0:m.onNotification(t)];case 5:s.sent(),s.label=6;case 6:return[3,25];case 7:return null===(_=this.inputEvtService)||void 0===_||_.onNotification(t),[3,25];case 8:return null===(b=this.linkService)||void 0===b||b.onNotification(t),[3,25];case 9:return null===(g=this.searchService)||void 0===g||g.onNotification(t),[3,25];case 10:try{(i=function(e){switch(e){case"DocumentSaved":return G.e.DocumentSaved;case"InkStrokesAdded":return G.e.InkStrokesAdded;case"InkAdded":return G.e.InkAdded;case"InkUpdated":return G.e.InkUpdated;case"SetDocumentDirty":return G.e.DocumentDirty;case"ShowEditableInk":return G.e.ShowEditableInk;case"ShowEraserableInk":return G.e.ShowErasableInk;default:throw"Unsupported notification name"}}(e.data.name))!==G.e.InkAdded&&i!==G.e.InkUpdated||this.eventBus.dispatch(G.e.AnnotationChanged),this.eventBus.dispatch(i,t.payload)}catch(e){}return[3,25];case 11:return[4,null===(v=this.freeTextService)||void 0===v?void 0:v.onNotification(t)];case 12:return s.sent(),[3,25];case 13:return[4,this.getWatermarkService()];case 14:return[4,null==(r=s.sent())?void 0:r.onNotification(t)];case 15:return s.sent(),[3,25];case 16:return[4,null===(y=this.formService)||void 0===y?void 0:y.onNotification(t)];case 17:return s.sent(),[3,25];case 18:return 28===t.name&&this.eventBus.dispatch(G.e.VisiblePagesLoaded,t.payload),[3,25];case 19:return[4,null===(D=this.progressiveLoadingService)||void 0===D?void 0:D.onNotification(t)];case 20:return s.sent(),[3,25];case 21:return o=t.payload,c=o.name,d=o.charset,l=o.style,null===(I=this.fontProvider)||void 0===I||I.onMissingFont(c,d,l).then(function(e){e&&C.renderViewport("Init")}).catch(function(e){var t=new h.c(h.b.FontLoadFailed,"Fail to handle missing font: ".concat(c," error: ").concat(e));S.a.logError(t.toCaughtError())}),[3,25];case 22:return[4,null===(x=this.undoRedoService)||void 0===x?void 0:x.onNotification(t)];case 23:return s.sent(),[3,25];case 24:return[3,25];case 25:return[2]}var O})})},n.onTextSelected=function(e,t){var a,i,r;null===(i=(a=n.props).onTextSelected)||void 0===i||i.call(a,e),null===(r=n.viewerRendererRef)||void 0===r||r.updateSelectedTextInfo(e,t)},n.onTextDeselected=function(e){var t,a,i;null===(a=(t=n.props).onTextDeselected)||void 0===a||a.call(t,e),null===(i=n.viewerRendererRef)||void 0===i||i.updateSelectedTextInfo("",void 0)},n.renderViewport=function(e){return void 0===e&&(e="Scroll"),(0,s.yv)(n,void 0,void 0,function(){var t,n,a,i=this;return(0,s.SO)(this,function(r){return this.layoutManager.rootRect.clear(),"Scroll"===e&&y.a.sessionMark("Start",{scrollPos:JSON.stringify({x:this.layoutManager.rootRect.getScrollLeft(),y:this.layoutManager.rootRect.getScrollTop()})}),t=this.layoutManager.viewportRectRelativeToDocument,this.setState({visibleDocumentRect:this.layoutManager.visibleDocumentRectRelativeToContent}),null===(a=(n=this.props).onRenderViewport)||void 0===a||a.call(n),[2,new Promise(function(n,a){var r,o;null===(r=i.renderService)||void 0===r||r.render({rect:t,layoutSize:i.layoutManager.documentSize,rotation:null===(o=i.viewContext)||void 0===o?void 0:o.metadata.rotation,triggerType:e,onCompleted:function(e){n(e)},onError:function(e){a(e)}})})]})})},n.updateRenderResult=function(e){var t,a;if(e&&!(null===(t=q.a.features)||void 0===t?void 0:t.enableCalculateOffsetAtDrawTimeFix)){var i=n.layoutManager.viewportRectRelativeToContent.origin.symmetricMap();e.origin=null===(a=e.origin)||void 0===a?void 0:a.plus(i)}n.setState({viewportRenderResult:e,viewportBlurRenderResult:void 0})},n.updateBlurRenderResult=function(e){n.setState({visibleDocumentRect:n.layoutManager.visibleDocumentRectRelativeToContent,viewportBlurRenderResult:e})},n.updateCursorType=function(e){var t,a;e!==n.state.cursorType&&(n.setState({cursorType:e}),Object.values(G.c).includes(e)&&(null===(a=(t=n.props).onCursorUpdate)||void 0===a||a.call(t,e)))},n.onFormFocus=function(e){var t,a,i;if(n.context.isFormFillingEnabled&&n.props.formAttributes){var r=null===(t=n.rootRef.current)||void 0===t?void 0:t.hasAttribute(n.props.formAttributes);e&&!r?null===(a=n.rootRef.current)||void 0===a||a.setAttribute(n.props.formAttributes,"true"):!e&&r&&(null===(i=n.rootRef.current)||void 0===i||i.removeAttribute(n.props.formAttributes))}},n.getViewportRectRelativeToContentOffset=function(){var e;return null===(e=n.layoutManager)||void 0===e?void 0:e.viewportRectRelativeToContent.origin.symmetricMap()},(0,d.a)(n),n.state=At,n.pageLoaded=!0,n.outerRef=V.createRef(),n.outerRect=new ke,n.rootRef=V.createRef(),n.contentRef=V.createRef(),n.layoutManager=new Fe,n.l10n=(0,ze.b)(),n.wasmDataProvider=He.a.getInstance(),n.worker=new Worker(q.a.workerSrc),n.viewWorker=P(n.worker),n.viewWorker.setupEnv({wasmModuleInit:q.a.wasmModuleInit,enableLogging:!!q.a.enableLogging,activatedKillSwitches:g.a.activatedKillSwitches,globalVarNameForWorkerVer:q.a.globalVarNameForWorkerVer,mipPrefetchConfig:q.a.mipPrefetchConfig}),n.docLoader=new se(t.url,t.filename,t.fileSize,t.enableDownloadByRange,t.token,t.getAuthHeaders),n.docNeedPassword=!1,n.docOpener=new ce(function(){var e;null===(e=t.onNeedPassword)||void 0===e||e.call(t),n.docNeedPassword=!0}),n.eventBus=new b.a,n.preventScrollRender=!1,n}return(0,s.e2)(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.outerRect.initialize(this.outerRef.current),this.layoutManager.initialize(this.rootRef.current,this.contentRef.current,this.props.onScrollPositionUpdated),this.updateOuterHeight(),this.setLocaleStrings(),this.initViewer()},t.prototype.componentDidUpdate=function(e,t){var n,a,i,r=this,o=this.props,s=o.url,c=o.height,d=o.localeStrings,l=o.enableEdit;s!==e.url?(this.reset(),this.initViewer()):c!==e.height&&(this.updateOuterHeight(),this.resizeViewer()),d!==e.localeStrings&&this.setLocaleStrings(),void 0!==l&&e.enableEdit!==l&&(null===(n=this.viewContext)||void 0===n||n.viewHandler.setEditEnabled(l)),(null===(a=this.progressiveLoadingService)||void 0===a?void 0:a.enabled)&&!t.fileReady&&this.state.fileReady&&(this.renderViewport("Init").then(function(){r.eventBus.dispatch(G.e.InitialDisplayInfoApplied)}),null===(i=this.progressiveLoadingService)||void 0===i||i.dispose())},t.prototype.componentWillUnmount=function(){var e,t,n;this.mounted=!1,this.initRenderRequestId&&cancelAnimationFrame(this.initRenderRequestId),this.dispose(),this.worker.terminate(),this.wasmDataProvider.dispose(),null===(e=this.fontProvider)||void 0===e||e.dispose(),null===(n=(t=this.props).onDocumentUnloaded)||void 0===n||n.call(t)},t.prototype.render=function(){var e,t,n,a,i,r,o,d,l,f,p,m,_,h=(0,x.a)(this.props.theme,this.props.darkMode),b=this.pageManager,g=this.context;return V.createElement(c.a,{theme:(0,s.q5)({rtl:(0,u.a)()},h),className:"fillSize_526606d6"},V.createElement(ze.a,{strings:this.strings},V.createElement(Ke.a,{dpr:this.state.dpr,eventBus:this.eventBus,pageManager:b,viewHandler:null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler,onFirstRenderVisibleFn:this.props.onFirstRenderVisible,enablePreRender:this.state.fileReady&&this.props.enablePreRender},V.createElement(Be.a,{enableFormFilling:g.isFormFillingEnabled,formHandler:this.formHandler},V.createElement(Ge.a,{undoRedoService:this.undoRedoService},V.createElement(Ve.a,{enableGripperContextualMenu:this.props.enableGripperContextualMenu||!1,onGripperTouchStart:null===(t=this.inputEvtService)||void 0===t?void 0:t.onGripperTouchStart,copyToClipboard:null===(n=this.contentService)||void 0===n?void 0:n.copyToClipboard,deSelectText:null===(a=this.inputEvtService)||void 0===a?void 0:a.gripperDeSelectText},V.createElement(je.a,{enableFreeText:g.isFreeTextEnabled,freeTextHandler:this.freeTextHandler,freeTextContainer:this.props.freeTextContainer,setInitialFontAttributes:null===(i=this.freeTextService)||void 0===i?void 0:i.setInitialFontAttributes},V.createElement("div",{className:Ze,ref:this.outerRef},V.createElement("div",{className:"pdfViewer_526606d6",style:{cursor:this.state.cursorType},tabIndex:this.props.isRootFocusable&&!this.props.ariaHidden?0:-1,"aria-label":this.docLoader.filename,ref:this.rootRef,onClick:this.onClick,onContextMenu:this.onContextMenu,onKeyDown:this.onKeyDown,onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp,onPointerCancel:this.onPointerCancel,onPointerOut:this.onPointerOut,onPointerLeave:this.onPointerLeave,onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd},V.createElement(Re.a,{ariaHidden:!!this.props.ariaHidden,triggerPointerUp:null===(r=this.inputEvtService)||void 0===r?void 0:r.triggerPointerUp,focusOnPage:null===(o=this.viewerRendererRef)||void 0===o?void 0:o.focusOnVirtualBackwardForm},V.createElement(Et,{ref:this.setViewerRendererRef,enableAnnotation:g.isAnnotationEnabled,contentRef:this.contentRef,visibleDocumentRect:this.state.visibleDocumentRect,curPageIndex:null==b?void 0:b.getCurrentPage(),visiblePageInfos:null==b?void 0:b.getVisiblePages(),viewportRenderResult:this.state.viewportRenderResult,getViewportRectRelativeToContentOffset:this.getViewportRectRelativeToContentOffset,viewportBlurRenderResult:this.state.viewportBlurRenderResult,metadata:this.state.metadata,annotHandler:this.annotHandler,viewHandler:null===(d=this.viewContext)||void 0===d?void 0:d.viewHandler,annotParams:this.props.annotParams,getScaledOriginalPageRectByIndex:null==b?void 0:b.getScaledOriginalPageRectByIndex,getDistToViewportCenter:this.layoutManager.getDistToViewportCenter,isPageVisible:null==b?void 0:b.isPageVisible,getPageTextFn:null===(l=this.contentService)||void 0===l?void 0:l.getPageText,getLinkInfosFn:null===(f=this.linkService)||void 0===f?void 0:f.getLinkInfosInPage,renderRectFn:null===(p=this.contentService)||void 0===p?void 0:p.renderRect,renderViewportFn:this.renderViewport,goToPageFn:this.goToPage,toggleGripperFn:null===(m=this.viewerRendererRef)||void 0===m?void 0:m.toggleGripper,syncModeFn:null===(_=this.inputEvtService)||void 0===_?void 0:_.setMode,onEditStateChanged:this.props.onEditStateChanged,enableCopilot:this.props.enableCopilot,onRequestCopilot:this.props.onRequestCopilot,zoomOpt:this.zoomOpt,highlightCanvasRect:this.getHighlightCanvasRect(),highlightBoundingRegions:this.props.highlightBoundingRegions,visibleDocumentLeftOffsetRelativeToContent:this.layoutManager.visibleDocumentLeftToViewport,onFocusPdfViewer:this.focus})))))))))))},Object.defineProperty(t.prototype,"pageCount",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.pageCount)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentIndex",{get:function(){var e=this.pageManager;return e?e.currentIndex:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentScrollPosition",{get:function(){return this.layoutManager.currentScrollPosition},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filename",{get:function(){return this.docLoader.filename},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalLayoutSize",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.originalLayoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layoutSize",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.layoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalPageSizes",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.originalPageSizes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageSizes",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.pageSizes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalPageRects",{get:function(){var e=this.pageManager;return e?e.getOriginalPageRects():[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.scale)||1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){var e,t=null===(e=this.viewContext)||void 0===e?void 0:e.metadata.rotation;return t?t*z.A:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMip",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.mip)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMipDecrypted",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.isMipDecrypted)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coordinateConverters",{get:function(){return{convertPointFromClientToOriginalDocument:this.layoutManager.convertPointFromClientToOriginalDocument,convertPointFromOriginalDocumentToClient:this.layoutManager.convertPointFromOriginalDocumentToClient}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomOpt",{get:function(){var e;return null===(e=this.zoomService)||void 0===e?void 0:e.getZoomOpt()},enumerable:!1,configurable:!0}),t.prototype.setLocaleStrings=function(){return(0,s.yv)(this,void 0,void 0,function(){var e,t;return(0,s.SO)(this,function(n){switch(n.label){case 0:return e=this,(t=this.props.localeStrings)?[3,2]:[4,(0,ze.c)()];case 1:t=n.sent(),n.label=2;case 2:return e.strings=t,this.l10n.strings=this.strings,[2]}})})},t.prototype.tryCreateProgressiveLoadingService=function(){return(0,s.yv)(this,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){switch(t.label){case 0:return!this.progressiveLoadingService&&this.props.enableProgressiveLoading&&this.props.fileSize?[4,(0,J.d)()]:[3,3];case 1:return e=t.sent(),this.progressiveLoadingService=new e,[4,this.progressiveLoadingService.tryInitRangeDownload(this.props.url,this.props.fileSize,this.props.token,this.props.getAuthHeaders)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.getFileData=function(){var e,t;return(0,s.yv)(this,void 0,void 0,function(){var n,a,i;return(0,s.SO)(this,function(r){switch(r.label){case 0:return[4,this.tryCreateProgressiveLoadingService()];case 1:return r.sent(),(null===(e=this.progressiveLoadingService)||void 0===e?void 0:e.enabled)&&this.props.fileSize?[2,[new Uint8Array(0),this.props.fileSize]]:this.mounted?(n=null===(t=this.progressiveLoadingService)||void 0===t?void 0:t.getFileData())?(i=n,[3,4]):[3,2]:[2,[void 0,0]];case 2:return[4,this.docLoader.fetch()];case 3:i=r.sent(),r.label=4;case 4:return a=i,this.mounted&&a?(this.setState({fileReady:!0}),[2,[a,a.length]]):[2,[void 0,0]]}})})},t.prototype.initProgressiveLoadingService=function(e){var t;return(0,s.yv)(this,void 0,void 0,function(){var n,a,i,r,o,c=this;return(0,s.SO)(this,function(d){return(null===(t=this.progressiveLoadingService)||void 0===t?void 0:t.enabled)&&this.viewContext&&(n=function(){var e,t;c.setState({fileReady:!0}),c.viewContext&&(null===(t=(e=c.props).onDocumentLoaded)||void 0===t||t.call(e,c.viewContext.metadata))},a=function(t,n,a){return(0,s.yv)(c,void 0,void 0,function(){return(0,s.SO)(this,function(i){switch(i.label){case 0:return[4,e.onRangeRequestDone(t,n,a)];case 1:return i.sent(),[2]}})})},i=function(e){var t;null===(t=c.docLoadScenario)||void 0===t||t.fail(e)},r=function(){return(0,s.yv)(c,void 0,void 0,function(){return(0,s.SO)(this,function(e){switch(e.label){case 0:return[4,this.initDocument()];case 1:return e.sent(),[2]}})})},o=function(){return(0,s.yv)(c,void 0,void 0,function(){return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,e.resetStream()];case 1:return t.sent(),[4,e.closeDocument()];case 2:return t.sent(),this.disposeForReload(),this.initViewer(!0),[2]}})})},this.progressiveLoadingService.initProgressiveLoadingService(this.viewContext,this.layoutManager,this.renderViewport,o,r,n,a,i),this.bindWorkerMessage()),[2]})})},t.prototype.initViewer=function(e){var t,n,a,i,r,o,c,d,l,u,f,p,m,_,b,I,x,C,O,w,E,A,L,k,M,P;return void 0===e&&(e=!1),(0,s.yv)(this,void 0,void 0,function(){var T,U,F,H,R,N,B,j,V,z,G,K,W,Q,J,X,Z,$,ee,te,ne=this;return(0,s.SO)(this,function(ae){switch(ae.label){case 0:e||(this.docLoadScenario=S.a.createScenario({name:D.a.DocumentLoad,extraData:this.tempAuthLogFields})),ae.label=1;case 1:return ae.trys.push([1,22,,23]),g.a.isActivated("CheckWorkerVersion")?[3,3]:[4,this.checkWorkerVersion()];case 2:ae.sent(),ae.label=3;case 3:return this.bindPageEvents(),[4,this.getFileData()];case 4:return T=s.pM.apply(void 0,[ae.sent(),2]),U=T[0],F=T[1],this.mounted&&U&&F?(y.a.mark("Downloaded"),this.exposeFnsToWorker(),[4,this.wasmDataProvider.getModuleInnerInit()]):(H=new h.c(h.b.PdfLoadCanceled,"PdfViewer unmounted before opening document.unmounted:".concat(!this.mounted,", filedata undefined:").concat(!U,", fileSize:").concat(F)),S.a.logError(H.toCaughtError()),null===(t=this.docLoadScenario)||void 0===t||t.stop(),[2]);case 5:return R=ae.sent(),[4,this.viewWorker.initialize(R)];case 6:return ae.sent(),[4,this.viewWorker.getHandlerInstance(U,F,!!this.props.enableCopyByChunk,null===(n=this.progressiveLoadingService)||void 0===n?void 0:n.getChunkRequestSize())];case 7:return N=ae.sent(),v.a.verbose(Lt,"Created PdfViewHandler instance"),[4,this.viewWorker.getInputEvtHandler()];case 8:return B=ae.sent(),j=this,[4,Y.getInstance(N,B)];case 9:return j.viewContext=ae.sent(),this.docOpener.viewHandler=N,this.docOpener.reset(),[4,this.initProgressiveLoadingService(N)];case 10:return ae.sent(),V={featureConfigInMspdfkit:{enableFormFilling:!!(null===(a=q.a.features)||void 0===a?void 0:a.enableFormFilling),enableOpenMip:!!this.props.enableOpenMip,enableProgressiveLoading:!!(null===(i=this.progressiveLoadingService)||void 0===i?void 0:i.enabled),enableICUConverterKS:!g.a.isActivated("EnableICUConverter"),enableMipSdkTelemetry:!!(null===(r=q.a.features)||void 0===r?void 0:r.enableMipSdkTelemetry),enableOwnerPassword:!!(null===(o=q.a.features)||void 0===o?void 0:o.enableEncrypt),enableWatermark:!!(null===(c=q.a.features)||void 0===c?void 0:c.enableWatermark),enableDataCopyOptimizationKS:!g.a.isActivated("EnableDataCopyOptimization"),enableMipTokenPrefetch:!!(null===(d=q.a.features)||void 0===d?void 0:d.enableMipTokenPrefetch),enableLoadFontOnDemand:!!(null===(l=q.a.features)||void 0===l?void 0:l.enableLoadFontOnDemand),enableLoopFontsOnDemand:!!(null===(u=q.a.features)||void 0===u?void 0:u.enableLoopFontsOnDemand)},featureConfigInPdfControl:{enableFreeText:!!(null===(f=q.a.features)||void 0===f?void 0:f.enableFreeText),enableEnhancedInk:!!(null===(p=q.a.features)||void 0===p?void 0:p.enableEnhancedInk),enableProgressiveDocumentHandler:!!(null===(m=this.progressiveLoadingService)||void 0===m?void 0:m.enabled)&&!g.a.isActivated("EnableProgressiveDocumentHandler"),enableWatermark:!!(null===(_=q.a.features)||void 0===_?void 0:_.enableWatermark),enableOnlyBGRFormat:!!(null===(b=q.a.features)||void 0===b?void 0:b.enableOnlyBGRFormat),enableUndoRedo:!!(null===(I=q.a.features)||void 0===I?void 0:I.enableUndoRedo)}},[4,N.setFeatureConfig(V)];case 11:return ae.sent(),N.setEditEnabled(!!this.props.enableEdit),z=this,[4,this.viewWorker.getAnnotationHandlerInstance()];case 12:return z.annotHandler=ae.sent(),(null===(x=q.a.features)||void 0===x?void 0:x.enableFreeText)?(G=this,[4,this.viewWorker.getFreeTextHandler()]):[3,14];case 13:G.freeTextHandler=ae.sent(),ae.label=14;case 14:return(null===(C=q.a.features)||void 0===C?void 0:C.enableFormFilling)?(K=this,[4,this.viewWorker.getFormHandler()]):[3,16];case 15:K.formHandler=ae.sent(),ae.label=16;case 16:return(null===(O=q.a.features)||void 0===O?void 0:O.enableWatermark)?(W=this,[4,this.viewWorker.getWatermarkHandler()]):[3,18];case 17:W.watermarkHandler=ae.sent(),ae.label=18;case 18:return(null===(w=q.a.features)||void 0===w?void 0:w.enableUndoRedo)?(Q=this,[4,null===(A=(E=this.viewWorker).getUndoRedoHandler)||void 0===A?void 0:A.call(E)]):[3,20];case 19:Q.undoRedoHandler=ae.sent(),ae.label=20;case 20:return[4,this.tryOpenDocument()];case 21:return ae.sent(),[3,23];case 22:return(null==(J=ae.sent())?void 0:J.message)&&(X=q.a.wasmModuleInit.length>0?q.a.wasmModuleInit[0]:void 0)&&(Z=X.wasmUrl,$=X.dataUrl,ee=X.wasmJsUrlOrBlob,J.message+=". Additional: wasmUrl=".concat(encodeURIComponent(Z).replace("https",""),", wasmJsUrl=").concat("string"==typeof ee&&encodeURIComponent(ee).replace("https",""),", dataUrl=").concat(encodeURIComponent($||"").replace("https",""))),te=J instanceof h.c?J.toQosError():{isExpected:J.isExpected||J.name===h.b.InvalidPDF,error:J,code:J.name},this.pageLoaded&&this.mounted||(te.isExpected=!0),te.extraData=(0,s.q5)((0,s.q5)((0,s.q5)({},te.extraData),this.tempAuthLogFields),{unmounted:!this.mounted,unloaded:!this.pageLoaded}),(null===(L=q.a.features)||void 0===L?void 0:L.enableAsyncQosEvent)?window.setTimeout(function(){var e,t,n;null===(e=ne.docLoadScenario)||void 0===e||e.fail(te),null===(n=(t=ne.props).onInitError)||void 0===n||n.call(t,te)}):(null===(k=this.docLoadScenario)||void 0===k||k.fail(te),null===(P=(M=this.props).onInitError)||void 0===P||P.call(M,te)),[2];case 23:return[2]}})})},t.prototype.tryOpenDocument=function(e,t){var n,a;return(0,s.yv)(this,void 0,void 0,function(){var i,r,o,c;return(0,s.SO)(this,function(s){switch(s.label){case 0:i=!1,r=void 0,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.docOpener.tryOpen(e,t)];case 2:return i=s.sent(),[3,4];case 3:if(o=s.sent(),!(this.props.enableOpenMip&&o.name&&o.name.startsWith("Mip")))throw o;return i=!0,r=h.e.getParsedErrorData(o),[3,4];case 4:return i?(null===(a=this.progressiveLoadingService)||void 0===a?void 0:a.enabled)?[3,6]:[4,this.initDocument(r)]:(c={mip:!1},null===(n=this.docLoadScenario)||void 0===n||n.stop({extraData:c}),[2]);case 5:s.sent(),s.label=6;case 6:return[2]}})})},t.prototype.initDocument=function(e){var t,n,i,r,o,c,d,l,u,f,p;return(0,s.yv)(this,void 0,void 0,function(){var m,_,b,g,v=this;return(0,s.SO)(this,function(D){switch(D.label){case 0:if(y.a.mark("Opened"),!this.viewContext)throw new h.c(h.b.ViewContextNotInitialized,"PdfViewer viewContext empty");return[4,this.viewContext.initMetadata()];case 1:return D.sent(),null===(n=(t=this.props).onMetadataUpdated)||void 0===n||n.call(t,this.viewContext.metadata),this.viewContext.metadata&&this.setState({metadata:this.viewContext.metadata}),m=this.layoutManager.metadata=this.viewContext.metadata,_=(0,s.q5)({pageCount:m.pageCount,averagePageSize:0===m.pageCount?0:this.docLoader.fileSize/m.pageCount,mip:m.mip,hasOutline:m.hasOutline},this.tempAuthLogFields),e?(e.extraData=_,e.code===a.MipNoPermissions&&(null===(r=(i=this.props).onMipAuthFailed)||void 0===r||r.call(i)),null===(o=this.docLoadScenario)||void 0===o||o.fail(e),S.a.logError(e)):null===(c=this.docLoadScenario)||void 0===c||c.stop({extraData:_}),this.loadFontPromise=q.a.fontConfigs&&this.loadFonts(),this.initServices(),(null===(d=q.a.features)||void 0===d?void 0:d.enableUndoRedo)&&this.viewContext?[4,(0,J.g)()]:[3,3];case 2:b=D.sent(),this.undoRedoService=new b(this.viewContext,this.eventBus.dispatch.bind(this.eventBus),this.undoRedoHandler),D.label=3;case 3:return[4,(0,J.i)()];case 4:return g=D.sent(),this.pinchable=new g(function(){return v.scale},this.zoomService.blurZoom,function(){var e,t;null===(e=v.renderService)||void 0===e||e.clear(),null===(t=v.zoomService)||void 0===t||t.render()},this.eventBus),this.displayHelper||(this.displayHelper=new Je(this.layoutManager,this.props.uniqueId,this.props.enableCacheDisplayInfo,this.props.defaultPageNumber,this.props.defaultScale)),this.bindEvents(),null===(l=this.displayHelper)||void 0===l||l.applyInfoInLocalStorage(),[4,this.initContent()];case 5:return D.sent(),(null===(u=this.progressiveLoadingService)||void 0===u?void 0:u.enabled)||null===(p=(f=this.props).onDocumentLoaded)||void 0===p||p.call(f,m),[2]}})})},t.prototype.loadFonts=function(){var e;return(0,s.yv)(this,void 0,void 0,function(){var t,n,a;return(0,s.SO)(this,function(i){switch(i.label){case 0:return[4,this.viewWorker.getFontHandler()];case 1:return t=i.sent(),q.a.fontConfigs?(null===(e=q.a.features)||void 0===e?void 0:e.enableLoadFontOnDemand)?[4,(0,J.a)()]:[3,4]:[2];case 2:return n=i.sent(),this.fontProvider=new n(t,this.props.onFontLoading),[4,this.fontProvider.loadRequiredFonts(q.a.fontConfigs)];case 3:return i.sent(),[2];case 4:return g.a.isActivated("CacheFontFile")?[3,7]:[4,(0,J.a)()];case 5:return n=i.sent(),this.fontProvider=new n(t),[4,this.fontProvider.loadFonts(q.a.fontConfigs)];case 6:return i.sent(),[3,9];case 7:return a=q.a.fontConfigs.map(function(e){return e.fontUrl}),[4,t.loadFonts(a)];case 8:i.sent(),i.label=9;case 9:return[2]}})})},t.prototype.exposeFnsToWorker=function(){var e=this;k({getMIPToken:function(t){return(0,s.yv)(e,void 0,void 0,function(){var e,n;return(0,s.SO)(this,function(a){return this.props.enableOpenMip?[2,null===(n=(e=this.props).getMIPToken)||void 0===n?void 0:n.call(e,t)]:[2]})})},logQosStart:function(e){S.a.handler.logQosStart(e)},logQosEnd:function(e){S.a.handler.logQosEnd(e)},logEngagement:function(e){S.a.handler.logEngagement(e)},logError:function(e){S.a.handler.logError(e)},logVerbose:function(e){var t,n;null===(n=(t=S.a.handler).logVerbose)||void 0===n||n.call(t,e)}},this.worker)},t.prototype.initServices=function(){var e,t,n,a,i,r=this;this.viewContext&&(this.renderService=new Ce(this.viewContext,this.updateRenderResult,this.props.onRenderError,function(){r.eventBus.dispatch(G.e.InitialDisplayInfoApplied)}),this.zoomService=new Le(this.viewContext,this.layoutManager,this.renderViewport,this.updateBlurRenderResult,this.eventBus.dispatch.bind(this.eventBus),function(){r.preventScrollRender=!0},function(e,t){var n,a,i;null===(n=r.viewerRendererRef)||void 0===n||n.toggleGripper(!1),null===(i=(a=r.props).onScaleChanged)||void 0===i||i.call(a,e,t),r.eventBus.dispatch(G.e.ScaleChanged)}),this.contentService=new ae(this.viewContext,this.layoutManager,this.l10n,this.updateRenderResult,this.goToPage,this.scrollBy,this.onTextSelected,this.onTextDeselected,null===(e=this.progressiveLoadingService)||void 0===e?void 0:e.refreshViewPortForProgressiveLoading),this.linkService=new De(this.viewContext,this.layoutManager,this.goToPage,this.eventBus.dispatch.bind(this.eventBus)),this.searchService=new Oe(this.viewContext),this.inputEvtService=new Se(this.viewContext,this.layoutManager,this.l10n,this.contentService,function(e){var t;null===(t=r.viewerRendererRef)||void 0===t||t.toggleGripper(e)},function(e){var t;null===(t=r.viewerRendererRef)||void 0===t||t.updateGripperPosition(e)},this.goToPage,this.scrollBy,this.scrollTo,function(e){var t;null===(t=r.viewerRendererRef)||void 0===t||t.focusOnVirtualForwardForm(e)},function(e){var t;null===(t=r.viewerRendererRef)||void 0===t||t.focusOnVirtualBackwardForm(e)},this.updateCursorType,this.onFormFocus,function(){return r.context.isFormFillingEnabled},this.rootRef.current||void 0),(null===(t=q.a.features)||void 0===t?void 0:t.enableFreeText)&&(this.freeTextService=new ue(this.viewContext,(null===(n=this.pageManager)||void 0===n?void 0:n.getOriginalPageRects())||[],this.eventBus.dispatch.bind(this.eventBus))),(null===(a=q.a.features)||void 0===a?void 0:a.enableFormFilling)&&(this.formService=new de(this.eventBus.dispatch.bind(this.eventBus))),null===(i=this.loadFontPromise)||void 0===i||i.then(function(){r.renderViewport("Init")}))},t.prototype.initContent=function(){var e,t,n;return(0,s.yv)(this,void 0,void 0,function(){var a,i=this;return(0,s.SO)(this,function(r){switch(r.label){case 0:return a=null===(e=this.displayHelper)||void 0===e?void 0:e.initialRenderOptions,null===(t=this.zoomService)||void 0===t||t.initScale(null==a?void 0:a.scale),(null==a?void 0:a.rotation)?[4,this.rotate(a.rotation)]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.layoutManager.resetContentSize(),this.goToPage(0,null===(n=this.displayHelper)||void 0===n?void 0:n.initialPos),this.initRenderRequestId=requestAnimationFrame(function(){i.layoutManager.resetContentSize(),requestAnimationFrame(function(){v.a.verbose(Lt,"Root size: ".concat(i.layoutManager.rootRect.getClientWidth(),", ").concat(i.layoutManager.rootRect.getClientHeight())),i.renderViewport("Init")})}),[2]}})})},t.prototype.initManipulator=function(){return(0,s.yv)(this,void 0,void 0,function(){var e;return(0,s.SO)(this,function(t){switch(t.label){case 0:return[4,this.wasmDataProvider.getModuleInnerInit("Manipulator")];case 1:return e=t.sent(),[4,this.viewWorker.initialize(e)];case 2:return t.sent(),[2,this.viewWorker.getManipulatorHandlerInstance()]}})})},t.prototype.getManipulatorHandler=function(){return this.manipulatorInitPromise||(this.manipulatorInitPromise=this.initManipulator()),this.manipulatorInitPromise},t.prototype.reset=function(){var e;null===(e=this.renderService)||void 0===e||e.clear(),this.dispose(),this.layoutManager.metadata=void 0,this.setState(At),this.layoutManager.contentRect.reset(),this.layoutManager.rootRect.clear(),this.docLoader=new se(this.props.url,this.props.filename,this.props.fileSize,this.props.enableDownloadByRange,this.props.token,this.props.getAuthHeaders),v.a.verbose(Lt,"Reset")},t.prototype.disposeForReload=function(){var e,t,n,a,i;xe.getInstance().clear(),y.a.clearMarks(),this.storeDisplayInfo(),this.removeEvents(),null===(e=this.renderService)||void 0===e||e.clear(),null===(t=this.printService)||void 0===t||t.dispose(),null===(n=this.inputEvtService)||void 0===n||n.dispose(),this.docLoader.dispose(),null===(a=this.thumbnailService)||void 0===a||a.dispose(),null===(i=this.progressiveLoadingService)||void 0===i||i.dispose(),this.renderService=void 0,this.zoomService=void 0,this.contentService=void 0,this.inputEvtService=void 0,this.rotateService=void 0},t.prototype.dispose=function(){var e,t,n;null===(t=null===(e=this.pinchable)||void 0===e?void 0:e.dispose)||void 0===t||t.call(e),null===(n=this.viewContext)||void 0===n||n.dispose(),this.eventBus.dispose(),this.disposeForReload()},t.prototype.bindWorkerMessage=function(){this.worker.addEventListener("message",this.onWorkerMessage)},t.prototype.bindPageEvents=function(){window.addEventListener("beforeunload",this.onBeforePageUnload),window.addEventListener("unload",this.onPageUnload)},t.prototype.bindEvents=function(){var e;g.a.isActivated("UseSizeObserver")?window.addEventListener("resize",this.onResize):this.observeOuterSizeChange(),window.addEventListener("mousemove",this.onGlobalMouseMove),window.addEventListener("mouseup",this.onGlobalMouseUp);var t=this.rootRef.current;null==t||t.addEventListener("touchmove",this.onTouchMove),null==t||t.addEventListener("scroll",this.onScroll),null==t||t.addEventListener("wheel",this.onWheel,{passive:!1}),(null===(e=this.progressiveLoadingService)||void 0===e?void 0:e.enabled)||this.bindWorkerMessage()},t.prototype.removeEvents=function(){var e;g.a.isActivated("UseSizeObserver")?window.removeEventListener("resize",this.onResize):null===(e=this.outerSizeObserver)||void 0===e||e.disconnect(),window.removeEventListener("mousemove",this.onGlobalMouseMove),window.removeEventListener("mouseup",this.onGlobalMouseUp),window.removeEventListener("beforeunload",this.onBeforePageUnload),window.removeEventListener("unload",this.onPageUnload);var t=this.rootRef.current;null==t||t.removeEventListener("touchmove",this.onTouchMove),null==t||t.removeEventListener("scroll",this.onScroll),null==t||t.removeEventListener("wheel",this.onWheel),this.worker.removeEventListener("message",this.onWorkerMessage)},t.prototype.observeOuterSizeChange=function(){var e=this,t=!0;this.outerSizeObserver=new ResizeObserver(function(n){var a,i;try{for(var r=(0,s.BW)(n),o=r.next();!o.done;o=r.next())if(o.value.target.className===Ze){t?t=!1:e.onResize();break}}catch(e){a={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(a)throw a.error}}}),this.outerRef.current&&this.outerSizeObserver.observe(this.outerRef.current)},t.prototype.resizeViewer=function(){var e,t,n=this,a=(0,_.a)();a!==this.state.dpr&&(this.setState({dpr:a}),this.clearViewport()),(null===(e=this.zoomService)||void 0===e?void 0:e.isResponsiveZoomValid())&&this.eventBus.dispatch(G.e.ResponsiveResize),(null===(t=this.zoomService)||void 0===t?void 0:t.responsiveZoom())||(this.layoutManager.resetContentSize(),requestAnimationFrame(function(){n.renderViewport()}))},t.prototype.updateOuterHeight=function(){this.props.height&&this.outerRect.setHeight(this.props.height)},t.prototype.clearViewport=function(){var e;null===(e=this.renderService)||void 0===e||e.clear(),this.setState({viewportRenderResult:void 0,viewportBlurRenderResult:void 0})},t.prototype.isEvtInsideViewer=function(e){var t,n,a=new f.a(e.clientX,e.clientY),i=e.target,r=null===(t=this.rootRef.current)||void 0===t?void 0:t.getBoundingClientRect();return i instanceof Node&&(null===(n=this.rootRef.current)||void 0===n?void 0:n.contains(i))||!!r&&a.x>=r.x&&a.x<=r.x+r.width&&a.y>=r.y&&a.y<=r.y+r.height},t.prototype.getNativeEvt=function(e){return e.nativeEvent||e},t.prototype.checkWorkerVersion=function(){var e,t;return(0,s.yv)(this,void 0,void 0,function(){var n;return(0,s.SO)(this,function(a){switch(a.label){case 0:return[4,this.viewWorker.getExtWorkerVersion()];case 1:if(n=a.sent(),null===(t=(e=this.props).isWorkerVersionMismatch)||void 0===t?void 0:t.call(e,n))throw new h.f("Fail to initialize viewer due to mismatching between web worker and the main app, workerVersion=".concat(n,", workerSrc=").concat(encodeURIComponent(q.a.workerSrc)));return[2]}})})},Object.defineProperty(t.prototype,"pageManager",{get:function(){return this.layoutManager.pageManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tempAuthLogFields",{get:function(){return I.a.getTempAuthLogFields(this.props.url,this.props.token)},enumerable:!1,configurable:!0}),t.prototype.getHighlightCanvasRect=function(){var e,t,n,a,i,r,o,s;return new f.b(null!==(t=null===(e=this.layoutManager.rootRect)||void 0===e?void 0:e.getScrollLeft())&&void 0!==t?t:0,null!==(a=null===(n=this.layoutManager.rootRect)||void 0===n?void 0:n.getScrollTop())&&void 0!==a?a:0,null!==(r=null===(i=this.layoutManager.rootRect)||void 0===i?void 0:i.getClientWidth())&&void 0!==r?r:0,null!==(s=null===(o=this.layoutManager.rootRect)||void 0===o?void 0:o.getClientHeight())&&void 0!==s?s:0)},t.defaultProps={isRootFocusable:!0,enableCacheDisplayInfo:!0},t.contextType=Ne.b,t}(V.Component)}
,e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,r){for(var o,s,c=i(e),d=1;d<arguments.length;d++){for(var l in o=Object(arguments[d]))n.call(o,l)&&(c[l]=o[l]);if(t){s=t(o);for(var u=0;u<s.length;u++)a.call(o,s[u])&&(c[s[u]]=o[s[u]])}}return c}}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>l,b:()=>c});var a=n(132),i=n(0),r=n("odsp.util_385");let o=!1;const s=[];function c(e,t,n){r.Ov.isActivated("54E9C1A9-2920-4652-8B8B-78037EA1ADAD")?!o&&e&&(o=!0,a.a.logData({name:"ChatODSP.EntryPointRendered"})):e&&s.indexOf(t)<0&&(s.push(t),a.a.logData({name:"ChatODSP.EntryPointRendered",extraData:{scenario:t,userLicenseType:n()}}))}let d=!1;function l(e){d||(d=!0,new i.a({name:"ChatODSP.CopilotAvailability"}).end({resultType:!e.isFoRFlightEnabled&&e.isUserInMochaSegmentation?i.b.Failure:!e.isFoRFlightEnabled||e.customCopilotEAPCheckEnabled&&!e.isUserInEAP?i.b.ExpectedFailure:i.b.Success,extraData:{...e}}))}}
,,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{legacyGraphDataSourceKey:()=>m});var a=n(9),i=n("odsp.util_385"),r=n(41),o=n(15),s=n(45),c=n(74),d=n(1),l=n(151);const u={ODB:620},f=27e5;class p{getItemCurrentVersion(e,t){return a.c.resolve((async()=>{const n=this.getItemUrl(e,t),a=`${n}/versions?$select=id`,{value:i}=await this._sendVroomRequest(n,a,e,t||{},"versions",{});return i.length>0?i[0].id:""})())}getDownloadUrl(e,t={}){const n=this._urlCache;if(!t.forceRefresh){const t=n.get(e.key),{url:r,time:o}=t||{};if(!i.Ov.isActivated("BCD7B9B4-8CA3-4350-87D0-90643D190FE6","11/01/2023","Enable download url cache")&&r&&o>Date.now()-f)return a.c.wrap(r)}if(t.excludeTempAuth&&e.downloadUrlNoAuth)return a.c.resolve(e.downloadUrlNoAuth);if(e.downloadUrl&&""!==e.downloadUrl&&e.itemGeneratedTimeStamp&&Date.now()-e.itemGeneratedTimeStamp<f)return a.c.resolve(e.downloadUrl);const r=t.excludeTempAuth?{Prefer:"pactoken=N"}:void 0,o=this.getItemUrl(e,t),s=`${o}?select=id,@content.downloadUrl`;return this._sendVroomRequest(o,s,e,t,"itemDownloadUrl",r).then(t=>{const a=t["@content.downloadUrl"].replace(/[?&]ApiVersion=[^&]+/,"");return n.set(e.key,{url:a,time:Date.now()}),a})}getDownloadToken(e){const{item:t}=e,n=this._itemUrlHelper.getItemUrlParts(t.key);return n.isCrossDomain?this._identityDataSource.getSharePointToken({webAbsoluteUrl:new r.a(n.fullItemUrl).authority,apiQosName:"LegacyGraphDataSource"}).then(e=>{const{accessToken:t,isBadger:n}=e;return`${n?"badger":"bearer"} ${t}`}):a.c.resolve(void 0)}getAuthenticationParams(e,t){const{apiVersion:n=(i.JW.isFeatureEnabled(u)?"v2.1":"v2.0")}=t||{};return this.refreshAccessToken(e,{...t,apiVersion:n}).then(()=>this._getAuthenticationParamsSync(e,t))}getItemUrl(e,t={}){const{useDirectEndpoint:n=!this._pageContext.isSPO,isPath:a=!1,apiVersion:i="v2.0",allowCookies:r=!1}=t,o=this._getGraphBaseUrl(e,{useDirectEndpoint:n,apiVersion:i,allowCookies:r}),{graph:s}=e;if(s&&s.driveId&&"root"!==s.itemId){const{driveId:e="me",itemId:t="root"}=s;return`${o}/drives/${encodeURIComponent(e)}${"root"===t?"/root":`/items/${encodeURIComponent(t)}`}${a?":":""}`}{const t=e.graph;let n;const i=t&&t.driveId;if(i&&(n=`${o}/drives/${encodeURIComponent(i)}`),!n)return"";const r=this._itemUrlHelper.getItemUrlParts(e.key),{listRelativeItemUrl:s}=this._itemUrlHelper.getUrlParts({path:r.serverRelativeItemUrl,listUrl:r.serverRelativeListUrl});return`${n}/root${s?`:/${encodeURI(s)}${a?"":":"}`:a?":":""}`}}getAccessToken(e,t={}){const{apiVersion:n}=t,a=e;return"v2.1"===n?a&&a.graph.sessionTokenV21:a&&a.graph.sessionToken}refreshAccessToken(e,t={}){return a.c.resolve(this.getAccessToken(e,t))}getMetaPac(e,t={}){return a.c.resolve(this.getAccessToken(e,t))}getDownloadUrlSync(e,t){}getDriveUrl(e,t){return""}_getAuthenticationParamsSync(e,t){const n=this.getAccessToken(e,t);if(n){const{accessToken:e,proofToken:t}=n,a={};return e&&(a.access_token=e),t&&(a.prooftoken=t),a}return{}}_getGraphBaseUrl(e,t){const{useDirectEndpoint:n,apiVersion:a}=t,i=this._itemUrlHelper.getItemUrlParts(e.key),o=i.fullListUrl;if(n){if(o)return`${new r.a(o).authority}/_api/${a}`;if(i.isCrossDomain||i.isCrossList){const t=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;return`${new r.a(t).authority}/_api/${a}`}return this._urlDataSource.getApiBaseUrl({apiVersion:a})}return"https://graph.microsoft.com/v1.0"}_sendVroomRequest(e,t,n,i={},o,s){const c=this._itemUrlHelper.getItemUrlParts(n.key),{isCrossDomain:d}=c;i.apiName&&(o=`${i.apiName}.${o}`);const l=!d;return(l?a.c.resolve(void 0):this._identityDataSource.getSharePointToken({webAbsoluteUrl:new r.a(e).authority,apiQosName:"LegacyGraphDataSource"})).then(e=>{const n=l?void 0:e;return this._vroomDataRequestor.send({apiName:o,path:`${t}`,accessToken:n,qosExtraData:i.qosExtraData,allowCookies:l,headers:s})})}constructor(e,t){this._urlDataSource=t.urlDataSource,this._itemUrlHelper=t.itemUrlHelper,this._pageContext=t.pageContext,this._urlCache=new Map,this._vroomDataRequestor=t.vroomDataRequestor,this._identityDataSource=t.identityDataSource}}p.dependencies={urlDataSource:l.b,itemUrlHelper:o.c,pageContext:d.a,vroomDataRequestor:c.a,identityDataSource:s.resourceKey};const m=(0,i.C2)("LegacyGraphDataSource",p)}
,(e,t,n)=>{var a="Expected a function",i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,u=d||l||Function("return this")(),f=Object.prototype.toString,p=Math.max,m=Math.min,_=function(){return u.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=o.test(e);return n||s.test(e)?c(e.slice(2),n?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError(a);return h(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),function(e,t,n){var i,r,o,s,c,d,l=0,u=!1,f=!1,g=!0;if("function"!=typeof e)throw new TypeError(a);function v(t){var n=i,a=r;return i=r=void 0,l=t,s=e.apply(a,n)}function y(e){return l=e,c=setTimeout(D,t),u?v(e):s}function S(e){var n=e-d;return void 0===d||n>=t||n<0||f&&e-l>=o}function D(){var e=_();if(S(e))return I(e);c=setTimeout(D,function(e){var n=t-(e-d);return f?m(n,o-(e-l)):n}(e))}function I(e){return c=void 0,g&&i?v(e):(i=r=void 0,s)}function x(){var e=_(),n=S(e);if(i=arguments,r=this,d=e,n){if(void 0===c)return y(d);if(f)return c=setTimeout(D,t),v(d)}return void 0===c&&(c=setTimeout(D,t)),s}return t=b(t)||0,h(n)&&(u=!!n.leading,o=(f="maxWait"in n)?p(b(n.maxWait)||0,t):o,g="trailing"in n?!!n.trailing:g),x.cancel=function(){void 0!==c&&clearTimeout(c),l=0,i=d=r=c=void 0},x.flush=function(){return void 0===c?s:I(_())},x}(e,t,{leading:i,maxWait:t,trailing:r})}}
,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>q});var a=n(511),i=n(258),r=n(266),o=n(519),s=n(155),c=n(267),d=n(268),l=n(106),u=n(269),f=n(146),p=n(100),m=n("odsp.util_385"),_=n(857),h=n(203),b=n(157),g=n(523),v=n(526);const y=[".docm",".dotm",".dotx",".docx",".bmp",".jpg",".jpeg",".tiff",".tif",".png",".gif",".emf",".wmf",".psd",".svg",".ai",".pdf",".pptm",".pptx",".potm",".potx",".ppsm",".ppsx",".xlsm",".xlsx",".aspx"];function S(e){return!!e&&y.indexOf(e.toLowerCase())>=0}var D=n(270),I=n(107),x=n(6),C=n(527),O=n(61),w=n(271),E=n(15),A=n(97),L=n(27),k=n(21),M=n(1),P=n(31),T=n(528),U=n(4),F=n(79),H=n(158);const R=!m.Ov.isActivated("b8f99452-1739-40bb-a1bb-dd8b65e27ec6","07/13/2024","Fix image preview of remote item in Gallatin"),N=[".dcm",".dcm30",".dic",".dicm",".dicom"];function B(e){const{endpoint:t,driveId:n,itemId:a="root"}=(0,r.a)(e);if(t)return{endpoint:t,driveId:n,itemId:a}}function j(e){const{pageContext:t,spItemIdentity:n,itemFromServer:a,oneUpUrlDataSource:i,navigation:r,itemUrlHelper:o,rootItemSet:s}=e;let c,d;if(s)c=function(e){const{rootItemSet:t,oneUpUrlDataSource:n}=e;return n.getKey({[k.a.queryTypeParamKey]:t.queryType})}({oneUpUrlDataSource:i,rootItemSet:s});else{let e;a&&(e=a.FileRef||a.ServerRelativeUrl),n&&({key:c,id:d}=function(e){const{spItemIdentity:t,folderPath:n,newTargetListViewUrl:a,itemUrlHelper:i,supportsOnePageNavigation:r,itemQueryParams:o,searchParams:s,oneUpUrlDataSource:c,...d}=e,l=i.getUrlParts({webUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl,path:n||t.rootFolder});if(t.itemId&&!n)return{key:void 0,id:void 0};let u=!0;return r&&a&&!d.listUrl&&l.normalizedListUrl&&a.indexOf(l.normalizedListUrl)>-1&&(u=!1),{key:c.getKey({[k.a.idParamKey]:l.serverRelativeItemUrl||"",...u&&l.normalizedListUrl?{[k.a.listUrlKey]:l.normalizedListUrl}:{},...o||{},...s||{}}),id:l.serverRelativeItemUrl||""}}({spItemIdentity:n,oneUpUrlDataSource:i,folderPath:e,itemUrlHelper:o,listUrl:t.listUrl,viewParams:r.viewParams}))}return{key:c,viewParams:r.viewParams,id:d}}function V(e){const{itemFromServer:t,extension:n,mediaServiceFastMetadata:a,blockDownload:i,microServiceDataSource:r,pdfConversionOptions:o}=e;let s;const d={fileExtension:e.extension,item:t,mediaServiceMetadata:a};if(s=i&&(0,c.b)(n)?r.getPassthroughUrl(d,o):r.getPdfConversionUrl(d,void 0,o),s)return{url:s}}function z(e){if(e&&"{}"!==e)try{return JSON.parse(e)}catch(e){return}}function G({siteId:e,webId:t,docId:n,webUrl:a,layoutsUrl:i}){let r;const o=r=>a+"/"+i+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+(r?"":"&resolution=Width1024");return n&&(r={url:o(!1),width:0,height:0,getAligned:(e,t)=>({url:o(t.name===_.a.name),width:0,height:0})}),r}function K(e){return void 0!==e?e/1e4:NaN}function W(e){if(!e)return{};const{".driveAccessTokenV21":t,".driveAccessToken":n,".driveUrl":a,".driveUrlV21":i,".driveAccessCode":r,".driveAccessCodeV21":o}=e;let c,d,l;if(n){const e=(0,h.a)(n);if(c={accessToken:e.access_token,proofToken:e.prooftoken,tokenUrl:a},a){const e=B(a);e&&(l=e.driveId)}}if(t){const e=(0,h.a)(t);if(d={accessToken:e.access_token,proofToken:e.prooftoken,tokenUrl:i},i&&!l){const e=B(i);e&&(l=e.driveId)}}return m.Ov.isActivated("30d02c53-cd92-4e96-a4c6-f129734b443f","03/18/2025","Add MeTA PAC tokens (driveAccessCode and driveAccessCodeV21) to sessionToken")||(r&&(c={...c||{},metaPac:r}),o&&(d={...d||{},metaPac:o})),c&&(0,s.a)({authToken:c.accessToken,proofToken:c.proofToken})&&(c=void 0),d&&(0,s.a)({authToken:d.accessToken,proofToken:d.proofToken})&&(d=void 0),{driveId:l,sessionToken:c,sessionTokenV21:d}}const q=new m.OJ({name:"ProcessOneUpItem",factory:{dependencies:{pageContext:M.a,oneUpUrlDataSource:i.a,microServiceDataSource:A.a,navigation:L.a,itemUrlHelper:E.c,isMeTATempAuthDeprecationEnabled:H.a},create:({pageContext:e,oneUpUrlDataSource:t,microServiceDataSource:n,navigation:i,itemUrlHelper:r,isMeTATempAuthDeprecationEnabled:s})=>({instance:{processOneUpItem:function(c){return c.microServiceDataSource||delete c.microServiceDataSource,function(e){const{pageContext:t,itemFromServer:n,mediaTransformListSchema:i,microServiceDataSource:r,itemUrlHelper:s,oneUpUrlDataSource:c,spItemIdentity:_,spParentItemIdentity:h,navigation:y,listContext:E,currentPageContext:A,mainLinkInfo:L,isMeTATempAuthDeprecationEnabled:M}=e,H=t.listBaseTemplate,{key:q,id:Q}=j({pageContext:t,spItemIdentity:_,itemFromServer:n,oneUpUrlDataSource:c,navigation:y,itemUrlHelper:s}),Y={key:q||"",id:Q};if(h){const{key:e}=j({pageContext:t,spItemIdentity:h,itemFromServer:n,oneUpUrlDataSource:c,navigation:y,itemUrlHelper:s});e&&(Y.parentKey=e)}const{sessionToken:J,sessionTokenV21:X}=W(i);if(Y.graph={itemId:"",driveId:"",sessionToken:J,sessionTokenV21:X},(0,F.a)()&&L&&(Y.mainLinkInfo=L),n){const e=n[".spItemUrl"],i=e?B(e):void 0;if(i){const{itemId:e,driveId:t}=i;Y.itemId=e,Y.graph={...Y.graph,itemId:e||"",driveId:t||""}}const _=n.PermMask?(0,u.a)(n.PermMask):void 0;_&&(Y.permissions=_),Y.displayName=function({itemFromServer:e,listTemplateType:t=f.a.documentLibrary}){let n=t&&(0,p.d)(t)||t===f.a.promotedLinks||(0,p.c)(t)?e.Title:e.FileLeafRef;return t===f.a.links&&(n=e["URL.desc"]||e.URL||n),n}({itemFromServer:n,listTemplateType:H});const{name:h,extension:y}=function(e){const{File_x0020_Type:t,FileLeafRef:n,FileRef:a,RemoteItem:i}=e,r=t&&!i?"."+t:"",o=n||a&&new x.a(a).segments.slice(-1)[0]||"",s=r&&o?o.toLowerCase().lastIndexOf(r.toLowerCase()):-1;return{name:s>-1?o.substring(0,s):o,extension:r}}(n);Y.name=h,Y.extension=y;const L=Number(n.File_x0020_Size)||Number(n.FileSizeDisplay)||void 0;if(void 0!==L&&(Y.size=L),Y.totalSize=Number(n.SMTotalSize)||void 0,(0,U.ib)()){const e="Created_x0020_Date"in n,t=n.Created_x0020_Date?.split(";#").pop();if(e&&t){const e=new Date(t).getTime();if(!isNaN(e)){Y.dateCreatedTime=new Date(e);const t=O.a.language||window.navigator.language;Y.dateCreated=(0,g.c)(Y.dateCreatedTime,t)}}}const j="Modified."in n,W=n["Modified."];if(j&&W){const e=new Date(W).getTime();if(!isNaN(e)){Y.dateModifiedTime=new Date(e);const t=O.a.language||window.navigator.language;Y.dateModified=(0,g.c)(Y.dateModifiedTime,t)}}Y.contentTypeId=n.ContentTypeId;const Q=z(n.MediaServiceFastMetadata),J=z(n.MediaServiceMetadata),X=M?{isMeTATempAuthDeprecationEnabled:!0}:void 0,Z=function({itemFromServer:e,extension:t,microServiceDataSource:n,pageContext:a,isMeTATempAuthDeprecationEnabled:i}){if(!a.isSPO)return;const r=n.getFbxConversionUrl({fileExtension:t,item:e},{isMeTATempAuthDeprecationEnabled:i}),o=(0,d.b)(t)||!1;return r||o?{canConvert:!0,canRenderNative:o,conversionUrl:r&&r.replace("/bxf?","/glb?")}:void 0}({pageContext:t,itemFromServer:n,extension:y,microServiceDataSource:r,isMeTATempAuthDeprecationEnabled:M});Z&&(Y.model3d=Z);const $=_&&P.a.hasPermission(_,P.a.openItems),ee=t.blockDownloadsExperienceEnabled||t.viewOnlyExperienceEnabled||!$,te=(0,U.nc)()&&M?{isMeTATempAuthDeprecationEnabled:!0}:void 0,ne=V({itemFromServer:n,extension:y,mediaServiceFastMetadata:Q,blockDownload:ee,microServiceDataSource:r,pdfConversionOptions:te});ne&&(Y.pdfConversion=ne);let ae=function(e){const{itemFromServer:t,listTemplateType:n,mediaServiceFastMetadata:i,hasPdfConversion:r,has3d:o}=e;let s=a.a.Unknown;if(t.folder)s=a.a.Folder;else if("1"===t.FSObjType||t.RemoteItem){const e=t["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],n=t["File_x0020_Type.mapapp"];s=n&&"onenote"===n.substring(0,7)||e&&-1!==e.indexOf("onenote")?a.a.OneNote:a.a.Folder}if(s===a.a.Unknown){const e=t.File_x0020_Type,c=e?`.${e}`:"";if(e&&C.a.isShortcutFileType(e))return a.a.Shortcut;if("pdf"===e||r)return a.a.Media;if(o)return a.a.Media;if("audio"===(0,b.b)(c))return a.a.Media;if(i)return a.a.Media;if(s=(0,b.d)(c),s===a.a.Unknown)return void 0!==n&&(0,p.d)(n)?a.a.File:n===f.a.promotedLinks?a.a.Media:s}return s||a.a.File}({itemFromServer:n,mediaServiceFastMetadata:Q,listTemplateType:H,hasPdfConversion:!!V({itemFromServer:n,extension:y,mediaServiceFastMetadata:Q,blockDownload:!0,microServiceDataSource:r,pdfConversionOptions:te}),has3d:!!Z});if((((0,U.fc)()?S(y):(0,v.a)(y))||".ai"===y||".eps"===y||".psd"===y)&&r.getThumbnail({fileExtension:y,item:n,itemKey:q||"",mediaServiceMetadata:Q},X)&&(ae=a.a.Media),o.b(y))Y.htmlConversion={};else if(o.a(y)){const e=r.getHtmlConversionUrl({fileExtension:y,item:n,mediaServiceMetadata:Q},X);e&&(ae=a.a.Media,Y.htmlConversion={url:`${e}&inlineImages=true`})}if(".zip"===y||".rar"===y){const e=r.getZipMetaDataUrl({fileExtension:y,item:n,mediaServiceMetadata:Q},X),t=r.getDownloadZipContentsUrl(n);e&&t&&(ae=a.a.Media,Y.zip={zipMetaDataUrl:e,downloadZipContentsUrl:t})}const ie=Q&&Q.video,re=".ts"===y&&void 0!==L&&L<1<<19&&!ie;let oe;re&&(ae=a.a.File);const se={},ce=r.getDownloadAsZipUrl(n),de=r.getImmersiveReaderUrl({fileExtension:y,item:n}),le=c.getKeyParams(q),ue=s.getUrlParts({path:n.id||n.FileRef||n.ServerRelativeUrl,listUrl:le[k.a.listUrlKey]}),fe=ue.fullItemUrl,pe=fe?I.a(fe):void 0;ce&&(se[l.b.downloadAsZip]=ce),de&&(se[l.b.immersiveReaderUrl]=de),e&&(se[l.b.itemUrl]=e);let me=n["serverurl.progid"];me=me?me.substring(1):H===f.a.links?n.URL:pe,me&&(se[l.b.original]=me),C.a.isShortcutItem({key:q||"",extension:y})&&(ae=a.a.Shortcut,Y.shortcutInfo={shortcutLinkRewritten:!0},n._ShortcutUrl&&(se[l.b.shortcutTarget]=n._ShortcutUrl),n._ShortcutUniqueId&&(oe=G({siteId:n._ShortcutSiteId,webId:n._ShortcutWebId,docId:n._ShortcutUniqueId,webUrl:t.webAbsoluteUrl,layoutsUrl:t.layoutsUrl}))),me&&(se[l.b.open]=me);let _e=n["File_x0020_Type.mapapp"];_e||(_e=n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],_e&&(_e=_e.split("|").slice(-1).join())),Y.appMap=_e,oe||(oe=function(e){if(e.type===a.a.Folder)return;const{itemFromServer:t}=e;if(void 0!==e.listTemplateType&&(0,p.e)(e.listTemplateType))return{url:t.BackgroundImageLocation||"",width:0,height:0};const n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===f.a.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata},{isMeTATempAuthDeprecationEnabled:e.isMeTATempAuthDeprecationEnabled});if(n)return n;const{pageContext:i,currentPageContext:r}=e;if(((0,U.fc)()?S(e.extension):(0,v.a)(e.extension))&&i){const{siteId:e,webId:n,webAbsoluteUrl:a,layoutsUrl:o}=i;return G({siteId:R&&r?.siteId||e,webId:R&&r?.webId||n,docId:t.UniqueId,webUrl:a,layoutsUrl:o})}}({itemFromServer:n,listTemplateType:H,extension:y,key:q||"",type:ae,mediaServiceFastMetadata:Q,microServiceDataSource:r,pageContext:t,currentPageContext:A,isMeTATempAuthDeprecationEnabled:M})),Y.openUrl=me,Y.downloadUrl=n[".downloadUrl"]||void 0,Y.downloadUrlNoAuth=n[".downloadUrlNoAuth"]||void 0,Y.itemGeneratedTimeStamp=Date.now();const he=n["IconOverlay.mapoly"];if(he&&(Y.overlayUrl="/"+t.layoutsUrl+"/images/"+he),oe&&(Y.thumbnail=oe),ae===a.a.Folder){Y.childCount=function(e){const{FolderChildCount:t,ItemChildCount:n,RemoteItem:a}=e;if(a)return JSON.parse(a).FolderChildCount;const i=n?parseInt(n,10):NaN,r=t?parseInt(t,10):NaN;return isNaN(i)&&isNaN(r)?void 0:isNaN(i)?r:isNaN(r)?i:i+r}(n);const e=Number(n.SMTotalFileCount);Y.folder={totalCount:e>0?e:Y.childCount,childCount:Y.childCount}}const be=n.ServerRedirectedEmbedUrl;be&&(s.getUrlParts({path:be}).isCrossDomain||(Y.previewIFrameUrl=be)),Y.type=ae;const{ID:ge,UniqueId:ve}=n,ye={};ye.uniqueId=(0,m.YR)(ve),ye.ID=ge,(0,U.rb)()&&(ye.siteId=(0,m.YR)(A?.siteId),ye.webId=(0,m.YR)(A?.webId),ye.listId=(0,m.YR)(A?.listId));for(const e in n)n.hasOwnProperty(e)&&(ye[e]=n[e]);Y.properties=ye;const Se="ms-excel"===_e,De="ms-powerpoint"===_e,Ie="ms-visio"===_e,xe="ms-word"===_e;let Ce=!0;if((0,U.Sc)()&&y){const e=w.b[y.replace(/^\./,"")];Ce=!!e&&(e===w.f||e===w.c||e===w.d||e===w.e)}if(me&&(xe||Se||De||Ie)&&Ce){const e=function(e){const{isWord:t,extension:n,itemUrlParts:a,isPowerPoint:i,itemFromServer:r,microServiceDataSource:o,mediaServiceFastMetadata:s}=e;if(a.isCrossDomain)return;const c=t||i,d=(t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:r,mediaServiceMetadata:s}):"")||"",l=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:r,mediaServiceMetadata:s})||"";let u,f,p,m=!1,_="";const h=r[".ctag"],b=s&&s.officeBundle;return b&&(u=b.ctag,p=b.version,m=b.fatalError||!1,b.generationTime&&(f=new Date(b.generationTime)),_=b.errorInfo||""),{officeBundleGenerateUrl:d,officeBundleGetFragmentUrl:l,bundleCTag:u||"",bundleVersion:p||"",hasBundleGenerationFailed:m,bundleErrorInfo:_,generationTime:f,cTag:h||"",enableDefaultClick:c}}({isWord:xe,extension:y,itemUrlParts:ue,isPowerPoint:De,itemFromServer:n,microServiceDataSource:r,mediaServiceFastMetadata:Q});if(e&&!Ie&&(Y.officeBundle=e),e&&(xe||De)){const e=r.getPdfConversionUrl({fileExtension:y,item:n,mediaServiceMetadata:Q},!0,te);e&&(se[l.b.viewInBrowser]=e)}Y.wopiFrameUrl=me}const Oe=r.getVideoUrl({fileExtension:y,item:n,mediaServiceMetadata:Q});Oe&&(se[l.b.video]=Oe);const we=r.getMediaBaseUrl({fileExtension:y,item:n,mediaServiceMetadata:Q});we&&(se[l.b.mediaBaseUrl]=we);const Ee=r.getThumbnailSpriteBaseUrl({fileExtension:y,item:n});let Ae;Ee&&(se[l.b.thumbnailSpriteBaseUrl]=Ee),Y.urls=se;const Le=N.indexOf(y)>=0;let ke,Me,Pe,Te,Ue,Fe;if(ae===a.a.Folder)Ae=!!n.ProgId&&"sharepoint.documentset"===n.ProgId.toLowerCase(),Y.isDocSet=Ae;else if(ae!==a.a.Media&&!Q||void 0!==H&&(0,p.e)(H))ae===a.a.File&&E&&void 0!==E.isDocLib&&!E.isDocLib&&(Ue={});else{const e=b.b(y),t=Q&&Q.photo||(Le||"photo"===e?{}:void 0),a=ie||("video"===e?{}:void 0),r=Q&&Q.audio||("audio"===e?{}:void 0);t&&(ke={originalUrl:"photo"===e?pe:void 0,width:t.width||0,height:t.height||0},i&&i.itemId&&(Me=function({itemFromServer:e,mediaServiceFastMetadata:t,photoMetadata:n,fullMediaServiceMetadata:a}){let i;const r=t&&t.panorama;let o=!1;if(r&&"equirectangular"===r.projectionType?(i={projectionType:r.projectionType},o=!0):e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:void 0!==n.width&&n.width>0&&void 0!==n.height&&n.height>0&&n.width/n.height==2&&(o=!0),o&&a){const e=a.panorama;if(e)i={projectionType:r&&r.projectionType||void 0,croppedAreaImageHeightPixels:e.croppedAreaImageHeightPixels||void 0,croppedAreaImageWidthPixels:e.croppedAreaImageWidthPixels||void 0,croppedAreaLeftPixels:e.croppedAreaLeftPixels||void 0,croppedAreaTopPixels:e.croppedAreaTopPixels||void 0,fullPanoHeightPixels:e.fullPanoHeightPixels||void 0,fullPanoWidthPixels:e.fullPanoWidthPixels||void 0,initialHorizontalFOVDegrees:e.initialHorizontalFOVDegrees||void 0,initialVerticalFOVDegrees:e.initialVerticalFOVDegrees||void 0,initialViewHeadingDegrees:e.initialViewHeadingDegrees||void 0,initialViewPitchDegrees:e.initialViewPitchDegrees||void 0,initialViewRollDegrees:e.initialViewRollDegrees||void 0,poseHeadingDegrees:e.poseHeadingDegrees||void 0,posePitchDegrees:e.posePitchDegrees||void 0,poseRollDegrees:e.poseRollDegrees||void 0};else{const e=a.photo;if(e&&e.cameraModel){const t=e.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro - 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(t)>=0&&(i={projectionType:"equirectangular"})}}}return i}({itemFromServer:n,mediaServiceFastMetadata:Q,photoMetadata:t,fullMediaServiceMetadata:J})));const o={mediaEdits:n.Edits?JSON.parse(n.Edits):void 0,previewThumbnailsQualitySets:!m.Ov.isActivated("96f75f66-17fb-4071-9322-86e0db732994","07/04/2024","Get preview thumbnails information from RLDAS infromation for Seek bar thumbnails.")&&n.PreviewThumbnailsQualitySets?JSON.parse(n.PreviewThumbnailsQualitySets):void 0};Y.media=o;const s=Q&&Q.media;if(a){const e=m.Ov.isActivated("f0fc3265-1fce-4d4a-b67a-3b3dfa291a6f","09/27/2023","Get PremiumProcessingStatus from RLDAS for Premium Video in 1P 1.0")?void 0:a.premiumProcessingStatus;Pe={fourCC:a.fourCC||(".mp4"===y.toLowerCase()?"H264":void 0),bitrate:a.encodingBitrate,width:a.frameWidth||0,height:a.frameHeight||0,duration:K(s&&s.duration),audioFormat:r&&r.format,manifestMetadata:a.manifestMetadata,altManifestMetadata:a.altManifestMetadata,premiumProcessingStatus:e}}r&&(Te={duration:K(s&&s.duration)})}Y.photo=ke,Y.image360=Me,Y.video=Pe,Y.audio=Te;const He=!t||"21"===t.webTemplate&&700===t.listBaseTemplate;Fe=Number(n.PrincipalCount)>0?D.a.Shared:void 0===n.PrincipalCount?He?void 0:D.a.Unknown:D.a.Private,Y.sharingType=Fe;const Re=b.c({extension:y,isDocSet:Ae,listItem:Ue,sharingType:Fe,type:ae,textEditorMimeType:re?"text/typescript":void 0,panorama:Me,isMountPoint:!!n.RemoteItem});Y.iconName=Re,Y.isPlaceholder=!Y.displayName&&!Y.permissions;const Ne=function(e){return{isMalwareDetected:(0,T.a)(e),isNew:(0,T.b)(e)}}(n);if(Ne&&(Y.lifeCycleStatus=Ne),(0,F.a)()&&n[".mainLinkInfo"])try{Y.mainLinkInfo=JSON.parse(n[".mainLinkInfo"])}catch(e){}}return Y}({pageContext:e,oneUpUrlDataSource:t,microServiceDataSource:n,navigation:i,itemUrlHelper:r,isMeTATempAuthDeprecationEnabled:s,...c})},processOneUpListRootItem:function(o){return function(e){const{pageContext:t,oneUpListInfo:n,itemUrlHelper:i,oneUpUrlDataSource:r,spItemIdentity:o,navigation:s}=e,{key:c,id:d}=j({pageContext:t,spItemIdentity:o,oneUpUrlDataSource:r,navigation:s,itemUrlHelper:i}),l={key:c||"",id:d},{mediaTransform:u,list:f,permissions:p}=n,{sessionToken:m,sessionTokenV21:_,driveId:h}=W(u);return l.itemId=l.itemId||"root",l.graph={itemId:"root",driveId:h||"",sessionToken:m,sessionTokenV21:_},l.name=l.name||f.title,l.displayName=l.displayName||f.title,l.type=a.a.Folder,l.isRootFolder=!0,l.folder={},l.list=f,l.permissions=p,l}({pageContext:e,oneUpUrlDataSource:t,microServiceDataSource:n,navigation:i,itemUrlHelper:r,isMeTATempAuthDeprecationEnabled:s,...o})}}})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("odsp.util_385"),i=n(151);const r=new a.OJ({name:"oneUpUrlDataSource",factory:new a.A3(i.a)})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a="remoteItem"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a="parent"}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>i});const a="parentview",i="view"}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(13),i=n("odsp.util_385");function r(e){const{oneUpProps:t,appPageContext:n,item:r}=e,o=new a.b({context:n}),{id:s,listurl:c}=(0,i.pW)(r.key),d=o.getUrlParts({listUrl:c,path:s}),l=d.fullWebUrl;if(l&&d.serverRelativeListUrl){const e={webAbsoluteUrl:l,listUrl:d.serverRelativeListUrl};return t?.pageContexts?.get(e)}}}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>d});var a=n("odsp.util_385"),i=n(224),r=n(4),o=n(1);const s={ODB:61356},c={isFavoritesEnabled:i.a,pageContext:o.a},d=new a.OJ({name:"isFavoritesEnabledInOneUp",factory:{dependencies:c,create:e=>({instance:e.isFavoritesEnabled()&&(0,r.jb)(s)})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"UniversalPrintDataSourceAsync.key",loader:new a.hg(()=>n.e(79).then(n.bind(n,775)).then(e=>e.universalPrintDataSourceKey))})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>_});var a,i,r=n("odsp.util_385"),o=n(80),s=n(1),c=n(277),d=n(39),l=n(27),u=n(21),f=n(56),p=n(4);!function(e){e.legacy="legacy",e.phase1="react",e.phase2="newDesign"}(a||(a={})),function(e){e.carousel="carousel",e.fast="fast",e.embed="embed"}(i||(i={}));const m={isFastOneUp:o.j.optional,pageContext:s.a,navigation:l.a,platformDetection:f.a.optional},_=new r.OJ({name:"OneUpEngagementContextKey",factory:{dependencies:m,create:e=>{const{pageContext:t,isFastOneUp:n}=e,a=t?(0,d.c)(Number(t.webTemplate)):"unknown",i=t?(0,c.a)(t):void 0;return{instance:{previewContext:h(n),webTemplate:a,clientId:i,isSyntexEnabled:t?t.isSyntexEnabled:"unknown",oneUpPhase:"newDesign",isSyncAutoAction:(0,p.fb)()?"sync"===e.navigation.viewParams[u.b.openedFrom]?.toLowerCase():!!e.navigation.viewParams[u.b.action],isMobile:!!e.platformDetection?.isMobile}}}}});function h(e){return e?"fast":"carousel"}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n(39),i=n("odsp.util_385"),r=n(60);function o(e){const t=e?.authToken||"",n=(0,r.b)(t);let o;return o=n&&n.app_displayname?n.app_displayname:function(){const e=window;return{...(0,i.pW)((e.location.search||"").slice(1)),...(0,i.pW)((e.location.hash||"").slice(1)),...e.PageContext?.scenarioContext.embed||{}}.client_id}()||(Number(e.webTemplate)===a.b.mySite?"ODB":"SPList"),o}}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>g,b:()=>y});var a=n(0),i=n("odsp.util_385"),r=n(34),o=n(105),s=n(162),c=n(80),d=n(1),l=n(165),u=n(166),f=n(15),p=n(293),m=n(115),_=n(4),h=n(294);const b=i.Ov.isActivated("4991B354-419D-471B-9ABD-2B20890E4E0C");var g;!function(e){e.next="next",e.previous="previous",e.close="close"}(g||(g={}));const v={getValidViewerTypes:s.c,isFastOneUp:c.j.optional,pageContext:d.a,itemUrlHelper:f.c},y=new i.OJ({name:"OneUpLoadingCustomerPromiseFunctionsKey",factory:{dependencies:v,create:e=>{let t,n;const c=e.pageContext,d=(0,l.b)(c)?.toLowerCase()||"unknown",f="View";return{instance:{newLoadingCustomerPromise:function(a,i){let r=i;!b&&i&&(r={...i},delete r.item),void 0===n&&(t=a,n=new u.a({scenario:"OneUpLightSpeed.load",perfGoalInMs:o.c,pillar:f,extraData:{oneUpRenderingMode:e.isFastOneUp?o.e.fastOneUp:o.e.inlineOneUpFirstPage,viewerName:e.getValidViewerTypes.getValidViewerTypes(a),fileExtension:a.extension,fileSize:a.size,fileSizeRange:(0,o.g)(a.size),Ring:d,isCrossList:e.itemUrlHelper.getItemUrlParts(t.key).isCrossList,...r}}))},reportLoadingCXPSuccess:function(i){n?.end({resultType:a.b.Success,extraData:{...i.extraData,navigationOption:i.navExtraData?.navigationOption,isCrossList:e.itemUrlHelper.getItemUrlParts(t.key).isCrossList}}),n=void 0,i.navExtraData&&i.navExtraData.newItem&&("previous"===i.navExtraData.navigationOption||"next"===i.navExtraData.navigationOption)&&(t=i.navExtraData.newItem,n=new u.a({scenario:"OneUpLightSpeed.load",perfGoalInMs:o.c,pillar:f,extraData:{oneUpRenderingMode:o.e.inlineOneUpSlide,viewerName:e.getValidViewerTypes.getValidViewerTypes(i.navExtraData.newItem),fileExtension:i.navExtraData.newItem.extension,fileSize:i.navExtraData.newItem.size,fileSizeRange:(0,o.g)(i.navExtraData.newItem.size),Ring:d,isNavigating:!0,navigationOptions:i.navExtraData.navigationOption,navNewItemUniqueId:i.navExtraData.newItem?.properties?.uniqueId,isCrossList:e.itemUrlHelper.getItemUrlParts(t.key).isCrossList}}))},reportLoadingCXPFailure:function(o){const{errorType:d,error:l,item:u,meTAEvent:f}=o.rawError;let b,g,v,y,S;if(l instanceof i.a_||l instanceof i.a_){const e=l;b=(0,r.a)(l),g=function(e){return e&&"string"==typeof e?e.split(",").join("_"):JSON.stringify(e)}(b.resultCode||"Unknown"),v=b.resultType,y=l.correlationId,S={...o.rawError.extraData,...e.extraData}}else g=l.message,v=a.b.Failure,S={...o.rawError.extraData};const D="spdf"===c.cloudType?.toLowerCase(),I={viewerName:u&&e.getValidViewerTypes.getValidViewerTypes(u)||s.a.Unknown,extension:u&&u.extension||"Unknown",errorType:d,rawError:l,isPPE:D,...b?.extraData,CorrelationId:y||c?.CorrelationId,isCrossList:e.itemUrlHelper.getItemUrlParts(t.key).isCrossList,...(0,m.a)(o.rawError.extraData?.url),noTempAuth:o.rawError.extraData?.noTempAuth,...S};let x;if((0,_.Db)()){const e=(0,h.a)(I);x={...I,diagnosticInfo:e}}else x=I;n?.end({resultType:v,errorCode:g,extraData:x}),n=void 0,f&&(0,p.b)(f,{resultType:v,errorCode:g,extraData:x})}}}}}})}
,(e,t,n)=>{"use strict";let a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,{a:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>i});const a=e=>{if(!e)return!1;const t=(window.Flight?.ecsConfig&&JSON.parse(window.Flight?.ecsConfig))?.RolloutContext?.settings?.ODSPMicroservices_ODWeb;return t&&!0===t[e]},i=e=>a(e)}
,(e,t,n)=>{"use strict";function a(e){const t=e=>{try{const n=new URL(e.toLowerCase()).searchParams,a=n.get("tempauth"),i=n.get("access_token"),r=n.get("docid");return!!(a&&"false"!==a||i&&"false"!==i)||!!r&&t(decodeURI(r))}catch(e){return}};return t(e)}n.d(t,{a:()=>a})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>m});var a=n("odsp.util_385"),i=n(10),r=n(15),o=n(163),s=n(1),c=n(544),d=n(74);const l=(0,a.C2)("PreAuthServiceKey",c.a,{dataRequestor:d.a});var u=n(45),f=n(4);const p={oneUpStateStore:i.f,graphDataSource:o.a,itemUrlHelper:r.c,preAuthService:l,identityDataSource:u.resourceKey,pageContext:s.a},m=new a.OJ({name:"FileHandlerHelper",factory:{dependencies:p,create:e=>({instance:{hasFileHandler:function(t){const n=e.oneUpStateStore.getFileHandlerOptions();if(n){const e=n?.data.actions.preview,a=t.extension;for(let t=0;t<e.length;t++){const n=e[t].availableOn.file,i=n&&n.extensions||void 0;if(n&&a){const e="."!==a.charAt(0)?"."+a:a;if(!(0,f.Nb)())return!i||-1!==i.indexOf(e.toLowerCase())||-1!==i.indexOf("*");if(i&&i.indexOf(e.toLowerCase())>-1)return!0}}}return!1},getCorrespondingPreviewFileHandlerPostData:async function(t){const n=e.oneUpStateStore.getFileHandlerOptions();if(n){const e=n?.data.actions.preview,a=t.extension;for(let n=0;n<e.length;n++){const i=e[n].availableOn.file,r=i&&i.extensions||void 0;if(i&&a){const i="."!==a.charAt(0)?"."+a:a;if(!r||-1!==r.indexOf(i.toLowerCase())||-1!==r.indexOf("*")||-1!==r.indexOf(".*"))try{const a=await this.getFileHandlerItemUrl(t,e[n],!!e[n].handler.isPromoted);if(a&&a.length>0)return{...e[n],itemUrls:a};throw new Error("failed to get fileHandler item url")}catch(e){throw new Error(e)}}}}return Promise.resolve(void 0)},getFileHandlerItemUrl:async function(t,n,a){if(a)return Promise.resolve([e.graphDataSource.getItemUrl(t,{useDirectEndpoint:!1})]);{const a=e.itemUrlHelper.getItemUrlParts(t.key).fullItemUrl,i=e.itemUrlHelper.getItemUrlParts(t.key).fullWebUrl;if(a&&i){const r=await e.identityDataSource.getSharePointToken({webAbsoluteUrl:i,apiQosName:"FileHandlerHelper.getFileHandlerItemUrl"});return await e.preAuthService.getPreAuthUrls({driveUrl:(0,f.Vb)()?t.graph?.sessionToken?.tokenUrl:void 0,appId:n.handler.appId,items:[a],accessToken:r})}throw new Error("no item full url / item webAbsolute Url")}}}})}})}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=n("odsp.util_385").Ov.isActivated("fb3bead2-a0ae-4f8b-a7f4-c777ae0a7a93")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"OneUpAuthTokenHelperAsync.key",loader:new a.hg(()=>n.e(46).then(n.bind(n,778)).then(e=>e.authTokenHelperResourceKey))})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n(29);function i(){return window.ONEUPTELEMETRY_MANAGER=window.ONEUPTELEMETRY_MANAGER||(0,a.b)({sourceName:"OneUp"})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>s,c:()=>o});var a=n(73),i=n(166);function r(e,t){return new i.a({scenario:"OneUpLightSpeed.MeTA",extraData:{viewerName:e,...t}})}function o(e,t){e?.end({resultType:a.c.Success,extraData:t})}function s(e,t,n){if(t)e?.end(t);else if(n){let t;"code"in n&&(t=n);const i=t?.isExpected?a.c.ExpectedFailure:a.c.Failure,r=t?.code||n.name||n.message,o=t?.extraData||{rawError:n};e?.end({resultType:i,errorCode:r,extraData:o})}}}
,(e,t,n)=>{"use strict";function a(e){if("object"==typeof e&&e){for(const t of Object.keys(e))e[t]=a(e[t]);return e}return"string"==typeof e&&e.match(/https?:\/\//)?"DATA_Sanitized":e}n.d(t,{a:()=>a})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var a=n("odsp.util_385"),i=n(163),r=n(17),o=n(158);const s={resources:a.sp,oneUpStore:r.b,graphDataSource:i.a,isMeTATempAuthDeprecationEnabled:o.a},c=new a.OJ({name:"GetMeTAHeader.key",factory:{dependencies:s,create:({resources:e,oneUpStore:t,graphDataSource:n,isMeTATempAuthDeprecationEnabled:a})=>({instance:async function(i){if(a){const a=t.getOneUpProperties();if(a?.focusItem){const t=await n.getMetaPac(e,a.focusItem,i);let r;return t.metaPac&&(r={"X-SPOPacToken":t.metaPac}),r}}}})}})}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p});var a=n(109),i=n(550),r=n(30),o=n("odsp.util_385"),s=n(74),c=n(1),d=n(4);const l="multipart/mixed;boundary=",u="application/json";class f{update(e,t,n){this._getSharePointToken=e,this._basePath=`/drives/${n}/items/${t}`,this._layerPath=`${this._basePath}/annotationlayers`}createLayer({title:e,mainFileVersion:t="1.0",layerId:n}){const a=this._layerPath;return this._sendRequest({path:a,requestType:"POST",data:{title:e,mainFileVersion:t,id:n}})}deleteLayer({layerId:e}){const t=`${this._layerPath}/${e}`;return this._sendRequest({path:t,requestType:"DELETE"})}getLayers(){const e=this._layerPath;return this._sendRequest({path:e,requestType:"GET"})}createAnnotation({annotationId:e,layerId:t,content:n,partitionId:a,anchor:i,contentType:r}){const o=this._getAnnotationUrl(t);return this._sendRequest({path:o,requestType:"POST",data:{id:e,content:n,partitionId:a,anchor:i,contentType:r}})}getAnnotations({layerId:e,partitionId:t}){let n=this._getAnnotationUrl(e);return t&&(n+=`?partitionId=${t}`),this._sendRequest({path:n,requestType:"GET"})}deleteAnnotation({layerId:e,partitionId:t,annotationId:n}){const a=`${this._getAnnotationUrl(e)}/${n}?partitionId=${t}`;return this._sendRequest({path:a,requestType:"DELETE"})}async batchCreateAnnotations({payload:e}){const t="batch_"+r.a.generate(),n=this._createBatchBody(t,e.map(({id:e,layerId:t,annotationId:n,...a})=>({path:`${this._basePath}/AnnotationLayers('${t}')/universalannotations`,requestType:"POST",id:e,data:{id:n,...a}})));return this._sendRequest({path:"/$batch",requestType:"POST",headers:{"Content-Type":l+t},data:n})}async batchDeleteAnnotations({payload:e}){const t="batch_"+r.a.generate(),n=this._createBatchBody(t,e.map(({id:e,annotationId:t,layerId:n,partitionId:a})=>({path:`${this._getAnnotationUrl(n)}/${t}?partitionId=${a}`,requestType:"DELETE",id:e})));return this._sendRequest({path:"/$batch",requestType:"POST",headers:{"Content-Type":l+t},data:n})}get hasLicense(){return(0,d.jb)(d.$)?Boolean(this._pageContext.canUserUseSyntex)||Boolean(this._pageContext.isUserSyntexV2Licensed):Boolean(this._pageContext.canUserUseSyntex)}get isUniversalAnnotationDisabled(){return this._pageContext.isUniversalAnnotationDisabled??!1}get _server(){return(0,a.b)(this._pageContext)}_needRefreshToken(){return!this._token||!this._token.tokenExpiry||Date.now()>=this._token.tokenExpiry}async _getToken(){if(this._needRefreshToken()&&this._getSharePointToken){const e=await this._getSharePointToken(this._server);this._token=e}return this._token||void 0}_getAnnotationUrl(e){return`${this._layerPath}/${e}/universalannotations`}_createBatchBody(e,t){const n="\r\n",a=`changeset_${r.a.generate()}`,o=(0,i.b)(e,`multipart/mixed;boundary="${a}"`,"binary")+t.map(e=>(e=>{let t="--"+a+n;return t+="Content-Type: application/http\r\n",t+="Content-Transfer-Encoding: binary\r\n",t+="Content-ID: "+e.id+n,t+=n,t+=(0,i.a)(u,`${u};odata=verbose`,e.requestType,e.path),t+=n,e.data&&(t+=JSON.stringify(e.data)+n,t+=n),t})(e)).join("")+(()=>{let t="--"+a+"--"+n;return t+=n,t+="--"+e+"--"+n,t})();return new Blob([o])}async _sendRequest(e){const t=await this._getToken(),{data:n,path:a,requestType:i,headers:r}=e,o=n?n instanceof Blob?n:JSON.stringify(n):void 0;return this._dataRequestor.send({path:a,endpoint:`${this._server}/_api/v2.1`,headers:{Scenario:"Syntex_UniversalAnnotaion",...r},requestType:i,accessToken:t,apiName:"UniversalAnnotationAPI",apiVersion:"v2.1",postData:o,expectedErrorCodes:{resourceModified:!0}})}constructor(e,t){this._token=null,this._layerPath="";const{vroomDataRequestor:n,pageContext:a}=t;this._dataRequestor=n,this._pageContext=a}}f.dependencies={vroomDataRequestor:s.a,pageContext:c.a};const p=(0,o.C2)("UniversalAnnotationDataSource",f)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>_,c:()=>i,d:()=>h,e:()=>g,f:()=>b,g:()=>y,h:()=>v});var a,i,r=n(429),o=n(59),s=n(21),c=n(511),d=n(169),l=n("odsp.util_385"),u=n(406),f=n(49),p=n(111);class m extends Error{constructor(e,t){super(t),this.name="NetworkError",this.status=e}}!function(e){e[e.UnableFurtherCompression=13]="UnableFurtherCompression"}(a||(a={}));class _ extends Error{constructor(e,t){super(e),this.name="ManipulationError",this.code=t}}!function(e){e.ExceedsMaximumLength="ExceedsMaximumLength"}(i||(i={}));class h extends Error{constructor(e,t,n){super(t),Object.setPrototypeOf(this,h.prototype),this.name="UploadError",this.type=e,this.url=n||""}}async function b(e,t){if(!t)throw new Error("Invalid url");const n=await fetch(t,e);if(!n.ok)throw new m(n.status,`Fail to fetch file, url=${t}`);return n.arrayBuffer()}async function g(e,t){return Promise.all(e.map(e=>b(t,e)))}function v(e,t){const n=`${t.webUrl}/${e}.pdf`;if(n.length>=400)throw new h("ExceedsMaximumLength",l._0(d.w,n.length),n)}async function y(e,t,a,i){if(!i?.webUrl)return Promise.reject("");const{SharePointUploader:d}=await n.e(70).then(n.bind(n,750)),l={name:e.name,size:e.size,slice:(t,n)=>e},m=decodeURI(new URL(i.webUrl).pathname),_=decodeURI(i["@sharePoint.listUrl"]||""),h=a.getKey({[s.b.idParamKey]:m,[s.b.listUrlKey]:_}),b=new f.a({},{pageContext:t}),g=new p.a({},{pageContext:t,itemUrlHelper:b}),v=b.getItemUrlParts(h),y=new d({webApiUrl:g.build().webByItemUrl(v),fileUpload:l,throttler:new r.a({maxParallelUploads:1}),canStream:!0,dataRequestor:new o.b({},{pageContext:t,noRedirect:!0}),destinationUrl:v.serverRelativeItemUrl||"",nameConflictBehavior:u.a.rename,appName:"ODB OneUp viewer",onStart:()=>{},onAbort:()=>{},onProgress:e=>{}}),S=await y.upload(),D=a.getKey({[s.b.idParamKey]:S.ServerRelativeUrl}),I=_&&v.isCrossList,x=a.getKey({[s.b.idParamKey]:m,...I?{[s.b.listUrlKey]:_}:{}}),C={key:D||"",id:S.ServerRelativeUrl,type:c.a.File},O={key:x||"",id:v.serverRelativeItemUrl,type:c.a.Folder},w=a.getDefaultClickUrlForOneUp(C,{parentItem:O,urlType:"focus"});return Promise.resolve(w)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>c,c:()=>s,d:()=>o,e:()=>l});var a=n("tslib_145"),i=n(556),r=n(63),o=function(e){this.type="Qos",this.payload=(0,a.q5)((0,a.q5)({privacyClassification:"RequiredService"},e),{id:(0,i.a)(),status:r.b.Start,startTime:performance.now()})},s=function(e,t,n,i){this.type="Qos",this.payload=(0,a.q5)((0,a.q5)({privacyClassification:"RequiredService"},i),{id:e,name:t,status:n,endTime:performance.now()})},c=function(e){this.type="Engagement",this.payload=(0,a.q5)({privacyClassification:"OptionalDiagnostic"},e)},d=function(e){this.type="CaughtError",this.payload=(0,a.q5)({privacyClassification:"RequiredService"},e)},l=function(e){this.type="Verbose",this.payload=(0,a.q5)({privacyClassification:"OptionalDiagnostic"},e)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=function(){return"rtl"===(document.body&&document.body.getAttribute("dir")||document.documentElement.getAttribute("dir"))}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n(83);function i(e){try{var t=new URL(e).toString().match(/\/([^\/?#]+)[^\/]*$/);return t&&t.length>1?t[1]:""}catch(t){return a.a.warn("UrlHelper",'Given url "'.concat(e,'" is invalid')),""}}function r(e){e.startsWith("www.")&&(e="https://".concat(e));try{switch(new URL(e).protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}catch(e){return!1}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("tslib_145");(0,n("fui.util_939").ZW)([{rawString:".screenReader_6d70c630{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}"}]);var i=function(){function e(){}return e.read=function(e,t){if(""!==e)for(var n=[e],a=this._getLiveNodes(n.length,t||0),i=function(e){window.setTimeout(function(){a[e].textContent=n[e]},500*(e+1))},r=0;r<n.length;r++)i(r)},e.clear=function(){var e,t;try{for(var n=(0,a.BW)(this._liveNodes),i=n.next();!i.done;i=n.next()){var r=i.value;document.body.removeChild(r)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._liveNodes=[]},e._getLiveNodes=function(e,t){this.clear();for(var n=[],a=0;a<e;a++){var i=document.createElement("div");switch(n.push(i),document.body.appendChild(i),i.classList.add("screenReader_6d70c630"),i.setAttribute("data-tabster-never-hide",""),t){case 0:i.setAttribute("aria-live","polite");break;case 1:i.setAttribute("role","alert"),i.setAttribute("aria-live","assertive")}}return this._liveNodes=n,n},e._liveNodes=[],e}()}
,(e,t,n)=>{"use strict";function a(){if(window.devicePixelRatio)return Math.ceil(window.devicePixelRatio);if(window.matchMedia)for(var e=4;e>1;e=Math.round(10*(e-.1))/10)if(window.matchMedia("(-webkit-min-device-pixel-ratio: ".concat(e,")")).matches||window.matchMedia("(min-resolution: ".concat(e,"dppx)")).matches)return e;return 1}function i(e){return Math.floor(e*a())}n.d(t,{a:()=>a,b:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(64),i=n(84),r=function(){function e(){this._eventMap={}}return e.prototype.on=function(e,t){this._eventMap[e]||(this._eventMap[e]=[]),this._eventMap[e].push(t)},e.prototype.off=function(e,t){var n,a=this._eventMap[e];!a||(n=a.indexOf(t))<0||a.splice(n,1)},e.prototype.dispatch=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this._eventMap[e]&&this._eventMap[e].forEach(function(n){try{n.apply(null,t)}catch(t){var r=new a.c(a.b.EventHandleFailed,"Fail to handle event ".concat(e,", error: ").concat(t));i.a.logError(r.toCaughtError())}})},e.prototype.dispose=function(){var e=this;Object.keys(this._eventMap).forEach(function(t){for(var n=e._eventMap[t],a=n.length;a>=0;a--)e.off(t,n[a])})},e}()}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p});var a=n("odsp.util_385"),i=n(17),r=n(139),o=n(4),s=n(592),c=n(593),d=n(341),l=n(1),u=n(265),f=n(10);const p=new a.OJ({name:"canOpenCopilot",factory:{dependencies:{isCopilotEnabled:r.a,appPageContext:l.a,oneUpStore:i.b,oneUpStateStore:f.f},create:e=>({instance:{isCopilotSupportedForItem:function(t){const n=(0,o.jb)(o.h)&&e.isCopilotEnabled(),a=(0,u.a)({oneUpProps:e.oneUpStore.getOneUpProperties(),appPageContext:e.appPageContext,item:t}),i=(0,d.a)({item:t,currentPageContext:a,appPageContext:e.appPageContext});return!!(t.extension&&function(t,n,a,i){let r=a;const o=(0,s.c)(s.a),d="Media.Meeting"===i,l=(0,c.b)(o,d),u=e.oneUpStateStore.currentAppState.deletedKeys?.has(t.key);if(l){const e=n.replace(".","");r=r&&!!l.map.get(e)&&!u}else r=!1;return r}(t,t.extension,n,t.properties?.ProgId)&&i)}}})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(595),i=n("odsp.util_385");function r(e){const{item:t,currentPageContext:n,appPageContext:r}=e;if(t){const e=t.properties?.uniqueId,o=t.displayName;if(t.id&&e&&o){const s=(0,i.YR)(n?.siteId,!1)||(0,i.YR)(r.siteId,!1),c=(0,i.YR)(n?.webId,!1)||(0,i.YR)(r.webId,!1),d=(0,i.YR)(n?.listId,!1)||(0,i.YR)(r.listId,!1),l=[{id:t.id,name:o,sharepointIds:{siteId:s,webId:c,listId:d,listItemUniqueId:e}}],u=(0,a.a)(l);return u&&u[0]}}}}
,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>i});const a=!n("odsp.util_385").Ov.isActivated("5B8CD4DE-74E3-46DF-9A3E-B28C31F8BA71");function i(e){const{focusItem:t,navigation:n,saveAction:i}=e;return!(!a||!n.beforeUnload.isHashNavDialogHandlerRegistered?.())&&!!t&&i.evaluateAction({item:t}).isAvailable&&n.beforeUnload.hasActiveBlock()}}
,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l,c:()=>s,d:()=>f,e:()=>u,f:()=>c,g:()=>p,h:()=>m});var a=n("react-lib"),i=n(20),r=n(70),o=n(276);const s="CollabOneUp",c="Viewer",d="Command",l="Component";var u;!function(e){e.success="Success",e.unexpectedFailure="UnexpectedFailure",e.expectedFailure="ExpectedFailure"}(u||(u={}));const f=a.createContext({});function p(e,t){const n=0===e.indexOf(s)?e:`${s}.${e}`,a=t?.engagementContext;t&&t.engagementContext&&(t.engagementContext=void 0);const r={name:n,extraData:{...t,...a}};i.a.logData(r)}function m(){return(0,r.c)().consume(o.a)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"showCopilotPaneAsync.key",loader:new a.hg(()=>n.e(8).then(n.bind(n,821)).then(e=>e.showCopilotPaneKey))})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n(184);const i=e=>{const t=a.b,{palette:n,semanticColors:i}=t,r=`${i.buttonBackground} !important`,o=`${i.buttonBackgroundHovered} !important`,s=`${i.buttonBackgroundPressed} !important`;return{root:{...e},rootHovered:{cursor:"pointer",...e,background:o},rootPressed:{background:s},rootExpanded:{backgroundColor:r,...e},rootCheckedHovered:{cursor:"pointer",...e,background:o},rootCheckedPressed:{...e,background:s},rootExpandedHovered:{background:o,cursor:"pointer"},flexContainer:{color:n.black,width:"auto"},icon:{color:n.black}}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>f});var a=n(31),i=n(93);const r=n("odsp.util_385").Ov.isActivated("5EB3A0F2-70A9-4420-BC71-4E623B94CF83"),o=(e,t,n)=>{let i=!0;return t.map(t=>{a.a.hasPermission(e,t)||(i=!1)}),i},s=[a.a.insertListItems,a.a.editListItems],c=[a.a.reviewListItems],d=[a.a.openItems],l=[a.a.viewListItems],u=[a.a.fullMaskWithoutACP],f=e=>e?!r&&o(e,u)?i.a.owner:o(e,s)?i.a.edit:o(e,c)?i.a.review:o(e,d)?i.a.view:o(e,l)?i.a.restrictedview:i.a.none:i.a.none}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"CommentsPaneActionAsync.key",loader:new a.hg(()=>n.e(4).then(n.bind(n,824)).then(e=>e.commentsPaneActionKey))})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>o});var a=n("react-lib"),i=n(17),r=n(70);function o(e,t){const n=(0,r.c)(),o=[];(0,a.useEffect)(function(){return function(){const a=n.consume(i.b);for(const n in e)if(e.hasOwnProperty(n)){const i=n,r=e[i];r&&o.push(a.subscribe(i,r,t))}}(),function(){let e;for(;e=o.pop();)e()}},[])}function s(e){const[t,n]=(0,a.useState)();return o({updateOneUpStatus:function(t){if("update"in t.detail&&t.detail.update&&"publisher"in t.detail){const a=t.detail.update,i=e?e(a):a;n(i)}}},i.a.oneUpItemCacheUpdate||i.a.oneUpSpartanUpdate),t}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>d,c:()=>l,d:()=>c});var a=n(46),i=n(4),r=n("odsp.util_385");let o;function s(e){const t={aadUserId:e.aadUserId,experimentData:e.experimentData,experimentDataLookup:e.experimentDataLookup,serverTime:e.serverTime,siteId:e.siteId};o=(0,a.b)(90304,t),o?.logExposure()}function c(){return!r.Ov.isActivated("38e570f6-99f2-4061-8d53-4bbfa2e7c692","09/03/2024","RMA dialog KS")&&(!!(0,i.rc)()||!!o&&1===o.variantToDisplay)}function d(e){return 1===(0,a.c)(90278,e)}function l(e){return 1===(0,a.c)(90346,e)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>O,b:()=>w});var a=n("react-lib"),i=n.n(a),r=n(70),o=n("odsp.util_385"),s=n(369),c=n(0),d=n(34),l=n(374),u=n(385),f=n(371),p=n(21),m=n(220),_=n(1),h=n(387),b=n(4),g=n(10),v=n(190),y=n(364),S=n(162),D=n(56);const I=!o.Ov.isActivated("470B097E-0BC7-4D40-9A82-2F57E410A2B6"),x=!o.Ov.isActivated("F49447A1-A51A-4846-A1A7-17C779BF5529");let C=!1;function O(){C=!1}function w(){const e=(0,r.c)(),t=(0,s.a)(e=>e?.focusItem),n=e.consume(_.a),a=e.consume(h.a),O=e.consume(g.f),w=i().useContext(y.d),E=e.consume(D.a);i().useEffect(()=>{const i=window.location.search.substring(1),r=(0,o.pW)(i),s="true"===r.openShare,_="true"===r.openRMA,h=r[p.a.action],D=e.consume(v.a);h&&t&&(0,y.g)("CollabOneUp.SyncClientAutoOpen",{commandName:h,extension:t?.extension||"",viewer:S.a.Unknown,engagementContext:w});const A=function(){if(O.rightPaneType!==g.e.none)return!1;if(x?function(e){return e===m.i||e===m.e||e===m.a||e===m.b||e===m.d||e===m.c||e===m.h||e===m.f||e===m.g}(h):h===m.a||h===m.i||h===m.e)return!0;if((0,b.db)()){const e=t&&D.evaluateAction({item:t}).isAvailable,i=E.isMobile;if(e&&a&&!i){const e=(0,f.b)(n);return O.updateAutoOpenCopilotExperimentEnabled(e),e}}return!1}();let L,k,M,P;if(s&&t){const n=e.consume(l.d);P=n.evaluateAction({item:t}),L=P.isAvailable,k=P.onExecute,M=new Error(`no available action for ${l.d.name}`)}else if((0,f.d)()&&_&&t){const t=e.consume(u.a);P=t.evaluateAction(),L=P.isAvailable,k=P.onExecute,M=new Error(`no available action for ${u.a.name}`)}else t&&A&&(P=D.evaluateAction({item:t}),h?(L=P.isAvailable&&(!C||!I),k=I?e=>{if(!C&&P&&P.onExecute)return C=!0,P.onExecute?.(e)}:P.onExecute):(L=P.isAvailable,k=P.onExecute));if(t&&P&&(s||(0,f.d)()&&_||A)){const e=new c.a({name:`OneUpLightSpeed.autoActionExecutorInvoked.${P.id||"unknownAction"}`}),t="Unhandled exception executing an auto action";try{if(L&&k){const n=k({qosEvent:e});n&&n.then(t=>{const n=t||{resultType:c.b.Success};e.end(n)}).catch(n=>{const a=n||new Error(t);e.end((0,d.a)(a))})}else e.end((0,d.a)(M))}catch(n){const a=n||new Error(t);e.end((0,d.a)(a))}}},[t])}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>$,b:()=>Z,c:()=>J,d:()=>X});var a=n("odsp.util_385"),i=n("react-lib"),r=n(666),o=n(167),s=n(61),c=n(49),d=n(45),l=n(41),u=n(375),f=n(30),p=n(654),m=n(657),_=n(663),h=n(4),b=n(72),g=n(60),v=n(0),y=n(17),S=n(382),D=n(140),I=n(664),x=n(665),C=n(1),O=n(95),w=n(6),E=n(454);const A={identityDataSourceAync:O.a.lazy.async,appPageContext:C.a},L=new a.OJ({name:"sharingHostTokenProviderKey",factory:{dependencies:A,create:e=>{const{identityDataSourceAync:t,appPageContext:n}=e;return{instance:{onGetAuthToken(e){const{tokenName:n,getTokenParams:a}=e;return t().then(e=>n===S.a.Augloop&&e.getAugloopToken?e.getAugloopToken({resource:a?.resource,apiQosName:"SharingHost"}).then(e=>e?e.accessToken:void 0):Promise.resolve(void 0))},onRefreshCookies:e=>(0,E.a)()?t().then(t=>{let a;return t.getSharePointToken?t.getSharePointToken({webAbsoluteUrl:new w.a(e.webAbsoluteUrl||n.webAbsoluteUrl).authority,apiQosName:"Sharing.getAuthToken",disallowSelfIssuedToken:!0}).then(t=>(t&&(a=t.accessToken),a?e.sharingHostMessenger.sendReloadWithAuthToken(a).then(()=>Promise.resolve(!0)):Promise.resolve(!1))):Promise.resolve(!1)}):Promise.resolve(!1)}}}}});var k=n(206);const M=!a.Ov.isActivated("B0220AEF-CCEA-4D78-8DDA-5A135FA2B266"),P=!a.Ov.isActivated("98CFE6BF-ABFD-4293-A939-2917DF2B9BB9"),T=a.Ov.isActivated("3A6F37FF-6C59-4A8C-A454-D8C73E8F8634"),U=x.a(),F=a.Ov.isActivated("8603512d-f82c-40b8-8005-d2c99e472f05","9/11/2025","ahackett: Check user copilot licensed for share dialog in oneup"),H=(0,o.a)(async()=>(await Promise.all([n.e("ondemand.resx"),n.e(69)]).then(n.bind(n,834))).ShareDialog);function R(e){const t=new a.Zd;return e.onRender&&e.onRender(i.createElement(B,{...e,signal:t})),t.promise}function N(e){const t=new c.a({},{pageContext:e.pageContext}).getItemUrlParts(e.item.key),{fullListUrl:n,fullWebUrl:i,serverRelativeItemUrl:r}=t;let{isCrossList:o,isCrossDomain:s}=t;o=o||!T&&(0,D.a)(e.pageContext),s=s||!T&&(0,D.a)(e.pageContext);const d=T?i||"":(0,I.a)(i||""),{listurl:l,id:u}=M?{listurl:n,id:r}:(0,a.pW)((0,a.zY)(window.location.href));return{listurl:l,serverRelativeItemUrl:u,webAbsoluteUrl:d,isCrossList:o,isCrossDomain:s,listItemId:e.listItemId,listId:e.listId,uniqueId:e.uniqueId}}function B(e){const t=Date.now(),{signal:n}=e,a=i.useMemo(function(){return function(e){const{mode:t,itemName:n,resources:a}=e,{listurl:i,serverRelativeItemUrl:r,webAbsoluteUrl:o,isCrossList:s,isCrossDomain:c,uniqueId:u,listItemId:f,listId:p}=N(e);return()=>{if((0,h.Rb)()?s:c){const e=Date.now(),t=a.consume(d.resourceKey),s=(0,b.i)(b.h);return t.getSharePointToken({webAbsoluteUrl:new l.a(o).authority,apiQosName:"Sharing.getAuthToken",disallowSelfIssuedToken:s}).then(t=>{const a=T?o:(0,I.a)(o),c=t.accessToken,d={authToken:c,webAbsoluteUrl:o,isODB:!0,itemName:n,listUrl:i,serverRelativeItemUrl:r,cookieAuthIframeUrlForCrossDomain:`${a}/_layouts/15/sharedialog.aspx?crossdomain=true&clickTime=${e}`},l=(0,g.b)(c).appid||"",u="08e18876-6177-487e-b8b5-cf950c1e598c"===l||"c58637bb-e2e1-4312-8a00-04b5ffcd3403"!==l?v.b.Success:v.b.Failure;return new v.a({name:"oneUp_shareAuthToken"}).end({resultType:u,resultCode:l,extraData:{disallowSelfIssuedToken:s}}),Promise.resolve({...d})})}{let e,n=`${T?o:(0,I.a)(o||"")}/_layouts/15/sharedialog.aspx?listId=${p}&clientId=oneup&mode=${t}&fullScreenMode=true`;return f&&(n+=`&listItemId=${f}`),P&&u&&(n+=`&uniqueId=${u}`),U?e={hasTokenProvider:!0}:(0,h.sb)()&&(e={hasAdditionalTokenProvider:[S.a.Augloop]}),Promise.resolve({cookieAuthIframeUrl:n,sharingContext:e})}}}(e)},[e]),o=i.useMemo(function(){return function(e){const{resources:t,mode:n,item:a,pageContext:i}=e,{listurl:r,serverRelativeItemUrl:o,webAbsoluteUrl:c,isCrossList:l,isCrossDomain:b,listId:g,listItemId:v}=N(e),S=t.consume(L);return D=>{const{sharingInformation:I,clickTime:x}=D,[C,O]=(0,_.a)("OneUpSharingModalContainer");if(((0,h.Rb)()?l:b)&&C){C.style.position="relative",C.style.zIndex="10000000000000";const l=I.authToken,_=t.consume(d.resourceKey);let b;if((0,h.Ab)()){const e=t.consume(y.b)?.list;b=e?.list?.id??g}const D=(0,h.cb)()&&_?.getAugloopToken?async e=>(await _.getAugloopToken({resource:e,apiQosName:"ShowShareDialog"})).accessToken:void 0,w=F?void 0:t.consume(k.a)?.(),E={authToken:l||"",clientId:"oneup",mode:Number(n),listItemId:a.itemId||v,itemName:a.name||"",correlationId:i?.CorrelationId??f.a.generate(),scenarioId:"OneUp-CrossList",hostOptions:{showCloseButton:!0,hideShareDialogOverflowButton:!0},hostMethod:u.a.sharepoint,serverRelativeItemUrl:o,listId:b,listUrl:r,uniqueId:T?"":e.uniqueId,webAbsoluteUrl:c||"",locale:s.a.language||"en-US",fullScreenIframe:!0,...F?{}:{isUserCopilotLicensed:w}},A={onError:e=>{},onReady:()=>{console.log("sharePrefetch ready")},onTimeout:()=>{},onDismiss:()=>{e.onClose&&e.onClose(),O()},...(0,h.cb)()&&!U?{spRestTokenProvider:{getAugloopToken:D}}:void 0};U&&(A.sharingHostTokenProvider=S),new m.a({element:C,locale:E.locale,environment:i.env2??p.a.prod,disableIframeDomainCheck:!0,isConsumer:!1,context:E,styles:{minWidth:"480px"},clickTime:x,options:A}).initializeUI()}}}(e)},[e]),c=i.useMemo(function(){return function(e){const t=e.resources.consume(d.resourceKey);return(e,n)=>e===S.a.Augloop&&t?.getAugloopToken?t.getAugloopToken({resource:n?.resource,apiQosName:"ShowShareDialog"}).then(e=>e.accessToken):Promise.resolve(void 0)}(e)},[e]),D=e.resources.consume(L),x={...U?{onGetAuthToken:D.onGetAuthToken,onRefreshCookies:D.onRefreshCookies}:{},...U?{}:{onGetAdditionalToken:c}};return i.createElement(H,{getSharingInformation:a,getTargetDocId:()=>e.targetDocId,getClientId:()=>"oneup",initializeShareFrame:o,mode:r.a.share,resolve:()=>{},reject:e=>{n.reject(e)},locale:s.a.language||"en-US",itemName:e.itemName||"",onShareReady:()=>{},onShareLoaded:e=>{const{resultType:t,...a}=e,i={resultType:t,extraData:a};n.resolve(i)},onModalClose:()=>{e.onClose&&e.onClose()},clickTime:t,...x})}const j=new a.OJ({name:"ShowShareDialog",factory:{dependencies:{},create:e=>({instance:{showShareDialog:R}})}});var V=n(10),z=n(291),G=n(667);const K=!a.Ov.isActivated("98CFE6BF-ABFD-4293-A939-2917DF2B9BB9"),W="ShareAction",q="AddAgentToTeamsAction",Q=(e,t,n)=>a=>{const i=e.oneUpStateStore.currentAppState.deletedKeys?.has(a.item.key);let r=function(e){return!e.lifeCycleStatus?.isMalwareDetected}(a.item)&&!i;return t===q&&a.item.extension!==z.d&&a.item.extension!==z.e&&(r=!1),{isAvailable:r,id:t,onExecute:async()=>{const t=e.oneUpStore.getOneUpProperties(),i=G.a&&a.item?a.item:e.oneUpStore.getOneUpProperties()?.focusItem;let r;if(t&&i){r=(0,h.Ob)()&&t?.list?.list?.id||e.pageContext.listId;const o={listId:r,webAbsoluteUrl:e.pageContext.webAbsoluteUrl,listItemId:i.properties?.ID,uniqueId:K?i.properties?.uniqueId:void 0,mode:n,targetDocId:a.targetDocId,fullScreenMode:!0,itemName:i.name,item:i,pageContext:e.pageContext,resources:e.resources,onClose:()=>{e.oneUpStateStore.updateModalState("shareCommand",{showModal:!1,content:void 0})},onRender:t=>{e.oneUpStateStore.updateModalState("shareCommand",{showModal:!0,content:t})}},s=await e.getExecutor();return await s.showShareDialog(o)}}}},Y={getExecutor:j.async.lazy,pageContext:C.a,oneUpStore:y.b,resources:a.sp,oneUpStateStore:V.f},J=new a.OJ({name:"ShareAction",factory:{dependencies:Y,create:e=>({instance:{evaluateAction:Q(e,W,r.a.manageAccess)}})}}),X=new a.OJ({name:"ShareAction",factory:{dependencies:Y,create:e=>({instance:{evaluateAction:Q(e,W,r.a.share)}})}}),Z=new a.OJ({name:"ShareAction",factory:{dependencies:Y,create:e=>({instance:{evaluateAction:Q(e,"CopyAction",r.a.copyLink)}})}}),$=new a.OJ({name:"ShareAction",factory:{dependencies:Y,create:e=>({instance:{evaluateAction:Q(e,q,r.a.copyLink)}})}})}
,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p});var a=n("odsp.util_385"),i=n(93),r=n(10),o=n(1),s=n(17),c=n(367),d=n(386);const l=e=>{switch(e){case i.a.review:case i.a.restrictedview:case i.a.view:return!0;default:return!1}},u=({oneUpStore:e,oneUpStateStore:t,pageContext:n,resources:a,getExecutor:r})=>()=>{const o=(0,c.b)(e.focusItem?.permissions);return{isAvailable:!n.isAnonymousGuestUser&&l(o),id:"EditRequestAction",onExecute:async()=>{const s=e.getOneUpProperties();if(s&&o){const e=await r();await e.showRequestMoreAccessDialog({item:s.focusItem,pageContext:n,itemRole:o,requestRole:i.a.edit,resources:a,onClose:()=>{t.updateModalState("editRequestCommand",{showModal:!1,content:void 0})},onRender:e=>{t.updateModalState("editRequestCommand",{showModal:!0,content:e})}})}}}},f={oneUpStore:s.b,oneUpStateStore:r.f,pageContext:o.a,resources:a.sp,getExecutor:d.a.async.lazy},p=new a.OJ({name:"EditRequestAction",factory:{dependencies:f,create:e=>({instance:{evaluateAction:u(e)}})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"ShowRequestMoreAccessDialog.key",loader:new a.hg(()=>n.e(68).then(n.bind(n,836)).then(e=>e.showRequestMoreAccessDialogKey))})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)({name:"isAutoOpenCopilotPaneEnabled",factory:{dependencies:{},create:()=>({instance:!1})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>p,b:()=>b});var a=n("odsp.util_385"),i=n(0),r=n(299),o=n(133),s=n(10),c=n(50),d=n(368),l=n(15),u=n(4),f=n(76);const p="AnnotateAction",m={oneUpStateStore:s.f,uaDataSource:r.a,pdfHelper:c.b,itemUrlHelper:l.c,openCommentsPaneActionAsyncKey:d.a.async},_=e=>t=>{const n={id:p,isAvailable:h(t.item,e),isDisabled:o.k&&e.oneUpStateStore.getESignData().isCreateSidePanelActive,onExecute:async()=>{const{oneUpStateStore:n}=e,a=n.currentAppState.annotationViewerState,r=n.currentAppState.viewerStates?.get(t.item.key)?.pdfViewerStates?.outlineVisibility;return n.toggleAnnotationViewerVisiblity(p),r!==f.b.Focus&&r!==f.b.Visible||a.isActive||n.updateViewerState("annotateActionHideOutline",{key:t.item.key,options:{pdfViewerStates:{outlineVisibility:f.b.Hidden}}}),(0,u.jb)(u.z)&&await async function(e,t){const n=t.oneUpStateStore.state.currentState.annotationViewerState?.viewerVisiblity;if(n===s.a.On){const n=await t.openCommentsPaneActionAsyncKey();await n.evaluateAction({item:e.item,isAnnotateAction:!0})}}(t,e),{resultType:i.b.Success}}};return n};function h(e,t){if(!(0,u.jb)(u.eb))return!1;const n=t.uaDataSource.isUniversalAnnotationDisabled;if((0,u.jb)(u.W)&&n)return!1;if(t.oneUpStateStore.currentAppState.viewerStates?.get(e.key)?.pdfViewerStates?.isPdfMip)return!1;if(!t.pdfHelper.isSupportedFileType(e))return!1;if(t.itemUrlHelper.getItemUrlParts(e.key).geoRelation!==l.a.sameGeo)return!1;if(!t.pdfHelper.isMsPdfViewerAvailable(e)||!t.pdfHelper.isMsPdfViewerSupported())return!1;const a=t.oneUpStateStore.getESignData().isCreateSidePanelActive;return!(!o.k&&a||!t.uaDataSource.hasLicense||!t.pdfHelper.isNotEmbed())}const b=new a.OJ({name:"AnnotateAction",factory:{dependencies:m,create:e=>({instance:{evaluateAction:_(e)}})}})}
,,,,,,,,,,,,,(e,t,n)=>{"use strict";function a(){return!0}n.d(t,{a:()=>a})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>d,c:()=>c});var a=n("tslib_145"),i=n(170),r=n("react-lib"),o=r.createContext(void 0),s=function(e){var t=e.children,n=(0,a.dc)(e,["children"]),s=r.useMemo(function(){return new i.a(n.strings)},[n.strings]);return r.createElement(o.Provider,{value:s},t)},c=function(){return r.useContext(o)},d=function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t,n;return(0,a.SO)(this,function(i){switch(i.label){case 0:return[4,Promise.all([Promise.resolve().then(function(){var e=new Error("Cannot find module '../l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e}),Promise.resolve().then(function(){var e=new Error("Cannot find module '@ms/file-annotation-bar/lib/l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e})])];case 1:return e=a.pM.apply(void 0,[i.sent(),2]),t=e[0],n=e[1],[2,(0,a.q5)((0,a.q5)({},t.default),n.default)]}})})}}
,,(e,t,n)=>{"use strict";var a,i,r;n.d(t,{a:()=>i,b:()=>a,c:()=>r}),function(e){e.FreeText="FreeText",e.Pen="Pen",e.Highlighter="Highlighter",e.Eraser="Eraser",e.PointEraser="PointEraser",e.Display="Display",e.Watermark="Watermark"}(a||(a={})),function(e){e.DarkYellow="#FED430",e.LightOrange="#FBAE17",e.Orange="#F36323",e.Red="#E3182D",e.DarkPurple="#5B318D",e.Purple="#914BB8",e.Magenta="#CF1278",e.DarkRed="#C10051",e.LightBlue="#3ECCFD",e.Blue="#0078D7",e.DarkBlue="#0051BA",e.LightGreen="#7EC400",e.Green="#00B44B",e.LightGrey="#EBEBEB",e.Grey="#B6B6B6",e.Black="#1F1F1F"}(i||(i={})),function(e){e.Unknown="Unknown",e.Create="Create",e.Update="Update",e.Delete="Delete",e.UpdateOrDelete="UpdateOrDelete"}(r||(r={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>d,c:()=>c});var a=n("tslib_145"),i=n(170),r=n("react-lib"),o=r.createContext(void 0),s=function(e){var t=e.children,n=(0,a.dc)(e,["children"]),s=r.useMemo(function(){return new i.a(n.strings)},[n.strings]);return r.createElement(o.Provider,{value:s},t)},c=function(){return r.useContext(o)},d=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(function(){var e=new Error("Cannot find module '../../l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e})];case 1:return[2,e.sent().default]}})})}}
,,(e,t,n)=>{"use strict";n.d(t,{A:()=>r,B:()=>g,C:()=>s,D:()=>c,E:()=>i,F:()=>p,G:()=>m,H:()=>f,I:()=>o,J:()=>h,K:()=>C,L:()=>x,M:()=>j,a:()=>O,b:()=>b,c:()=>I,d:()=>D,e:()=>S,f:()=>u,g:()=>l,h:()=>w,i:()=>_,j:()=>d,k:()=>v,l:()=>y,m:()=>T,n:()=>k,o:()=>M,p:()=>P,q:()=>L,r:()=>A,s:()=>a,t:()=>E,u:()=>B,v:()=>R,w:()=>H,x:()=>F,y:()=>N,z:()=>U}),(0,n("fui.util_939").ZW)([{rawString:".OneUpModal_df49a5a0 .OneUpRoot_df49a5a0{display:flex;flex-direction:row;position:absolute;top:45px;left:0;right:0;bottom:0}.OneUpModal_df49a5a0 .OneUpRoot_df49a5a0 .OneUpRightPane_df49a5a0{min-width:320px}.OneUpModal_df49a5a0 .OneUpRoot_df49a5a0 .OneUpVersionHistoryRightPane_df49a5a0{min-width:320px;overflow-y:auto!important}.OneUpModal_df49a5a0 .OneUpRootLightBackground_df49a5a0{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.OneUpModal_df49a5a0 .OneUpRootDarkBackground_df49a5a0{background-color:rgba(0,0,0,0)}.OneUpModal_df49a5a0 [data-automation-id=CopilotPaneCommand]{min-width:32px!important;width:32px!important;margin:4px 2px!important}.OneUpModal_df49a5a0 [data-automation-id=commentCommand]{margin:4px 2px!important;width:32px!important}.OneUpModal_df49a5a0 .OneUpRootNoCommandBar_df49a5a0{display:flex;flex-direction:column;position:absolute;top:0;left:0;right:0;bottom:0}.OneUpModal_df49a5a0 .OneUpDetailsPane_df49a5a0{position:relative;width:380px;height:100%}@media (width <= 380px){.OneUpModal_df49a5a0 .OneUpDetailsPane_df49a5a0{width:100%}}.OneUpModal_df49a5a0 .OneUpCommentsPane_df49a5a0{padding:10px 10px 10px 20px;width:340px;height:calc(100% - 60px)}.OneUpModal_df49a5a0 .OneUpCommentsPane_df49a5a0 .OneUpCommentsPaneTitle_df49a5a0{display:flex;align-items:center;font-family:sans-serif;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:"}.OneUpModal_df49a5a0 .OneUpVersionHistoryPane_df49a5a0{padding:10px;width:630px}.OneUpModal_df49a5a0 .OneUpVersionHistoryPane_df49a5a0 .OneUpVersionHistoryPaneHeader_df49a5a0{display:flex;justify-content:space-between;align-items:center;padding:10px}.OneUpModal_df49a5a0 .OneUpVersionHistoryPane_df49a5a0 .OneUpVersionHistoryPaneHeader_df49a5a0 .OneUpVersionHistoryPaneTitle_df49a5a0{font-size:20px;font-weight:600;font-family:sans-serif;margin:0}.OneUpModal_df49a5a0 .OneUpDetailsPaneSpinner_df49a5a0{height:100%;display:flex;justify-content:center;align-items:center}.OneUpModal_df49a5a0 .OneUpViewer_df49a5a0{position:relative;flex:1 1 auto}.OneUpModal_df49a5a0 .OneUpAccessibleLoadAnnouncement_df49a5a0{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.OneUpModal_df49a5a0 .OneUpCommandBar_df49a5a0{display:flex;justify-content:space-between}.OneUpModal_df49a5a0 div.OneUpRootAnimation_df49a5a0{opacity:0;transition:opacity 367ms linear,visibility 367ms linear,transform 367ms linear}.OneUpModal_df49a5a0 div.OneUpRootAnimation_df49a5a0.OneUpEntrance_df49a5a0{transition-delay:0s,0s,0s;opacity:1;visibility:visible}.OneUpModal_df49a5a0 div.OneUpRootAnimation_df49a5a0.OneUpExit_df49a5a0{opacity:0;visibility:hidden}.OneUpModal_df49a5a0 div.OneUpRootAnimation_df49a5a0.OneUpEntranceV2_df49a5a0{transition-delay:0s,0s,0s;opacity:1;visibility:visible}.OneUpModal_df49a5a0 div.OneUpRootAnimation_df49a5a0.OneUpExitV2_df49a5a0{opacity:0;visibility:hidden}@media (prefers-reduced-motion){.OneUpModal_df49a5a0 div.OneUpRootAnimation_df49a5a0{transition:unset;opacity:1;visibility:inherit}}.OneUpCommandButtonPrimary_df49a5a0{margin-left:5px;margin-right:5px}.OneUpCommandButtonPrimaryWhite_df49a5a0{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.OneUpCommandButtonPrimaryWhiteV2_df49a5a0{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"!important;border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"!important}.PreviousButton_df49a5a0{position:absolute;top:50%;left:32px;z-index:9999}.PrevBtnNextToPdfOutline_df49a5a0{left:344px}.NextButton_df49a5a0{position:absolute;top:50%;right:32px}.OneUpContextMenuCommandIcon_df49a5a0{display:flex}.OneUpNewBadge_df49a5a0{margin-left:10px;align-self:center;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:inline-flex;align-items:center;justify-content:center;position:relative;font-size:.625rem;height:8px;padding:3px 6px;border-radius:20px}.OneUpHelpMenuOption_df49a5a0{border:transparent;margin:5px}.OneUpHelpButton_df49a5a0{width:32px;height:32px;position:absolute;bottom:12px;right:24px;z-index:99999;display:flex;flex-direction:column;align-items:center}.OneUpHelpButton_df49a5a0 i{font-size:16px}.OneUpHelpButtonPerfBtnOpen_df49a5a0{right:249px}.OneUpHelpButtonRightPaneOpen_df49a5a0{right:364px}.OneUpHelpButtonVersionHistoryPaneOpen_df49a5a0{right:694px}.OneUpHelpButtonDetailsPaneOpen_df49a5a0{right:424px}.OneUpPerfButton_df49a5a0{position:absolute;bottom:0;right:0;z-index:9999;display:flex;flex-direction:column;align-items:flex-end;box-shadow:0 0 5px "},{theme:"black",defaultValue:"#000"},{rawString:";border-top-left-radius:10px;border-top-right-radius:10px}.OneUpPerfButton_df49a5a0 .OneUpPerfButtonHeader_df49a5a0{display:flex;flex-direction:row;justify-content:space-between;width:100%;border-radius:inherit}.OneUpPerfButton_df49a5a0 .OneUpPerfButtonHeaderText_df49a5a0{margin-top:5px;margin-left:10px}.OneUpPerfButton_df49a5a0 .OneUpPerfButtonDivider_df49a5a0{margin-left:10px;margin-right:10px}.OneUpPerfButton_df49a5a0 .OneUpPerfButtonLink_df49a5a0{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OneUpPerfButton_df49a5a0 .OneUpPerfButtonContent_df49a5a0{margin:10px;display:flex;flex-direction:row;align-items:flex-end}.versionHistoryNumber_df49a5a0:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}::-webkit-scrollbar{width:14px;height:14px;scrollbar-width:thin;scrollbar-color:#605e5c transparent}::-webkit-scrollbar-thumb{-webkit-background-clip:content-box;background-clip:content-box;border-radius:8px;border:4px solid transparent;background-color:#605e5c}::-webkit-scrollbar-thumb:hover{background-color:#3b3a39}::-webkit-scrollbar-button{display:none}::-webkit-scrollbar-corner{background:0 0}@media (forced-colors:active){::-webkit-scrollbar{scrollbar-color:CanvasText transparent}::-webkit-scrollbar-thumb{background-color:CanvasText;border:4px solid Window}}"}]);const a="OneUpModal_df49a5a0",i="OneUpRoot_df49a5a0",r="OneUpRightPane_df49a5a0",o="OneUpVersionHistoryRightPane_df49a5a0",s="OneUpRootDarkBackground_df49a5a0",c="OneUpRootNoCommandBar_df49a5a0",d="OneUpDetailsPane_df49a5a0",l="OneUpCommentsPane_df49a5a0",u="OneUpCommentsPaneTitle_df49a5a0",f="OneUpVersionHistoryPane_df49a5a0",p="OneUpVersionHistoryPaneHeader_df49a5a0",m="OneUpVersionHistoryPaneTitle_df49a5a0",_="OneUpDetailsPaneSpinner_df49a5a0",h="OneUpViewer_df49a5a0",b="OneUpAccessibleLoadAnnouncement_df49a5a0",g="OneUpRootAnimation_df49a5a0",v="OneUpEntranceV2_df49a5a0",y="OneUpExitV2_df49a5a0",S="OneUpCommandButtonPrimary_df49a5a0",D="OneUpCommandButtonPrimaryWhite_df49a5a0",I="OneUpCommandButtonPrimaryWhiteV2_df49a5a0",x="PreviousButton_df49a5a0",C="PrevBtnNextToPdfOutline_df49a5a0",O="NextButton_df49a5a0",w="OneUpContextMenuCommandIcon_df49a5a0",E="OneUpNewBadge_df49a5a0",A="OneUpHelpMenuOption_df49a5a0",L="OneUpHelpButton_df49a5a0",k="OneUpHelpButtonPerfBtnOpen_df49a5a0",M="OneUpHelpButtonRightPaneOpen_df49a5a0",P="OneUpHelpButtonVersionHistoryPaneOpen_df49a5a0",T="OneUpHelpButtonDetailsPaneOpen_df49a5a0",U="OneUpPerfButton_df49a5a0",F="OneUpPerfButtonHeader_df49a5a0",H="OneUpPerfButtonHeaderText_df49a5a0",R="OneUpPerfButtonDivider_df49a5a0",N="OneUpPerfButtonLink_df49a5a0",B="OneUpPerfButtonContent_df49a5a0",j="versionHistoryNumber_df49a5a0"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_145"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=function(e){this.viewHandler=e.viewHandler,this.inputEvtHandler=e.inputEvtHandler,this.metadata=e.metadata}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_145"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("clientName")}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var a=n(1),i=n(15),r=n(111),o=n("odsp.util_385");const s=new o.OJ({name:"ApiUrlHelper.encodeWebAbsoluteUrl",factory:new o.Rn(!0)}),c=(0,o.C2)("ApiUrlHelper",r.a,{itemUrlHelper:i.c,pageContext:a.a,encodeWebAbsoluteUrl:s})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>d,c:()=>s,d:()=>l});var a=n("tslib_145"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)},c=i.createContext(void 0),d=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(c.Provider,{value:n},t)},l=function(){var e=i.useContext(c);if(!e)throw new Error("usePageTabIndexContext must be used within a PageTabIndexProvider");return e}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>o,c:()=>l,d:()=>d});var a=n("tslib_145"),i=n(170),r=n("react-lib"),o=function(e){return new i.a(e)},s=r.createContext(void 0),c=function(e){var t=e.children,n=(0,a.dc)(e,["children"]),o=r.useMemo(function(){return new i.a(n.strings)},[n.strings]);return r.createElement(s.Provider,{value:o},t)},d=function(){return r.useContext(s)},l=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(function(){var e=new Error("Cannot find module '../../l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e})];case 1:return[2,e.sent().default]}})})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c.a,b:()=>d.p,c:()=>d.s,d:()=>l.f,f:()=>a.c,e:()=>a.b});var a=n(202),i=n(214),r=(n(229),n("tslib_145")),o=n("react-lib"),s=n("react-dom-lib"),c=(function(){function e(e,t){this.container=e,this.render(t)}e.prototype.render=function(e){var t=this;s.render(o.createElement(i.a,(0,r.q5)({},(0,r.q5)((0,r.q5)({},e),{componentRef:function(e){t._innerRef=e}}))),this.container)},e.prototype.dispose=function(){s.unmountComponentAtNode(this.container)},Object.defineProperty(e.prototype,"innerRef",{get:function(){return this._innerRef},enumerable:!1,configurable:!0})}(),n(37)),d=n(57),l=n(71);n(145),n(557)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>l,c:()=>o,e:()=>s,d:()=>r.a,f:()=>d});var a=n("odsp.util_385"),i=(n(456),n(212),n(95));new a.OJ("list"),new a.OJ("oAuthTokenDataSource"),new a.OJ("siteScripts"),n(860);var r=n(96);new a.OJ("recentList"),new a.OJ("prefetchCache"),new a.OJ("folder"),new a.OJ("appsItem"),new a.OJ("externallySharedItem"),new a.OJ("popularItem"),new a.OJ("subsiteItem"),new a.OJ("mostViewsItem"),new a.OJ("mostViewersItem"),new a.OJ("settings"),new a.OJ("getItem"),new a.OJ("items"),new a.OJ("versionControl"),new a.OJ("versionHistory"),new a.OJ("vault");const o=i.a,s=(new a.OJ("peopleCardFactory"),new a.OJ("peopleCard"),new a.OJ("language"),new a.OJ("languagePicker"),new a.OJ("leftNav"),new a.OJ("search"),new a.OJ("sharing"),new a.OJ("sharingLightSpeed"),new a.OJ("sharingData"),new a.OJ("groups"),new a.OJ("suiteNav"),new a.OJ("iosMobileAppPath"),new a.OJ("url")),c=(new a.OJ("universalAnnotation"),new a.OJ("download")),d=(new a.OJ("docFormat"),new a.OJ("footer"),new a.OJ("manifests"),new a.OJ("itemActivityFeed"),new a.OJ("itemActivityFeedHelper"),new a.OJ("itemActivityFeedSharingHelper"),new a.OJ("userInfo"),new a.OJ("storageInfo"),new a.OJ("storageOptions"),new a.OJ("album"),new a.OJ("tag"),new a.OJ("shareByLink"),new a.OJ("folderItemCount"),new a.OJ("photo"),new a.OJ("subscriptions"),new a.OJ("analytics"),new a.OJ("sendFeedback"),new a.OJ("embed"),new a.OJ("application"),new a.OJ("policyTip"),new a.OJ("policyTipLightSpeed"),new a.OJ("customAction"),new a.OJ("taxonomy"),new a.OJ("web"),new a.OJ("floodgate"),new a.OJ("shortcutsDS"),new a.OJ("encoding"),new a.OJ("rating"),new a.OJ("publish"),new a.OJ("videoItem")),l=(new a.OJ("sites"),new a.OJ("copy"),new a.OJ("upsell"),new a.OJ("notifications"),new a.OJ("command"),new a.OJ("processFilters"),new a.OJ("quota"),new a.OJ("itemColumn"),new a.OJ("bundle"),new a.OJ("itemPicker"),new a.OJ("site"),new a.OJ("pushChannel"),new a.OJ("itemAutoRefresh"),new a.OJ("loginApp"),new a.OJ("mruRecent"),new a.OJ("pdf"),new a.OJ("zip"),new a.OJ("url2"),new a.OJ("attachments"),new a.OJ("spotlight"),new a.OJ("error"),new a.OJ("promotedPhotos"),new a.OJ("fileHandler"),new a.OJ("fileHandlerFromCache"),new a.OJ("recycleBin"),new a.OJ("deleteRestore"),new a.OJ("instrumentation"),new a.OJ("shadowCall"),new a.OJ("graph"));new a.OJ("formula"),new a.OJ("appUrl"),new a.OJ("graphUrl"),new a.OJ("batchUploaderType"),new a.OJ("vroomItemIdentityProcessor"),new a.OJ("preAuth"),new a.OJ("peopleService"),new a.OJ("schema"),new a.OJ("restore"),new a.OJ("restore"),new a.OJ("restoreActivities"),new a.OJ("inAppMessaging"),new a.OJ("notificationSettings"),new a.OJ("itemInvalidator"),new a.OJ("itemUpdator"),new a.OJ("wopiFrame"),new a.OJ("wrs"),new a.OJ("excel"),new a.OJ("worker"),new a.OJ("checkUserAccessDataSource"),new a.OJ("userExpiration"),new a.OJ("itemMuteNotificationDataSource"),new a.OJ("ticketRedeemer"),new a.OJ("recommendList"),new a.OJ("reportAbuse"),new a.OJ("legacyReportAbuse"),new a.OJ("requestReview"),new a.OJ("removeFromShareWithMeList"),new a.OJ("siteUserPermissions")}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>l,c:()=>d});var a=n("tslib_145"),i=n("react-lib"),r=n.n(i),o={setMode:function(){},resetPageSelection:function(){},subscribe:function(){},unsubscribe:function(){},toggle:function(){}},s=(0,i.createContext)(o),c=(0,i.createContext)(function(){}),d=function(){return r().useContext(s)},l=function(){var e=r().useContext(c);return(0,i.useCallback)(function(t){e(function(e){return(0,a.q5)((0,a.q5)({},e),t)})},[e])},u=function(e){var t=e.children,n=(0,a.pM)((0,i.useState)(o),2),d=n[0],l=n[1];return r().createElement(c.Provider,{value:l},r().createElement(s.Provider,{value:d},t))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>d,c:()=>s,d:()=>o});var a=n("tslib_145"),i=n(82),r=n(71),o=function(e,t,n,o){var s,c,d,l,u,f=(0,a.pM)([e.x,e.y],2),p=f[0],m=f[1],_=(0,a.pM)([e.width,e.height],2),h=_[0],b=_[1];switch(o){case r.f.Degree90:p=(s=(0,a.pM)([t.height-m-b,p],2))[0],m=s[1],h=(c=(0,a.pM)([b,h],2))[0],b=c[1];break;case r.f.Degree180:p=(d=(0,a.pM)([t.width-p-h,t.height-m-b],2))[0],m=d[1];break;case r.f.Degree270:p=(l=(0,a.pM)([m,t.width-p-h],2))[0],m=l[1],h=(u=(0,a.pM)([b,h],2))[0],b=u[1]}return new i.b(p,m,h,b).scale(n||1)},s=function(e,t,n,a,r){var s=e.x,c=e.y,d=void 0===r?{width:0,height:0}:r,l=d.width,u=d.height;return o(new i.b(s,c,l,u),t,n,a)},c=function(e,t,n,o){var s,c,d,l=(0,a.pM)([e.x/n,e.y/n],2),u=l[0],f=l[1];switch(o){case r.f.Degree90:u=(s=(0,a.pM)([f,t.height-u],2))[0],f=s[1];break;case r.f.Degree180:u=(c=(0,a.pM)([t.width-u,t.height-f],2))[0],f=c[1];break;case r.f.Degree270:u=(d=(0,a.pM)([t.width-f,u],2))[0],f=d[1]}return new i.a(u,f)},d=function(e,t,n,a,o){var s=e.left,c=e.top,d=e.bottom,l=e.right,u=function(e,t){return new i.a(e*a+n,t*a)};switch(o){case r.f.Degree0:return u(s,d);case r.f.Degree90:return u(s,c);case r.f.Degree180:return u(t?l:s,c);case r.f.Degree270:return u(l,t?d:c);default:return new i.a(0,0)}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_145"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={}));const i=a}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>G});var a=n("odsp.util_385"),i=n(1),r=n(539),o=n(35),s=n(72),c=n(466);const d=!a.Ov.isActivated("DB0DA5A6-F7AD-46D8-8419-EA01B02D5B6E");var l=n(138),u=n(227),f=n(6);const p=a.Ov.isActivated("6BC7F79B-F64E-45FD-8C10-8A0B11E1A1AE"),m=a.Ov.isActivated("b34b53db-eebd-41ab-a952-cea4ecae7061"),_=a.Ov.isActivated("FCE15EEB-B33F-48C7-B6B0-01C53F4E3F22"),h=a.Ov.isActivated("CE33C02E-50E4-42DC-A90F-21222CB273FF"),b=a.Ov.isActivated("A3C20F37-C7C2-4AC6-ADB4-8C6958661CE0"),g=a.Ov.isActivated("18041F7A-7BDD-4D29-86F1-1C56AC02CABB"),v=a.Ov.isActivated("E33B9D9A-36D5-4622-942E-D752961FB9C5"),y=a.Ov.isActivated("ED251D77-47F5-4235-A7E7-5B016DCF530C"),S=a.Ov.isActivated("770CD907-DCBF-4F19-9F41-B0CE57497A99"),D=a.Ov.isActivated("ff106db9-b7de-4cb7-b28a-41fd6264cb74"),I={"az-nb":a.Ov.isActivated("11E94882-32E7-41F9-97E5-517D8392AD64"),"az-rms":a.Ov.isActivated("4326281B-C894-4584-A679-2A8F906F9186"),"ms-augloop":a.Ov.isActivated("FECC1297-0280-4181-AC7D-C7619C8317C7"),"ms-designer":a.Ov.isActivated("08A57D58-3B4E-4D6F-8069-4923A16D1410"),"ms-forms":a.Ov.isActivated("DE809C5A-1684-42BD-8234-8CD758135C88"),"ms-graph":a.Ov.isActivated("9DAED3DC-9C1F-4868-94C9-559F38847D35"),"ms-loki":a.Ov.isActivated("82D3735E-7873-4DFB-9C17-05D2621E7ED9"),"ms-mcu":a.Ov.isActivated("6961FBF5-64D1-49FC-B005-A913747B8ACA"),"ms-officeapps":a.Ov.isActivated("87A9B0FD-843A-48E5-A8CE-4D8DB62A436A"),"ms-substrate":a.Ov.isActivated("D48E094B-A6B2-4A5A-B21A-3027E03520C5"),"ms-substrate-search":a.Ov.isActivated("FED1D456-746E-49F6-9B01-3A55C05B67E5"),"ms-substrate-sti":a.Ov.isActivated("2E7FC3E3-8CB0-48F3-99D2-96C57E6791B6"),"ms-substrate-taiger-service":a.Ov.isActivated("C0C4A112-23C5-47BC-B4DA-1DF407EC0525"),"ms-substrate-tenant-feedback":a.Ov.isActivated("BB31A897-FBA6-45DB-ABAE-F80ED5C76178"),"oAuth-SA":a.Ov.isActivated("371D965D-71B0-457C-9859-A4DAE8D93331"),"office-home":a.Ov.isActivated("7904032D-82A6-4E91-9B0F-19FC78818E0E"),"power-bi":a.Ov.isActivated("2988E6EE-0506-4DAD-95B1-AD4457FC47D2"),"power-platform":a.Ov.isActivated("0A68AF2D-350A-46AC-825C-97D4C5F1E3B1"),"SharePoint-embedded":a.Ov.isActivated("819646EE-A230-4E40-AE1F-8706BCAC044D"),"SharePoint-graph":a.Ov.isActivated("6F52630A-DAEC-4706-A27F-C3F9C78FA0B2"),"SharePoint-media":a.Ov.isActivated("DB3A7BE9-BC20-448A-B625-077BEBEC6008"),"SharePoint-mediaGPT":a.Ov.isActivated("D2B7A193-D1A2-46B1-AC7B-D7BB6D55E34C"),"teams-cmd":a.Ov.isActivated("60A336BB-9983-4209-8AA2-D363834C1949"),"your-phone":a.Ov.isActivated("5E52A975-66D9-4250-AC01-58D481529EBA"),oAuth:a.Ov.isActivated("C9B5BE64-2CEF-4898-A844-CACAD3B22692"),ocps:a.Ov.isActivated("7083D304-F054-4320-9699-7630F7983EB7"),pushchannel:a.Ov.isActivated("2C50BE8C-2E41-4E97-B00A-411397F2D382"),SharePoint:a.Ov.isActivated("EF16A944-DBA4-46F1-BE52-E010C4FDE981"),SharePoint_MSAL:a.Ov.isActivated("846C4E85-895E-478B-B0BF-CD8F8A911C81"),SharePoint_SelfIssued:a.Ov.isActivated("CA3D4808-E720-411F-8A0E-D4D8DCBF7E5F"),SPHome:a.Ov.isActivated("595982BE-C488-4ADF-9E0C-7FCEDAAD2621"),yammer:a.Ov.isActivated("6D22340C-BED0-4910-A341-0AD4C7EB165A")},x=["onedrive_implicit.access"],C=new Set;for(const e of["https://esign.svc.cloud.dev.microsoft","https://esign.svc.cloud.microsoft","9471276c-aa67-4dd2-bde2-291a033f3c3c","396ef0b6-ae1c-4404-86ce-0a869d4d2987",l.c])C.add(e);var O=n(58),w=n(59),E=n(36),A=n(13),L=n(272),k=n(540);const M=a.Ov.isActivated("14B745EB-1E25-4510-8F86-1E531232E670");var P=n(436),T=n(213);const U=(0,a.C2)("acquireTokenFetcher",class{getToken(e){const{name:t,resource:n,tokenType:i,apiQosName:r}=e,o={resource:n,tokenType:i};if(!a.Ov.isActivated("3985CFAD-51BE-4D3E-A7F9-F1C2ADFD85E4","09/18/2023","Validate that self-signed resource is in tenant")){const e=new A.b({context:this._pageContext}).getUrlParts({webUrl:n});if("SPO"===i&&e.geoRelation===A.a.unknown)throw new a.a_({code:"InvalidTenantForSelfSignedToken"})}const s=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString();return(0,k.b)(`AcquireTokenFetcher.GetToken.${t} (${r})`,void 0,!0),this._dataRequestor.getData({url:s,webAbsoluteUrl:this._pageContext.webAbsoluteUrl,method:"POST",qosName:`AcquireToken.getToken.${t}`,qosObjectType:r,additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},allowOAuth:!1,noRedirect:M?void 0:this._noRedirect,parseResponse:(e,t)=>({...JSON.parse(e),correlationId:t.getCorrelationId()}),additionalPostData:JSON.stringify(o),telemetryHandler:e=>{const{errorData:t,eventData:n}=e;let i=n;if(t){const{code:e}=t;if(e&&(e.indexOf("0x80070005")>-1||e.indexOf("10012")>-1)){if(a.Ov.isActivated("CA0F7D1A-8CFF-448C-9522-D43AFF8278E2"))return{eventData:{...n,resultType:E.a.ExpectedFailure}};i=(0,L.c)(i,{resultType:E.a.ExpectedFailure})}}return r&&(i=(0,L.c)(i,{objectType:r})),{eventData:i}}}).then(e=>((0,k.a)(`AcquireTokenFetcher.GetToken.${t} (${r})`,"Succeeded",void 0,!0),e)).catch(e=>{throw(0,k.a)(`AcquireTokenFetcher.GetToken.${t} (${r})`,"Failed",void 0,!0),e})}constructor(e,t){const{cookieRefresher:n,pageContext:i,noRedirect:r=!a.Ov.isActivated("22A14184-8C68-4EA3-8CA6-09C8A9009A71")||void 0}=t;this._pageContext=i,this._noRedirect=r;const o=n?{getFormDigest:async e=>{await n.refreshCookies({resource:e.url,url:e.url,expiration:e.expiration,claimsChallenge:e.claimsChallenge,apiQosName:e.apiQosName})}}:void 0;this._dataRequestor=new w.a({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:i,tokenProvider:o,noRedirect:r}),this._apiUrlHelper=new O.a({webAbsoluteUrl:i.webAbsoluteUrl})}},{pageContext:i.a,cookieRefresher:P.a.optional,noRedirect:T.a}),F=!a.Ov.isActivated("3CA3181A-AA3E-4895-BF73-D6089D92C8F5"),H=!a.Ov.isActivated("DDD0B6F7-6461-4DFD-A821-98C1FB34AA32");var R=n(144);const N=(0,a.C2)("spHttpTokenFetcher",class{async getToken(e){const{name:t,resource:n,claimsChallenge:a,expiration:i,apiQosName:r,scopes:o}=e,s=await this._getSpHttpDataSource(),c=!!i||"ms-substrate"===t,{accessToken:l,expiresOn:u}=await s.fetchTokenData({resource:n,claims:a?.claims,forceRefresh:c,tokenName:H?t:void 0,apiQosName:F?r:"",...d?{scopes:o}:{}});return{access_token:l,expires_on:u?.toISOString()}}constructor(e,t){this._getSpHttpDataSource=t.getSpHttpDataSource}},{getSpHttpDataSource:R.a.async.lazy.bypass}),B=new a.OJ({name:"isMsalSupported",factory:new a.Rn(()=>!0)}),j=new a.OJ({name:"isSubstrateAcquireDisabled",factory:{dependencies:{},create:()=>({instance:()=>(0,s.i)(s.f)})}}),V=new a.OJ("enableOdcOnSpoToken"),z=(0,a.C2)("spHttpTokenFetcherWithAcquireFallback",class{async getToken(e){let{scopes:t,tokenType:n}=e;m||_||"oAuth-SA"===e.name||({scopes:t,...e}=e),h||"SPO"!==n||({tokenType:n,...e}=e);const{resource:a}=e;if((0,u.a)(a,{appPageContext:this._appPageContext})){if(this._isMsalSupported()){if(((0,o.a)(s.e)||this._enableOdcOnSpoToken)&&("SPO"===n||"SharePoint"===e.name||"SharePoint_SelfIssued"===e.name||"SharePoint_MSAL"===e.name))return this._enableOdcOnSpoToken?await this._spHttpTokenFetcher.getToken({...e,scopes:x}):await this._spHttpTokenFetcher.getToken(e);if("SharePoint_MSAL"===e.name||"oAuth-SA"===e.name)return await this._spHttpTokenFetcher.getToken(e)}return await this._acquireTokenFetcher.getToken(h?e:{...e,tokenType:n})}if(this._isMsalSupported()){if(a===this._appPageContext.msGraphEndpointUrl||"ms-graph"===e.name){if(v&&(0,o.a)(s.c))return await this._spHttpTokenFetcher.getToken(e);if(!p&&t&&(t.indexOf("InformationProtection.Read.All")>-1||t.indexOf("InformationProtectionPolicy.Read")>-1||t.indexOf("Calendars.Read")>-1||!b&&t.indexOf("Sites.Read.All")>-1))return await this._spHttpTokenFetcher.getToken(e);if(!v)return(0,o.a)(s.c)?await this._spHttpTokenFetcher.getToken(e):await this._acquireTokenFetcher.getToken(e)}if("SharePoint-mediaGPT"===e.name)return await this._spHttpTokenFetcher.getToken(e);if(v){if(this._isSubstrateAcquireDisabled()&&(a===this._appPageContext.substrateEndpointUrl||"ms-substrate"===e.name||"ms-substrate-search"===e.name||"ms-substrate-sti"===e.name||"ms-substrate-tenant-feedback"===e.name||"ms-substrate-taiger-service"===e.name||"STI"===e.tokenType))return await this._spHttpTokenFetcher.getToken(e)}else if(a===this._appPageContext.substrateEndpointUrl||"ms-substrate"===e.name||"ms-substrate-search"===e.name||"ms-substrate-sti"===e.name||"STI"===e.tokenType)return this._isSubstrateAcquireDisabled()?await this._spHttpTokenFetcher.getToken(e):await this._acquireTokenFetcher.getToken(e);if(v){if(!p&&("az-nb"===e.name||"office-home"===e.name))return await this._spHttpTokenFetcher.getToken(e)}else if("az-nb"===e.name||"office-home"===e.name)return p?await this._acquireTokenFetcher.getToken(e):await this._spHttpTokenFetcher.getToken(e);if("ms-designer"===e.name||"ms-mcu"===e.name||"ms-forms"===e.name||"pushchannel"===e.name||"teams-cmd"===e.name||"oAuth-SA"===e.name||"ocps"===e.name||"ms-augloop"===e.name||"ms-substrate-tenant-feedback"===e.name||"ms-substrate-taiger-service"===e.name||"az-rms"===e.name||"power-platform"===e.name||"your-phone"===e.name)return await this._spHttpTokenFetcher.getToken(e);if("oAuth"===e.name&&C.has(a))return await this._spHttpTokenFetcher.getToken(e);if(v){if((0,o.a)(s.d)&&"SharePoint-media"===e.name)return await this._spHttpTokenFetcher.getToken(e)}else if("SharePoint-media"===e.name)return(0,o.a)(s.d)?await this._spHttpTokenFetcher.getToken(e):await this._acquireTokenFetcher.getToken(e);if(v){if(!g&&e.resource===r.a)return await this._spHttpTokenFetcher.getToken(e)}else if(e.resource===r.a)return g?await this._acquireTokenFetcher.getToken(e):await this._spHttpTokenFetcher.getToken(e);if(!y){const t=this._appPageContext.farmSettings?.ExternalService_flowservicehostname?`https://${this._appPageContext.farmSettings.ExternalService_flowservicehostname}`:"https://service.flow.microsoft.com";if(new f.a(a).authority===t)return S?await this._spHttpTokenFetcher.getToken(e):await this._acquireTokenFetcher.getToken(e)}if((0,o.a)(s.b)&&!I[e.name])return await this._spHttpTokenFetcher.getToken({...e,scopes:d&&(0,c.a)(a)?x:e.scopes})}return d&&(0,c.a)(a)?await this._spHttpTokenFetcher.getToken({...e,scopes:x}):await this._acquireTokenFetcher.getToken(e)}constructor(e,t){this._acquireTokenFetcher=t.acquireTokenFetcher,this._spHttpTokenFetcher=t.spHttpTokenFetcher,this._appPageContext=t.appPageContext,this._isMsalSupported=t.isMsalSupported,this._isSubstrateAcquireDisabled=t.isSubstrateAcquireDisabled,this._enableOdcOnSpoToken=t.enableOdcOnSpoToken,!D&&this._appPageContext.farmSettings?.ExternalService_powerappsappshostname&&C.add(`https://${this._appPageContext.farmSettings.ExternalService_powerappsappshostname}`)}},{acquireTokenFetcher:U,spHttpTokenFetcher:N,appPageContext:i.a,isMsalSupported:B,isSubstrateAcquireDisabled:j,enableOdcOnSpoToken:V.optional}),G=new a.OJ({name:"TokenFetcher.key",factory:new a.TF(z)})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n(57),i=function(){function e(){}return e.normalizeScale=function(e,t){void 0===t&&(t=1);var n=Math.pow(10,t);return Math.round(e*n)/n},e.normalizeScaleWithMinMaxScale=function(e,t,n){void 0===n&&(n=1);var a=Math.pow(10,n),i=Math.round(t*a)/a;return t/e>=1?Math.min(this._maxScale,i):Math.max(this._minScale,i)},e.setMinMaxScale=function(e,t){this._minScale=e,this._maxScale=t},e._minScale=a.z,e._maxScale=a.y,e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n("react-lib"),i=a.createContext(void 0),r=function(){return a.useContext(i)},o=function(e){var t=e.children,n={enableFormFilling:e.enableFormFilling,formHandler:e.formHandler};return a.createElement(i.Provider,{value:n},t)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_145"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n("odsp.util_385"),i=n(1);const r=!a.Ov.isActivated("D3C0DFEB-12A9-4202-B5C5-CC6F8108222A"),o={pageContext:i.a},s=new a.OJ({name:"chatODSPPageUrl",factory:{dependencies:o,create:e=>{let t;if(r){const n=new URL(e.pageContext.webAbsoluteUrl);n.pathname=`${e.pageContext.layoutsUrl}/chat.aspx`,t=n.toString()}else t=`${e.pageContext.webAbsoluteUrl}/${e.pageContext.layoutsUrl}/chat.aspx`;return{instance:t}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("fui.util_939"),i=n(482);const r={AcceptMedium:"",Accounts:"",Add:"",AddFriend:"",AlertSolid:"",AlignLeft:"",AlignRight:"",AppIconDefault:"",Archive:"",Ascending:"",Attach:"",AutomateFlow:"",Back:"",BackToWindow:"",Blocked12:"",Blocked2:"",BlockedSite:"",BlockedSiteSolid12:"",BooleanData:"",CalculatorAddition:"",CalculatorMultiply:"",Calendar:"",CalendarDay:"",CalendarWeek:"",CalendarWorkWeek:"",Cancel:"",CC:"",CCSolid:"",Chat:"",CheckboxComposite:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CheckMark:"",ChevronDown:"",ChevronDownSmall:"",ChevronLeft:"",ChevronLeftMed:"",ChevronLeftSmall:"",ChevronRight:"",ChevronRightMed:"",ChevronRightSmall:"",ChevronUp:"",ChoiceColumn:"",ChromeClose:"",CircleAdditionSolid:"",CirclePlus:"",CircleRing:"",Clear:"",ClearFilter:"",ClosePaneMirrored:"",CloudPrinter:"",Color:"",Comment:"",CommentAdd:"",CompassNW:"",Completed:"",CompletedSolid:"",Contact:"",Copy:"",CriticalErrorSolid:"",Currency:"",DateTime2:"",Delete:"",Descending:"",Diamond:"",Document:"",DocumentApproval:"",Down:"",Download:"",DynamicList:"",Edit:"",EditListPencil:"",EditNote:"",Embed:"",EntityExtraction:"",Error:"",ErrorBadge:"",ExcelDocument:"",ExcelLogo:"",FabricFolder:"",FabricFolderLink:"",FabricMovetoFolder:"",FabricOpenFolderHorizontal:"",Favicon:"",FavoriteStar:"",FavoriteStarFill:"",Feedback:"",FileRequest:"",Filter:"",Flag:"",Flow:"",Folder:"",FullScreen:"",FullView:"",GenericScan:"",Giftbox:"",Glimmer:"",GlobalNavButton:"",Globe:"",Go:"",GridViewMedium:"",GripperBarVertical:"",GripperDotsVertical:"",GroupedList:"",GroupList:"",Handwriting:"",Heart:"",HeartFill:"",History:"",Home:"",HomeGroup:"",Info:"",InfoSolid:"",LargeGrid:"",Library:"",Lightbulb:"",Link:"",Link12:"",List:"",Lock:"",Mail:"",MailAttached:"",Market:"",Megaphone:"",MicrosoftTranslatorLogo:"",More:"",MoreVertical:"",Number:"",ODLink:"",OneDriveAdd:"",OpenFile:"",OpenFolderHorizontal:"",OpenPane:"",OpenPaneMirrored:"",OutlookLogo:"",Page:"",PDF:"",People:"",PeopleAdd:"",Photo2:"",Pin:"",Pinned:"",PinnedSolid:"",PinSolid12:"",PinSolidOff12:"",PinToTab:"",Play:"",PlayerSettings:"",PlaylistMusic:"",POI:"",PopExpand:"",PowerApps2Logo:"",PowerAutomateLogo:"",PowerPointDocument:"",ReadingMode:"",ReadOutLoud:"",RecycleBin:"",ReminderPerson:"",RemoveFilter:"",Rename:"",Reply:"",Ringer:"",SavedOffline:"",Search:"",SecurityGroup:"",Send:"",Settings:"",Share:"",ShareiOS:"",Signin:"",SingleBookmark:"",SingleBookmarkSolid:"",SingleColumnEdit:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",Snooze:"",Sort:"",SortDown:"",SortLines:"",SortUp:"",Speech:"",SpeechOff:"",StackIndicator:"",StatusCircleCheckmark:"",StatusErrorFull:"",Stop:"",Switch:"",SyncStatusSolid:"",SyncToPC:"",Tag:"",TagUnknown12:"",TagUnknown12Mirror:"",Taskboard:"",TeamsLogo:"",TextDocument:"",TextDocumentShared:"",TextField:"",Tiles:"",Trending12:"",UnavailableOffline:"",Undo:"",Uneditable2:"",Unknown:"",Unpin:"",Up:"",Upload:"",View:"",ViewAll:"",ViewList:"",VisioLogo:"",Warning12:"",WarningSolid:"",WordDocument:"",Work:""};function o(e){const t={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:`url('${i.a}') format('woff')`},icons:r};(0,a.fU)(t,e)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("CookieRefresher")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>d,c:()=>s,d:()=>c});var a=n("tslib_145"),i="ODSPPDF",r="WASM_CACHE",o=[r];function s(e,t,n){return(0,a.yv)(this,void 0,void 0,function(){var i,r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,l()];case 1:return i=a.sent(),r=i.transaction([e],"readonly"),o=r.objectStore(e),s=o.get(t),[2,new Promise(function(e,a){s.onerror=function(){i.close(),a("Fail to retreive store by ".concat(t))},s.onsuccess=function(t){var a=t.target.result;a&&a.version===n?(i.close(),e(a.value)):(i.close(),e(void 0))}})]}})})}function c(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,l()];case 1:return n=a.sent(),i=n.transaction([e],"readwrite"),r=i.objectStore(e),o=r.put(t,t.key),[2,new Promise(function(e,a){o.onerror=function(){n.close(),a("Fail to update store by ".concat(t.key))},o.onsuccess=function(){n.close(),e()}})]}})})}function d(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,l()];case 1:return n=a.sent(),i=n.transaction([e],"readwrite"),r=i.objectStore(e),o=r.getAllKeys(),[2,new Promise(function(e,a){o.onsuccess=function(n){var a=n.target.result;null==a||a.forEach(function(e){e.startsWith(t)&&r.delete(e)}),e()},o.onerror=function(){n.close(),a("Fail to get all keys")}})]}})})}function l(){return(0,a.yv)(this,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){if(!self.indexedDB)throw new Error("This browser doesn't support IndexedDB");return e=indexedDB.open(i,1),[2,new Promise(function(t,n){e.onupgradeneeded=function(){var t=e.result;o.forEach(function(e){t.objectStoreNames.contains(e)&&t.deleteObjectStore(e),t.createObjectStore(e)})},e.onerror=function(){n("Fail to open indexeddb ".concat(i))},e.onsuccess=function(){t(e.result)}})]})})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>l,c:()=>d});var a=n("tslib_145"),i=n("react-lib"),r=n.n(i),o={isVisible:!1},s=(0,i.createContext)(o),c=(0,i.createContext)(function(){}),d=function(){return r().useContext(s)},l=function(){var e=r().useContext(c);return(0,i.useCallback)(function(t){e(function(e){return(0,a.q5)((0,a.q5)({},e),t)})},[e])},u=function(e){var t=e.children,n=(0,a.pM)((0,i.useState)(o),2),d=n[0],l=n[1];return r().createElement(c.Provider,{value:l},r().createElement(s.Provider,{value:d},t))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n(128),i=n(215),r="textField",o=function(){var e,t=null===(e=document.activeElement)||void 0===e?void 0:e.className;return a.a.isActivated("EnableCJKInFormTextField")?t===i.b:t===i.a||t===r}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_145"),i=n(85),r=n("react-lib");(0,n("fui.util_939").ZW)([{rawString:'.inputWrapper_e17f0b58{display:inline-block;height:100%}input{height:24px;border:1px solid;border-radius:2px;background-color:"#ffffff";color:"#323130"}input:focus{outline:none}'}]);var o=function(e){var t=e.visible,n=e.autoFocusOnInput,o=e.onEnterWhenFocused,s=e.onShiftEnterWhenFocused,c=e.inputProps,d=e.rootProps,l=e.outerRef,u=e.children,f=(0,a.pM)(r.useState(!1),2),p=f[0],m=f[1],_=r.useRef(null),h=r.useRef(null),b=(0,i.a)();r.useEffect(function(){var e,a;t&&n&&(null===(e=_.current)||void 0===e||e.focus(),m(!0),null===(a=h.current)||void 0===a||a.focus())},[n,t]);var g=r.useCallback(function(e){var t,n;switch(e.key){case"Enter":h.current===document.activeElement?e.shiftKey?null==s||s():null==o||o():(m(!0),null===(t=h.current)||void 0===t||t.focus());break;case"Escape":m(!1),null===(n=_.current)||void 0===n||n.focus(),e.stopPropagation(),e.preventDefault()}},[o,s]),v=r.useCallback(function(e){var t;null===(t=c.onBlur)||void 0===t||t.call(c,e),m(!1)},[c]);return r.createElement("div",{ref:l,className:"inputWrapper_e17f0b58"},r.createElement("div",(0,a.q5)({},d,{ref:_,"data-is-focusable":!0,onKeyDown:g}),r.createElement("input",(0,a.q5)({},c,{ref:h,style:{borderColor:b.semanticColors.inputBorder,backgroundColor:b.semanticColors.inputBackground,color:b.semanticColors.inputText},"data-is-focusable":p,onBlur:v})),r.createElement("style",null,"::placeholder {color: ".concat(b.semanticColors.inputPlaceholderText,"; }")),u))};o.defaultProps={visible:!0,autoFocusOnInput:!1}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(83),i="LocalStorageHelper",r=function(){function e(){}return e.setItem=function(e,t){try{return localStorage.setItem(e,t),!0}catch(e){return a.a.error(i,e),!1}},e.getItem=function(e){try{return localStorage.getItem(e)}catch(e){return a.a.error(i,e),null}},e.setBooleanItem=function(e,t){return this.setItem(e,t.toString())},e.getBooleanItem=function(e){return"true"===this.getItem(e)},e}()}
,(e,t,n)=>{"use strict";n.r(t),n.d(t,{oneDriveDataSourceKey:()=>o});var a=n("odsp.util_385"),i=n(475),r=n(1);const o=new a.OJ({name:"OneDriveDataSource.key",factory:{dependencies:{pageContext:r.a},create:({pageContext:e})=>{const t=new i.a({},{pageContext:e});return{instance:t,disposable:t}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"isBizChatEnabled",factory:new a.Rn(()=>!1)})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("VroomDataRequestor")}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n("odsp.util_385"),i=n(98),r=n(449),o=n(450);const s=new a.OJ({name:"isOfflineStateObservable.key.isOfflineStateObservable",factory:{dependencies:{offlineDetection:i.a},create:e=>{const t=new r.a,n=new o.a(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(e=>{n.set(e)})),{instance:n,disposable:t}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n(164);a.a.prototype.trackPromise=function(e){let t=!1;const n=this.attach({dispose:()=>{!t&&e.cancel&&e.cancel()}}),a=()=>{t=!0,n.dispose()};return e.done(a,a),e},a.a.prototype.trackSignal=function(e){return this.attach({dispose:()=>{e.cancel()}}),e};const i=a.a}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("odsp.util_385"),i=n(542);const r=a.Ov.isActivated("544e04a1-a11f-4d23-aedf-80ecb02d2818")?class{get(){return this._value}set(e){this._value=e,this._observers.forEach(e=>{e()})}subscribe(e){return this._observers.add(e),()=>{this._observers.delete(e)}}constructor(e){this._value=e,this._observers=new Set}}:class{get(){return this._observableValue.value}set(e){this._observableValue.value=e}subscribe(e){return this._observableValue.subscribe(e,"set"),()=>{this._observableValue.unsubscribe(e,"set")}}constructor(e){this._observableValue=new i.a(e)}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"cookieOrigin",factory:new a.Rn(window.location.origin)})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n("react-lib"),i=a.createContext(void 0),r=function(){return a.useContext(i)},o=function(e){var t=e.children,n={undoRedoService:e.undoRedoService};return a.createElement(i.Provider,{value:n},t)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l});var a=n("tslib_145"),i=n("react-lib"),r=n(216),o=i.createContext(void 0),s={dirty:!1},c=function(e,t){var n;return t.type===r.a.Reset?s:{dirty:!0,annotTypeOfLatestEdit:null===(n=t.payload)||void 0===n?void 0:n.annotType}},d=function(e){var t=e.children,n=(0,a.pM)(i.useReducer(c,s),2),r=n[0],d=n[1],l=i.useMemo(function(){return{editState:r,dispatchEditAction:d}},[r]);return i.createElement(o.Provider,{value:l},t)},l=(o.Consumer,function(){return i.useContext(o)})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("odsp.util_385"),i=n(35);function r(){return!a.Ov.isActivated("702E9983-B7E6-47C0-A412-6E557D0A20C9")&&(0,i.a)({ODB:60342})}a.Ov.isActivated("96723D41-0476-4E60-A02D-199517143E81","11/10/2020","Allow ADAL as fallback for OAuth token requests")}
,(e,t,n)=>{"use strict";e.exports=n(201)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("engagementHandlers")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("getOneUpOnePlayerResources")}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>c});var a=n(47);const i=n(40).a.local,r="copilotLicenseStore",o=new a.a(r,i);function s(){try{return o.getValue(r)??!1}catch(e){return!1}}function c(e){try{o.setValue(r,e)}catch(e){}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"swapCobOnSpoDomainWithMpc",factory:new a.Rn(!1)})}
,,(e,t,n)=>{"use strict";var a=n(479),i=n(480),r=n(9),o=n(244);const s={webThemeProvider:e=>new i.a({pageContext:e,getThemeDataSource:()=>(e=>new r.c((t,a)=>{window.require.specified("@msinternal/odsp-datasources/lib/dataSources/theming/spList/WebThemeDataSource"),n.e(83).then(n.bind(n,768)).then(o.a).then(n=>{t(new n(e))})}))(e)})};a.a.initializeTheme(s);var c=n(434),d=n("fui.util_939"),l=n(483),u=n(484),f=n("odsp.util_385");(0,c.a)();const p={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:`url(${l.a}) format('woff')`},icons:{PinOff:"",PinNavMenu:"",PinOffSolid:"",PinSolid:""}};(0,d.fU)(p),function(){const e={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"App Icons"',src:`url('${u.a}') format('woff')`},icons:{SharePointLogo:"",SharePointLogoInverse:"",TeamsLogo:"",TeamsLogoInverse:"",OutlookLogo:"",OutlookLogoInverse:"",OneDriveLogo:"",WordLogo:"",WordLogoInverse:"",ExcelLogo:"",ExcelLogoInverse:"",PowerPointLogo:"",PowerPointLogoInverse:"",OneNoteLogo:"",OneNoteLogoInverse:"",DefenderApp:""}};if(f.Ov.isActivated("b79a8b93-9904-471d-af54-d53545352fbd"))(0,d.mi)(Object.keys(e.icons));else{const t=d.RZ.getValue("icons"),n=Object.keys(e.icons).map(e=>e.toLowerCase()).filter(e=>t?.[e]);(0,d.mi)(n)}(0,d.fU)(e,{disableWarnings:!0})}();var m=n("react-lib"),_=n.n(m),h=n(500),b=n(501),g=n(485),v=n(486),y=n(487),S=n(488),D=n(489),I=n(490),x=n(491),C=n(492),O=n(493),w=n(494),E=n(495),A=n(496),L=n(497),k=n(414);const M=`${d.fG}/`,P=k.a?(0,k.c)(`${M}`):`${M}assets/item-types/`,T=`${M}office-ui-fabric-react-assets/foldericons`,U=`${M}assets/brand-icons/product/`,F=C.a,H=O.a;var R,N=n(498),B=n(499);(0,h.a)(P,{disableWarnings:!0}),(0,b.a)(T,{disableWarnings:!0}),(0,g.a)(U,{disableWarnings:!0}),R={disableWarnings:!0},(0,d.fU)({fontFace:{},style:{width:12,height:12,overflow:"hidden"},icons:{shortcutBadge12:m.createElement("img",{alt:"",src:v.a})}},R),(0,d.fU)({fontFace:{},style:{width:16,height:16,overflow:"hidden"},icons:{shortcutBadge16:m.createElement("img",{alt:"",src:y.a})}},R),(0,d.fU)({fontFace:{},style:{width:20,height:20,overflow:"hidden"},icons:{shortcutBadge20:m.createElement("img",{alt:"",src:S.a})}},R),(0,d.fU)({fontFace:{},style:{width:12,height:12,overflow:"hidden"},icons:{shortcutBadge12_dark:m.createElement("img",{alt:"",src:D.a})}},R),(0,d.fU)({fontFace:{},style:{width:16,height:16,overflow:"hidden"},icons:{shortcutBadge16_dark:m.createElement("img",{alt:"",src:I.a})}},R),(0,d.fU)({fontFace:{},style:{width:20,height:20,overflow:"hidden"},icons:{shortcutBadge20_dark:m.createElement("img",{alt:"",src:x.a})}},R),(0,C.b)(F,{disableWarnings:!0}),(0,O.b)(H,{disableWarnings:!0}),(0,w.a)({disableWarnings:!0}),(0,E.a)({disableWarnings:!0}),(0,A.a)({disableWarnings:!0}),(0,L.a)({disableWarnings:!0}),(0,d.fU)({icons:{errorExclamation:m.createElement("img",{src:N.a,alt:""}),errorExclamationDark:m.createElement("img",{src:B.a,alt:""})}}),n.e(22).then(n.bind(n,769)).then(({initializeIcons:e})=>{e({disableWarnings:!0},!0)}).catch(e=>{console.error("Icons error",e)}),n("react-dom-lib");var j=n(748),V=n(502),z=n(1),G=n(225),K=n(27),W=n(149),q=n(70),Q=n(532),Y=n(97),J=n(96),X=n(533),Z=n(416),$=n(15),ee=n(534);const te={crossDomainImageHelper:(0,f.C2)("ThumbnailHelper.crossDomainImageHelper",ee.a,{apiUrlHelper:Z.a}),itemUrlHelper:$.c},ne=new f.OJ({name:"ThumbnailHelper",factory:{dependencies:te,create:e=>{const t=new ee.b(e);return{instance:t,disposable:t}}}});var ae=n(278),ie=n(56);const re=(0,f.C2)("MetaDataProcessor",ae.a,{pageContext:z.a,platformDetection:ie.a});var oe=n(535),se=n(17),ce=n(226);const de=new f.OJ({name:"updateThumbnailUrlCallback",factory:{dependencies:{},create:e=>({instance:function(e,t){e.itemsWaitingForCookies.map(n=>{const{itemKey:a}=n,i=(0,q.c)().consume(se.b),r=i?.getOneUpProperties();if(r&&a===r.focusItem.key){const o=t.authTokenV21,s=t.proofTokenV21,c=n.thumbnailUrl+`&access_token=${o}&prooftoken=${s}`,d=e.thumbnailHelper.getThumbnail({baseUrl:c,itemKey:a,fileExtension:n.fileExtension,mediaServiceMetadata:n.mediaServiceMetadata});if(d){const e={...r.focusItem};e.thumbnail=ce.replace(d),i.update({focusItem:e},"AuthCookieHelperUpdateThumbnail")}}})}})}}),le=(0,f.C2)("AuthCookieHelper",oe.a,{thumbnailHelper:ne,platformDetection:ie.a,updateThumbnailUrlCallback:de});var ue=n(536);const fe=(0,f.C2)("AuthTokenStore",ue.a,{}),pe=new f.A3(X.a,{pageContext:z.a,thumbnailHelper:ne,metaDataProcessor:re,authCookieHelper:le,authTokenStore:fe}),me=new f.OJ({name:"MicroServiceDataSource",factory:pe});var _e=n(212);const he=new f.OJ({name:"ItemCommentsDataSource.key",loader:new f.hg(()=>n.e(43).then(n.bind(n,776)).then(e=>e.resourceKey))});var be=n(860);const ge=new f.OJ({name:"PeoplePickerDataSource.async.key",loader:new f.hg(()=>n.e(76).then(n.bind(n,777)).then(e=>e.resourceKey))});(0,d.ZW)([{rawString:"div[class*=OneUpModalSizing]>div.ms-Dialog-main{height:100vh!important;height:100dvh!important;width:100vw!important;max-width:unset!important;max-height:unset!important;min-height:unset!important;border-radius:0!important}div[class*=OneUpSafariMobile]>div.ms-Dialog-main{height:100%!important}"}]);var ve=n(718),ye=n(537),Se=n(81),De=n(282),Ie=n(105),xe=n(407),Ce=n(162),Oe=n(22),we=n(112),Ee=n(163);(0,d.ZW)([{rawString:".OneUpHtml_54b8a18c{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUpHtmlIOS_54b8a18c{overflow:auto;position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUpHtmlIFrame_54b8a18c{width:100%;height:100%;background-color:#fff;border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}.OneUpHtmlNewDesign_54b8a18c{position:absolute;top:0;width:75%;bottom:0;left:0;right:0;margin:auto;text-align:center;-webkit-overflow-scrolling:touch}"}]);var Ae=n(283),Le=n(467),ke=n(546),Me=n(10);function Pe(e,t){if(e)try{return e.getResponseHeader(t)||void 0}catch(e){}}var Te=n(4),Ue=n(296),Fe=n(115),He=n(293),Re=n(285),Ne=n(158);function Be(e){const{item:t}=e,n=(0,q.c)(),a=m.useRef();if(!t)return m.createElement(m.Fragment,null);const i=n.consume(Me.f),r=n.consume(ie.a).isIOS,o=n.consume(Le.downloadDataSourceKey),[s,c]=m.useState(!1),[d,l]=m.useState(),[u,p]=m.useState(),[_,h]=m.useState(!1),b=m.createRef(),g=m.useRef(),v=n.consume(Ne.a);m.useEffect(()=>()=>{u&&window.URL.revokeObjectURL(u)},[]),m.useEffect(()=>{if(r&&b&&b.current){const{clientWidth:e,clientHeight:t}=b.current;b.current.style.width=`${e}px`,b.current.style.height=`${t}px`}},[b]);const y=t=>{const{extension:n}=t||e.item,a=n&&n.toLowerCase();return!!a&&(".htm"===a||".html"===a||".svg"===a)},S=t=>{if((0,Te.qb)())return!1;if(e.item.htmlConversion&&!y()){const e=t.extraData.status;if(t.code.indexOf("406")>=0||e&&e.toString().indexOf("406")>=0)return!0}return!1},D=(n,r,o)=>{const s=r?(0,Ie.o)(r):"";let c=new f.a_({code:n.name,message:n.message,extraData:{...o,rawError:JSON.stringify(n).concat(`, ${s}`)}});if(r)try{const e=r;let t,a="",i="";if(e){a=n.name.concat("."+e.code||0),i=n.message.concat("."+e.message);const r="error";if(e.data&&e.data[r])try{const n=e.data[r];a=a.concat("."+n?.code).concat("."+e?.status),i=i.concat("."+n?.message?.value).concat("."+e?.statusText),t=n.stack}catch(e){}}c=new f.a_({code:a,message:i,isExpected:S(c),correlationId:e?.correlationId,extraData:{...c.extraData,status:e?.status,statusText:e?.statusText,stack:t}})}catch(e){try{const e=r;c=new f.a_({code:n.name.concat("."+e.name),message:n.message.concat("."+e.message),isExpected:S(c),extraData:{...c.extraData}})}catch(e){}}i.updateErrorState("oneupHtmlViewer",{errorType:Ie.d.viewerInitLoadingError,error:c,item:t,meTAEvent:a.current,extraData:{noTempAuth:g.current}}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(c,"HTMLViewer")},I=(e,a)=>{const i=n.consume(Ee.a);return e?.url&&!a?.forceRefresh?Promise.resolve({shouldRetryForceToken:!1,url:e?.url}):i.getAuthenticationParams(t,a).then(e=>({shouldRetryForceToken:!1,url:`${i.getItemUrl(t,{useDirectEndpoint:!0})}/content?format=html&${(0,Oe.a)(e)}`})).catch(e=>{if(e&&e instanceof Error&&"AccessExpired"===e.name)return{shouldRetryForceToken:!0};try{let t;if(e&&e instanceof XMLHttpRequest){t=e?(0,Fe.d)(e):void 0;const n=JSON.parse(e.responseText);if("unauthenticated"===n.error?.code&&"AccessExpired"===n.error?.innererror?.code)return{shouldRetryForceToken:!0}}const n=(0,Ie.i)("error getting auth params for graph html conversion","HTMLGraphAuthParamError");return D(n,e,{...t}),{shouldRetryForceToken:!1}}catch{const t=(0,Ie.i)("error getting auth params parsed error for graph html conversion","HTMLGraphAuthParamParseError");return D(t,e),{shouldRetryForceToken:!1}}})},x=(e,t)=>(g.current=!(0,Re.a)(e),we.a.startAndPostProcess({url:e,headers:t},(e,t)=>e.responseText));m.useEffect(()=>{s||(async e=>{const{extension:i,htmlConversion:r}=e;let s=!1;if((0,Te.qb)()){const e=i&&i.toLowerCase();s=".htm"===e||".html"===e||".svg"===e}else s=y(e);if(r&&!s){if((0,Te.Gb)()){let e,t=!1;if(r.url){const a=n.consume(Ue.a);if(e=await a(),!v)try{const e=r.url?.split("access_token=")[1].split("&")[0];if(e){const n=(e=>{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)})(e),a=Date.now();n.exp&&a-1e3*parseInt(n.exp,10)>=198e5&&(t=!0)}}catch(e){const t=(0,Ie.i)("error parsing JWT token from htmlConversion url param","HtmlTokenHtmlConversionUrlError");D(t,e)}}(0,Fe.b)(r.url)&&(a.current=(0,He.a)(Ce.a.Html));const i=I(r,{forceRefresh:!!t});return Promise.resolve(i).then(t=>t.url?x(t.url,e):Promise.resolve(void 0)).catch(e=>{if(e){let t={};try{if(e&&e instanceof XMLHttpRequest&&r){t=e?(0,Fe.d)(e):{};const a=JSON.parse(e.responseText);if("unauthenticated"===a.error?.code&&"AccessExpired"===a.error?.innererror?.code){const e=!!r.url,a=e&&v?i:I(void 0,{forceRefresh:!0});return Promise.resolve(a).then(async t=>{let a;if(e){const e=n.consume(Ue.a);a=await e({forceRefresh:!0})}return t.url?x(t.url,a):Promise.resolve(void 0)}).catch(e=>{const n=(0,Ie.i)("error reattempting to get item conversion content url with token retry without htmlConversion prop","HTMLUrlPromiseTokenRetryWithoutHtmlConvError");return D(n,e,{...t}),Promise.resolve(void 0)})}}const a=(0,Ie.i)("error getting graph html conversion","HtmlConversionError");return D(a,e,{...t}),Promise.resolve(void 0)}catch{const n=(0,Ie.i)("error getting parsed error for graph html conversion","HTMLGraphHtmlConversionParseError");return D(n,e,{...t}),Promise.resolve(void 0)}}const t=(0,Ie.i)("error calling to get item html content conversion ","HTMLConversionGeneralError");D(t)})}{const e=n.consume(Ee.a),a=r.url||e.getAuthenticationParams(t).then(n=>`${e.getItemUrl(t,{useDirectEndpoint:!0})}/content?format=html&${(0,Oe.a)(n)}`);return Promise.resolve(a).then(e=>we.a.startAndPostProcess({url:e},(e,t)=>e.responseText))}}return a.current=void 0,o.getItemContents(t).then(e=>ke.c(e,"text/html").then(e=>e.text).catch(e=>{const t=(0,Ie.i)("error parsing content from blob","HTMLParseContentBlobError");throw D(t,e),new Error})).catch(e=>{const t=(0,Ie.i)("error getting item content from download datasource","HTMLGetItemContentsError");throw D(t,e),new Error})})(t).then(e=>{if(e)if((0,Ae.a)())l(e),c(!0);else{const t=new Blob([e],{type:"text/html"});let n;try{n=window.URL.createObjectURL(t),p(n),c(!0)}catch(e){const t=(0,Ie.i)("error creating object url from blob","HTMLCreateObjectUrlError");D(t,e)}}else{const e=(0,Ie.i)("empty html file content","HTMLEmptyContentError");D(e)}},n=>{let r=Ie.d.genericViewerLoadingError;if(n instanceof XMLHttpRequest){const e=function(e,t){const n=e&&e.status,a=e&&t&&-1!==t.indexOf(n),i=Pe(e,"x-errorcode")||Pe(e,"x-clienterrorcode");return new f.a_({isExpected:a,code:i||n.toString(),message:JSON.stringify(e.response)})}(n,[406]);r="HTMLErrorProcessingContent",i.updateErrorState("oneupHtmlViewer",{errorType:Ie.d.viewerInitLoadingError,error:e,item:t,meTAEvent:a.current,extraData:{noTempAuth:g.current}})}else r="HTMLErrorRetrievingContent",i.updateErrorState("oneupHtmlViewer",{errorType:Ie.d.viewerInitLoadingError,error:n,item:t,meTAEvent:a.current,extraData:{noTempAuth:g.current}});e.fallbackToOtherViewer&&e.fallbackToOtherViewer(new Error(r),"HTMLViewer")})},[s,t]);const C=(0,Se.a)(()=>{_||(e.onViewerLoaded&&e.onViewerLoaded({meTAEvent:a.current,extraData:{noTempAuth:g.current}}),h(!0))}),O=(0,Se.a)(t=>{if(0===e.offset){const e=(0,Ie.i)(`${t.type} - Error loading HTML viewer`,`${t.type} - HTMLIframeLoadError`);D(e)}});return s&&t?m.createElement("div",{className:r?"OneUpHtmlIOS_54b8a18c":"OneUpHtmlNewDesign_54b8a18c"},m.createElement("iframe",{ref:b,className:"OneUpHtmlIFrame_54b8a18c",sandbox:"",title:t.name,frameBorder:"0",src:u,srcDoc:d,onLoad:C,onError:O})):m.createElement(m.Fragment,null)}var je=n(21),Ve=n(41),ze=n(99);const Ge=f.Ov.isActivated("441dc3a7-bbe8-456c-91fd-59e0e22bb611","08/26/2024","Add subpath for mpc in swproxy url to make it be processed in the farm where the user mysite is"),Ke=(0,f.C2)("WorkerDataSource",class{getWorkerUrl(e,t){const n=this._window,a=`${n.location.protocol}//${n.location.host}`,i=new Ve.a(e);if(t||i.authority!==a){const i=new Ve.a(this._webAbsoluteUrl);if(a===i.authority&&this._isEmbed){if(t){const e="https://my.microsoftpersonalcontent.com"===a;return`${a}${!Ge&&e?i.path:""}/_layouts/15/odspserviceworkerproxy.aspx?swManifestName=${encodeURIComponent(t)}&debug=false&bypass=false`}return`${a}/_layouts/15/serviceworkerproxy.aspx?serviceWorkerUrl=${encodeURIComponent(e)}`}{const t=this._urlCache;if(t[e])return t[e];const a=n.URL.createObjectURL(new Blob([`importScripts(${JSON.stringify(e)});`],{type:"text/javascript"}));return t[e]=a,a}}return e}dispose(){const e=this._urlCache;for(const t in e)e.hasOwnProperty(t)&&this._window.URL.revokeObjectURL(e[t])}constructor(e,t){this._urlCache={};const{window:n=window,urlDataSource:a,navigation:i}=t;this._window=n,this._webAbsoluteUrl=t.pageContext.webAbsoluteUrl;const r=a.getPageType(i.viewParams);this._isEmbed=r===ze.a.Embed}},{pageContext:z.a,urlDataSource:J.a,navigation:K.a});var We=n(180),qe=n(76),Qe=n(128),Ye=n(84),Je=n(470),Xe=n(558),Ze=n(157),$e=n(61),et=n(547),tt=n(0),nt=n(31),at=n(113);const it="OpenPdfInBrowserAction",rt={pageContext:z.a,oneUpStore:se.b,navigation:K.a,resources:f.sp,platform:ie.a,oneUpStateStore:Me.f},ot=new f.OJ({name:"OpenPdfInBrowserAction",factory:{dependencies:rt,create:e=>{return{instance:{evaluateAction:(t=e,e=>{var n,a;return{isAvailable:(n=e.item,a=t.oneUpStateStore.currentAppState.isTeamsFileScenario,(0,Te._b)()?!!n&&st(n)&&".pdf"===n.extension?.toLowerCase():!!n&&st(n)&&".pdf"===n.extension?.toLowerCase()&&!a),id:it,onExecute:async()=>{const{item:n}=e,a=n.openUrl;if(a)return t.navigation.navigateTo({url:a,frameId:"_blank"}),{resultType:tt.b.Success};{const e=(0,Ie.i)("no url");throw t.oneUpStateStore.updateErrorState(it,{errorType:Ie.d.actionError,error:e,item:n}),e}}}})}};var t}}});function st(e){return!!(e&&e.extension&&e.openUrl&&e.itemStatus!==at.b.ConditionalAccessViewOnly&&e.itemStatus!==at.b.ConditionalAccessBlocked&&nt.a.hasItemPermission(e,nt.a.openItems))}var ct=n(42),dt=n(108),lt=n(30),ut=n(106),ft=n(167);const pt=(0,ft.a)(async()=>(await n.e(25).then(n.bind(n,783))).MalwareDetectedDialog),mt={oneUpStateStore:Me.f},_t=new f.OJ({name:"ShowMalwareDetectedAction",factory:{dependencies:mt,create:e=>({instance:function(t){try{const n=m.createElement(pt,t);e.oneUpStateStore.updateModalState("showMalwareDetectedDialog",{showModal:!0,content:n})}catch(t){throw e.oneUpStateStore.updateErrorState("showMalwareDetectedDialog",{errorType:Ie.d.actionError,error:t,item:void 0}),t}}})}});var ht=n(289),bt=n(116),gt=n(168),vt=n(549);const yt="DownloadAction",St={pageContext:z.a,oneUpStore:se.b,downloadDataSource:Le.downloadDataSourceKey,resources:f.sp,graphDataSource:Ee.a,oneUpStateStore:Me.f,showMalwareDetectedDialog:_t,navigation:K.a,itemUrlHelper:$.c},Dt=new f.OJ({name:"DownloadAction",factory:{dependencies:St,create:e=>{return{instance:{evaluateAction:(t=e,e=>({isAvailable:It({item:e.item,appLevelPagecontext:t.pageContext,itemUrlHelper:t.itemUrlHelper,remoteWebPageContexts:t.oneUpStore.pageContexts,oneUpStateStore:t.oneUpStateStore}),id:yt,onExecute:async()=>{const e=t.oneUpStore.getOneUpProperties()?.focusItem;if(!0===e?.lifeCycleStatus?.isMalwareDetected){const n={item:e,allowInfectedFileDownload:!!t.pageContext?.allowInfectedDownload,onDismiss:()=>{t.oneUpStateStore.updateModalState("showMalwareDetectedDialog",{showModal:!1,content:void 0})},onDownload:async()=>{const n=t.downloadDataSource.getItemClassicDownloadLink(e);t.navigation.navigateTo({url:n,frameId:"_blank"})}};t.showMalwareDetectedDialog(n)}else if(e&&e.type===dt.a.Folder&&e.urls){const n=e.urls[ut.a.itemUrl],a=ht.a?t.graphDataSource.getAccessToken(e):await t.graphDataSource.getAccessToken(e),i=[{name:e.name,size:e.size,docId:`${n}${-1!==n.indexOf("?")?"&":"?"}access_token=${a.accessToken}`,isFolder:!0}];let r="";i&&1===i.length&&(r=i[0].name+".zip");const o=e.urls[ut.a.downloadAsZip],s=function(){const e=document.createElement("iframe");return e.id="zip-download-iframe",e.name=e.id,e.hidden=!0,e}();document.body.appendChild(s);const c=document.createElement("form");c.target=s.id,c.method="POST",c.action=o,c.style.display="none";const d=document.createElement("input");d.type="hidden",d.name="files",d.value=JSON.stringify({items:i}),c.appendChild(d);const l=document.createElement("input");l.type="hidden",l.name="guid",l.value=lt.a.generate(),c.appendChild(l);const u=document.createElement("input");u.type="hidden",u.name="accessToken",u.value=a.accessToken,c.appendChild(u);const f=document.createElement("input");f.type="hidden",f.name="zipFileName",f.value=r,c.appendChild(f);const p=document.createElement("input");p.type="hidden",p.name="provider",p.value="spo",c.appendChild(p);const m=document.createElement("input");m.type="submit",c.appendChild(m),s.contentWindow?.document.body.appendChild(c),c.submit()}else{if(!e||e.type===dt.a.Folder){const n=(0,Ie.i)("no parent view/item");throw t.oneUpStateStore.updateErrorState(yt,{errorType:Ie.d.actionError,error:n,item:e}),n}{const n={items:[e]};await t.downloadDataSource.downloadItems(n).then(()=>({resultType:tt.b.Success})).catch(n=>{throw t.oneUpStateStore.updateErrorState("download action",{errorType:Ie.d.actionError,error:n,item:e}),n})}}return{resultType:tt.b.Success}}}))}};var t}}});function It(e){const{item:t,appLevelPagecontext:n,itemUrlHelper:a,remoteWebPageContexts:i,oneUpStateStore:r}=e;if(!t||!t.key||!t.urls)return!1;if(!gt.a&&(0,bt.c)(t.extension))return!1;if(r&&r.currentAppState&&r.currentAppState.renamedKeyInFastOneUp&&r.currentAppState.renamedKeyInFastOneUp===t.key)return!1;if(t.itemStatus===at.b.ConditionalAccessBlocked||t.itemStatus===at.b.ConditionalAccessViewOnly)return!1;if(t.type===dt.a.OneNote)return!1;if(!nt.a.hasItemPermission(t,nt.a.openItems))return!1;let o=n;const s=a.getItemUrlParts(t.key);if(s.fullWebUrl&&s.serverRelativeListUrl){const e={webAbsoluteUrl:s.fullWebUrl,listUrl:s.serverRelativeListUrl};i&&i.get(e)&&(o=i.get(e))}if(o)if((0,Te.kb)()){const e={blockDownloadsExperienceEnabled:!!o.blockDownloadsExperienceEnabled,viewOnlyExperienceEnabled:!!o.viewOnlyExperienceEnabled,itemIsFolder:t.type===dt.a.Folder,itemHasOpenUrl:!!t.openUrl,itemHasAppMap:!!t.appMap},n=(0,vt.a)(e);if(n===at.b.ConditionalAccessBlocked||n===at.b.ConditionalAccessViewOnly)return!1}else if(o.blockDownloadFileTypePolicyEnabled||o.blockDownloadsExperienceEnabled||o.viewOnlyExperienceEnabled)return!1;return!(!t.urls[ut.a.downloadAsZip]||!t.urls[ut.a.itemUrl]||0===t.childCount||t.type!==dt.a.Folder)||!t.isRootFolder&&(t.type===dt.a.File||t.type===dt.a.Media||t.type===dt.a.Unknown)}const xt={downloadActionProvider:Dt},Ct="downloadCommand",Ot=new f.OJ({name:"DownloadCommand",factory:{dependencies:xt,create:({downloadActionProvider:e})=>({instance:{id:Ct,name:ct.w,title:ct.x,automationId:Ct,iconProps:{iconName:"Download"},evaluateAction:e.evaluateAction}})}});var wt=n(299),Et=n(80),At=n(246),Lt=n(247),kt=n(249),Mt=n(222),Pt=n(292),Tt=n(48),Ut=n(78);const Ft="OneUpViewer";function Ht(e="unknownViwer"){return(0,W.e)(`oneUp-${e}.start`)}function Rt(e){return"number"==typeof e&&isNaN(e)?void 0:{data:e,needFlatten:!0}}class Nt{initRumoneLogger(){if(this._initialized)return;this._initialized=!0;const e=this._pageContext&&this._pageContext.ariaCollectorUrl?new Ve.a(this._pageContext.ariaCollectorUrl).domain:"/Collector/3.0/";this._rumone.startAPIMeasurement({ignore:t=>t.indexOf(e)>=0,getAPIName:e=>e.toLowerCase().indexOf("/RenderListDataAsStream")?"RenderListDataAsStream":""})}logRumonePerformance(e,t){let{viewerName:n,clientId:a,extension:i,fileSizeRange:r,embedStartLoadingTime:o=NaN,viewerStartTime:s=NaN,userClickTime:c=NaN,endTime:d,pageTransType:l,breakDownData:u,oneupScenario:f,isLightSpeed:p,isFullPageLogging:m,isServerSideTransfer:_,isFluentV9:h,isPdfNoTempAuth:b,isPdfUseToken:g,pdfSource:v,mip:y,isAutoOpenCopilotExperimentEnabled:S,isFromSyncClientAutoOpen:D}=e;o=this._regulateTime(o),c=this._regulateTime(c),d=this._regulateTime(d),s=this._regulateTime(s);const I=this._regulateTime(performance.timing.navigationStart),x=this._regulateTime(this._getResponseEnd()),C=this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart"));let O=c;isNaN(O)&&(O=o),isNaN(O)&&(O=I);const w=new Tt.b;if(this._rumone&&this._rumone.isRunning()){const E=m?"FullPageLoad":"Load",A=p?0===f?`ODSPEmbedLightSpeed.${E}`:`ODSPOneUpLightSpeed.${E}`:0===f?`ODSPEmbed.${E}`:`ODSPOneUp.${E}`;this._rumone.writeScenarioId(A),this._rumone.addExpectedControl(Ft),this._rumone.writePageTransitionType(void 0!==l?l:Lt.a.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();const L=location.href.toLowerCase().indexOf("embed.aspx")>=0;L&&this._pageContext&&this._rumone.collectSPClientFlights(this._pageContext),(0,Te.gb)()&&e.isFastOneUp&&this._pageContext&&this._rumone.collectSPClientFlights(this._pageContext);const k=new Ut.a("OneUpRumOneHelper");k.on(this._rumone,"measureTTI",()=>{const n=this._rumone.getPerformanceData();t&&t({EUPL:n.EUPL,TTI:n.TTI}),w.complete({FCI:n.TTI,FMP:n.EUPL,startTiming:this._regulateAbsoluteTime(O),AbsoluteFCI:this._regulateAbsoluteTime(n.TTI+O),AbsoluteFMP:e.endTime}),k.dispose()}),this._rumone.setSettings({TTISettings:{enabled:!0},getStartTime:()=>O});const M=new kt.a({controlId:Ft,startTime:O,endTime:d,renderTimeCalculator:this._computeRenderTime,renderTimeRequiredDataChecker:this._checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(M),u={...u,waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),isEmbedASPXHosted:Rt(L),w3cResponseEnd:Rt(x-I),appStart:Rt(C-x),render:Rt(d-C),viewerRenderTime:Rt(d-s),oneUpViewer:Rt(n),oneUpClientId:Rt(a),oneUpFileExtension:Rt(i),oneUpFileSizeRange:Rt(r),beforeOneUpLoading:Rt(I-c),beforeOneUpLoadingIframeCost:Rt(I-o),beforeOneUpLoadingHostCost:Rt(o-c),userClickTime:Rt(c),embedStartLoadingTime:Rt(o),isLightSpeed:Rt(!!p),isServerSideTransfer:Rt(!!_),isFluentV9:Rt(!!h),isPdfNoTempAuth:void 0!==b?Rt(b):void 0,isPdfUseToken:void 0!==g?Rt(g):void 0,pdfSource:v&&Rt(v),mip:void 0!==y?Rt(y):void 0,isAutoOpenCopilotExperimentEnabled:void 0!==S?Rt(S):void 0,isFromSyncClientAutoOpen:Rt(!!D)},this._rumone.writeEUPLBreakdown(JSON.stringify(u))}return w.promise}resetRumOne(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)}_isDateTime(e){const t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()}_regulateTime(e){return this._isDateTime(e)&&W.a?e-performance.timing.navigationStart:e}_regulateAbsoluteTime(e){return!this._isDateTime(e)&&W.a?e+performance.timing.navigationStart:e}_getResponseEnd(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN}constructor(e,t){this.resetRumOneApiMeasurement=()=>{this._rumone.undoAPIInstrument()},this._computeRenderTime=e=>{if(e){const{startTime:t,endTime:n}=e;if(!isNaN(t)&&null!==t&&!isNaN(n)&&null!==n&&n>t)return n-t}return 0},this._checkRenderTimeRequiredDataAvailable=e=>{if(e){const{startTime:t,endTime:n}=e;return!isNaN(t)&&null!==t&&!isNaN(n)&&null!==n&&n>t}return!1};const{pageContext:n}=t,{loggerName:a="oneup"}=e;this._pageContext=n,this._initialized=!1;const i=(0,Pt.a)();this._rumone=At.a.getRUMOneLogger({name:a,onLog:(e,t)=>{Mt.a.withManager(i).logData({streamName:e,dictionary:t})}}),window.getRumOneForTAB=()=>this._rumone}}(0,f.C2)("OneUpRumoneHelper",Nt,{pageContext:z.a.optional});const Bt=new f.OJ({name:"OneUpRumoneHelper",factory:{dependencies:{pageContext:z.a.optional},create:({pageContext:e})=>({instance:{getOneUpRumoneLogger:t=>new Nt(t,{pageContext:e})}})}});var jt=n(50),Vt=n(551);const zt=new f.OJ({name:"PdfSaveHelper.key",loader:new f.hg(()=>n.e(63).then(n.bind(n,785)).then(e=>e.resourceKey))});(0,d.ZW)([{rawString:".pdfWrapper_d49e1686{position:absolute;width:100%;height:100%}"}]);var Gt=n(45),Kt=n(297),Wt=n(552),qt=n(82),Qt=n(553);const Yt={scale:1,rotation:0,currentScrollPosition:new qt.a(0,0),originalLayoutSize:{width:0,height:0},originalPageRects:[]},Jt=(0,ft.a)(async()=>(await Promise.all([n.e("ondemand.resx"),n.e(17)]).then(n.bind(n,786))).ESignWrapper,{useChildrenAsPlaceholder:!(0,Te.ec)()});var Xt=n(63),Zt=n(300),$t=n(169),en=n(554),tn=n(258),nn=n(49);const an=(0,ft.a)(async()=>(await Promise.all([n.e("ondemand.resx"),n.e(61)]).then(n.bind(n,787))).PdfFilePicker);var rn;!function(e){e[e.Extract=0]="Extract",e[e.Merge=1]="Merge",e[e.Encrypt=2]="Encrypt",e[e.Select=3]="Select",e[e.Compress=4]="Compress"}(rn||(rn={}));const on=_().forwardRef(({filePickerProps:e,telemetryHandler:t,...n},a)=>{const{filename:i="PDF"}=n,[r,o]=_().useState(""),s=_().useRef(0),c=_().useRef(),d=_().useRef(),l=_().useRef(),u=_().useRef(),f=_().useRef(),p=_().useRef([]),m=(0,en.d)(a),h=(0,q.c)();_().useEffect(()=>{"merge"===e?.config?.mode&&(s.current=1)},[e?.config?.mode]);const b=_().useCallback(async(e,t)=>{const n=h.consume(z.a),a=h.consume(tn.a);return(0,Zt.g)(e,n,a,t)},[h]),g=(0,en.c)(b),v=_().useMemo(()=>i.endsWith(".pdf")?i.slice(0,-4):i,[i]),y=_().useCallback(async(t,n)=>{o(`Extracted from ${v}`),e?.setConfig?.({mode:"save"}),c.current=t,d.current=n,s.current=0},[v,e]),S=_().useCallback(async t=>{o(`Encrypted from ${v}`),e?.setConfig?.({mode:"save"}),l.current=t,s.current=2},[v,e]),D=_().useCallback(async(t,n)=>{e?.setConfig?.({mode:"select",focusZoneProps:n}),u.current=t,s.current=3},[e]),I=_().useCallback(async t=>{o(`Compressed from ${v}`),e?.setConfig?.({mode:"save"}),f.current=t,s.current=4},[v,e]),x=_().useCallback(()=>{e?.setConfig?.({mode:"close"}),p.current=[]},[e]),C=_().useCallback(async n=>{e?.setConfig?.({mode:"close"}),await m({successText:$t.j,runningText:$t.i,failedText:$t.h,telemetryHandler:t,scenarioName:Xt.a.DocumentExtract,before:()=>{d.current?.()},runner:()=>g(n,async()=>c.current?.())})},[e,g,m,t]),O=_().useCallback(n=>{e?.setConfig?.({mode:"close"}),m({successText:$t.f,runningText:$t.e,failedText:$t.d,disableAutoHide:!0,telemetryHandler:t,scenarioName:Xt.a.DocumentEncrypt,runner:()=>g(n,async()=>l.current?.())})},[e,g,m,t]),w=_().useCallback(async t=>{e?.setConfig?.({mode:"close"});const n=await Promise.all(t.map(async e=>({buffer:await(0,Zt.f)({credentials:"same-origin"},e.webDavUrl),name:e.name||""}))),a=n.map(({buffer:e})=>new Uint8Array(e)),i=n.map(({name:e})=>e);u.current?.(a,i)},[e]),E=_().useCallback(n=>{e?.setConfig?.({mode:"close"}),m({successText:$t.c,runningText:$t.b,failedText:$t.a,disableAutoHide:!0,telemetryHandler:t,scenarioName:Xt.a.DocumentCompress,runner:()=>g(n,async()=>f.current?.())})},[e,g,m,t]),A=_().useCallback(async n=>{Array.isArray(n)?(p.current=[...n],o(`Merged from ${v}`),e?.setConfig?.({mode:"save"})):(e?.setConfig?.({mode:"close"}),await m({successText:$t.m,runningText:$t.l,failedText:$t.k,telemetryHandler:t,scenarioName:Xt.a.DocumentMerge,runner:async()=>g(n,async()=>{const e=(await(0,Zt.e)([...p.current].map(e=>e.webDavUrl),{credentials:"same-origin"})).map(e=>new Uint8Array(e,0,e.byteLength));return a.current?.merge(e)}),after:()=>{p.current=[]}}))},[v,e,g,a,m,t]),L=_().useCallback(async e=>{switch(s.current){case 0:await C(e);break;case 2:O(e);break;case 3:w(e);break;case 4:E(e);break;default:await A(e)}},[O,C,A,w,E]),k=_().useMemo(()=>{if(!e)return;const t=h.consume(z.a);let n=t.listId;n&&"{"===n[0]&&"}"===n[n.length-1]&&(n=n.substring(1,n.length-1));const a=e.item.parentKey;let i;if(a){const e=new nn.a({},{pageContext:t}).getItemUrlParts(a);i={entry:{sharePoint:{byPath:{web:e.serverRelativeWebUrl,list:e.fullListUrl,folder:e.listRelativeItemUrl}}},telemetry:{sessionId:t?.CorrelationId}}}return{...e,item:{listId:n,siteUrl:t.siteAbsoluteUrl,listItemId:e.item.listItemId},pickerPageUrl:`${t.webAbsoluteUrl}/${t.layoutsUrl}/FilePicker.aspx`,defaultNewFileName:r,options:i,onClose:x,onConfirm:L}},[e,h,r,x,L]),M=_().useMemo(()=>_().createElement(Xe.a,{ref:a,...n,execExtract:y,encryptDialogProps:n.encryptDialogProps&&{...n.encryptDialogProps,execEncrypt:S},compressDialogProps:n.compressDialogProps&&{...n.compressDialogProps,execCompress:I},execSelect:D}),[a,n,y,S,D,I]);return _().createElement(_().Fragment,null,M,k&&_().createElement(an,k))}),sn=_().memo(on),cn=(0,ft.a)(async()=>(await n.e(77).then(n.bind(n,815))).UniversalAnnotationWrapper,{useChildrenAsPlaceholder:!(0,Te.ec)()}),dn=e=>{const[t,n]=m.useState(!1),[a,i]=m.useState(!1),r=m.useRef(null),o=m.useRef(null),s=m.useRef(null),c=m.useRef(null),{universalAnnotationProps:d,eSignProps:l,...u}=e,{itemId:f,onDocumentLoaded:p,height:_,addOnsEnabled:h,filename:b,fileSize:g,pdfItemViewer:v=sn}=u,y=(0,Kt.a)(()=>u,u),S=l?.isEsignSidePanelActive||l?.isEsignRecipient,D=m.useCallback(({pageCount:e,mip:t,isMipDecrypted:n,isAnnotAllowed:a,isFormFieldAllowed:r,isPrintAllowed:o,isFileEncrypted:s,isSigned:c,hasOutline:d,isOutlineDefaultOff:l})=>{p?.({pageCount:e,mip:t,isMipDecrypted:n,isAnnotAllowed:a,isFormFieldAllowed:r,isPrintAllowed:o,isFileEncrypted:s,isSigned:c,hasOutline:d,isOutlineDefaultOff:l}),i(!0)},[p]),I=m.useCallback(()=>{n(!0)},[]),{documentMetadataLoaded:x,documentMetadata:C}=((e,t,n)=>{const[a,i]=m.useState(Wt.d),[r,o]=m.useState(!1),s=m.useCallback(()=>{const e=n.current?.getPdfMetadata()??Yt;var t,a;i({scale:(t=e).scale,rotation:t.rotation/Wt.k%4,currentScrollPosition:{x:t.currentScrollPosition.x,y:t.currentScrollPosition.y},originalLayoutSize:{height:t.originalLayoutSize.height,width:t.originalLayoutSize.width},originalPageRects:(a=t.originalPageRects,a.map(e=>({top:e.origin.y,left:e.origin.x,height:e.height,width:e.width})))})},[n,n.current]);return(0,Qt.a)(s),m.useEffect(()=>{if(e&&t)return s(),void o(!0);e||o(!1)},[e,t]),{documentMetadataLoaded:r,documentMetadata:a}})(S||e.universalAnnotationProps?.isUniversalAnnotationActive,(0,Te.ec)()?t&&a:a,r),O=(0,q.c)(),w=O.consume(Gt.resourceKey),E=m.useCallback((e,t)=>{h?.universalAnnotation&&o.current?.updateScrollPosition(e,t),h?.eSign&&s.current?.updateScrollPosition(e,t)},[]),A=(0,Se.a)(e=>{h?.universalAnnotation&&o.current?.zoom(e),h?.eSign&&s.current?.zoom(e)}),L=(0,Se.a)(e=>{h?.universalAnnotation&&o.current?.updateCursorType(e)}),k=(0,Se.a)(()=>{h?.universalAnnotation&&o.current?.rotateClockwise(),h?.eSign&&s.current?.rotateClockwise()}),M=m.useMemo(()=>m.createElement("div",{ref:c,className:"pdfWrapper_d49e1686"},m.createElement(v,{...y,height:l?.isEsignRecipient?void 0:y.height,ref:r,onDocumentLoaded:D,onRenderViewport:(0,Te.ec)()?I:void 0,enableToolbar:!(h?.eSign&&S),shouldPlaceToolbarOnTop:!0,onScrollPositionUpdated:E,onRotationChanged:k,onScaleChanged:A,onCursorUpdate:L})),[v,y,l?.isEsignRecipient,D,I,h?.eSign,S,E,k,A,L]);let P,T;if(h?.universalAnnotation&&d){const{driveId:e,progressRegister:t,onPreloadFailure:n,onPreloadSuccess:a,isUniversalAnnotationActive:i}=d,s=O.consume(wt.a);P=m.createElement(cn,{pdfItemViewerRef:r,pdfAppRef:c,universalAnnotationRef:o,isUniversalAnnotationActive:i,progressRegister:t,dataSource:s,driveId:e,itemId:f,onPreloadFailure:n,onPreloadSuccess:a,viewerHeight:_,documentMetadataLoaded:x,documentMetadata:C},M)}if(h?.eSign){const{uniqueId:e,isEsignSidePanelActive:t=!1,setIsEsignSidePanelActive:n,parentItemPermission:a,parentItemUri:i,isEsignRecipient:o,documentUrl:d,canSendToExternalRecipients:u,canAddNewExternalUser:f,hasParentItemPermissionsLoaded:p,onUpdateToast:h}=l||{},v=!!(e&&b&&d&&g&&n&&r.current?.getEventHandlers),{rotate:y,scrollTo:S,getEventHandlers:D,hasSignature:I}=r.current||{};((0,Te.Hb)()||v)&&(T=m.createElement(Jt,{item:{itemId:e||"",name:b||"",size:g||0,openUrl:d||"",parent:{permissions:a,openUrl:i||"",hasLoaded:p}},esignWrapperRef:s,showCreatePanel:t,isRecipient:o,documentMetadataLoaded:x,documentMetadata:C,onCancelClick:()=>n?.(!1),getSessionToken:async e=>w.getOAuthSessionToken({endPoint:e,apiQosName:"ESignWrapper"}),documentRotate:y,documentScrollTo:S,height:_??c.current?.clientHeight??0,getEventHandlers:D,hasSignature:I,isNewDesign:l?.isNewOneup,creatorPermissions:{canAddExistingExternalRecipient:u,canAddNewExternalRecipient:f},onUpdateToast:e=>h?.("eSign",{...e,actionButtons:void 0})},P||M))}return T||P||M},ln=m.memo(dn);var un=n(98),fn=n(64),pn=n(588),mn=n(73),_n=n(62),hn=n(20),bn=n(142),gn=n(294),vn=n(166),yn=n(114),Sn=n(284);const Dn={"PDF Save Failed":["GetPdfStreamFailed","UploadFileDataFailed"],"PDF Load Failed: Init":["GetDocument","GetDownloadUrl","GetWasmAsset","WasmCacheFailed","WasmModuleInitFailed","WasmModuleNotFound"],"PDF Load Failed: Previewer":["PreviewerFailToFetchFile","PreviewerFailToLoadPage","PreviewerFailToLoadTask","PreviewerUnmounted"],"PDF Load Failed: WasmRuntime":["RuntimeError","WasmRuntimeError"],"PDF Load Failed: Others":["AnnotationAddFailed","EventHandleFailed","FileDownloadFailed","FontLoadFailed","InvalidPDF","PrintFailed","RangeDownloadSizeMismatch","RangeError","ShowThumbnailFailed","TypeError","PDFWorkerMismatch","ViewContextNotInitialized"]},In=e=>{switch(e){case"PDF.Edit":return"Edit";case"PDF.Load":return"View";default:return"None"}},xn=e=>{const t=(()=>{const t=e||"None";return t.endsWith("GetDocument")?"GetDocument":t.endsWith("GetDownloadUrl")?"GetDownloadUrl":t.endsWith("GetWasmAsset")?"GetWasmAsset":t})();return Object.keys(Dn).find(e=>-1!==Dn[e]?.indexOf(t))||"None"};class Cn{constructor(e,t){this._qosEventMap={},this.logQosStart=e=>{const t=e.payload.name,n=(e=>{switch(e){case Xt.a.DocumentSave:return"PDF.Edit";case Xt.a.DocumentLoad:return"PDF.Load";default:return}})(t),a={scenario:n||"PDF."+t,pillar:In(n),perfGoalInMs:18e5,extraData:{viewerName:"MSPdf",...this._initExtraData,...e.payload.extraData}};this._qosEventMap[t]=new vn.a(a)},this.logQosEnd=e=>{const{name:t,status:n,extraData:a}=e.payload,i=this._qosEventMap[t];if(!i)return;let r;if(n===Xt.b.Succeed)r={resultType:mn.c.Success,extraData:{...this._initExtraData,...a}};else{const t=this._resource.consume(un.a.optional);On(e.payload,!!t?.offline);const{code:n,error:a,isExpected:i}=e.payload,o={...this._initExtraData,...e.payload.extraData,error:a.message};r={resultType:i?mn.c.ExpectedFailure:mn.c.Failure,errorCode:n,veto:xn(n),extraData:{...o,pdfDiagnosticInfo:(0,gn.a)(o)}}}i.end(r),this._qosEventMap[t]=void 0},this.logError=e=>{const{error:t,extraData:n}=e.payload,a={};for(const e in n)if(n.hasOwnProperty(e)){const t=n[e];a[e]=JSON.stringify(t)}_n.a.logError(t,a)},this.logEngagement=e=>{const{name:t,extraData:n,actionScenario:a}=e.payload,i={location:"MsPdfViewer",usageType:pn.a[pn.a.Click],isIntentional:!0};hn.a.logData({...i,name:t,extraData:{...n,actionScenario:a}})},this.logVerbose=e=>{if((0,yn.j)()||(0,Sn.b)(Te.c.ECS))return;const{name:t,message:n}=e.payload;bn.a.logData({name:t,message:n})},this._resource=e,this._initExtraData=t}}function On(e,t){if(e.error.name!==fn.d.NetworkError)return;const{extraData:n}=e,a=n?.status,i=n?.responseHeaders;e.isExpected=!!a&&(406===a||412===a)||t||e.isExpected,e.extraData={...n,correlationId:i?.get("SPRequestGuid")||i?.get("X-Correlationid")||void 0,requestId:i?.get("request-id")||void 0}}(0,d.ZW)([{rawString:".root_25e3a853{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}"}]);const wn="root_25e3a853";var En=n(34),An=n(589);function Ln(e){const{item:t,onViewerLoaded:n,isMainViewer:a,offset:i}=e,[r,o]=m.useState(t?.thumbnail?.url||""),[s,c]=m.useState(!0),d=(0,q.c)(),l=d.consume(Me.f),u=!!d.consume(Et.j.optional),f=m.useRef(),p=m.useRef(),[_,h]=m.useState(!0),b=m.useRef(),g=m.useRef(),v=!!d.consume(Ne.a);m.useEffect(()=>{a||f.current||(f.current=new vn.a({scenario:"OneUpLightSpeed.thumbnailViewer",perfGoalInMs:Ie.c,extraData:{oneUpRenderingMode:u?Ie.e.fastOneUp:Ie.e.inlineOneUpFirstPage}}))},[a,f,u]);const y=(0,Se.a)(n=>{const{resultType:i,resultCode:r,extraData:o}=(0,En.a)(n);a?(l.updateErrorState("oneupThumbnailViewer",{errorType:Ie.d.viewerInitLoadingError,error:n,item:t,extraData:{viewer:Ce.a.Thumbnail,extension:t&&t.extension||"",url:t?.thumbnail?.url,...o,noTempAuth:g.current},meTAEvent:p.current}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ThumbnailViewer")):f.current&&(f.current.end({resultType:i,errorCode:r,extraData:{viewer:Ce.a.Thumbnail,extension:t&&t.extension||"",...o}}),f.current=void 0)}),S=(0,Se.a)(async e=>{try{if(!((0,Te.vc)()&&t&&(p.current||(0,Te.ab)()&&!t.thumbnail?.url)))throw e;{const{width:n,height:a}=t.thumbnail||{},i=n&&a?{width:n,height:a}:void 0,r=d.consume(Ee.a),{blobUrl:s,error:l}=await r.getThumbnailUrl(t,{useDirectEndpoint:!0,size:i})||{};if(!s)throw l?(0,An.a)(e,l):e;o(s),c(!1)}}catch(e){y(e),c(!1)}});m.useEffect(()=>{if(0!==i)return;const e=t?.thumbnail?.url;g.current=!e||!(0,Re.a)(e);const n=(0,Fe.b)(e);n&&(p.current=(0,He.a)(Ce.a.Thumbnail)),(0,An.b)({resources:d,thumbnailUrl:e,isMeTA:n,isMeTATempAuthDeprecationEnabled:v}).then(e=>{const{blobUrl:n,error:a}=e;if(n)o(n),f.current?.end({resultType:tt.b.Success,extraData:{viewer:Ce.a.Thumbnail,extension:t&&t.extension||""}});else if(a)throw a;c(!1)}).catch(e=>{S(e).catch(()=>{})})},[d,i,S,t,n,a,v]);const D=(0,Se.a)(()=>{if(_&&n){const e=b.current;if(e&&"code"in e&&(e.code=`${e.code}-VroomLoadSuccess`),a){let a=p.current;p.current&&e&&((0,He.b)(p.current,void 0,e),a=void 0),n({extraData:{url:t.thumbnail?.url,noTempAuth:g.current},meTAEvent:a})}h(!1)}}),I=(0,Se.a)(e=>{const t=b.current;t?("code"in t&&(t.code=`${t.code}-VroomLoadFail`),y(t)):y(new Error(e.type))}),x=(0,Se.a)(e=>{(0,Te.mb)()&&e.preventDefault()});return 0===e.offset&&!s&&r?m.createElement("div",{className:wn},m.createElement("img",{alt:"",src:r,onLoad:D,onError:I,onContextMenu:x})):m.createElement(m.Fragment,null)}var kn=n(39),Mn=n(146),Pn=n(418),Tn=n(133);const Un="SPeSign",Fn=()=>{const e=`${btoa(lt.a.generate().match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join("")).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_")}`,t={};let n;return n=t[e]||0===t[e]?t[e]+1:0,t[e]=n,`${e}.${n}`},Hn=e=>{switch(e&&e.cloudType?.toLowerCase()){case"prod":case"prodbubble":case"ag08":case"ag09":case"chn":case"dod":case"gcch":case"gcc":return"396ef0b6-ae1c-4404-86ce-0a869d4d2987";default:return"9471276c-aa67-4dd2-bde2-291a033f3c3c"}};function Rn(e){const{isSyntexESignatureEnabled:t,isSyntexPAYGEnabled:n,userEmail:a}=e;return!!((0,Te.jb)(Te.E)||t&&n&&(!Tn.g||a))}function Nn(e){const{webTemplate:t,listBaseTemplate:n}=e;return!(t===kn.b.mySite.toString()||n===Mn.a.mySiteDocumentLibrary)}var Bn=n(184);const jn=new f.OJ({name:"IdentityDataSource.key",loader:new f.hg(()=>Promise.resolve().then(n.bind(n,45)).then(e=>e.resourceKey))});var Vn=n(138),zn=n(591);const Gn=new f.OJ({name:"UniversalActionExecutor.key",loader:new f.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(78)]).then(n.bind(n,816)).then(e=>e.universalPrintActionExecutorKey))});var Kn=n(275);const Wn="UniversalPrintAction",qn={pageContext:z.a,oneUpStore:se.b,resources:f.sp,platform:ie.a,oneUpStateStore:Me.f,getExecutor:Gn.async.lazy,pdfViewerHelper:jt.b,navigation:K.a,oneUpUrlDataSource:tn.a},Qn=new f.OJ({name:"UniversalPrintAction",factory:{dependencies:qn,create:e=>{return{instance:{evaluateAction:(t=e,e=>{const a=function(e,t,n,a){const i=n.currentAppState.isTeamsFileScenario,r=e&&e.graph&&"personal"===e.graph.driveType;if(e&&e.extension&&e.openUrl&&e.itemStatus!==at.b.ConditionalAccessViewOnly&&e.itemStatus!==at.b.ConditionalAccessBlocked&&nt.a.hasItemPermission(e,nt.a.openItems)&&!n.currentAppState.viewerStates?.get(e.key)?.pdfViewerStates?.isPdfMip&&(n.currentAppState.viewerStates?.get(e.key)?.pdfViewerStates?.isPrintAllowed??1)){if((0,Te.Dc)()){if(!(0,Te._b)()&&i)return!1;if(r)return!1;const n=(0,zn.a)(e.extension);return!(!n||"ms-word"!==n)||!!t.isSupportedFileType(e)}{const a=n.currentAppState.isUniversalPrintLicenseValid,r=(0,zn.a)(e.extension);if(r&&"ms-word"===r){if(a)return!0}else if(t.isSupportedFileType(e))return!(!(0,Te._b)()&&i&&!a)}}return!1}(e.item,t.pdfViewerHelper,t.oneUpStateStore,t.pageContext),i=t.oneUpStore.getOneUpProperties();return{isAvailable:a,id:Wn,onExecute:async()=>{const{focusItem:a,parentItem:r,focusItemSet:o}=i;if(!(i&&o&&o.length&&a&&r)){const e=(0,Ie.i)("no parent view/item");throw t.oneUpStateStore.updateErrorState(Wn,{errorType:Ie.d.actionError,error:e,item:a}),e}if((0,Te.Dc)()){const i=await t.resources.consumeAsync(Kn.a);if(!await i.hasValidLicenseCached()){if(t.pdfViewerHelper.isSupportedFileType(a))return Yn(t.navigation,a),{resultType:tt.b.Success};{const n=t.oneUpStore.list?.id;if(n){const a=t.oneUpUrlDataSource.getOpenInOfficeOnlineUrl(e.item,n);return t.navigation.navigateTo({url:a,frameId:"_blank"}),{resultType:tt.b.Success}}return{resultType:tt.b.Failure}}}try{const e=await t.getExecutor();return await e.executeUniversalPrint({item:a,resources:t.resources,oneUpStateStore:t.oneUpStateStore}),{resultType:tt.b.Success}}catch(i){const r=(await n.e(55).then(n.bind(n,749))).ToastActionStatus;if(t.oneUpStateStore.updateToastState("updateToast",{visible:!1,actionStatus:r.none,displayText:ct.Rb,actionButtons:void 0}),t.pdfViewerHelper.isSupportedFileType(a))Yn(t.navigation,a);else{const n=t.oneUpStore.list?.id;if(n){const a=t.oneUpUrlDataSource.getOpenInOfficeOnlineUrl(e.item,n);t.navigation.navigateTo({url:a,frameId:"_blank"})}}throw t.oneUpStateStore.updateErrorState(Wn,{errorType:Ie.d.actionError,error:i,item:a}),i}}else{if(!t.oneUpStateStore.currentAppState.isUniversalPrintLicenseValid)return Yn(t.navigation,a),{resultType:tt.b.Success};try{const e=await t.getExecutor();return await e.executeUniversalPrint({item:a,resources:t.resources,oneUpStateStore:t.oneUpStateStore}),{resultType:tt.b.Success}}catch(e){throw t.pdfViewerHelper.isSupportedFileType(a)&&Yn(t.navigation,a),t.oneUpStateStore.updateErrorState(Wn,{errorType:Ie.d.actionError,error:e,item:a}),e}}}}})}};var t}}});function Yn(e,t){const n=t.openUrl;n&&e.navigateTo({url:n,frameId:"_blank"})}var Jn=n(340);const Xn=new f.OJ({name:"getIsPdfPaidFeaturesEnabled",factory:{dependencies:{},create:()=>({instance:()=>Promise.resolve(!1)})}}),Zn=()=>({pdfDownloadTime:Rt(We.a.getDurationBetweenMarks("Start","Downloaded")),pdfOpenTime:Rt(We.a.getDurationBetweenMarks("Downloaded","Opened")),pdfFirstRenderTime:Rt(We.a.getDurationBetweenMarks("Opened","FirstRenderCompleted")),pdfGetTokenTime:Rt(We.a.getDurationBetweenMarks("GetTokenStart","GetTokenEnd"))}),$n=e=>$e.a.language.toLowerCase()===e||$e.a.cultureLCID.toLowerCase()===e||window.navigator.language.toLowerCase()===e,ea=["NoConnection","expiredToken"];function ta(e){!function(e="unknownViwer"){(0,W.f)(`oneUp-${e}.start`)}("MSPdf");const{item:t,offset:n,parentItem:a,onViewerLoaded:i,onLogFullPageRumone:r,fallbackToOtherViewer:o}=e,[s]=(0,Me.g)("currentState",e=>e.pdfAppMode??qe.a.View),[c]=(0,Me.g)("currentState",t=>e.item?t.viewerStates?.get(e.item.key)?.pdfViewerStates?.filePickerConfig:{mode:"close"}),[d]=(0,Me.g)("currentState",t=>!!e.item&&t.viewerStates?.get(e.item.key)?.pdfViewerStates?.isPdfMip),[l]=(0,Me.g)("currentState",t=>{if(e.item)return t.viewerStates?.get(e.item.key)?.pdfViewerStates?.outlineVisibility}),u=(0,q.c)(),p=u.consume(jt.b),_=u.consume(wt.a),h=u.consume(Ee.a),b=u.consume(Me.f),g=u.consume(z.a),v=u.consumeAsync(zt),y=u.consume(Ot),S=u.consume(ot),D=u.consume(K.a),I=u.consume(un.a.optional),x=u.consume(Jn.a),C=u.consume(Qn),O="ZXNpZ24"===D.viewParams[je.b.navParamKey],[w]=(0,Me.g)("currentState",t=>!!e.item&&t.viewerStates?.get(e.item.key)?.pdfViewerStates?.pdfEncryptDialogVisible),[E]=(0,Me.g)("currentState",t=>!!e.item&&t.viewerStates?.get(e.item.key)?.pdfViewerStates?.pdfCompressDialogVisible),[A]=(0,Me.g)("currentState",e=>e.eSignData),[L]=(0,Me.g)("currentState",e=>e.annotationViewerState),[k]=(0,Me.g)("currentState",e=>e.isPdfPaidFeaturesEnabled??!1),[M]=(0,Me.g)("currentState",e=>e.rightPane),[T,U]=m.useState(!1),[F,H]=m.useState(!1),[R,N]=m.useState(!1),[B,j]=m.useState(void 0),[G,Q]=m.useState({}),Y=m.useRef(null),J=m.useRef(!1),X=m.useRef($n("zh-cn")),Z=m.useMemo(()=>0===n,[n]),$=T&&Z?"OneUp-pdf OneUp-pdf--loaded":"OneUp-pdf",ee=m.useMemo(()=>t?y.evaluateAction({item:t}):void 0,[y,t]),te=m.useMemo(()=>t?S.evaluateAction({item:t}):void 0,[S,t]),ne=m.useRef();void 0===ne.current&&(ne.current=!p.isNotEmbed());const ae=m.useRef();void 0===ae.current&&(ae.current=!ne.current&&(!(0,Te.ec)()||function(e){return Nn(e)&&Rn(e)}(g)));const ie=m.useRef();void 0===ie.current&&(ie.current=(0,Te.jb)(Te.eb)&&_.hasLicense&&!ne.current);const re=m.useRef();m.useEffect(()=>{const e=new Cn(u,{pdfSource:p.getPdfSource(t?.pdfConversion)});re.current=e,(0,Qe.b)(f.Ov.isActivated),(0,Ye.b)(e)},[u,t?.key]);const oe=(0,Se.a)(async e=>{let t;try{t=await u.consumeAsync(jn)}catch{return}try{if(t.getAzRMSToken)return t.getAzRMSToken({resource:e?.resource||Vn.a,apiQosName:"OneUpMSPDFViewer"}).then(e=>e.accessToken);throw new Error("Identity datasource not found for AzRMS token")}catch(e){if("handleError"===e.code)return;throw p.handleMipTokenError(e)}}),se=(0,Se.a)(async e=>!!p?.isODSPCopilotEnabled(t)&&(b.updatePdfCopilotAction("updatePdfCopilotAction",e,!1),Promise.resolve(!0))),ce=m.useRef(),de=m.useRef(),le=(0,Se.a)(e=>{e.url===G.url&&e.token===G.token||(Q({...e}),(0,Fe.b)(e.url)&&(de.current=(0,He.a)(Ce.a.MSPdf)))}),ue=(0,Se.a)((e,a)=>{if(0===n){const{code:n,isExpected:i}=e,r=!!i||!!I?.offline||-1!==ea.indexOf(n||""),s=`${n||e.name||"UnknownError"}.${a}`,c=e instanceof f.a_?new f.a_({...e,code:s,isExpected:r}):new f.a_({code:s,isExpected:r,message:e.details||e.message||JSON.stringify(e)});b.updateErrorState("oneupPDFViewer",{errorType:Ie.d.viewerInitLoadingError,error:c,item:t}),o&&o(c,"MSPDFViewer")}}),fe=(0,Se.a)(()=>{F&&H(!1),T||U(!0)}),pe=(0,Se.a)(t=>{fe(),e.item&&b.updateViewerState("updatePdfViewerLoaded",{key:e.item.key,options:{pdfViewerStates:{isOpened:!0,isPdfMip:t?.mip,isAnnotAllowed:t?.isAnnotAllowed,isPrintAllowed:(0,yn.e)()||(t?.isPrintAllowed??!0),isFileEncrypted:t?.isFileEncrypted,isSigned:t?.isSigned,outlineVisibility:p.isPdfOutlineAvailable(e.item)&&t?.hasOutline||p.isPdfOutlineNextAvailable(e.item)?L?.isActive||t?.isOutlineDefaultOff?qe.b.Hidden:qe.b.Visible:void 0}}})}),me=(0,Se.a)(()=>{fe(),e.item&&b.updateViewerState("updatePasswordProtectedPdf",{key:e.item.key,options:{pdfViewerStates:{isPdfPasswordProtected:!0}}})}),_e=(0,Se.a)(e=>{if(0===n){On(e,!!I?.offline);const{code:n,isExpected:a,extraData:i,error:r}=e,s=new f.a_({code:n,correlationId:i?.correlationId,isExpected:a,message:r.message,innerError:r,extraData:i});b.updateErrorState("oneupPDFViewer",{errorType:Ie.d.viewerInitLoadingError,error:s,item:t,meTAEvent:de.current,extraData:{url:G.url}}),o&&o(s,"MSPDFViewer")}}),he=(0,Se.a)(t=>{t===qe.a.Edit&&(L?.isActive?b.toggleAnnotationViewerVisiblity("OneUpMSPDFViewer"):!(0,yn.a)()&&M&&M.type!==Me.e.none&&b.updateRightPaneState("closeRightPaneForPdfEdit",{type:Me.e.none,content:void 0})),e.item&&b.updatePdfState("updatePdfAppMode",t)}),be=(0,Se.a)(t=>{e.item&&b.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerConfig:t}}})}),ge=m.useCallback(async e=>{const t=await u.consumeAsync(Vt.b.optional);switch(e){case Vt.a.Modified:t?.notifyModified();break;case Vt.a.ExitEdit:t?.notifyExitEdit()}},[u]),ve=(0,Se.a)(({dirty:e})=>{e&&ge(Vt.a.Modified)}),ye=(0,Se.a)(()=>{ge(Vt.a.Modified)}),De=(0,Se.a)(()=>b.setAnnotationViewerPreloadSucceeded("OneUpMSPDFViewer",!1)),xe=(0,Se.a)(()=>b.setAnnotationViewerPreloadSucceeded("OneUpMSPDFViewer",!0)),we=(0,et.a)({register:()=>{},start:()=>{},setMaximum:e=>{},setCurrent:e=>{},succeed:()=>{xe()},fail:()=>{De()}},[xe,De]),Ae=(0,Se.a)(async()=>t&&((0,yn.f)()||p.isPdfEditAvailable(t)&&p.isPdfEditable(t))?(0,yn.u)()?(await v)?.getItemCurrentVersion(t,g)||Promise.resolve(""):h.getItemCurrentVersion(t,{useDirectEndpoint:!0}):Promise.resolve("")),Le=m.useCallback(async()=>{const e=await ce.current||Promise.resolve(""),t=await Ae();return!!e&&!!t&&t!==e},[Ae]),ke=(0,Se.a)(async n=>{if(!t||!n)return Promise.reject(new Error("Invalid document"));if(ne.current)return(await u.consumeAsync(Vt.b.optional))?.execSave(n);const a=await v,i=await a.execSave({item:t,parentItem:e.parentItem,oneUpStateStore:b,pageContext:g,fileData:n});if(i?.extraData?.schema){const{resultType:e,resultCode:t,extraData:n}=i.extraData.schema;if(e!==tt.b.Success)return Promise.reject(new Error(`errorCode:${t}, extraData:${JSON.stringify(n)}`))}ce.current=Ae()}),Pe=(0,Se.a)(()=>{ee?.isAvailable&&ee.onExecute?.({})}),Ue=(0,Se.a)(()=>{te?.isAvailable&&te.onExecute?.({})}),Ne=(0,Se.a)(()=>{t&&p.isProgressiveLoadingEnabled(t)&&(F&&H(!1),N(!0)),i&&i({perfData:{euplBreakDownData:We.a.getMarkerTime("Previewed")?{pdfTTI:Rt(We.a.getDurationBetweenMarks("Start","Previewed"))}:{...Zn(),pdfTTI:Rt(We.a.getDurationBetweenMarks("Start","FirstRenderCompleted"))},extraPerfData:{...p.getTempAuthLogData(G),pdfSource:p.getPdfSource(t?.pdfConversion),mip:d??!1}},meTAEvent:de.current,extraData:{url:G.url}})}),Be=(0,Se.a)(()=>{(0,yn.l)()||r?.({perfData:{euplBreakDownData:Zn(),extraPerfData:{...p.getTempAuthLogData(G),pdfSource:p.getPdfSource(t?.pdfConversion),mip:d??!1}}})}),Ve=(0,Se.a)(()=>{T||R||H(!0)}),ze=(0,Se.a)(e=>{if(!(0,yn.x)()&&e.ctrlKey&&"P"===e.key.toUpperCase()){if(e.preventDefault(),!t)return;const n=C.evaluateAction({item:t}),a=n.isAvailable,i=n.onExecute,r=new tt.a({name:`OneUpLightSpeed.commandInvoked.${n.id}`});a&&i&&i({qosEvent:r})?.then(e=>{const t=e||{resultType:tt.b.Success};r.end(t)}).catch(e=>{const t=e||new Error("Unhandled exception");r.end((0,En.a)(t))})}});m.useEffect(()=>{const e=setTimeout(()=>{Ve()},1e4);return()=>clearTimeout(e)},[Ve]),m.useEffect(()=>{(0,yn.m)()?b.updateIsPdfPaidFeaturesEnabled("initIsPdfPaidFeaturesEnabled",!!u.consume(Et.l.optional)):u.consume(Xn)().then(e=>{b.updateIsPdfPaidFeaturesEnabled("initIsPdfPaidFeaturesEnabled",e)})},[u,b]),m.useEffect(()=>{if(!(0,yn.w)()&&J.current)return;let e=jt.a.GetDownloadUrl;const n=async()=>{if(t.pdfConversion?.url){const e=await h.getMetaPac(u,t);if(e.metaPac)return[{name:"X-SPOPacToken",value:e.metaPac}]}return[]};(async()=>{if(!t)return{};J.current=!0;const a=t.pdfConversion;if(a){const e=a.url;if(e)return{url:e,getAuthHeaders:(0,yn.n)()||!(0,Fe.b)(e)||(0,Re.a)(e)?void 0:n};const i=await h.getAuthenticationParams(t);return{url:`${h.getItemUrl(t,{useDirectEndpoint:!0})}/content?format=pdf&${(0,Oe.a)(i)}`}}if(p.isNoTempAuthEnabled()){const n=await h.getDownloadUrl(t,{useDirectEndpoint:!0,excludeTempAuth:p.isTempAuthDeprecated(t)});if(p.isSameDomainEmbed(n))return{url:n};let a;return(0,Re.a)(n)||(e=jt.a.GetDownloadToken,We.a.mark("GetTokenStart"),a=await h.getDownloadToken({url:n,item:t}),We.a.mark("GetTokenEnd")),{url:n,token:a}}return h.getDownloadUrl(t,{useDirectEndpoint:!0}).then(e=>({url:e}))})().then(le,t=>ue(t,e))},[h,t,p,ue,le,u]),m.useEffect(()=>{ce.current=Ae()},[t,Ae]),m.useEffect(()=>{ae.current&&O&&he(qe.a.Esign)},[he,O]);const Ge=m.useMemo(()=>p.isPdfOutlineAvailable(t)?{visibility:l,onOutlineClose:()=>{b.updateViewerState("PDFViewerUpdateIsOutlineVisible",{key:t.key,options:{pdfViewerStates:{outlineVisibility:qe.b.Hidden}}})}}:void 0,[t,l,p,b]);m.useEffect(()=>{const e={...Bn.b,semanticColors:{...Bn.b.semanticColors,bodyBackground:"transparent"}},n=t?p.getEmbedOptions()?.allowEdit:void 0,i=t?p.isPdfEditAvailable(t)&&p.isPdfEditable(t)&&(!ne.current||n):void 0,r={enableDownload:ee?.isAvailable,enableOpenInBrowser:te?.isAvailable,onDownload:Pe,onOpenInBrowser:Ue},o=(0,Te.jb)(Te.l)?{enableOpenMip:!0,getMIPToken:oe,mipDialogProps:r}:{enableOpenMip:!1,mipDialogProps:r},l=p.isPdfEncryptAvailable(t)?{closeEncryptDialog:()=>{b.updateViewerState("updatePdfEncryptDialogVisibleState",{key:t.key,options:{pdfViewerStates:{pdfEncryptDialogVisible:!1}}})},encryptVisible:w}:void 0,u=p.isPdfCompressAvailable(t)?{closeCompressDialog:()=>{b.updateViewerState("updatePdfCompressDialogVisibleState",{key:t.key,options:{pdfViewerStates:{pdfCompressDialogVisible:!1}}})},compressVisible:E}:void 0,f=p.isODSPCopilotEnabled(t)&&x?.isCopilotSupportedForItem(t)&&s===qe.a.View;let m=t?{url:"",filename:t?.displayName,fileSize:t.size,mode:s,encryptDialogProps:l,outlineProps:Ge,compressDialogProps:u,enableThumbnailView:s===qe.a.Extract,telemetryHandler:re.current,enableEdit:i&&!d,enablePreRender:(0,Te.jb)(Te.s),enableProgressiveLoading:p.isProgressiveLoadingEnabled(t),enablePrint:(0,yn.e)()||p.isPdfPrintable(t),isPaidFeaturesEnabled:k,darkMode:!0,theme:e,shouldAutoFocus:!1,showOpenInNewWindow:!1,openUrl:"",toolbarAttributes:{"data-handle-special-keys":"Left Right Esc"},enableCopyByChunk:!(0,yn.o)(),enableDebugString:(0,Te.jb)(Te.n)&&!ne.current,formAttributes:"data-suppresskeyboardbinding",...o,shouldExitEditModeAfterSave:!ne.current,allowUnloadPageWithEdits:ne.current,enableCacheDisplayInfo:(0,Te.jb)(Te.m),uniqueId:t.properties?.uniqueId,onDocumentLoaded:pe,enableCopilot:f,onRequestCopilot:se,onNeedPassword:me,onCurrentPageChanged:()=>{},onInitError:_e,onEditStateChanged:ne.current?ve:void 0,onExitEditMode:ne.current?ye:void 0,updateMode:he,execSave:ke,isFileVersionChanged:Le,itemId:t.graph?.itemId,onFirstRenderVisible:Ne,onDocumentFullyLoaded:Be,filePickerProps:{app:"OneDrive",config:c??{mode:"close"},setConfig:be,getIconUrl:e=>`${P}${e}/${(0,Ze.b)("pdf")}.png`,item:{listItemId:t.properties?.ID||"",parentKey:a.key||""}}}:void 0;m&&(m={...m,addOnsEnabled:{eSign:ae.current,universalAnnotation:ie.current}}),j(m)},[s,ee?.isAvailable,ke,c,oe,pe,Pe,ve,ye,_e,Be,Ne,Ue,x,se,be,he,Le,t,me,te?.isAvailable,a.key,p,re,b,w,d,Ge,E,k]);const $e=window.require,nt=$e.toUrl?$e.toUrl("item-viewer-pdf/"):void 0;m.useEffect(()=>{const e=u.consume(Ke),n=(0,Te.jb)(Te.l)?{mipWasmUrl:`${nt}mspdf2.wasm`,mipWasmJsUrl:`${nt}mspdf2.min.js`}:{},a={workerUrl:e.getWorkerUrl(`${nt}index.worker.js`,p.getWorkerManifestName()),wasmUrl:`${nt}mspdfkit.wasm`,wasmJsUrl:`${nt}mspdfkit.min.js`,dataUrl:`${nt}mspdfkit.data`,...n,parserWasmUrl:t&&(p.isPdfExtractAvailable(t)||p.isPdfEncryptAvailable(t)||p.isPdfCompressAvailable(t))?`${nt}mspdfparser.wasm`:void 0,parserWasmJsUrl:t&&(p.isPdfExtractAvailable(t)||p.isPdfEncryptAvailable(t)||p.isPdfCompressAvailable(t))?`${nt}mspdfparser.min.js`:void 0},i=`${nt}media/fonts/`,r="noto_sans_jp.otf",o="noto_sans_ko.ttf",s=[{fontUrl:`${i}arial.ttf`,fontName:"arial.ttf",type:Je.b.ANSI,ondemand:!1},{fontUrl:`${i}noto_sans_sc.ttf`,fontName:"noto_sans_sc.ttf",type:Je.b.ChineseSimplified,ondemand:!X.current},{fontUrl:`${i}${r}`,fontName:r,type:Je.b.Japanese,ondemand:!($n("ja")||$n("ja-jp"))},{fontUrl:`${i}${o}`,fontName:o,type:Je.b.Korean,ondemand:!($n("ko")||$n("ko-kr"))}];(0,yn.i)()||s.push({fontUrl:`${i}noto_sans_tc.ttf`,fontName:"noto_sans_tc.ttf",type:Je.b.ChineseTraditional,ondemand:!($n("zh-tw")||$n("zh-hk")||$n("zh-mo"))});const c=!(0,yn.k)(),d=c?{resource:Vn.a,authority:(l=g?.aadInstanceUrl,f=g?.aadTenantId,l&&f?`${l}/${f}`:"")}:void 0;var l,f;const m={enableFreeText:(0,Te.jb)(Te.q)&&!X.current,enableFormFilling:(0,Te.jb)(Te.p)&&!X.current,enableEnhancedInk:(0,Te.jb)(Te.o),enableOptimizedPinch:(0,Te.jb)(Te.s)&&(0,Te.jb)(Te.r),enableEncrypt:p.isPdfEncryptAvailable(t),enableCompress:p.isPdfCompressAvailable(t),enableMipSdkTelemetry:(0,Te.jb)(Te.g),enableWatermark:p.isWatermarkAvailable(t),enableOutline:p.isPdfOutlineAvailable(t),enableOutlineNext:p.isPdfOutlineNextAvailable(t),enableOnlyBGRFormat:(0,Te.jb)(Te.k),enableLoadFontOnDemand:(0,Te.jb)(Te.f),enableLoopFontsOnDemand:(0,Te.jb)(Te.C),enableMipTokenPrefetch:c,enableUndoRedo:(0,Te.jb)(Te.v)};(0,Xe.b)(a,s,m,d)},[nt,t,p,u,g,x]);const at=m.useMemo(()=>({isUniversalAnnotationActive:0===n&&!!L?.isActive,driveId:t?.graph?.driveId,onPreloadFailure:De,onPreloadSuccess:xe,progressRegister:()=>we}),[L?.isActive,we,t?.graph?.driveId,De,xe,n]);m.useEffect(()=>{const{permissions:e,openUrl:t}=a;!A?.isCreateSidePanelActive||e&&t||(0,V.a)(u)},[u,a.permissions,a.openUrl,A?.isCreateSidePanelActive,a]),m.useEffect(()=>{const e=Y.current;return e?.addEventListener("keydown",ze),()=>{e?.removeEventListener("keydown",ze)}},[ze]);const it=m.useMemo(()=>{if(ae.current&&t&&t.openUrl&&t.properties?.uniqueId&&0===n)return{uniqueId:t.properties.uniqueId,documentUrl:t.openUrl,isEsignRecipient:s===qe.a.Esign,isEsignSidePanelActive:A?.isCreateSidePanelActive,setIsEsignSidePanelActive:e=>{b.updateESignDataState("SetIsEsignSidePanelActive",{isCreateSidePanelActive:e})},parentItemPermission:a.permissions,parentItemUri:a.openUrl,isNewOneup:!(0,yn.c)(),hasParentItemPermissionsLoaded:b.state.currentState.hasValidPermissionToParent,canSendToExternalRecipients:A?.canAddExistingExternalUser,canAddNewExternalUser:A?.canAddNewExternalUser,onUpdateToast:(e,t)=>b.updateToastState(e,{...t,actionButtons:void 0})}},[t,n,s,A?.isCreateSidePanelActive,A?.canAddExistingExternalUser,A?.canAddNewExternalUser,a.permissions,a.openUrl,b]),rt=m.useMemo(()=>Z&&B&&G.url&&""!==G.url?m.createElement(ln,{...B,token:G.token,getAuthHeaders:G.getAuthHeaders,url:G.url,eSignProps:it,universalAnnotationProps:at}):m.createElement(m.Fragment,null),[Z,B,G,it,at]),st=m.useRef();return st.current||(st.current={viewer:Ce.a.MSPdf,extension:t&&t.extension||"unknown"}),m.createElement("div",{className:$},m.createElement("div",{className:"newOneUpPdfContainer",role:"document",ref:Y},rt),F&&m.createElement(Ln,{mainViewerEngagementData:st.current,isMainViewer:!1,...e}))}var na,aa=n(308),ia=n(127),ra=n(342);function oa(e){function t(t){const n=new tt.a({name:`OneUpLightSpeed.commandInvoked.${t.id}`}),a="Unhandled exception executing an action";try{if(e.onClickCallback&&e.onClickCallback(),t.action.onExecute)t.action.onExecute({qosEvent:n})?.then(e=>{const t=e||{resultType:tt.b.Success};n.end(t)}).catch(t=>{e.updateErrorStateCallBack(`Unhandled exception executing an action: ${e.text}`);const i=t||new Error(a);n.end((0,En.a)(i))});else{e.updateErrorStateCallBack(`no available action for ${t.name}`);const a=new Error(`no available action for ${t.name}`);n.end((0,En.a)(a))}}catch(t){e.updateErrorStateCallBack(`Unhandled exception executing an action: ${e.text}`);const i=t||new Error(a);n.end((0,En.a)(i))}}const n=Bn.b;if(e.command.action.isDisabled)return m.createElement(m.Fragment,null);let a=m.createElement(m.Fragment,null);if(0===e.buttonType)a=m.createElement(aa.a,{className:xe.e,onClick:()=>t(e.command),disabled:!!e.command.action.isDisabled,title:e.command.title,ariaLabel:e.toolTipText||e.command.title},e.text);else if(1===e.buttonType){const{palette:i,semanticColors:r}=n,o=`${r.buttonBackground} !important`,s=`${r.buttonBackgroundHovered} !important`,c=`${r.buttonBackgroundPressed} !important`,d=`${r.buttonBorder} !important`,l=40,u=72,f={height:`${l}px`,width:`${l}px`,borderRadius:"25px",fontSize:"30px",zIndex:9999,color:i.black,border:`1px solid ${d}`},p={root:{...f,backgroundColor:e.isActive?s:o,"&::before":{content:"''",width:`${u}px`,height:`${u}px`,position:"absolute",transform:`translate(-50%, calc(-50% + ${l/2}px))`}},rootHovered:{...f,backgroundColor:s,cursor:"pointer"},rootPressed:{...f,backgroundColor:c}};a=m.createElement(ia.a,{iconProps:{iconName:e.text},styles:p,disabled:!!e.command.action.isDisabled,onClick:()=>t(e.command),ariaLabel:e.toolTipText||e.command.title})}else a=m.createElement(aa.a,{className:`${xe.d} ${f.Ov.isActivated("9038af9c-9d8f-4288-bff3-2b0ef5c72aa3","11/08/2023","Fix Download Button shim incorrect color (should be white)")?"":xe.c}`,disabled:!!e.command.action.isDisabled,onClick:()=>t(e.command),title:e.command.title,ariaLabel:e.toolTipText||e.command.title},e.text);return m.createElement(ra.a,{content:e.toolTipText?e.toolTipText:e.text},a)}!function(e){e[e.primary=0]="primary",e[e.iconButton=1]="iconButton",e[e.default=2]="default"}(na||(na={})),(0,d.ZW)([{rawString:".OneUpOther_04a3e9e8{position:absolute;width:100%;height:100%;left:50%;top:50%;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8{text-align:center}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherFileName_04a3e9e8{font-size:21px}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherDownload_04a3e9e8{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherMessage_04a3e9e8{margin:15px}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherMessageNewDesign_04a3e9e8{margin-top:15px;margin-bottom:15px}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherActions_04a3e9e8{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherActions_04a3e9e8{padding:4px 20px 6px 20px}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherActions_04a3e9e8 .odButtonBarMain_04a3e9e8{float:none}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherFileIcon_04a3e9e8 .FileTypeIcon_04a3e9e8{outline:0}.OneUpOtherMalwareDetectedIcon_04a3e9e8{height:208px;width:208px}.OneUpOtherMalwareDetectedIconExperiment_04a3e9e8{height:256px;width:256px}"}]);var sa=n(605);const ca={pageContext:z.a,oneUpStore:se.b,navigation:K.a,resources:f.sp,platform:ie.a},da=new f.OJ({name:"OpenInOfficeOnlineAction",factory:{dependencies:ca,create:e=>{return{instance:{evaluateAction:(t=e,e=>{var n;return{isAvailable:!(!(n=e.item)||!n.appMap)&&n.itemStatus!==at.b.ConditionalAccessBlocked&&n.itemStatus!==at.b.ConditionalAccessViewOnly,id:"OpenInOfficeOnlineAction",onExecute:async()=>t.resources.consumeAsync(tn.a).then(n=>{const a=t.oneUpStore.list?.id;if(a){const i=n.getOpenInOfficeOnlineUrl(e.item,a);return t.navigation.navigateTo({url:i,frameId:"_blank"}),{resultType:tt.b.Success}}return{resultType:tt.b.Failure}})}})}};var t}}}),la={resources:f.sp,navigation:K.a,oneUpUrlDataSource:tn.a},ua=new f.OJ({name:"OpenInOtherViewerAction",factory:{dependencies:la,create:e=>{const t={evaluateAction:(n=e,e=>{const t={isAvailable:!0,id:"OpenInOtherViewerAction",onExecute:async()=>{if(e.item.folder){const t={urlType:"default"};let a=n.oneUpUrlDataSource.getDefaultClickUrlForOneUp(e.item,t);"#"===a.charAt(0)&&(a="?"+a.substring(1)),await n.navigation.navigateTo({url:a,frameId:"_blank"})}else{const t={urlType:"default"},a=n.oneUpUrlDataSource.getDefaultClickUrlForOneUp(e.item,t);await n.navigation.navigateTo({url:a,frameId:"_blank"})}return{resultType:tt.b.Success}}};return t})};var n;return{instance:t}}}});var fa=n(606),pa=n(85),ma=n(610),_a=n(611);const ha=["agent","copilot"],ba=f.Ov.isActivated("3a3977b1-d189-4347-85b1-d19bb3ad8141");function ga(e){const{iconName:t,iconFieldAriaLabel:n}=e,a=e.desiredSize||16;let i="";if(t){const n=e.iconSize||a,r=(0,bt.b)(t,!0),o=!ba&&(-1!==ha.indexOf(t)||r),s=r?_a.a:ma.a;i=o?s:function(e,t,n,a){return function(e,t,n,a){return`${P}${n}${e?"_2x":""}/${t}.${a||"png"}`}(n,e,t,a)}(t,n,!!e.platformDetection?.isRetinaSupported,e.fileExtention)}const r=e.className||"FileTypeIcon-icon";return m.useMemo(()=>m.createElement("img",{className:r,src:i,alt:n,style:{width:`${a}px`,height:`${a}px`}}),[r,i,n,a])}var va=n(612),ya=n(613),Sa=n(614);const Da=f.Ov.isActivated("4F69420A-9950-45CF-8BD3-2E57ED1A714D"),Ia=f.Ov.isActivated("875099EF-AA79-4289-8864-F787C33E6577"),xa=f.Ov.isActivated("96D5A045-AF6F-4674-9E1E-36BB29142BBA");var Ca;function Oa(e){const t=(0,q.c)(),{item:n,viewerType:a,offset:i,onViewerLoaded:r}=e,o=t.consume(Dt),s=n?o.evaluateAction({item:n}):void 0,c=t.consume(da),d=n?c.evaluateAction({item:n}):void 0,l=t.consume(ua),u=n?l.evaluateAction({item:n}):void 0,f=t.consume(z.a),p=t.consume(ie.a);let _,h;const b=n?.extension,g=!!b&&(".fluid"===b||".loop"===b||".note"===b||".whiteboard"===b||".wbtx"===b);let v=e.fallbackErrorCode;const y=(0,pa.a)(),S=y.palette;m.useEffect(()=>{0===i&&r&&r()},[i,r]),m.useEffect(()=>{e.fallbackCxpRef?.current?.end({resultType:mn.c.Success,extraData:{viewer:Ce.a.Other,extension:n&&n.extension||""}})},[]),n&&(s&&s.isAvailable&&(_={id:"downloadCommand",action:s}),(0,Ce.b)(n).length>0&&(v=1),(0,Te.pc)()?a===Ce.a.WAC&&d&&d.isAvailable||a===Ce.a.Other&&(0,Ce.b)(n).length>0&&(0,Ce.b)(n)[0].originalViewer&&(0,Ce.b)(n)[0].originalViewer===Ce.a.WAC&&d&&d.isAvailable?h={id:"openCommand",action:d}:a!==Ce.a.Other||g||!xa&&n.zip||!u||!u.isAvailable||(h={id:"openCommand",action:u}):a!==Ce.a.Other||g||!xa&&n.zip||!u||!u.isAvailable?a===Ce.a.WAC&&d&&d.isAvailable&&(h={id:"openCommand",action:d}):h={id:"openCommand",action:u});const D=t.consume(Me.f),I=e=>{const t=(0,Ie.i)(e);D.updateErrorState(`otherViewerActionFailure: ${e}`,{errorType:Ie.d.actionError,error:t,item:n})},x=n?.lifeCycleStatus?.isMalwareDetected??!1,C=!Ia&&!Da,O=!!f?.allowInfectedDownload,w=!!f?.m365GroupsBlockDownloadsExperienceEnabled,E=sa.d,A=va.a;let L;return C&&(L=y&&y.isInverted?Sa.a:ya.a),m.createElement("div",{className:"OneUpOther_04a3e9e8"},m.createElement("div",{className:"OneUpOtherContent_04a3e9e8"},C?m.createElement("img",{className:"OneUpOtherMalwareDetectedIconExperiment_04a3e9e8",src:L,alt:E}):x?m.createElement("img",{className:"OneUpOtherMalwareDetectedIcon_04a3e9e8",src:A,alt:E}):n?.iconName?m.createElement("div",{className:"OneUpOtherFileIcon_04a3e9e8"},m.createElement(ga,{iconName:n.iconName,platformDetection:p,desiredSize:96})):null,m.createElement("div",{className:"OneUpOtherFileName_04a3e9e8",style:{color:S?.black}},n?.name),m.createElement("div",{className:"OneUpOtherMessageNewDesign_04a3e9e8",style:{color:S?.black}},x?m.createElement(fa.a,{allowInfectedFileDownload:O}):n?.itemStatus===at.b.ConditionalAccessBlocked?w?sa.a:sa.b:function(e,t){switch(t){case 0:return sa.i;case 1:return sa.h;default:return e?sa.e:sa.f}}(C,v)),m.createElement("div",{className:"OneUpOtherActions_04a3e9e8"},h&&n&&m.createElement(oa,{command:h,text:sa.g,buttonType:na.primary,updateErrorStateCallBack:I,toolTipText:sa.g}),_&&n&&m.createElement(oa,{command:_,text:sa.c,buttonType:h?na.default:na.primary,updateErrorStateCallBack:I,toolTipText:sa.c}))))}!function(e){e[e.ZipTooLarge=0]="ZipTooLarge",e[e.UnsupportedFileType=1]="UnsupportedFileType"}(Ca||(Ca={}));var wa=n(473),Ea=n(16),Aa=n(617),La=n(616);const ka=!f.Ov.isActivated("229b7061-d676-49af-a733-a9b269161b4b");function Ma(e){return!!e&&e.width>0&&e.height>0}function Pa(e){const{size:t,scale:n,item:a,isMeTA:i}=e,[r,o]=m.useState({localBlobImageUrl:"",scale:e.scale}),s=ka?{width:0,height:0}:{width:a?.photo?.width||0,height:a?.photo?.height||0},c=0===s.width||0===s.height,[d,l]=m.useState(c?void 0:s),[u,p]=m.useState(!0),_=(0,q.c)(),[h,b]=m.useState(!0),g=m.useRef(),v=!!_.consume(Ne.a),y=(0,Se.a)(()=>c?{width:d?.width||0,height:d?.height||0}:s),S=(0,Se.a)(async r=>{try{if(!((0,Te.vc)()&&a&&(i||(0,Te.ab)()&&!a.thumbnail?.url)))throw r;{const e=_.consume(Ee.a),{blobUrl:i,error:s}=await e.getThumbnailUrl(a,{useDirectEndpoint:!0,size:t})||{};if(g.current=r,!i)throw s?(0,An.a)(r,s):r;o({localBlobImageUrl:i,scale:n}),b(!1)}}catch(t){e.onImageLoadFail(t),b(!1)}}),D=(0,Se.a)(t=>{if(g.current){const t=g.current;"code"in t&&(t.code=`${t.code}-VroomLoadFail`),e.onImageLoadFail(t)}else e.onImageLoadFail(new Error("img load fail"))}),I=(0,Se.a)(e=>{(0,Te.mb)()&&e.preventDefault()}),x=(0,Se.a)(async(e=r.scale,t={width:1024,height:1024},n)=>{if(r.localBlobImageUrl&&e<=r.scale)return;let s=n;const d={width:Math.ceil(t.width*e*window.devicePixelRatio),height:Math.ceil(t.height*e*window.devicePixelRatio)},l=s?new Ea.a(s):void 0;if(l){let e=y();c&&d&&(e=d),l.setQueryParameter("width",(e.width||1024).toString()),l.setQueryParameter("height",(e.height||1024).toString()),s=l.toString()}try{let t,n;if((0,Te.ob)()&&a&&a.photoContent?t=a.photoContent.url:({blobUrl:t,error:n}=await(0,An.b)({resources:_,thumbnailUrl:s,isMeTA:i,isMeTATempAuthDeprecationEnabled:v})),t)o({localBlobImageUrl:t,scale:e});else if(n)throw n;b(!1)}catch(e){await S(e)}}),C=r.localBlobImageUrl?r.localBlobImageUrl:e.item?.thumbnail?.url;if(m.useEffect(()=>{c||!r.localBlobImageUrl?x(n,t,a?.thumbnail?.url).catch(()=>{}):b(!1)},[]),!t)return m.createElement(m.Fragment,null);let O;const w=y(),E={width:t.width*n,height:t.height*n};return Ma(w)&&Ma(E)&&(O=(0,Aa.b)({boundsSize:E,contentSize:w,mode:"contain",maxScale:1/0})),O&&d&&O.width>d.width&&O.height>d.height&&(O=n<=1?d:{width:d.width*n,height:d.height*n}),m.createElement("div",{className:wn,"data-automation-id":"oneup-image-container"},!h&&m.createElement("img",{"data-automation-id":"oneup-image-frame","tab-index":0,alt:f._0(La.a,e.item?.displayName),src:C,style:d?{width:`${O?.width}px`,height:`${O?.height}px`,opacity:1}:{opacity:0},onLoad:t=>{if(u&&e.onViewerLoaded){const t=g.current;t&&"code"in t&&(t.code=`${t.code}-VroomLoadSuccess`),e.onViewerLoaded(t),p(!1)}if(C&&0===C.indexOf("blob:")&&1===n&&!d){const e={width:t.currentTarget.offsetWidth,height:t.currentTarget.offsetHeight};l(e)}},onError:D,onContextMenu:I}))}const Ta=(0,ft.a)(async()=>(await Promise.resolve().then(n.bind(n,473))).Projector);function Ua(e){const{item:t,offset:a,fallbackToOtherViewer:i,onViewerLoaded:r,parentItem:o}=e,s=(0,q.c)(),c=s.consume(Me.f),[d]=(0,Me.g)("currentState",e=>e.imageMode===Me.c.edit),l=!d&&(0,Fe.b)(t?.thumbnail?.url),u=m.useRef(),f={url:t?.thumbnail?.url,noTempAuth:!t?.thumbnail?.url||!(0,Re.a)(t.thumbnail.url)};m.useEffect(()=>{l&&0===a&&(u.current=(0,He.a)(Ce.a.Photo))},[l,a]);const p=(0,Se.a)(async(e=!1)=>{c.updateImageState("openImageEditor",Me.c.view)}),_=(0,Se.a)(e=>{let t=u.current;u.current&&e&&((0,He.b)(u.current,void 0,e),t=void 0),r({meTAEvent:t,extraData:f})}),h=(0,Se.a)(e=>{0===a&&(c.updateErrorState("oneupPhotoViewer",{errorType:Ie.d.viewerInitLoadingError,error:e,item:t,meTAEvent:u.current,extraData:f}),i&&i(new Error("photoViewerFailToLoad"),"PhotoViewer"))}),b=(0,Se.a)(e=>{if(0===a){const n=(0,Ie.i)(e.message,e.id);c.updateErrorState("oneUpPhotoEditor",{errorType:Ie.d.actionError,error:n,item:t}),i&&i(new Error("photoEditorFailToLoad"),"PhotoViewer")}});if(!t||0!==a)return m.createElement(m.Fragment,null);const g=m.createElement(Ta,{mode:wa.ProjectorMode.preview},({size:e,transformV:n})=>m.createElement(Pa,{item:t,size:e,scale:n.scale,onImageLoadFail:h,onViewerLoaded:_,isMeTA:l})),v=(0,ft.a)(async()=>(await n.e(50).then(n.bind(n,817))).OneUpImageEditor);return m.createElement(m.Fragment,null,d&&t?m.createElement(v,{item:t,parentItem:o,resources:s,switchToView:p,onErrorCallBack:b}):g)}var Fa=n(143),Ha=n(264);(0,d.ZW)([{rawString:".OneUpTextFileContent_b125dea2{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-flow:column nowrap;align-items:stretch;justify-content:space-between;box-shadow:0 0 7px 2px rgba(0,0,0,.15);border-radius:5px}.OneUpTextFileContent_b125dea2 .OneUpTextFileTitle_b125dea2{flex:0 0 24px;font-size:14px;padding:6px 0 0 10px}html[dir=rtl] .OneUpTextFileContent_b125dea2 .OneUpTextFileTitle_b125dea2{padding:6px 10px 0 0}.OneUpTextFileContent_b125dea2 .OneUpTextFileEditor_b125dea2{position:relative;flex:1 1 auto;width:100%}.isFluentVNext_b125dea2 .OneUpTextFileContent_b125dea2{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.isFluentVNext_b125dea2 .OneUpTextFileContent_b125dea2 .OneUpTextFileTitle_b125dea2{border-top-left-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:";border-top-right-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.OneUpTextFileContentLight_b125dea2{background-color:#fff;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.OneUpTextFileContainer_b125dea2{position:relative;margin:auto;width:75%;height:100%}.oneUpTextEditor{height:100%}"}]);var Ra,Na=n(474),Ba=n(231),ja=n(188),Va=n(354);!function(e){e.Default="Default",e.OneUpTextFile="OneUpTextFile"}(Ra||(Ra={}));const za=!f.Ov.isActivated("c0448c19-5a5d-49a7-818a-33485f56176e"),Ga=!f.Ov.isActivated("a0d3c12d-224c-4052-a6a4-0ba003e4ec1d");function Ka(e){const{closeCallback:t}=e,a=(0,q.c)(),i=a.consume(Me.f),o=a.consume(se.b),s=a.consume(K.a),c=a.consume(Et.i),[d,l]=m.useState(!1),u=m.useRef(e.editorContent),[f,p]=m.useState(e.editorContent),[_,h]=m.useState(void 0),b=a.consume(ja.a),g=!!e.item&&b.evaluateAction({item:e.item}).isAvailable,v=m.useRef(!0);m.useEffect(()=>()=>{v.current=!1},[]),m.useEffect(()=>{if(Va.a){const e=e=>s.beforeUnload.isHashNavDialogHandlerRegistered?.()&&g?Ra.OneUpTextFile:"",n=()=>r.c.resolve(t?.(!0).then(()=>{o.clean(),i.clean(),i.navClean()}));return s.beforeUnload.registerHandler(e),s.beforeUnload.registerOnContinueHandler(n),()=>{s.beforeUnload.unRegisterHandler(e),s.beforeUnload.unRegisterOnContinueHandler(n)}}},[g,s.beforeUnload,o,i,t]),m.useEffect(()=>{const e=()=>{Ga&&!v.current||(window.innerWidth<1024&&!d?l(!0):window.innerWidth>=1024&&d&&l(!1))};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[d]),m.useEffect(()=>{Ga&&!v.current||(e.editorContent!==f&&(p(e.editorContent),u.current=e.editorContent),e.item&&i.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!1}}}))},[f,i,e.editorContent,e.item,e.item?.key]);const y=(0,Se.a)(async()=>{const t=(await n.e(1).then(n.bind(n,758))).resourceKey,i=a.consumeAsync(t);let r=null;if(e.item&&e.parentItem&&(r=(await i).evaluateAction({item:e.item,parentItem:e.parentItem})),r&&r.onExecute&&e.item){const e=new tt.a({name:"OneUpLightSpeed.saveInvokedInEditor"});r.onExecute({qosEvent:e})?.then(()=>{}).catch(e=>{})}}),S=(0,Se.a)(t=>{Ga&&!v.current||(e.setEditorLoaded(!0),t.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KeyS,()=>{y()},""),u.current=f,t.onDidChangeModelContent(()=>{if(Ga&&!v.current)return;const n=t.getValue();if(void 0!==u.current&&n!==u.current&&e.item){h(n);const t=new Blob([n],{type:e.item.textEditorMimeType});t.name=e.item.name;const a={extension:e.item.extension,iconName:"text",name:(e.item.name||"")+e.item.extension,size:n.length,_file:t,slice:(e,n)=>t},r=i.getViewerState(e.item.key);r&&r.saveData&&(r.saveData.fileUpload=a),r&&r.saveData&&r.saveData.saveButtonVisible||i.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!0,fileUpload:a}}})}else e.item&&n===f&&(h(n),i.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!1}}}))}))}),D={wordWrap:"on",automaticLayout:!0,scrollbar:{alwaysConsumeMouseWheel:!1},minimap:{enabled:!d},readOnly:!e.isEditable,theme:c?"vs-dark":"vs",...za?{unicodeHighlight:{invisibleCharacters:!1,ambiguousCharacters:!1}}:{}};let I="OneUpTextFileContent_b125dea2";return c||(I+=" OneUpTextFileContentLight_b125dea2"),m.createElement("div",{className:I,"data-automationid":"OneUpTextFile-Content"},m.createElement("div",{className:"OneUpTextFileTitle_b125dea2","data-automationid":"OneUpTextFile-Title"},e.editorTitle),m.createElement("div",{className:"OneUpTextFileEditor_b125dea2"},m.createElement(Na.a,{className:"oneUpTextEditor",editorDidMount:S,language:"plaintext",options:D,value:_||f,moduleType:Ba.a.ESM,getWorkerUrl:()=>"",importESMModule:()=>r.c.resolve(n.e(44).then(n.bind(n,818)))})))}const Wa=new f.OJ({name:"EncodingProviderAsyncKey",loader:new f.hg(()=>n.e(16).then(n.bind(n,820)).then(e=>e.resourceKey))});var qa=n(355);const Qa=!f.Ov.isActivated("5bbf5cba-aaed-483d-82d0-a2629a658259"),Ya=!f.Ov.isActivated("960e7f41-3474-4923-a898-b4b542bd118e"),Ja=!f.Ov.isActivated("3AB8014F-9C31-4C18-8258-37E7110BCE71"),Xa=!f.Ov.isActivated("A6C39EC2-C951-45F4-AF81-86FAABEC4E4E");var Za;function $a(e){const t=(0,q.c)(),[n,a]=m.useState(""),[i,o]=m.useState(""),[s,c]=m.useState(!1),[d,l]=m.useState(0),[u,p]=m.useState(!0),[_,h]=m.useState(!1),[b,g]=m.useState(!1),v=t.consume(z.a),y=t.consume(Me.f),{item:S,offset:D,fallbackToOtherViewer:I,parentItem:x}=e,C=m.useRef(!0);m.useEffect(()=>()=>{C.current=!1},[]);const O=(0,Se.a)(e=>{0===D&&(y.updateErrorState("oneupTextViewer",{errorType:Ie.d.viewerInitLoadingError,error:e,item:S}),I&&I(new Error("textViewerFailToLoad"),"TextViewer"))}),w=(0,Se.a)(t=>{if(!Ja||C.current)if(t)2!==d&&l(2),u&&e.onViewerLoaded&&s&&(e.onViewerLoaded(),p(!1));else{const e=new Error("Error loading monaco editor");O(e)}}),E=(0,Se.a)(e=>{const n=e.extension?(0,Fa.c)(e.extension):void 0;async function i(e){if(e&&n){if(Qa){const a=(await t.consumeAsync(Wa)).getEncoding();return ke.a(e,n,a)}return ke.c(e,n)}}function o(e){if(Ja&&!C.current)return;let t=e;if(Ya&&e?.status){const{status:n,code:a,correlationId:i,data:r,...o}=e;delete o.authenticate,delete o.targetUrl,delete o.redirectUrl,t=new f.a_({code:`${n}_${a}`,correlationId:i,extraData:{innerError:r,...o}})}O(t),h(!1)}function s(e){Ja&&!C.current||(a(e?.text||""),c(!0),h(!1))}return r.c.resolve(t.consumeAsync(Le.downloadDataSourceKey)).then(t=>t.getItemContents(e)).then(async e=>i(e)).then(e=>{s(e)}).catch(async n=>{const a=Xa?await t.consumeAsync(Et.d.optional):void 0;if(a){const t=new tt.a({name:"OneUpTextViewerOpenFallbackOnVroom"});return a(e).then(async e=>i(e)).then(e=>{s(e);const a=n.data?.error?.code?.split(",")[0],i=a===qa.a.fileNotFound.toString();t.end({resultType:tt.b.ExpectedFailure,extraData:{error:n,errorMessage:"SPO API failed, most likely due to cross farm content. Fallback on Vroom API."}}),!i||Ja&&!C.current||g(!0)}).catch(e=>{t.end({resultType:tt.b.Failure,extraData:{error:e}}),o(e)})}o(n)})}),A=(0,Se.a)(e=>{if(Ja&&!C.current)return;const t=e.displayName||e.name;o(t||"")});m.useEffect(()=>{s&&2===d&&w(!0)},[w,d,s]),m.useEffect(()=>{!s&&S&&(E(S),A(S))},[s,S,E,A,d]),m.useEffect(()=>{if(!s&&S){const e=setTimeout(()=>{Ja&&!C.current||h(!0)},5e3);return()=>{clearTimeout(e)}}},[s,S]);const L=(0,Se.a)(()=>!b&&(!S||!S.extension||".osts"!==S.extension)&&!!S&&function(e,t,n){if(!nt.a.hasItemPermission(e,nt.a.editListItems))return!1;if(!t)return!1;const a=n?.list?.isForceCheckout;return!((0,Ha.a)(e,t.userId)||a&&!(0,Ha.b)(e,t.userId))}(S,v,e.list));let k=m.createElement("div",{className:"OneUpTextFileContainer_b125dea2"},m.createElement(Ka,{editorTitle:i,editorContent:s?n:void 0,isEditable:L(),setEditorLoaded:w,item:S,parentItem:x,closeCallback:e.closeCallback}));const M=m.useRef();return M.current||(M.current={viewer:Ce.a.TextFile,extension:S&&S.extension||"unknown"}),_&&!s&&(k=m.createElement(Ln,{mainViewerEngagementData:M.current,isMainViewer:!1,...e})),k}!function(e){e[e.shouldLoad=0]="shouldLoad",e[e.loading=1]="loading",e[e.loaded=2]="loaded",e[e.error=3]="error"}(Za||(Za={})),(0,d.ZW)([{rawString:".OneUpWacFullScreen_bfffd0c2{width:100%;height:100%;border:0}.OneUpWacNinetyPercent_bfffd0c2{width:90%;height:100%;border:0;margin:auto}"}]);const ei="OneUpWacFullScreen_bfffd0c2",ti=(0,f.C2)("WopiFrameDataSource",class{getWopiFrameUrl(e,t){const n="ms-word"===e.appMap,a=e.wopiFrameUrl,i=n?this._wordAction:"embedview";let r=a&&a.replace(/action=([^&]+)/,`action=${i}&wdnc=1&nobg=1&wdhostscenario=oneuplightspeed`);return r&&!f.JW.isFeatureEnabled({ODB:60385})&&(r=r?.concat("&bypassowl=true")),n&&!f.Ov.isActivated("feaac491-2c3c-48e6-b23a-701bb912ce09")&&(r=r?.concat("&wdignorefpo=1")),!f.Ov.isActivated("53193300-5ac6-4cf5-a3a0-882ac3497e79","10/31/2024","Update wopiembedframe.aspx to doc.aspx for embedview action")&&f.JW.isFeatureEnabled({ODB:62222})&&t?r?r.replace("Doc.aspx","doc2.aspx"):void 0:r?r.replace(/\/_layouts\/[^?]+/i,`/_layouts/15/${t?"WopiEmbedFrame":"doc"}.aspx`):void 0}constructor(e,t){const n=t.platformDetection;this._wordAction=n.isMobile&&!n.isIPad?"mobileview":"embedview"}},{platformDetection:ie.a}),ni=new f.OJ("wopiToken");var ai,ii=n(6),ri=n(277),oi=n(47),si=n(40),ci=n(240);function di(e){const t=!f.Ov.isActivated("2c617684-fdeb-4e99-91af-9f322f25818d","7/18/2024","Killswitch to use channel message to communicate WAC page with parent frame"),n=e.item,a=(0,q.c)(),i=a.consume(ti),r=a.consume(ni.optional),o=a.consume(Me.f),s=a.consume(z.a),[c,d]=m.useState(!1),[l,u]=m.useState(),[p,_]=m.useState(""),h=m.createRef(),b=m.useRef(!1),[g]=m.useState(Math.random().toFixed(16)),[v,y]=m.useState(),[S,D]=m.useState("");if(!(0,Te.tc)()){const e=a.consume(Gt.resourceKey),t=new nn.a({},{pageContext:s}).getItemUrlParts(n.key),i=new ii.a(t.normalizedItemUrl);e.getSharePointToken({webAbsoluteUrl:i.authority,apiQosName:"OneUpWacViewer"}).then(e=>{D(e.accessToken)})}const I=(t,a,i)=>{o.updateErrorState("oneupWacViewer",{errorType:Ie.d.viewerInitLoadingError,error:t,item:a,extraData:{...i,extension:n?.extension,appMap:n?.appMap}}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(t,"WacViewer")},x=e=>{if(h&&h.current?.contentDocument){const t=h&&h.current?.contentDocument;t.body||t.createElement("body");const n=t.createElement("form");n.action=e.url,n.method="POST",n.style.visibility="hidden",n.target="_self";const a=e.postdata;for(const e in a)if(e&&a[e]){const i=t.createElement("input");i.type="hidden",i.name=e,i.value=a[e],n.appendChild(i)}t.body.appendChild(n),n.submit(),d(!0)}else{const e=(0,Ie.i)("missing iframe reference for form post","WacIFrameReferenceError");I(e,n)}},C=(a,i,r,o,c,d)=>{let l=tt.b.Success,u=JSON.stringify(r);if(a)try{l=tt.b[a]}catch{l=tt.b.Failure,u="Additional Error: Failed to convert WAC Event Data resultType to known result type, using default of Failure. Original WAC errorInfo: "+u}const p={hostSessionId:o,loadResultSource:t?"wacChannelMessaging":"wacWindowPostMessage"};if(l!==tt.b.Success||-1!==a?.toLowerCase().indexOf("failure")){const e=new f.a_({code:i||"oneupWacLoadGenericFailure",message:u,correlationId:c||s?.CorrelationId,isExpected:l===tt.b.ExpectedFailure,extraData:{...p,stack:r?JSON.stringify(r):"",rawError:JSON.stringify(d)}});I(e,n,{...d})}else e.onViewerLoaded&&e.onViewerLoaded({extraData:{...p,...d}})},O=e=>{let t;try{t=e.data}catch(t){const a=(0,Ie.i)("Error loading Wac viewer iframe - cannot parse wac message","WacInitIframeError.ProcessWacMessage");return I(a,n,{...e,e:t}),void(b.current=!0)}"WacHost_initialized"===t.messageId&&C(t.values?.resultType,t.values?.resultCode,t.values?.errorInfo,t.hostSessionId,t.correlationId||s?.CorrelationId,t),b.current=!0};m.useEffect(()=>{!n||c&&!S||(e=>{let a;if(r&&r.then(e=>{a=e}),!n||!e||""===a){const e=(0,Ie.i)("missing item or wopitokenval","WacItemOrTokenError");return void I(e,n)}let o=i.getWopiFrameUrl(n,a);if(!o||/^javascript:\/\//i.test(o.trim())){let e;return e=o?(0,Ie.i)("wopiframeurl is not acceptable format","WacUrlFormatError"):(0,Ie.i)("wopiframeurl is empty","WacUrlEmptyError"),void I(e,n)}const c=ri.a(s);c&&(o+="&wdorigin="+encodeURIComponent(String(c)));const l="OfficeDocClickTime",f=new oi.a("",si.a.local),m=f.getValue(l,si.a.session),h=m?new Date(m):void 0;f.setValue(l,"",si.a.session),h&&(o+="&CT="+encodeURIComponent(String(h)));const b=new ci.b,v=b&&b.viewParams.uih;v&&(o+="&uih="+v);const y=new URL(o).origin;if(_(y),t){const e={wdskipfccheck:"true",appName:"OneUp",origin:window.location.origin,channelId:g,app:"OneUp",scenario:"OneUpWacViewer"};o+=new URLSearchParams(e)}if(a){const e=b&&b.viewParams.EmbeddingPageOrigin,t=b&&b.viewParams.EmbeddingPageSessionInfo;x({url:o,postdata:{access_token:a,EmbeddingPageOrigin:e||p,EmbeddingPageSessionInfo:t||""}})}else!(0,Te.tc)()&&S?x({url:o,postdata:{access_token:S}}):(u(o),d(!0))})(n)},[c,n,r,S]),m.useEffect(()=>{let e;const n=h?.current?.contentWindow;function a(e){if(e.source&&n&&e.source===n){const t=e.data;if("initialize"===t.type&&t.channelId===g){const t=e.ports[0];t&&y(t)}}}if(t&&!v&&n)return e=window.setInterval(()=>{n.postMessage({type:"identify-parent",channelId:g},p)},1e3),window.addEventListener("message",a),()=>{e&&(clearInterval(e),e=void 0),window.removeEventListener("message",a)}},[v,h,l,g,t,p]),m.useEffect(()=>{function e(e){(e=>{if("notification"===e.type){const t=e.data;"page-loaded"===t.notification&&C(t.result?.resultType,t.result?.resultCode,t.result?.errorInfo,t.hostSessionId,t.correlationId||s?.CorrelationId,t)}b.current=!0})(e.data)}if(v&&t)return v.addEventListener("message",e),v.start(),v.postMessage({type:"activate"}),()=>{v.removeEventListener("message",e)}},[v,t]),m.useEffect(()=>{t||window.addEventListener("message",O,!1)},[]),m.useEffect(()=>()=>{t||window.removeEventListener("message",O,!1)},[]);const w=(0,Se.a)(()=>{setTimeout(function(){if(!b.current){const e=(0,Ie.i)("Error loading Wac viewer iframe - no response from wac in callbacktimeout 240000ms","WacInitIframeError.WacCallbackTimeout");I(e,n)}},24e4)}),E=(0,Se.a)(()=>{w()}),A=(0,Se.a)(()=>{if(0===e.offset){const e=(0,Ie.i)("Error loading Wac viewer iframe","WacInitIframeError.IFrameLoadError");I(e,n)}}),L=e.isFallback?"fallback":"",k="ms-excel"===e.item?.appMap,M=c&&n?m.createElement("div",{className:`oneup-wac-container ${k?"OneUpWacNinetyPercent_bfffd0c2":ei} ${L}`,"data-automation-id":"oneup-wac-container"},m.createElement("iframe",{"data-automation-id":"oneup-wac-frame",className:`oneup-wac-frame ${ei}`,ref:h,title:n.name,onLoad:E,onError:A,src:l})):m.createElement(m.Fragment,null);return(0,Te.Ic)()?0===e.offset?M:m.createElement(m.Fragment,null):M}function li(e){return e.getResponseHeader("X-CorrelationId")||void 0}!function(e){e.WacHostInitialized="WacHost_initialized"}(ai||(ai={}));const ui=(0,f.C2)("OneUpZipDataSource",class{getContents(e,t){const n=new tt.a({name:"OneUpZipDataSourceGetContents"});return this._getMeTAHeader().then(e=>this._makeXHR({url:t,headers:e})).then(t=>{const a=t.status;if(!(a>=200&&a<300)){const e={code:`${a}.InvalidStatus`,message:"getContents xhr status unacceptable range",status:a,statusText:t.statusText,responseType:t.responseType,response:t.response,responseTxt:t.responseText};return n.end({resultType:tt.b.Failure,extraData:{...e}}),r.c.reject(t)}try{const a=JSON.parse(t.responseText),{delimiter:i,error:r,list:o=[]}=a.metadata;return e.dateModified&&e.extension&&e.name&&n.end({resultType:tt.b.Success}),{delimiter:i,error:r,root:{children:o,date:e.dateModified||"",extension:e.extension||"",isFolder:!0,name:e.name||"",childCount:o.length,parentFolder:void 0,path:"",size:0}}}catch(e){return n.end({resultType:tt.b.ExpectedFailure,extraData:{e,code:`${a}.InvalidResponse`}}),r.c.reject(new f.a_({code:`${a}.InvalidResponse`,message:e&&e.message,correlationId:li(t),isExpected:!0,extraData:{responseText:t.responseText}}))}}).catch(e=>{if(e instanceof f.a_)return n.end({resultType:tt.b.Failure,extraData:{error:e,code:`${e.code}.XhrExceptionApiErr`}}),r.c.reject(e);let t,a=!1,i=e&&e.message,o="GetZipContents";if(e instanceof XMLHttpRequest){const n=e&&e.status;a=!!n&&n>=400&&n<500,n&&!this._offlineDetection.offline||(a=!0),t=li(e),o=e.getResponseHeader("X-ErrorCode")||"";try{const t=JSON.parse(e.responseText);let n=t&&t.error;for(;n.innererror;)n=n.innererror;n&&(i=n.message,o=n.code)}catch(t){i=e.responseText?"Invalid JSON response":"Empty response",a=!0}o=`${n}.${o}`}return n.end({resultType:a?tt.b.ExpectedFailure:tt.b.Failure,extraData:{code:`${o}.XhrException`,error:e,resultCode:o,errorMessage:i,correlationId:t}}),r.c.reject(new f.a_({code:o,message:i,isExpected:a,correlationId:t,extraData:{responseText:e instanceof XMLHttpRequest?e.responseText:""}}))})}constructor(e,t){this._makeXHR=t.makeXHR||we.a.start,this._offlineDetection=t.offlineDetection,this._getMeTAHeader=t.getMeTAHeader}},{makeXHR:void 0,offlineDetection:un.a,getMeTAHeader:Ue.a});var fi=n(622);(0,d.ZW)([{rawString:".OneUpZipContainer_16573a18{margin:auto;margin-top:20px;box-shadow:0 0 7px 2px rgba(0,0,0,.15);display:flex;flex-direction:column;max-width:780px;min-width:70%;height:95%}.OneUpZipHeader_16573a18{height:130px;display:flex;min-height:130px;justify-content:center;position:relative}.OneUpZipImage_16573a18{height:130px;width:135px}.OneUpZipNumber_16573a18{position:absolute;top:83px;font-size:medium;width:113px}html[dir=ltr] .OneUpZipNumber_16573a18{text-align:right}html[dir=rtl] .OneUpZipNumber_16573a18{text-align:left}.OneUpZipList_16573a18{padding:0 20px;overflow:auto}"}]);var pi=n(623);(0,d.ZW)([{rawString:".odZipContentListBreadcrumb_472c7f54{margin-bottom:20px}.odZipContentListLink_472c7f54{cursor:pointer;text-decoration:none;font-size:12px}.odZipContentListLink_472c7f54:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}"}]);var mi=n(626),_i=n(627),hi=n(358),bi=n(92),gi=n(363),vi=n(324),yi=n(632),Si=n(625),Di=n(32),Ii=n(332);class xi extends m.Component{render(){const e=!!this.props.allowSelection,t=this.state.ancestors,n=this.state.crumbs.reduce((e,t)=>e?f._0(Si.a,t.text,e):t.text,""),a=t[t.length-1].childCount,i=f.nu(Si.i,Si.h,a),r=i?f._0(i,a):"";return m.createElement(vi.a,null,m.createElement(mi.a,{className:"odZipContentListBreadcrumb_472c7f54",ariaLabel:f._0(Si.b,n),items:this.state.crumbs,maxDisplayedItems:5}),m.createElement(_i.a,{className:"od-ZipContent-DetailsList",items:t[t.length-1].children,columns:this._columns,checkboxVisibility:e?hi.a.onHover:hi.a.hidden,selectionMode:e?bi.c.multiple:bi.c.none,layoutMode:hi.e.fixedColumns,onItemInvoked:this._onItemInvoked,selection:this._selection,constrainMode:hi.d.horizontalConstrained,selectionPreservedOnEmptyClick:!0,ariaLabel:r,onDidUpdate:this._onDetailsListUpdated}))}UNSAFE_componentWillReceiveProps(e){this.props!==e&&e.root!==this.props.root&&this.setState((e,t)=>{const{root:n}=t;return this._selection.setItems(n.children,!0),{ancestors:[n],crumbs:this._appendBreadcrumb([],n.name)}})}_onDetailsListUpdated(){this.state.initialLoadComplete||(this.setState({initialLoadComplete:!0}),this.props.onLoad&&this.props.onLoad())}_onItemInvoked(e){e.isFolder&&this.setState(t=>{const n=t.crumbs,a=n.length;return this._selection.setItems(e.children,!0),this.props.onNavigate(e),{ancestors:t.ancestors.concat([e]),crumbs:this._appendBreadcrumb([...n.slice(0,-1),{...n[a-1],isCurrentItem:!1}],e.name)}})}_onBreadcrumbClick(e,t){if(t){const e=parseInt(t.key,10);this.setState(t=>{const n=t.ancestors[e];return this._selection.setItems(n.children,!0),this.props.onNavigate(n),{ancestors:t.ancestors.slice(0,e+1),crumbs:this._appendBreadcrumb(t.crumbs.slice(0,e),n.name)}})}else console.log("no item available for breadCrumbClick")}_appendBreadcrumb(e,t){const n=e.length;return[...e,{text:t,key:`${n}`,isCurrentItem:!0,onClick:this._onBreadcrumbClick}]}_getAllColumns(){return[{key:"zipIcon",fieldName:void 0,minWidth:20,maxWidth:20,name:"",onRender:Ci.bind(this)},{key:"zipName",fieldName:void 0,isResizable:!0,minWidth:200,name:Si.d,onRender:Oi.bind(this,"name")},{key:"zipDateModified",fieldName:void 0,isCollapsable:!0,isResizable:!0,minWidth:100,name:Si.c,onRender:Oi.bind(this,"date")},{key:"zipFileSize",fieldName:void 0,isCollapsable:!0,isResizable:!0,minWidth:100,name:Si.e,onRender:(e,t,n)=>e?m.createElement("div",null,e.size?pi.a.getDisplayString(e.size,{language:$e.a.language,ignoreZero:!0}):""):m.createElement(m.Fragment,null)}]}constructor(e){super(e);const{root:t}=e;this._onItemInvoked=this._onItemInvoked.bind(this),this._onBreadcrumbClick=this._onBreadcrumbClick.bind(this),this._onDetailsListUpdated=this._onDetailsListUpdated.bind(this),this._columns=this._getAllColumns(),this.state={ancestors:[t],crumbs:this._appendBreadcrumb([],t.name),initialLoadComplete:!1};const n=this._selection=new gi.a({selectionMode:bi.c.single,onSelectionChanged:()=>{const e=this.state.ancestors;this.props.onSelect(n.getSelection(),e[e.length-1])}});n.setItems(t.children,!0)}}function Ci(e,t,n){if(!e)return m.createElement(m.Fragment,null);const{extension:a}=e,i={extension:a,size:20,type:e.isFolder?d.t1.folder:void 0},r=(0,Ii.a)(i);return m.createElement(Di.a,{...r,style:{width:"20px",height:"20px"},title:e.isFolder?Si.f:f._0(Si.g,a)})}function Oi(e,t,n,a){return t?"name"===e&&!0===t.isFolder?m.createElement(yi.a,{className:"odZipContentListLink_472c7f54",onClick:()=>this._onItemInvoked(t)},t[e]):m.createElement("div",null,t[e]):m.createElement(m.Fragment,null)}const wi=xi;var Ei=n(364),Ai=n(635);function Li(e){const t=e.item,n=(0,q.c)(),a=n.consume(ie.a).isRetinaSupported,i=n.consume(Me.f),[r,o]=m.useState(!1),[s,c]=m.useState(),[d,l]=m.useState(),u=m.useContext(Ei.d),p={extension:t?.extension||"unknown",viewer:Ce.a.Zip,engagementContext:u},_=(e,t)=>{},h=e=>{c(e.childCount),(0,Ei.g)(`${Ei.c}.ZipNavigateNested`,p)};m.useEffect(()=>{!r&&t&&(r=>{const s=r.zip&&r.zip.zipMetaDataUrl,d=!s||!(0,Re.a)(s),u=n.consume(ui);if(!s){const n=(0,Ie.i)("zip url is null","ZipEmptyMetadataUrl");return i.updateErrorState("oneupZipViewer",{errorType:Ie.d.viewerInitLoadingError,error:n,item:t,extraData:{noTempAuth:d}}),void(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer"))}const p=(0,Fe.b)(s)?(0,He.a)(Ce.a.Zip):void 0,m={hasZipUrl:!!s,noTempAuth:d};u.getContents(r,s).then(n=>{if(!n||n.error&&""!==n.error){const a=(0,Ie.i)(n.error||"Missing zip contents","ZipErrorRetrievingContents");return i.updateErrorState("oneupZipViewer",{errorType:Ie.d.viewerInitLoadingError,error:a,item:t,meTAEvent:p,extraData:m}),void(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(a,"ZipViewer"))}c(n.root.childCount),l({allowSelection:!1,root:n.root,onNavigate:h,onSelect:_,isRetinaEnabled:a,onLoad:()=>{e.onViewerLoaded&&e.onViewerLoaded({meTAEvent:p,extraData:m})}}),o(!0)}).catch(n=>{let a;if(a=n&&n instanceof f.a_?n:n&&n instanceof Error?new f.a_({code:n.name||"ZipErrorRetrievingContents",message:n.message,extraData:{...m,rawError:JSON.stringify(n)}}):new f.a_({code:"ZipErrorRetrievingContents",extraData:{...m,rawError:JSON.stringify(n)}}),i.updateErrorState("oneupZipViewer",{errorType:Ie.d.viewerInitLoadingError,error:a,item:t,meTAEvent:p,extraData:m}),n)try{const t=n;-1!==t.code?.indexOf("Sandbox_FileTooLarge")?e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer",Ca.ZipTooLarge):t.isExpected&&-1!==t.extraData?.toString().indexOf("notSupported")&&e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer",Ca.UnsupportedFileType)}catch(t){e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer")}else e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer")})})(t)},[r,t]);const b=(0,pa.a)().palette;return r&&t&&d?m.createElement("div",{className:"OneUpZipContainer_16573a18",style:{backgroundColor:b?.white}},m.createElement("div",{className:"OneUpZipHeader_16573a18",style:{backgroundColor:b?.neutralLight},role:"heading"},m.createElement("img",{className:"OneUpZipImage_16573a18",src:Ai.a,alt:fi.a}),m.createElement("span",{className:"OneUpZipNumber_16573a18",style:{color:b?.white}},s)),m.createElement("div",{className:"OneUpZipList_16573a18",style:{backgroundColor:b?.white},role:"presentation","data-is-scrollable":"true"},m.createElement(wi,d))):m.createElement(m.Fragment,null)}(0,d.ZW)([{rawString:".container{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}.od-Error{text-align:center;position:absolute}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}]);var ki=n(636),Mi=n(171),Pi=n(637),Ti=n(638),Ui=n(639);const Fi=[Pi.a,Ti.a,Ui.a];function Hi(e){const t=(0,q.c)().consume(Me.f),{errorTitle:n,errorDetailedText:a,correlationId:i,errorCode:r,actionUrl:o,actionText:s}=e,c=function(){const e=Math.floor(Math.random()*Fi.length);return Fi[e]}(),d=m.useCallback(()=>{window.open(o,"_blank")},[o,!0]);return m.useEffect(()=>{e.itemKey&&t.updateViewerState("errorViewerAfterDelete",{key:e.itemKey,options:{showMainCommands:!1,showTitle:!0}})},[t,e.itemKey]),m.createElement("div",{className:"container"},m.createElement("div",{className:"od-Error"},m.createElement("div",{className:"od-Error-image"},m.createElement("img",{className:"od-Error-imageTag",src:c,alt:n})),m.createElement("div",{role:"alert"},m.createElement("p",{className:"od-Error-title"},n),a&&m.createElement("p",{className:"od-Error-subText"},a),i&&m.createElement("p",{className:"od-Error-code"},f._0(ki.b,i)),r&&m.createElement("p",{className:"od-Error-code"},f._0(ki.a,r)),o&&m.createElement("p",{className:"od-Error-code"},m.createElement(Mi.a,{href:o,text:s,onClick:d})))))}var Ri=n(286);(0,d.ZW)([{rawString:".OneUpFileHandlerIFrame_c746f6bf{width:100%;height:100%;border:0}"}]);var Ni=n(295);function Bi(e){const[t]=(0,Me.g)("currentState",e=>e.fileHandlerOptions?e.fileHandlerOptions.data.actions.preview:void 0),[n,a]=m.useState(),i=(0,q.c)(),r=i.consume(Ri.a),o=i.consume(Me.f),s=i.consume(z.a),c=m.createRef(),d=s.userLoginName,l=s.currentUICultureName||s.currentCultureName||"en-US",[u,f]=m.useState(!1),p=(0,Se.a)(()=>{u||(e.onViewerLoaded&&e.onViewerLoaded(),f(!0))}),_=(0,Se.a)(t=>{0===e.offset&&(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(new Error("FileHandlerIframeLoadError"),"FileHandlerViewer"),o.updateErrorState("oneupFileHandlerViewer",{errorType:Ie.d.viewerInitLoadingError,error:t,item:e.item}))});return m.useEffect(()=>{t&&e.item&&r.getCorrespondingPreviewFileHandlerPostData(e.item).then(e=>{e&&(a(e),p())}).catch(e=>{_(e)})},[e.item?.key,t,r,p,_]),m.useEffect(()=>{if(c&&c.current?.contentDocument&&n)try{const e={cultureName:l,client:"OneUp",domainHint:"organizations",userId:d,appId:n.handler.appId,items:JSON.stringify(n.itemUrls)};(0,Ni.a)({url:n.url,postdata:e,document:c.current.contentDocument})}catch(e){_(e)}},[c,n,d,l,_]),m.createElement("iframe",{className:"OneUpFileHandlerIFrame_c746f6bf",ref:c,allow:"clipboard-read; clipboard-write",sandbox:"allow-scripts allow-same-origin allow-forms allow-top-navigation allow-popups allow-popups-to-escape-sandbox"})}var ji=n(640),Vi=n(642);const zi=new f.OJ({name:"isCopilotAgentBillingAvailableAsyncKey",loader:new f.hg(()=>n.e(9).then(n.bind(n,823)).then(e=>e.copilotAgentBillingDataSourceKey))}),Gi={pageContext:z.a,getCopilotAgentBillingDataSource:zi.async.lazy},Ki=new f.OJ({name:"isCopilotAgentBillingAvailable",factory:{dependencies:Gi,create:({pageContext:e,getCopilotAgentBillingDataSource:t})=>{if(f.JW.isFeatureEnabled({ODB:62537})&&!f.Ov.isActivated("26e3d359-a853-4dad-9ea6-85b6855e7b25","04/09/2025","Enables the SharePointEmbeddedPayAsYouGoEnabled feature")&&e.isSPECopilotPayGEnabled)return{instance:()=>!0};const n=f.JW.isFeatureEnabled({ODB:62330})&&!f.Ov.isActivated("37051AB0-8881-4429-9EF0-2016312BCC4A")&&(0,Vi.a)({pageContext:e,getCopilotAgentBillingDataSource:t});return{instance:()=>n}}}});var Wi=n(206),qi=n(646);const Qi={isUserCopilotLicensed:Wi.a,isCopilotAgentBillingAvailable:Ki},Yi=!f.Ov.isActivated("0F710A94-5239-46C8-8DD0-E02D3B7E4BA6"),Ji=new f.OJ({name:"shouldBlockCopilotViewer",factory:{dependencies:Qi,create:({isUserCopilotLicensed:e,isCopilotAgentBillingAvailable:t})=>({instance:function(){if(!(e()||f.JW.isFeatureEnabled({ODB:62330})&&!f.Ov.isActivated("8B678DCC-BB1A-423D-A06A-E217D891D8AE")&&t()))return{errorTitle:qi.d,actionText:qi.b,actionUrl:"https://techcommunity.microsoft.com/t5/microsoft-365-copilot/microsoft-365-copilot-wave-2-ai-innovations-in-sharepoint-and/ba-p/4245159"}}})}});var Xi=n(367),Zi=n(93),$i=n(368),er=n(132),tr=n(79),nr=n(262),ar=n(137);const ir=!f.Ov.isActivated("217c20ef-7cb2-4851-bb66-294b6e38535c");function rr(e){if(!e)return"NA";if(e<0)return"Unknown";const t=Math.log(e)/Math.LN2|0;return`${1<<t%10}-${1<<t%10+1}${t<10?" B":` ${"KMGTPEZY"[t/10-1|0]}iB`}`}function or(e){const{item:t,setIsLoaded:a,offset:i,parentItem:r,list:o,setIsPanningEnabled:s,itemIndex:c,closeCallback:d}=e,l=(0,q.c)(),u=m.useContext(Ei.d),f=l.consume(Et.j.optional),p=m.useRef(l.consume(Ce.c)),_=l.consume($.c),h=l.consume(K.a),[b,g]=m.useState(!1),[v,y]=m.useState(),{getValidViewerTypes:S}=p.current,[D,I]=m.useState(S(t)),x=l.consume(ji.a),C=m.useRef(void 0),O=(0,Se.a)(async()=>{const e=await l.consumeAsync($i.a);await e.evaluateAction({item:t,isAnnotateAction:!1})});m.useEffect(()=>{a(!0)},[a]);const[w]=(0,Me.g)("currentState",e=>e.viewerStates),[E]=(0,Me.g)("currentState",e=>e.deletedKeys),[A]=(0,Me.g)("currentState",e=>e.imageMode===Me.c.edit),[L]=(0,Me.g)("currentState",e=>e.fileHandlerOptions),[k]=(0,Me.g)("currentState",e=>e.isAutoOpenCopilotExperimentEnabled);m.useEffect(()=>{I(S(t))},[L,t,S]);const M=w?.get(t.key),P=m.useRef(),T=(0,Se.a)(e=>{const n=l.consume(Et.o.optional),a=t?x.evaluateAction({item:t}):void 0;u.isCopilotAvailable=a?.isAvailable;const{url:r,...o}=e?.extraData||{},s=(0,Fe.a)(r);let c="unknown";if(!Xi.a){const e=(0,Xi.b)(t.permissions);void 0!==e&&(c=Zi.a[e])}if(0!==i&&i||!n)n&&(0,Ei.g)(`${Ei.c}.${Ei.f}`,{extension:t.extension||"unknown",viewer:D,isInitalLoad:!1,engagementContext:u,userRole:c});else{const a=l.consume(se.b),i=a.focusItemSet?.map(e=>e?.properties?.uniqueId),r=t.extension,d=_.getItemUrlParts(t.key).isCrossList;if(n({viewer:D,extension:r,isCrossList:d,fileSizeRange:rr(t.size),euplBreakDownData:e?.perfData?.euplBreakDownData,extraPerfData:e?.perfData?.extraPerfData,extraData:{...o,...s,isAutoOpenCopilotExperimentEnabled:k},itemSetIds:i,focusItemUniqueId:t?.properties?.uniqueId,index:a.currentIndex}),e?.meTAEvent&&(0,He.c)(e.meTAEvent,{...s,viewerName:D,extension:r,isCrossList:d}),ir&&(0,tr.a)()){const e=!!h.viewParams[nr.a],n=_.getItemUrlParts(t.key),a=n.geoRelation!==$.a.sameGeo;let i;if(a&&n.fullWebUrl)try{i=new URL(n.fullWebUrl).hostname}catch{}!function({hasMainLinkShareToken:e,isCrossGeo:t,extraData:n}){const a=e?er.e.Success:t?er.e.ExpectedFailure:er.e.Failure;new er.d({name:"S3.MainLink"}).end({resultType:a,extraData:n})}({hasMainLinkShareToken:e,isCrossGeo:a,extraData:{isFastOneUp:f,isCrossList:d,isCrossGeo:a,queryType:(0,ar.g)(h.viewParams),domain:i,mainLinkScenario:"OneUp"}})}(0,Ei.g)(`${Ei.c}.${Ei.f}`,{extension:t.extension||"unknown",viewer:D,isInitalLoad:!0,engagementContext:u,userRole:c})}if(D===Ce.a.MSPdf&&(0,Te.jb)(Te.y)){const e=h.viewParams;e&&e.commentId&&""!==e.commentId&&O()}}),U=(0,Se.a)(e=>{const n=l.consume(Et.n.optional);0!==i&&i||!n||n({viewer:D,extension:t.extension,isCrossList:_.getItemUrlParts(t.key).isCrossList,fileSizeRange:rr(t.size),euplBreakDownData:e?.perfData?.euplBreakDownData,extraPerfData:e?.perfData?.extraPerfData})}),F=(0,Se.a)((e,n,a)=>{0!==i||b||(C.current=new vn.a({scenario:"OneUpLightSpeed.fallBackToOtherViewer",perfGoalInMs:Ie.c,extraData:{errorMessage:e.message,from:n,extension:t.extension,isFastOneUp:f}}),g(!0),y(a))});m.useEffect(()=>{(f||A)&&s?s(!1):0===i&&s&&(D===Ce.a.Thumbnail||D===Ce.a.Photo||D===Ce.a.Other?s(!0):s(!1))},[f,A,s,i,D]);const H={item:t,offset:i,parentItem:r,list:o,setIsLoaded:a,setIsPanningEnabled:s,itemIndex:c,closeCallback:d,viewerType:D,onViewerLoaded:T,onLogFullPageRumone:U,fallbackToOtherViewer:F},R=e=>{const{viewerType:a,key:i,offset:r,mode:o,parentItem:s,list:c,isFallBackToOtherViewer:d,deletedKeysMap:u,errorViewerDisplayName:f,fallbackErrorCode:p}=e;let _=m.createElement(m.Fragment,null);if(P.current||(P.current={viewer:D,extension:t.extension||"unknown"}),u&&u.get(i))_=m.createElement(Hi,{errorTitle:ct.qb,itemKey:i,fileName:f});else if(d)_=m.createElement(Oa,{...H,isErrorFallBack:!0,fallbackCxpRef:C,fallbackErrorCode:p});else if(0===r||a!==Ce.a.MSPdf&&a!==Ce.a.ThreeD&&a!==Ce.a.TextFile)switch(a){case Ce.a.FileHandler:_=m.createElement(Bi,H);break;case Ce.a.Html:_=o&&o===Me.b.edit?m.createElement($a,H):m.createElement(Be,H);break;case Ce.a.Image360:{const e=(0,ft.a)(async()=>(await Promise.all([n.e("ondemand.resx"),n.e(49)]).then(n.bind(n,779))).OneUpImage360Viewer);_=m.createElement(e,H);break}case Ce.a.MSPdf:c&&s&&(_=m.createElement(ta,H));break;case Ce.a.Photo:_=m.createElement(Ua,H);break;case Ce.a.TextFile:_=m.createElement($a,H);break;case Ce.a.ThreeD:{const e=(0,ft.a)(async()=>(await n.e(45).then(n.bind(n,780))).OneUp3DViewer);_=m.createElement(e,H);break}case Ce.a.WAC:_=m.createElement(di,H);break;case Ce.a.Zip:_=m.createElement(Li,H);break;case Ce.a.Copilot:{if(Yi){const e=l.consume(Ji)();if(e){_=m.createElement(Hi,e);break}}const e=(0,ft.a)(async()=>(await Promise.all([n.e("ondemand.resx"),n.e(47)]).then(n.bind(n,781))).OneUpCopilotViewer);_=m.createElement(e,H);break}case Ce.a.OnePlayerVideo:case Ce.a.OnePlayerAudio:if(0===r){const e=(0,ft.a)(async()=>(await n.e(56).then(n.bind(n,782))).OneUpVideoViewer);_=m.createElement(e,H);break}_=m.createElement(Oa,{...H,isErrorFallBack:!1,fallbackCxpRef:C});break;case Ce.a.Error:{const e={...t.error};_=m.createElement(Hi,e);break}case Ce.a.Thumbnail:_=m.createElement(Ln,{isMainViewer:!0,mainViewerEngagementData:P.current,...H});break;default:_=m.createElement(Oa,{...H,isErrorFallBack:!1,fallbackCxpRef:C})}else _=m.createElement(Ln,{isMainViewer:!1,mainViewerEngagementData:P.current,...H});return _},N={viewerType:D,key:t.key,offset:i,mode:M?.htmlMode,parentItem:r,list:o,isFallBackToOtherViewer:b,deletedKeysMap:E,errorViewerDisplayName:t.displayName,fallbackErrorCode:v},B=m.useMemo(()=>R(N),[D,t.key,i,M?.htmlMode,r,o,b,E,t.displayName,t.thumbnail?.url,v]);return(0,Te.Qb)()?B:R(N)}var sr=n(647),cr=n(648),dr=n(369);const lr={navigation:K.a,inlineOneUpUrlDataSource:Et.h.optional,oneUpUrlDataSource:tn.a.async.lazy,oneUpStateStore:Me.f},ur=new f.OJ({name:"oneup-lightspeed/src/utilities/NavigateToItemKey.navigateToItem",factory:{dependencies:lr,create:({navigation:e,inlineOneUpUrlDataSource:t,oneUpUrlDataSource:n,oneUpStateStore:a})=>({instance:async function({item:i,options:r}){if(t){const n=t.getDefaultClickUrl(i,r);return e.navigateTo({url:n,ignoreHistory:!0}),{resultType:tt.b.Success}}try{r?.hasNavigationBlock||a.navClean();const t=(await n()).getDefaultClickUrlForOneUp(i,r);return e.navigateTo({url:t,ignoreHistory:!0}),{resultType:tt.b.Success}}catch{return{resultType:tt.b.Failure}}}})}}),fr=!f.Ov.isActivated("7A994F85-F671-4044-8C7A-B2031B413F75"),pr="PreviousAction",mr={oneUpStore:se.b,navigation:K.a,oneUpStateStore:Me.f,oneUpLoadingCustomerPromiseFunctions:De.b,navigateToItem:ur},_r=new f.OJ({name:"PreviousAction",factory:{dependencies:mr,create:e=>{const t={evaluateAction:(n=e,e=>{const t=n.oneUpStore.getOneUpProperties(),a={isDisabled:(i=t,!(i&&i.currentIndex&&i.focusItemSet&&i.focusItemSet.length)||0===i.currentIndex),isAvailable:!(!t||(0,Te.Yb)()&&n.oneUpStateStore.getOneUpNavMode()===Me.d.single),id:pr,onExecute:async()=>{if(t&&t.currentIndex&&t.focusItemSet&&t.focusItemSet.length){const e=t.focusItemSet[t.currentIndex-1];n.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:De.a.previous,newItem:e}});const a={parentItem:t.parentStoreKey?.key?{key:t.parentStoreKey?.key}:t.parentItem,urlType:"focus",parentViewParams:fr?t.parentStoreKey?.viewParams:void 0};return await n.navigateToItem({item:e,options:a}),{resultType:tt.b.Success}}{const e=(0,Ie.i)("no focusItemSet");throw n.oneUpStateStore.updateErrorState(pr,{errorType:Ie.d.actionError,error:e,item:void 0}),e}}};var i;return a})};var n;return{instance:t}}}}),hr=!f.Ov.isActivated("7A994F85-F671-4044-8C7A-B2031B413F75"),br="NextAction",gr={oneUpStore:se.b,navigation:K.a,oneUpStateStore:Me.f,oneUpLoadingCustomerPromiseFunctions:De.b,navigateToItem:ur},vr=new f.OJ({name:"NextAction",factory:{dependencies:gr,create:e=>{const t={evaluateAction:(n=e,e=>{const t=n.oneUpStore.getOneUpProperties(),a={isDisabled:(i=t,!(i&&void 0!==i.currentIndex&&i.focusItemSet&&i.focusItemSet.length)||i.currentIndex+1>=i.focusItemSet.length),isAvailable:!(!t||(0,Te.Yb)()&&n.oneUpStateStore.getOneUpNavMode()===Me.d.single),id:br,onExecute:async()=>{if(t&&void 0!==t.currentIndex&&t.focusItemSet&&t.focusItemSet.length){const e=t.focusItemSet[t.currentIndex+1];if(e){n.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:De.a.next,newItem:e}});const a={parentItem:t.parentStoreKey?.key?{key:t.parentStoreKey?.key}:t.parentItem,urlType:"focus",parentViewParams:hr?t.parentStoreKey?.viewParams:void 0};return await n.navigateToItem({item:e,options:a}),{resultType:tt.b.Success}}return{resultType:tt.b.Failure,extraData:{errorType:"noNextItem"}}}{const e=(0,Ie.i)("no focusItemSet");throw n.oneUpStateStore.updateErrorState(br,{errorType:Ie.d.actionError,error:e,item:void 0}),e}}};var i;return a})};var n;return{instance:t}}}});var yr=n("fui.core_136");const Sr=new f.OJ({name:"UpdateItemWithMainAccessAsyncKey",loader:new f.hg(()=>n.e(80).then(n.bind(n,825)).then(e=>e.updateItemWithMainAccessKey))});var Dr=n(649),Ir=n(371);const xr=m.lazy(()=>Promise.all([n.e("ondemand.resx"),n.e(42)]).then(n.bind(n,826))),Cr=()=>m.createElement(m.Suspense,{fallback:null},m.createElement(xr,null)),Or=!f.Ov.isActivated("2beb39f3-1076-486e-b9a7-e673102fc285"),wr=(0,yr.N3o)();function Er(e){const t=(0,q.c)(),n=(0,dr.a)(),a=m.useContext(Ei.d),i=t.consume(z.a),[r,o]=m.useState(!1),[s,c]=m.useState(!0),[d,l]=m.useState(),u=m.useRef(""),p=t.consume(ur),_=t.consume(Jn.a),[h,b]=m.useState(!1),g=m.useRef(t.consume(Ce.c)),[v]=(0,Me.g)("currentState",e=>e?.rightPane.type),[y]=(0,Me.g)("currentState",e=>e?.imageMode===Me.c.edit),[S]=(0,Me.g)("currentState",e=>e?.pdfAppMode),D=(0,dr.a)(e=>e?.focusItem),[I]=(0,Me.g)("currentState",e=>e?.deletedKeys),[x,C]=m.useState(!1),{getValidViewerTypes:O}=g.current,w=t.consume(_r),E=n?.focusItem?w.evaluateAction({item:n?.focusItem}):void 0,A=t.consume(vr),L=n?.focusItem?A.evaluateAction({item:n?.focusItem}):void 0,k=E?{id:"previousCommandNewDesign",action:E}:void 0,M=L?{id:"nextCommandNewDesign",action:L}:void 0;s&&((0,Ei.g)(`${Ei.c}.Load`,{isInitalLoad:!0,viewer:Ce.a.Unknown,extension:"unknown",engagementContext:a}),c(!1));const[P]=(0,Me.g)("currentState",e=>e.imageMode!==Me.c.edit&&[qe.a.Edit,qe.a.Esign].every(t=>t!==e.pdfAppMode)&&!e.eSignData.isCreateSidePanelActive),[T]=(0,Me.g)("currentState",e=>e.viewerStates),[U,F]=m.useState((0,tr.a)());m.useEffect(()=>{I&&D&&I.has(D.key)&&C(!0)},[D,I]),m.useEffect(()=>{const{mainLinkInfo:e,permissions:a}=n?.focusItem||{};(0,tr.a)()&&n?.focusItem.key&&e&&a&&(0,Dr.a)({mainLinkInfo:e,permissions:a,pageContext:i})?(F(!0),t.consumeAsync(Sr).then(e=>e(n.focusItem,window.location.href,()=>{F(!1)})).catch(()=>{F(!1)})):U&&F(!1)},[n?.focusItem.key]),m.useEffect(()=>{n?.focusItem&&_.isCopilotSupportedForItem(n.focusItem)&&(0,Ir.c)(i)&&v!==Me.e.copilotPane&&!y&&S!==qe.a.Extract&&S!==qe.a.Edit&&!x?b(!0):b(!1)},[n?.focusItem,v,_,y,S,x,i]);const H=m.useCallback(e=>{o(e)},[]),R=m.useCallback(t=>t&&t?.item&&t.item.parentItem&&t.item.listItem?m.createElement(or,{item:t.item.currentItem,parentItem:t.item.parentItem,list:t.item.listItem,offset:t.offset,itemIndex:t.itemIndex,setIsLoaded:t.setIsLoaded,setIsPanningEnabled:H,closeCallback:e.closeCallback}):null,[]),N=(B=n)?{key:B.focusItem.key,currentItem:B.focusItem,parentItem:B.parentItem,listItem:B.list}:void 0;var B;const j={extension:N?.currentItem.extension||"",viewer:N?.currentItem?O(N?.currentItem):Ce.a.Unknown,...a},V=m.useRef(),[G,K]=m.useState(),W=m.useCallback(e=>{Or&&(K(e),V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{K(void 0),V.current=void 0},500))},[]),Q=(0,Se.a)(async(e,t,n)=>{const a={parentItem:e?.parentItem,urlType:"focus"};j.commandName="UnknownItemInvoked";const i=n;i&&i.key===(wr?"ArrowLeft":"ArrowRight")?(W("next"),j.commandName=M?.id):i&&i.key===(wr?"ArrowRight":"ArrowLeft")&&(W("previous"),j.commandName=k?.id),(0,Ei.g)(`${Ei.c}.${Ei.a}`,j),e&&await p({item:e.currentItem,options:a})});return m.useEffect(()=>{N&&(u.current=f._0(cr.d,N?.currentItem.displayName),d||l(N))},[N,d]),m.createElement("div",{className:xe.J},m.createElement("div",{"aria-live":"polite","tab-index":"-1",role:"alert",className:xe.b},u.current),P&&k&&k.action.isAvailable&&function(e,t,n,a){return m.createElement("div",{className:[xe.L,a].join(" ")},m.createElement(oa,{command:e,onClickCallback:()=>Lr(e.id,t),text:"ChevronLeft",buttonType:na.iconButton,updateErrorStateCallBack:()=>{},toolTipText:cr.b,isActive:n}))}(k,j,"previous"===G,function(e,t){const n=e?t?.get(e?.key)?.pdfViewerStates?.outlineVisibility:void 0;return n&&n!==qe.b.Hidden?xe.K:""}(N,T)),!U&&m.createElement(sr.a,{rootProps:{id:"oneUpCarousel",role:"main"},items:Ar(n),item:N,onRenderSlide:R,onItemInvoked:Q,isEnabled:r,slideAllocationCount:5}),P&&M&&M.action.isAvailable&&function(e,t,n){return m.createElement("div",{className:xe.a},m.createElement(oa,{command:e,onClickCallback:()=>Lr(e.id,t),text:"ChevronRight",buttonType:na.iconButton,updateErrorStateCallBack:()=>{},toolTipText:cr.a,isActive:n}))}(M,j,"next"===G),h&&m.createElement(Cr,null))}function Ar(e){const t=[];if(e&&e.focusItemSet&&e.focusItemSet.length>0)for(let n=0;n<e.focusItemSet.length;n++)t.push({key:e.focusItemSet[n].key,currentItem:e.focusItemSet[n],parentItem:e.parentItem,listItem:e.list});return t}function Lr(e,t){t.commandName=e||"UnknownClicked",(0,Ei.g)(`${Ei.c}.${Ei.a}`,t)}const kr=new f.OJ({name:"OpenInfoPaneActionAsync.key",loader:new f.hg(()=>n.e(60).then(n.bind(n,830)).then(e=>e.openInfoPaneActionKey))}),Mr=new f.OJ({name:"OpenAboutThisCopilotPaneActionAsync.key",loader:new f.hg(()=>Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx"),n.e(58)]).then(n.bind(n,831)).then(e=>e.openAboutThisCopilotPaneActionKey))}),Pr=new f.OJ({name:"VersionHistoryActionExecutorAsync.key",loader:new f.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(81)]).then(n.bind(n,832)).then(e=>e.versionHistoryActionExecutorKey))});var Tr=n(190);const Ur=(0,ft.a)(async()=>(await n.e(53).then(n.bind(n,829))).OneUpRightPaneWithError);function Fr(){const e=(0,q.c)(),[t]=(0,Me.g)("currentState",e=>e.rightPane),n=e.consume(Me.f),a=(0,dr.a)(e=>e?.focusItem),i=(0,Se.a)(async t=>{const n=(await e.consumeAsync(kr)).evaluateAction({item:t});n.isAvailable&&n.onExecute&&await n.onExecute({qosEvent:new tt.a({name:"openInfoPane"})})}),r=(0,Se.a)(async t=>{const n=(await e.consumeAsync(Mr)).evaluateAction({item:t});n.isAvailable&&n.onExecute&&await n.onExecute({qosEvent:new tt.a({name:"openAboutThisCopilotPane"})})}),o=(0,Se.a)(async t=>{const n=await e.consumeAsync(Pr);await n.executeOpenVersionHistory({item:t})}),s=(0,Se.a)(async t=>{const n=await e.consumeAsync($i.a);await n.evaluateAction({item:t,isAnnotateAction:!0})}),c=(0,Se.a)(()=>{n.updateRightPaneState("closeRightPane",{type:Me.e.none,content:void 0})}),d=(0,Se.a)(async n=>{switch(t?.type){case Me.e.detailPane:await i(n);break;case Me.e.copilotDetailPane:await r(n);break;case Me.e.versionHistory:await o(n);break;case Me.e.commentsPane:await s(n);break;case Me.e.copilotPane:n&&n.extension&&e.consume(Tr.a).evaluateAction({item:n}).isAvailable||c();break;case Me.e.none:default:c()}});m.useEffect(()=>{const e=new tt.a({name:"retriggerRightPane"});a&&d(a).then(()=>e.end({resultType:tt.b.Success})).catch(t=>{e.end({resultType:tt.b.Failure,extraData:{error:t}})})},[a?.key,d]),m.useEffect(()=>{if(t?.firstFocusableTarget&&(0,Te._c)()){let e=null;"string"==typeof t.firstFocusableTarget?e=document.querySelector(t.firstFocusableTarget):t.firstFocusableTarget&&(e=t.firstFocusableTarget()),e?.focus()}},[t]);const l=m.useMemo(()=>void 0!==t?.type&&t.type!==Me.e.none?m.createElement(Ur,{errorType:t.type,onClose:c}):m.createElement(m.Fragment,null),[t?.type,c]),u={borderRadius:5,overflow:"hidden",margin:8,backgroundColor:Bn.a};return m.createElement(m.Fragment,null,(t?.content||t?.hasError)&&m.createElement("div",{className:function(){if(!t)return"";switch(t.type){case Me.e.detailPane:case Me.e.copilotDetailPane:case Me.e.commentsPane:case Me.e.copilotPane:return xe.A;case Me.e.versionHistory:return xe.I;default:return""}}(),style:u},function(){if(t)switch(t.type){case Me.e.detailPane:case Me.e.copilotDetailPane:case Me.e.commentsPane:case Me.e.copilotPane:case Me.e.versionHistory:return(0,Te.oc)()&&t.hasError?l:t.content||void 0;default:return}}()))}var Hr=n(650);const Rr=(0,n(8).a)(Hr.a,e=>{const{className:t,theme:n}=e;return{root:[n.fonts.medium,"ms-CommandBar",{display:"flex",backgroundColor:"transparent",padding:"0 8px 0 8px",height:44},t],primarySet:["ms-CommandBar-primaryCommand",{flexGrow:(0,Te.Oc)()?"1":"unset",display:"flex",alignItems:"stretch",flexBasis:(0,Te.Oc)()?"25%":"unset",zIndex:1,color:n.palette.themePrimary}],middleSet:["ms-CommandBar-middleCommand",{display:"flex",justifyContent:"center",alignItems:"stretch",flexGrow:(0,Te.Oc)()?"2":"1",flexBasis:(0,Te.Oc)()?"50%":"unset",[`@media (max-width: ${yr.jyi}px)`]:{display:"none"},color:n.palette.themePrimary}],secondarySet:["ms-CommandBar-secondaryCommand",{display:"flex",alignItems:"stretch",justifyContent:"flex-end",flexGrow:(0,Te.Oc)()?"1":"unset",flexBasis:(0,Te.Oc)()?"25%":"unset",color:n.palette.themePrimary,marginRight:"-6px"}]}},void 0,{scope:"CommandBar"}),Nr="mainDividerCommand";function Br(e){return{id:Nr,isAvailable:!0,isDisabled:!0}}const jr=new f.OJ({name:"DividerNonInteractiveCommand",factory:{dependencies:{},create:()=>({instance:{id:Nr,automationId:Nr,iconProps:{iconName:"Separator",iconStyle:"color: white !important"},ariaLabel:ct.v,buttonStyles:{root:{width:"20px !important",color:"white",background:"transparent",minWidth:"20px"}},evaluateAction:Br}})}});var Vr=n(652),zr=n(154);function Gr(e){const{definitions:t,item:n,parentItem:a}=e,i=[];let r=!0;for(let e=0;e<t.length;e++){const o=t[e],{evaluateAction:s,evaluateSubCommands:c,subCommands:d,getSubCommands:l,...u}=o,f=s({item:n,parentItem:a});if(!f.isAvailable)continue;let p,m;if(d?.length&&(p=Gr({definitions:d,item:n})),c){const e=c(n);e?.length&&(p=Gr({definitions:e,item:n}))}l&&(m=async()=>Gr({definitions:await l(),item:n})),(!p||p.length||m||o.isSplit)&&(o.isDivider&&(r||e===t.length-1)||(r=!!o.isDivider,i.push({...u,name:o.evaluateCommandName?o.evaluateCommandName(n):o.name,title:o.evaluateTitle?o.evaluateTitle(n):o.title,iconProps:o.evaluateIconProps?o.evaluateIconProps(n):o.iconProps,buttonStyles:o.evaluateButtonStyles?o.evaluateButtonStyles(n):o.buttonStyles,action:f,...p?{subCommands:p}:{},...m?{getSubCommands:m}:{}})))}return i}const Kr={main:[],far:[],overflow:[]};class Wr{get workingSet(){return this._workingSet}get displaySet(){return this._showCommands?this._displaySet:Kr}updateWorkingSetOverride(e){const t=(0,Vr.a)({suspensibles:Array.from(this._workingSetOverrides.values()),onRetry:()=>this.updateWorkingSetOverride(e)});t&&(this._workingSetOverride=this._generateWorkingSet(t),this.updateDisplaySet(e))}updateDisplaySet(e){const t=(0,Vr.a)({suspensibles:Array.from(this._displaySetOverrides.values()),onRetry:()=>this.updateDisplaySet(e)});if(!t)return;const{publisher:n,item:a}=e;a&&(this._item=a),this._displaySet=this._generateDisplaySet(t),this._setShowCommands(!0),this._eventMC.publish("displaySetChange",{publisher:n,displaySet:this.displaySet})}calcDisplaySet(e,t){this._item=e,this._parentItem=t,this._displaySet=this._generateDisplaySet([])}addWorkingSetOverride(e){return this._workingSetOverrides.add(e),()=>this._workingSetOverrides.delete(e)}addDisplaySetOverride(e){return this._displaySetOverrides.add(e),()=>this._displaySetOverrides.delete(e)}dispose(){this._eventMC.dispose(),this._displaySetOverrides.clear(),this._workingSetOverrides.clear()}_generateWorkingSet(e){let t=this._workingSet;for(const n of e)t=n(t);return t}_generateDisplaySet(e){const t=this._item,n=this._parentItem;let a=function(e){const{commandDefinitionSet:t,item:n,parentItem:a}=e;return{main:Gr({definitions:t.main,item:n,parentItem:a}),far:Gr({definitions:t.far,item:n,parentItem:a}),overflow:Gr({definitions:t.overflow,item:n,parentItem:a})}}({commandDefinitionSet:this._workingSetOverride,item:t,parentItem:n});for(const n of e)a=n({displaySet:a,item:t});return a}_setShowCommands(e){this._showCommands=e}constructor(e){this.isContextual=()=>!1,this.onDisplaySetChange=e=>this._eventMC.subscribe("displaySetChange",t=>{e(t.detail.displaySet)}),this.getDisplaySetCommand=e=>{const t=[this._displaySet.main,this._displaySet.far,this._displaySet.overflow];for(const n of t)for(const t of n)if(t.id===e)return t},this.getWorkingSetCommand=e=>{const t=[this._workingSetOverride.main,this._workingSetOverride.far,this._workingSetOverride.overflow];for(const n of t)for(const t of n)if(t.id===e)return t};const{item:t,workingSet:n,showCommands:a=!0}=e;this._item=t,this._parentItem=void 0,this._workingSet=n,this._showCommands=a,this._workingSetOverride=n,this._workingSetOverrides=new Set,this._displaySetOverrides=new Set,this._eventMC=new zr.a,this._displaySet=this._generateDisplaySet([]),this.updateWorkingSetOverride({publisher:"commandBarInitialLoad"})}}var qr=n(653);const Qr={actionProvider:qr.a},Yr="closeCommand",Jr=new f.OJ({name:"CloseCommand",factory:{dependencies:Qr,create:({actionProvider:e})=>({instance:{id:Yr,buttonStyles:{root:{margin:"auto 6px"}},automationId:Yr,title:ct.i,iconProps:{iconName:"Cancel"},evaluateAction:e.evaluateAction}})}});var Xr=n(224),Zr=n(668),$r=n(274),eo=n(134),to=n(669),no=n(203),ao=n(13),io=n(670),ro=n(442);const oo=!f.Ov.isActivated("477a83b0-a601-4574-a95c-87b89e0949a7");var so;!function(e){e[e.Favorite=0]="Favorite",e[e.Unfavorite=1]="Unfavorite"}(so||(so={}));const co={pageContext:z.a,oneUpStore:se.b,resources:f.sp,urlDataSource:tn.a,oneUpStateStore:Me.f,isFavoritesEnabled:Xr.a,offlineDetection:un.a,navigation:K.a,identityDataSource:Gt.resourceKey,oneDriveDataSource:ro.oneDriveDataSourceKey,onClickFavoriteSpartan:Et.m.optional,isFavoritesEnabledInOneUp:$r.a};function lo(e,t,a,i,r,o,s){let c,d="";const l=(0,ft.a)(async()=>(await n.e(75).then(n.bind(n,759))).ToastActionButton);a?0===i?(d=m.createElement(m.Fragment,null,to.a,m.createElement("span",{style:{fontWeight:"bold"}},r||to.e),to.h),c=s?m.createElement(m.Fragment,null,m.createElement(l,{theme:o,key:"openFavorites",text:to.f,onClick:()=>{window.open(s,"_blank")}})):void 0):d=m.createElement(m.Fragment,null,to.g,m.createElement("span",{style:{fontWeight:"bold"}},r||to.e),to.d):d=0===i?m.createElement(m.Fragment,null,to.c,m.createElement("span",{style:{fontWeight:"bold"}},r||to.e),to.b):m.createElement(m.Fragment,null,to.j,m.createElement("span",{style:{fontWeight:"bold"}},r||to.e),to.i),e.oneUpStateStore.updateToastState("favoriteAction",{visible:!0,actionStatus:a?t.ToastActionStatus.succeed:t.ToastActionStatus.error,displayText:d,actionButtons:c})}const uo={actionProvider:new f.OJ({name:"FavoriteAction",factory:{dependencies:co,create:e=>{return{instance:{evaluateAction:(t=e,e=>{const a=t.offlineDetection,i=t.oneUpStore.getOneUpProperties(),r=void 0!==t.oneUpStateStore.currentAppState.isFocusItemFavorited,o=t.oneUpStateStore.currentAppState.isFocusItemFavorited||!1,s=(c=e.item,d=o,(0,Zr.a)({extension:c.extension,isMountPoint:!!c.mountPoint})&&!d);var c,d;const l=o,u={isAvailable:t.isFavoritesEnabledInOneUp&&!a.offline&&(t.oneUpStateStore.currentAppState.isFocusItemFavorited?l:s),id:"FavoriteAction",isDisabled:!r};return(async()=>await n.e(55).then(n.bind(n,749)))().then(a=>{u.onExecute=async()=>{const r=await n.e(20).then(n.bind(n,837)),s=await t.resources.consumeAsync(r.resourceKey),c=new ao.b({context:t.pageContext}),{id:d,listurl:l}=(0,f.pW)(e.item.key),u=c.getUrlParts({listUrl:l,path:d}),p=u.fullWebUrl,m=await(_=t,h=p,h?_.identityDataSource.getSharePointToken({webAbsoluteUrl:h,apiQosName:"FavoriteAction"}).then(e=>e):new Promise(()=>{}));var _,h;const b={webAbsoluteUrl:p,listUrl:u.serverRelativeListUrl},g=i?.pageContexts?.get(b),v=(0,io.a)(),y={items:[{siteId:g?.siteId||t.pageContext.siteId,webId:g?.webId||t.pageContext.webId,listId:g?.listId||t.pageContext.listId,listItemUniqueId:e.item.properties?.uniqueId}],accessToken:m};(async function(e){if(oo){let t=await e.oneDriveDataSource.getPersonalUrl();return"/"!==t.charAt(t.length-1)&&(t=t.concat("/")),t.concat("_layouts/15/onedrive.aspx?view=",`${eo.a.Favorites}`)}{const t=e.urlDataSource.getPageType(e.navigation.viewParams),n={};t!==ze.a.Files&&(n[je.b.pageParamKey]=t),n[je.b.queryTypeParamKey]=`${eo.a.Favorites||""}`;const a="#"+(0,no.b)(n,void 0,!0);return Promise.resolve(`${window.location.protocol}//${window.location.host}/${a}`)}})(t).then(n=>{if(!(y.items[0].siteId&&y.items[0].webId&&y.items[0].listId&&y.items[0].listItemUniqueId))return t.oneUpStateStore.updateErrorState("favoriteAction.Favorite",{errorType:Ie.d.actionError,error:{name:"favoriteAction.MissingItemProperties",message:"Missing required item properties for favorite-unfavorite call"},item:e.item}),{resultType:tt.b.Failure};if(o?s.unfavoriteItems(y).then(()=>(lo(t,a,!0,1,e.item.name,v,n),t.oneUpStateStore.setIsFocusItemFavorited("favoriteAction",!1),{resultType:tt.b.Success})).catch(i=>(lo(t,a,!1,1,e.item.name,v,n),t.oneUpStateStore.updateErrorState("favoriteAction.Unfavorite",{errorType:Ie.d.actionError,error:i,item:e.item}),{resultType:tt.b.Failure})):s.favoriteItems(y).then(()=>(lo(t,a,!0,0,e.item.name,v,n),t.oneUpStateStore.setIsFocusItemFavorited("favoriteAction",!0),{resultType:tt.b.Success})).catch(i=>(lo(t,a,!1,0,e.item.name,v,n),t.oneUpStateStore.updateErrorState("favoriteAction.Favorite",{errorType:Ie.d.actionError,error:i,item:e.item}),{resultType:tt.b.Failure})),!(0,Te.cc)()){if(!t.onClickFavoriteSpartan||!e.item.properties?.ID)return{resultType:tt.b.Failure,extraData:{error:`onClickFavoriteSpartan or item id not available, item id is ${e.item.properties?.ID}`}};{const n={isFavorited:o,listItemId:e.item.properties?.ID};t.onClickFavoriteSpartan(n)}}}).catch(n=>{t.oneUpStateStore.updateErrorState("favoriteAction.GetFavoritesEndpoint",{errorType:Ie.d.actionError,error:n,item:e.item,extraData:{isCurrentOneDrive:t.oneDriveDataSource.isCurrentOneDrive}});const i={resultType:tt.b.Failure,error:n.name,extraData:{error:n,item:e.item,isCurrentOneDrive:t.oneDriveDataSource.isCurrentOneDrive}};return lo(t,a,!1,o?1:0,e.item.name,v),i})}}).catch(e=>{u.isAvailable=!1}),u})}};var t}}}),oneUpStateStore:Me.f},fo="favoriteCommand",po=new f.OJ({name:"FavoriteCommand",factory:{dependencies:uo,create:({actionProvider:e,oneUpStateStore:t})=>({instance:{id:fo,name:ct.F,automationId:fo,evaluateTitle:e=>t.currentAppState.isFocusItemFavorited?ct.Hb:ct.G,evaluateIconProps:e=>t.currentAppState.isFocusItemFavorited?{iconName:"FavoriteStarFill"}:{iconName:"FavoriteStar"},evaluateAction:e.evaluateAction}})}});function mo(e){if(e)switch((0,zn.a)(e)){case"ms-word":return"Word";case"ms-excel":return"Excel";case"ms-powerpoint":return"PowerPoint";case"ms-visio":return"Visio";case"ms-project":return"Project";case"ms-publisher":return"Publisher";case"ms-access":return"Access";case"onenote|UsePlain":return"OneNote"}}const _o={pageContext:z.a,oneUpStore:se.b,navigation:K.a,resources:f.sp,platform:ie.a},ho=new f.OJ({name:"OpenInOfficeClientAction",factory:{dependencies:_o,create:e=>{return{instance:{evaluateAction:(t=e,e=>{return{isAvailable:(n=e.item,a=t.platform,!!((a.isMac||a.isWindows||a.isIOS||a.isWinPhone||a.isAndroid)&&n&&nt.a.hasItemPermission(n,nt.a.openItems)&&n.openUrl&&n.appMap&&n.itemStatus!==at.b.ConditionalAccessBlocked&&n.itemStatus!==at.b.ConditionalAccessViewOnly)),id:"OpenInOfficeClientAction",onExecute:async()=>t.resources.consumeAsync(tn.a).then(n=>{const a=n.getOpenInOfficeClientUrl(e.item,t.navigation.viewParams);return t.navigation.navigateTo({url:a,frameId:"_blank"}),{resultType:tt.b.Success}})};var n,a})}};var t}}});var bo=n(673),go=n(674),vo=n(675),yo=n(676);const So=f.Ov.isActivated("4517af36-b494-4137-bed5-a607bcad4a39");function Do(e){if(e)switch((0,zn.a)(e)){case"ms-word":return So?{iconName:"svg/word_16x1.svg",className:xe.h}:{className:xe.h,imageProps:{src:bo.a,width:16,height:16}};case"ms-excel":return So?{iconName:"svg/excel_16x1.svg",styles:{root:{width:16,height:16}}}:{className:xe.h,imageProps:{src:go.a,width:16,height:16}};case"ms-powerpoint":return So?{iconName:"svg/powerpoint_16x1.svg",className:xe.h}:{className:xe.h,imageProps:{src:vo.a,width:16,height:16}};case"ms-visio":return{iconName:"svg/visio_16x1.svg",className:xe.h};case"ms-project":return{iconName:"ProjectDocument",className:xe.h};case"ms-publisher":return{iconName:"PublisherLogo",className:xe.h};case"ms-access":return{iconName:"AccessLogo",className:xe.h};case"onenote|UsePlain":return So?{iconName:"svg/onenote_16x1.svg",className:xe.h}:{className:xe.h,imageProps:{src:yo.a,width:16,height:16}}}}const Io={actionProvider:ho,oneUpStore:se.b},xo="openInOfficeClientCommand";function Co(e){return mo(e.extension)?f._0(ct.ib,mo(e.extension)):ct.ab}const Oo=new f.OJ({name:"OpenInOfficeClientCommand",factory:{dependencies:Io,create:e=>({instance:{id:xo,automationId:xo,evaluateAction:e.actionProvider.evaluateAction,evaluateIconProps:e=>Do(e.extension),evaluateCommandName:e=>Co(e),evaluateTitle:e=>Co(e)}})}}),wo={actionProvider:da,oneUpStore:se.b},Eo="openInOfficeOnlineCommand";function Ao(e,t){return mo(e.extension)?t?f._0(ct.cb,mo(e.extension)):f._0(ct.ob,mo(e.extension)):t?ct.sb:ct.rb}const Lo=new f.OJ({name:"OpenInOfficeOnlineCommand",factory:{dependencies:wo,create:e=>({instance:{id:Eo,automationId:Eo,evaluateAction:e.actionProvider.evaluateAction,evaluateIconProps:e=>Do(e.extension),evaluateCommandName:e=>Ao(e),evaluateTitle:e=>Ao(e,!0)}})}});var ko=n(677),Mo=n(678);function Po(e){const t=new f.Zd;if(e.item&&e.item.urls&&e.item.urls[ut.b.immersiveReaderUrl]){const t=e.item.urls[ut.b.immersiveReaderUrl],{getImmersiveReaderContext:n}=(0,ko.a)({url:t,qosName:"OneUpLightSpeed.OpenInImmersiveReader.GetReaderOptions"}),a=new f.Zd,i=()=>{a.resolve(),e.onClose&&e.onClose()};if(n){const t=new tt.a({name:"OneUpLightSpeed.OpenInImmersiveReader.Launch"});return(0,Mo.a)({getImmersiveReaderContext:n,options:{onExit:i}}).then(()=>(e.onRender&&e.onRender(),a.promise.then(()=>{t.end({resultType:tt.b.Success})}).catch(n=>{t.end({resultType:tt.b.Failure,extraData:{error:n.message,stack:n.stack,extension:e.item.extension,fileSize:e.item.size}}),e.onError&&e.onError(n)}))).catch(n=>{t.end({resultType:tt.b.Failure,extraData:{error:n.message,stack:n.stack,extension:e.item.extension,fileSize:e.item.size}}),e.onError&&e.onError(n)})}e.onError&&e.onError({name:"IM.MissingReaderContext",message:"IM context options missing"})}else e.onError&&e.onError({name:"IM.ItemMissingProps",message:"Item missing required properties"});return t.promise}const To=new f.OJ({name:"ShowImmersiveReader",factory:{dependencies:{},create:e=>({instance:{showImmersiveReader:Po}})}});var Uo=n(679);const Fo="OpenInImmersiveReaderAction",Ho=[".docx",".txt",".html"],Ro={getExecutor:To.async.lazy,pageContext:z.a,oneUpStore:se.b,resources:f.sp,oneUpStateStore:Me.f},No={actionProvider:new f.OJ({name:"OpenInImmersiveReaderAction",factory:{dependencies:Ro,create:e=>{return{instance:{evaluateAction:(t=e,e=>{const{item:n}=e,a=function(e){return!(!e.extension||!e.size)&&!(!e.urls||!e.urls[ut.b.immersiveReaderUrl])&&-1!==Ho.indexOf(e.extension)&&(0,Uo.a)(e.size)}(n);return{isAvailable:a,id:Fo,onExecute:async()=>{const a=await t.getExecutor(),i=new Tt.b,r={...e,onClose:()=>{},onRender:e=>{i.complete()},onError:e=>{e.name=`IMLaunchFailure.${e.name}`,t.oneUpStateStore.updateErrorState(Fo,{errorType:Ie.d.actionError,error:e,item:n}),i.error(e)}};try{await a.showImmersiveReader(r)}catch(e){}return i.getPromise()}}})}};var t}}})},Bo="openInImmersiveReaderCommand",jo=new f.OJ({name:"OpenInImmersiveReaderCommand",factory:{dependencies:No,create:({actionProvider:e})=>({instance:{id:Bo,name:ct.tb,title:ct.nb,automationId:Bo,iconProps:{iconName:"ReadOutLoud"},evaluateAction:e.evaluateAction}})}}),Vo={pageContext:z.a,oneUpStore:se.b,resources:f.sp,oneUpStateStore:Me.f,getValidViewerTypesFromResource:Ce.c},zo={actionProvider:new f.OJ({name:"OpenInHtmlViewerAction",factory:{dependencies:Vo,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{getValidViewerTypes:n}=t.getValidViewerTypesFromResource,a=n(e.item),i=t.oneUpStateStore.getViewerState(e.item.key),r=!!i&&i.htmlMode===Me.b.edit;return{isAvailable:a===Ce.a.Html&&r,id:"OpenInHtmlViewerAction",onExecute:async()=>(t.oneUpStateStore.updateViewerState("updateHtmlModeView",{key:e.item.key,options:{htmlMode:Me.b.view}}),{resultType:tt.b.Success})}})}}}}})},Go="openInHtmlViewerCommand",Ko=new f.OJ({name:"OpenInHtmlViewerCommand",factory:{dependencies:zo,create:({actionProvider:e})=>({instance:{id:Go,name:ct.eb,automationId:Go,iconProps:{iconName:"View"},evaluateAction:e.evaluateAction}})}}),Wo={pageContext:z.a,oneUpStore:se.b,resources:f.sp,oneUpStateStore:Me.f,getValidViewerTypesFromResource:Ce.c},qo={actionProvider:new f.OJ({name:"OpenInTextEditorAction",factory:{dependencies:Wo,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{getValidViewerTypes:n}=t.getValidViewerTypesFromResource,a=n(e.item),i=t.oneUpStateStore.getViewerState(e.item.key),r=void 0===i?.htmlMode||i?.htmlMode===Me.b.view;return{isAvailable:a===Ce.a.Html&&r&&".msg"!==e.item.extension,id:"OpenInTextEditorAction",onExecute:async()=>(t.oneUpStateStore.updateViewerState("updateHtmlModeEdit",{key:e.item.key,options:{htmlMode:Me.b.edit}}),{resultType:tt.b.Success})}})}}}}})},Qo="openInTextEditorCommand",Yo=new f.OJ({name:"OpenInTextEditorCommand",factory:{dependencies:qo,create:({actionProvider:e})=>({instance:{id:Qo,name:ct.db,automationId:Qo,iconProps:{iconName:"Edit"},evaluateAction:e.evaluateAction}})}}),Jo=!f.Ov.isActivated("1cbefa0c-46a0-4a8e-90f8-0831761b38fb"),Xo={navigation:K.a,getValidViewerTypesFromResource:Ce.c},Zo={actionProvider:new f.OJ({name:"OpenInStreamAction",factory:{dependencies:Xo,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{getValidViewerTypes:n}=t.getValidViewerTypesFromResource,a=n(e.item),i=e.item.openUrl,r=Jo&&(0,Fe.b)(e.item.urls?.[ut.b.video])||!Jo,o=(a===Ce.a.OnePlayerVideo||a===Ce.a.OnePlayerAudio)&&r&&!!i,s=i?.indexOf("?"),c=`${i}${-1===s?"?web=1":"&web=1"}&referrer=OneUpViewer.web&referrerScenario=OpenFile.view`;return{isAvailable:o,id:"OpenInStreamAction",onExecute:async()=>(await t.navigation.navigateTo({url:c,frameId:"_blank"}),{resultType:tt.b.Success})}})}}}}}),oneUpStore:se.b},$o="openInStreamCommand";(0,d.fU)({icons:{OpenRegular:m.createElement("svg",{fill:"currentColor",width:"16",height:"16",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"M6 4a2 2 0 0 0-2 2v8c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2v-2.5a.5.5 0 0 1 1 0V14a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h2.5a.5.5 0 0 1 0 1H6Zm5-.5c0-.28.22-.5.5-.5h5c.28 0 .5.22.5.5v5a.5.5 0 0 1-1 0V4.7l-4.15 4.15a.5.5 0 0 1-.7-.7L15.29 4H11.5a.5.5 0 0 1-.5-.5Z"}))}});const es=new f.OJ({name:"OpenInStreamCommand",factory:{dependencies:Zo,create:({actionProvider:e})=>({instance:{id:$o,name:ct.$,title:ct.$,automationId:$o,evaluateAction:e.evaluateAction,iconProps:{iconName:"OpenRegular",className:xe.h}}})}});var ts=n(173),ns=n(36);const as={oneUpStateStore:Me.f,pageContext:z.a,fileHandlerHelper:Ri.a},is=new f.OJ({name:"OpenInFileHandleCommand",factory:{dependencies:as,create:e=>{function t(t){const n={imageProps:{src:t.handler.appIcon?.svg,title:t.handler.actionMenuDisplayName,imageFit:ts.b.contain}},a=t.handler.actionMenuDisplayName||t.displayName;return{id:"fileHandlerOpen",name:a,title:t.handler.actionMenuDisplayName,automationId:"fileHandlerOpen",iconProps:n,extraData:{handlerName:a},evaluateAction:n=>{const i=n.item;return{isAvailable:rs(t.availableOn,n.item.extension,!1),id:`fileHandlerOpenAction-${a}`,onExecute:async()=>{const a=Number(e.pageContext.webTemplate)===kn.b.mySite,r=(0,Te.lc)()?a?"OneDrive":"SharePoint":"OneUp",o={cultureName:e.pageContext.currentUICultureName||e.pageContext.currentCultureName||"en-US",client:r,domainHint:"organizations",userId:e.pageContext.userLoginName},s=function(e){const t=window.open({}.url||"","_blank");return t&&(t.opener=null),t||void 0}(),c=!!t.handler.isPromoted;let d,l;try{d=await e.fileHandlerHelper.getFileHandlerItemUrl(n.item,t,c)}catch(e){l=e}if(d&&d.length>0){const n={...o,appId:t.handler.appId,items:JSON.stringify(d)};if(s&&s.document)return s.opener=null,(0,Ni.a)({url:t.url,postdata:n,document:s.document}),{resultType:ns.a.Success};{const t=(0,Ie.i)("No target window available to invoke File Handler");throw e.oneUpStateStore.updateErrorState("openFileHandlerAction",{errorType:Ie.d.actionError,error:t,item:i}),t}}{const t=l||(0,Ie.i)("unknown error calling getFileHandlerItemUrl");throw e.oneUpStateStore.updateErrorState("openFileHandlerAction",{errorType:Ie.d.actionError,error:t,item:i}),t}}}}}}return{instance:function(n){const a=[],i=n||e.oneUpStateStore.getFileHandlerOptions();if(i){const e=i.data.actions.open;for(let n=0;n<e.length;n++){const i=t(e[n]);a.push(i)}}return a}}}}});function rs(e,t,n){const a=e.file,i=e.folder,r=e.file&&e.file.extensions||void 0;if(n)return!!i;if(a&&t){const e="."!==t.charAt(0)?"."+t:t;return!r||-1!==r.indexOf(e.toLowerCase())||-1!==r.indexOf("*")||-1!==r.indexOf(".*")}return!1}var os=n(680),ss=n(681),cs=n(100),ds=n(413);const ls=e=>t=>{const n=e.oneUpStore.getOneUpProperties()?.parentItem,a=!!t.item&&!!t.item.key&&!!e.pageContext&&function(e,t){const n=t?.canUserUseClipchamp??!1,a=(0,Te.jb)({ODB:1344}),i=(0,Te.jb)({ODB:61399}),r=(t&&t.listBaseTemplate===cs.a.webPageLibrary)??!1,o=nt.a.hasItemPermission(e,nt.a.insertListItems);return(0,os.b)(e.extension??"",!0)&&o&&a&&!r&&(n||i)}(t.item,e.pageContext),i=(0,os.a)(n?.graph,e.pageContext.webAbsoluteUrl,{referrer:e.clientName||"OneUp",referrerScenario:"EditInClipchamp",video:t.item?.graph});return{isAvailable:a,id:"EditInClipchampAction",onExecute:async()=>((0,ss.a)(i,{forceInSameWindow:!1}),{resultType:tt.b.Success})}},us={oneUpStore:se.b,navigation:K.a,pageContext:z.a,clientName:ds.a.optional},fs=new f.OJ({name:"EditInClipchampAction",factory:{dependencies:us,create:e=>({instance:{evaluateAction:ls(e)}})}});var ps=n(682),ms=n(683);const _s={actionProvider:fs,oneUpStore:se.b},hs="editInClipchampCommand",bs=new f.OJ({name:"EditInClipchampCommand",factory:{dependencies:_s,create:({actionProvider:e})=>{const t=f.JW.isFeatureEnabled(Te.a)?ms.a:ps.a;return{instance:{id:hs,name:ct.A,title:ct.A,automationId:hs,evaluateAction:e.evaluateAction,iconProps:{imageProps:{src:t,styles:{root:{width:"16px",height:"16px",display:"flex !important"}}}}}}}}}),gs=new f.OJ({name:"OpenInAppDataSourceAsync.key",loader:new f.hg(()=>n.e(59).then(n.bind(n,838)).then(e=>e.openInAppDataSourceKey))}),vs=async e=>{const t=await e.resources.consumeAsync(gs);await t.openInApp(e.item,e.pageContexts)},ys=new f.OJ({name:"OpenInAppActionExecutor",factory:{dependencies:{},create:e=>({instance:{executeOpenInApp:vs}})}}),Ss="OpenInAppAction",Ds={oneUpStore:se.b,platform:ie.a,oneUpStateStore:Me.f,itemUrlHelper:$.c,getValidViewerTypesFromResource:Ce.c,getExecutor:ys.async.lazy,resources:f.sp},Is={actionProvider:new f.OJ({name:"OpenInAppAction",factory:{dependencies:Ds,create:e=>{return{instance:{evaluateAction:(t=e,e=>{const n=(i=e.item,r=t.platform,o=t.getValidViewerTypesFromResource.getValidViewerTypes(e.item),!(!(r.isWindows||r.isWinPhone||r.isAndroid||r.isIOS||r.isMac)||!i||o===Ce.a.Copilot||!nt.a.hasItemPermission(i,nt.a.openItems)||i.appMap||i.itemStatus===at.b.ConditionalAccessBlocked||(o===Ce.a.MSPdf||o===Ce.a.Pdf||o===Ce.a.Photo)&&nt.a.hasItemPermission(i,nt.a.insertListItems)&&nt.a.hasItemPermission(i,nt.a.editListItems))),a=t.oneUpStore.getOneUpProperties();var i,r,o;return{isAvailable:n,id:Ss,onExecute:async()=>{const{focusItem:e,parentItem:n,focusItemSet:i}=a;if(a&&i&&i.length&&e&&n){const n=await t.getExecutor();return await n.executeOpenInApp({item:e,pageContexts:a.pageContexts,resources:t.resources}),{resultType:tt.b.Success}}{const n=(0,Ie.i)("no parent view/item");throw t.oneUpStateStore.updateErrorState(Ss,{errorType:Ie.d.actionError,error:n,item:e}),n}}}})}};var t}}}),oneUpStore:se.b},xs="OpenInAppCommand",Cs=new f.OJ({name:"OpenInAppCommand",factory:{dependencies:Is,create:e=>({instance:{id:xs,name:ct._,title:ct._,automationId:xs,iconProps:{iconName:"OpenInNewWindow"},evaluateAction:e.actionProvider.evaluateAction}})}});var Os=n(191);const ws={openInOfficeClientCommand:Oo,openInOfficeOnlineCommand:Lo,openInImmersiveReaderCommand:jo,openInHtmlViewerCommand:Ko,openInTextEditorCommand:Yo,openInStreamCommand:es,openInFileHandlerCommands:is,editInClipchampCommand:bs,openInAppCommand:Cs,oneUpStateStore:Me.f},Es="openCommandGroup",As=new f.OJ({name:"OpenGroupCommand",factory:{dependencies:ws,create:e=>({instance:function(){const{openInOfficeClientCommand:t,openInImmersiveReaderCommand:n,openInOfficeOnlineCommand:a,openInTextEditorCommand:i,openInHtmlViewerCommand:r,openInStreamCommand:o,editInClipchampCommand:s,openInAppCommand:c}=e,d=e.openInFileHandlerCommands();return{id:Es,name:ct.Z,automationId:Es,subCommands:[t,a,i,r,n,o,...d,s,c],evaluateAction:t=>{const n=e.oneUpStateStore.currentAppState.deletedKeys?.has(t.item.key);return{isAvailable:!n}},buttonStyles:(0,Os.a)(),evaluateIconProps:e=>Do(e.extension)||{iconName:"OpenInNewWindow"}}}})}});var Ls=n(476);const ks=new f.OJ({name:"OnPickCopyFileAsync.key",loader:new f.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(57)]).then(n.bind(n,839)).then(e=>e.onPickCopyFileKey))}),Ms=(0,ft.a)(async()=>(await Promise.all([n.e("ondemand.resx"),n.e(21)]).then(n.bind(n,751))).Sdk80FilePickerHostModal);function Ps(e){const t=new f.Zd;return e.onRender(m.createElement(Ts,e)),t.promise}function Ts(e){const t=(0,q.c)(),n=`${e.pageContext.webAbsoluteUrl}/${e.pageContext.layoutsUrl}/FilePicker.aspx`,a={title:ct.o,selection:{mode:"pick"},commands:{pick:{label:ct.n}},typesAndSources:{mode:"folders"},entry:{sharePoint:{byPath:{web:e.web,list:e.list,folder:e.folder}}}},i=(0,Se.a)(t=>(e.onClose(),Promise.resolve())),r=(0,Se.a)(e=>Promise.resolve()),o=(0,Se.a)(n=>{const a=new tt.a({name:"OneUpCopyToOnPick"}),i=t.consumeAsync(ks);return e.onClose(),i.then(t=>{t(n,e.folder).then(()=>a.end({resultType:tt.b.Success})).catch(e=>{a.end({resultType:tt.b.Failure,error:e})})}).catch(e=>{a.end({resultType:tt.b.Failure,error:e})}),Promise.resolve()});return m.createElement(Ms,{pickerPageUrl:n,app:e.clientName,scenario:"MoveCopy",options:a,onPick:o,onClose:i,onLoad:r})}const Us=new f.OJ({name:"ShowFilePicker",factory:{dependencies:{},create:e=>({instance:{showFilePicker:Ps}})}}),Fs=e=>t=>{return{isAvailable:(n=t.item,!(n.itemStatus===at.b.ConditionalAccessBlocked||n.itemStatus===at.b.ConditionalAccessViewOnly||!gt.a&&(0,bt.c)(n.extension)||!nt.a.hasItemPermission(n,nt.a.openItems)||n.isRootFolder||n.lifeCycleStatus?.isMalwareDetected)),id:"copyToAction",onExecute:async()=>{e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!0});const n=await e.getExecutor(),a=e.itemUrlHelper.getItemUrlParts(t.item.key),i=e.oneUpStore.parentItem?e.itemUrlHelper.getItemUrlParts(e.oneUpStore.parentItem.key):void 0,r=a.fullListUrl,o=a.fullWebUrl,s=i?.fullItemUrl,c={pageContext:e.pageContext,clientName:e.clientName||"OneUp",onClose:()=>{e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!1})},onRender:t=>{e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!0,content:t})},list:r,web:o,folder:s};return await n.showFilePicker(c),{resultType:tt.b.Success}}};var n},Hs={getExecutor:Us.async.lazy,pageContext:z.a,clientName:ds.a.optional,oneUpStateStore:Me.f,itemUrlHelper:$.c,oneUpStore:se.b},Rs={actionProvider:new f.OJ({name:"CopyToAction",factory:{dependencies:Hs,create:e=>({instance:{evaluateAction:Fs(e)}})}})},Ns="copyToCommand",Bs=new f.OJ({name:"CopyToCommand",factory:{dependencies:Rs,create:({actionProvider:e})=>({instance:{id:Ns,name:ct.o,title:ct.p,automationId:Ns,iconProps:{iconName:"Copy"},evaluateAction:e.evaluateAction}})}});var js=n(684);const Vs=new f.OJ({name:"DeleteActionExecutor.key",loader:new f.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(13)]).then(n.bind(n,840)).then(e=>e.deleteActionExecutorKey))}),zs="DeleteAction",Gs={pageContext:z.a,oneUpStore:se.b,navigation:K.a,resources:f.sp,platform:ie.a,oneUpStateStore:Me.f,getExecutor:Vs.async.lazy,navigateToItem:ur},Ks={actionProvider:new f.OJ({name:"DeleteAction",factory:{dependencies:Gs,create:e=>{return{instance:{evaluateAction:(t=e,e=>{const n=(a=e.item,nt.a.hasItemPermission(a,nt.a.deleteListItems)&&(gt.a||!(0,bt.c)(a.extension)));var a;const i=t.oneUpStore.getOneUpProperties();return{isAvailable:n,id:zs,onExecute:async()=>{const{focusItem:n,parentItem:a,focusItemSet:r,currentIndex:o,list:s}=i;if(!(i&&r&&r.length&&n&&a)){const e=(0,Ie.i)("no parent view/item");throw t.oneUpStateStore.updateErrorState(zs,{errorType:Ie.d.actionError,error:e,item:n}),e}{const c={parentKey:a.key,items:[e.item],deletionType:js.a.Recycle,allowUndo:!1,emptyRecycleBin:!1,listId:s?.list?.id,overrideLock:!0,enforceETag:!1};let d=a;d=void 0!==o&&o+1<r.length?r[o+1]:o&&o-1>=0?r[o-1]:a;let l=!1;(await t.getExecutor()).executeDelete({deleteItemsContext:c,item:e.item}).then(async e=>{if(l=e,l){let e=t.oneUpStateStore.currentAppState.deletedKeys;e||(e=new Map),e.set(n.key,!0),t.oneUpStateStore.updateDeletedKeysState("DeleteAction",e),d.key===a.key?(await(0,f.iM)(5e3),await t.navigateToItem({item:d,options:{urlType:"focus"}})):await t.navigateToItem({item:d,options:{parentItem:i.parentItem,urlType:"focus"}})}return{resultType:tt.b.Success}}).catch(e=>{throw t.oneUpStateStore.updateErrorState("delete action",{errorType:Ie.d.actionError,error:e,item:n}),e})}}}})}};var t}}})},Ws="deleteCommand",qs=new f.OJ({name:"DeleteCommand",factory:{dependencies:Ks,create:({actionProvider:e})=>({instance:{id:Ws,name:ct.r,title:ct.s,automationId:Ws,iconProps:{iconName:"Delete"},evaluateAction:e.evaluateAction}})}}),Qs={actionProvider:n(388).b,oneUpStateStore:Me.f},Ys="annotateCommand",Js=new f.OJ({name:"AnnotateCommand",factory:{dependencies:Qs,create:({actionProvider:e,oneUpStateStore:t})=>({instance:{id:Ys,automationId:Ys,name:ct.e,iconProps:{iconName:"InkingTool"},evaluateTitle:e=>t.currentAppState.annotationViewerState.isActive?ct.S:ct.kb,evaluateAction:e.evaluateAction}})}});var Xs=n(685),Zs=n(686);const $s={openCommentsPaneActionAsync:$i.a.async,oneUpStateStore:Me.f},ec={actionProvider:new f.OJ({name:"OnClickCommentsButtonAction",factory:{dependencies:$s,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const n=t.oneUpStateStore.currentAppState.deletedKeys?.has(e.item.key);return{id:"onClickCommentsButtonAction",isAvailable:(0,Xs.a)(e.item)&&!n,onExecute:async()=>{if(t.oneUpStateStore.currentAppState.rightPane.type===Me.e.commentsPane)t.oneUpStateStore.updateRightPaneState("onClickCommentsButton",{type:Me.e.none}),(0,Zs.b)(Zs.a.CloseCommentsFromCommandBar,e.item.extension);else{const n=await t.openCommentsPaneActionAsync();await n.evaluateAction({item:e.item,isAnnotateAction:!1}),(0,Zs.b)(Zs.a.OpenCommentsFromCommandBar,e.item.extension)}}}})}}}}}),oneUpStateStore:Me.f},tc="commentCommand",nc=new f.OJ({name:"CommentsCommand",factory:{dependencies:ec,create:({actionProvider:e,oneUpStateStore:t})=>({instance:{id:tc,automationId:tc,buttonStyles:(0,Os.a)(),iconProps:{iconName:"Comment"},evaluateTitle:e=>t.currentAppState.rightPane.type===Me.e.commentsPane?ct.T:ct.Mb,evaluateAction:e.evaluateAction}})}});var ac=n(687),ic=n(688),rc=n(689),oc=n(690),sc=n(691),cc=n(217);function dc(e,t,n,a,i,r){return!!t&&!(n||t.isExternalGuestUser||".pdf"!==e?.extension?.toLowerCase()||!i?.()||r||a||!Nn(t)||!function(e){if(!e)return!1;switch(e){default:return!1;case"edog":case"spdf":case"prodbubble":case"prod":return!0}}(t.cloudType?.toLowerCase()))}function lc(e,t,n,a,i,r,o){const s=!!cc.c||!!n?.isSyntexESignatureEnabled,c=s&&!(!n?.isSyntexPAYGEnabled||!n?.syntexEsignatureThirdPartyEnabledProviders?.some(e=>e===Pn.b.Adobe)),d=s&&!(!n?.isSyntexPAYGEnabled||!n?.syntexEsignatureThirdPartyEnabledProviders?.some(e=>e===Pn.b.Docusign)),l=dc({extension:t?.extension},n,a,i,r,o);return l&&e===Pn.a.Adobe?c:!(!l||e!==Pn.a.Docusign)&&d}const uc=(0,ft.a)(async()=>(await Promise.all([n.e("ondemand.resx"),n.e(54)]).then(n.bind(n,841))).OneUpSigningRequestOrchestrator),fc=e=>!!e&&e.viewerVisiblity===Me.a.On,pc={oneUpStore:se.b,oneUpStateStore:Me.f,pageContext:z.a,pdfHelper:jt.b,identityDataSource:Gt.resourceKey,itemUrlHelper:$.c,platformDetection:ie.a},mc=(e,t)=>({item:n})=>{const{oneUpStore:a,oneUpStateStore:i,pageContext:r,pdfHelper:o,platformDetection:s,identityDataSource:c}=e,d=fc(i.currentAppState.annotationViewerState),l=i.currentAppState.viewerStates?.get(n.key)?.pdfViewerStates,u=`create_${t}RequestAction`,f=a.focusItem??n,p=It({item:f,appLevelPagecontext:e.pageContext,itemUrlHelper:e.itemUrlHelper,remoteWebPageContexts:e.oneUpStore.pageContexts});return{isAvailable:lc(t,f,r,d,l?.isPdfPasswordProtected||l?.isPdfMip,()=>!!f&&o.isMsPdfViewerAvailable(f),s.isMobile),id:u,onExecute:async()=>{i.updateESignDataState(u,{isCreateSidePanelActive:!1});const e=await c.getOAuthSessionToken({endPoint:Hn(r),apiQosName:"create3PESignRequestAction"}),n=await c.getSharePointToken({webAbsoluteUrl:r.webAbsoluteUrl,disallowSelfIssuedToken:!0,apiQosName:"create3PESignRequestAction"}),a={provider:t,item:{name:f.displayName,driveId:f.graph?.driveId,openUrl:f.openUrl,size:f.size,permissions:f.permissions,policies:{canDownload:p,isSigned:l?.isSigned}},sessionToken:{...e,correlationId:e.correlationId??Fn()},spSessionToken:{...n,correlationId:n.correlationId??Fn()}};return i.updateModalState(u,{showModal:!0,content:m.createElement(uc,{key:a.sessionToken.correlationId,...a})}),{resultType:ns.a.Success}}}},_c=new f.OJ({name:"create3PESignRequestAction",factory:{dependencies:pc,create:e=>({instance:{evaluateAction:mc(e,Pn.a.Adobe)}})}}),hc=new f.OJ({name:"create3PESignRequestAction",factory:{dependencies:pc,create:e=>({instance:{evaluateAction:mc(e,Pn.a.Docusign)}})}});var bc=n(377);const gc={oneUpStore:se.b,oneUpStateStore:Me.f,pageContext:z.a,platformDetection:ie.a,pdfHelper:jt.b},vc=e=>({item:t})=>{const{oneUpStateStore:n,oneUpStore:a,pageContext:i,platformDetection:r,pdfHelper:o}=e,s=fc(n.currentAppState.annotationViewerState),c=n.currentAppState.viewerStates?.get(t.key)?.pdfViewerStates,d={id:"toggleESignAction",isAvailable:dc(a.focusItem,i,s,c?.isPdfPasswordProtected||c?.isPdfMip,()=>!!a.focusItem&&o.isMsPdfViewerAvailable(a.focusItem),r.isMobile)&&Rn(i),isDisabled:Tn.k&&!c?.isOpened,onExecute:async()=>{const e=!n.currentAppState.eSignData?.isCreateSidePanelActive;return n.updateESignDataState("ToggleESign",{isCreateSidePanelActive:e}),e&&Tn.h&&(async(e,t,n)=>{try{const a=e.listId?e.listId.replace(/^\{|\}$/g,""):"",i=new bc.a({pageContext:e,getParentListId:()=>a,itemProvider:{invalidateItem:function(){}}}),r=await i.getSharingInformation(t),o=n.currentAppState.eSignData?.isCreateSidePanelActive;n.updateESignDataState("ToggleESign",{isCreateSidePanelActive:o,canAddExistingExternalUser:r.canAddExistingExternalPrincipal,canAddNewExternalUser:r.canAddExternalPrincipal})}catch(e){}})(i,t,n),{resultType:ns.a.Success}}};return d},yc={syntexSignActionProvider:new f.OJ({name:"createSyntexSignRequestAction",factory:{dependencies:gc,create:e=>({instance:{evaluateAction:vc(e)}})}}),adobeSignActionProvider:_c,docuSignActionProvider:hc,pageContext:z.a},Sc=new f.OJ({name:"ToggleESignCommand",factory:{dependencies:yc,create:({syntexSignActionProvider:e,adobeSignActionProvider:t,docuSignActionProvider:n,pageContext:a})=>{const i=function(e){const{isSyntexESignatureEnabled:t,syntexEsignatureThirdPartyEnabledProviders:n}=e,a=t?[Un]:[],i=n?.filter(e=>e===Pn.b.Adobe||e===Pn.b.Docusign)||[];return a.concat(i)}(a),r=[{id:"GetSyntexSignatures",name:ct.P,title:ct.Q,automationId:"GetSyntexSignatures",groupHeader:ct.E,iconProps:{imageProps:{src:ac.a}},evaluateAction:e.evaluateAction},{id:"GetAdobeSignatures",name:ct.J,title:ct.K,automationId:"GetAdobeSignatures",groupHeader:ct.E,iconProps:{imageProps:{src:ic.a}},evaluateAction:t.evaluateAction},{id:"GetDocusignSignatures",name:ct.L,title:ct.M,automationId:"GetDocusignSignatures",groupHeader:ct.E,iconProps:{imageProps:{src:rc.a}},evaluateAction:n.evaluateAction}],o=window.matchMedia&&window.matchMedia("(-ms-high-contrast: active)").matches||window.matchMedia&&window.matchMedia("(forced-colors: active)").matches,s=i.length>1,{commandName:c,commandTitle:d}=function(e){return 1!==e.length?{commandName:ct.N,commandTitle:ct.O}:{[Un]:{commandName:ct.P,commandTitle:ct.Q},[Pn.b.Adobe]:{commandName:ct.J,commandTitle:ct.K},[Pn.b.Docusign]:{commandName:ct.L,commandTitle:ct.M}}[e[0]]}(i);return{instance:{id:"GetSignatures",name:c,title:d,automationId:"GetSignatures",iconProps:{imageProps:{src:o?sc.a:oc.a}},evaluateAction:{[Un]:e.evaluateAction,[Pn.b.Adobe]:t.evaluateAction,[Pn.b.Docusign]:n.evaluateAction}[i[0]]||e.evaluateAction,subCommands:s?r:[],buttonStyles:s?{root:{".ms-Icon":{margin:"0 2px"}},flexContainer:{padding:"0 6px"}}:void 0}}}}});var Dc=n(72);const Ic={actionProvider:(0,Te.jb)({ODB:61495})&&!Dc.l?.isAnonymousGuestUser?Qn:ot},xc="printCommand",Cc=new f.OJ({name:"PrintCommand",factory:{dependencies:Ic,create:({actionProvider:e})=>({instance:{id:xc,name:ct.Sb,title:ct.Db,automationId:xc,iconProps:{iconName:"Print"},evaluateAction:e.evaluateAction,properties:{"aria-label":`${ct.Db}, ${ct.Xb}`}}})}});var Oc=n(692),wc=n(693);const Ec={oneUpStateStore:Me.f},Ac=new f.OJ({name:"OutlineAction",factory:{dependencies:Ec,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{oneUpStateStore:n}=t,a=n.currentAppState.viewerStates?.get(e.item.key)?.pdfViewerStates,i=a?.outlineVisibility,r=n.currentAppState.annotationViewerState;return{isAvailable:!!i,id:"PdfOutline",isDisabled:!a?.isOpened,onExecute:async()=>{n.updateViewerState("outlineActionUpdateIsOutlineVisible",{key:e.item.key,options:{pdfViewerStates:{outlineVisibility:i===qe.b.Hidden?qe.b.Focus:qe.b.Hidden}}}),i===qe.b.Hidden&&r?.isActive&&n.toggleAnnotationViewerVisiblity("outlineActionHideAnnotationViewer")}}})}}}}});var Lc=n(131);const kc={actionProvider:Ac,oneUpStateStore:Me.f},Mc="pdfOutlineCommand",Pc=new f.OJ({name:"PdfOutlineCommand",factory:{dependencies:kc,create:({actionProvider:e,oneUpStateStore:t})=>((0,Lc.d)(),{instance:{id:Mc,automationId:Mc,title:ct.vb,name:ct.yb,evaluateIconProps:e=>t.currentAppState.viewerStates?.get(e.key)?.pdfViewerStates?.outlineVisibility===qe.b.Hidden?{iconName:"TextBulletListSquare"}:{iconName:"TextBulletListSquareFill"},evaluateAction:e.evaluateAction}})}}),Tc={getExecutor:Pr.async.lazy,oneUpStateStore:Me.f},Uc={actionProvider:new f.OJ({name:"onClickVersionHistoryAction",factory:{dependencies:Tc,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>({isAvailable:gt.a||!(0,bt.c)(e.item.extension),id:"openVersionHistoryAction",onExecute:async()=>{if(t.oneUpStateStore.currentAppState.rightPane.type!==Me.e.versionHistory)return(await t.getExecutor()).executeOpenVersionHistory({item:e.item});t.oneUpStateStore.updateRightPaneState("closeVersionHistory",{type:Me.e.none})}}))}}}}})},Fc="VersionHistoryCommand",Hc=new f.OJ({name:"VersionHistoryCommand",factory:{dependencies:Uc,create:({actionProvider:e})=>({instance:{id:Fc,name:ct.Nb,title:ct.Bb,ariaLabel:ct.Nb+", "+ct.Bb,properties:{"aria-label":`${ct.Nb}, ${ct.Bb}`},automationId:Fc,iconProps:{iconName:"StackIndicator"},evaluateAction:e.evaluateAction}})}}),Rc=new f.OJ({name:"EmbedDialogExecutor.key",loader:new f.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(15)]).then(n.bind(n,842)).then(e=>e.embedDialogExecutorKey))}),Nc="EmbedAction",Bc={pageContext:z.a,oneUpStore:se.b,navigation:K.a,resources:f.sp,platform:ie.a,oneUpStateStore:Me.f,getExecutor:Rc.async.lazy,getValidViewerTypesFromResource:Ce.c},jc={actionProvider:new f.OJ({name:"EmbedAction",factory:{dependencies:Bc,create:e=>{return{instance:{evaluateAction:(t=e,e=>{const n=function(e,t){return!(!e||5===e.queryType||13===e.queryType||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected||e&&e.type===dt.a.Folder||t.getValidViewerTypesFromResource.getValidViewerTypes(e)===Ce.a.Copilot)}(e.item,t),a=t.oneUpStore.getOneUpProperties();return{isAvailable:n,id:Nc,onExecute:async()=>{const{focusItem:n,parentItem:i,focusItemSet:r,list:o}=a;if(a&&r&&r.length&&n&&i&&o){const n=await t.getExecutor();return await n.executeEmbedDialog({item:e.item}),{resultType:tt.b.Success}}{const e=(0,Ie.i)("no parent view/item");throw t.oneUpStateStore.updateErrorState(Nc,{errorType:Ie.d.actionError,error:e,item:n}),e}}}})}};var t}}})},Vc="embedCommand",zc=new f.OJ({name:"EmbedCommand",factory:{dependencies:jc,create:({actionProvider:e})=>({instance:{id:Vc,name:ct.C,title:ct.D,automationId:Vc,iconProps:{iconName:"Embed"},evaluateAction:e.evaluateAction}})}}),Gc={pageContext:z.a,navigation:K.a},Kc={actionProvider:new f.OJ({name:"ViewOriginalImageAction",factory:{dependencies:Gc,create:e=>{return{instance:{evaluateAction:(t=e,e=>{const n=function(e){const t=e.photo?.originalUrl;return t&&t.replace(/#/g,"%23")}(e.item);var a,i;return{isAvailable:!!n&&(a=e.item,!(i=t.pageContext).blockDownloadsExperienceEnabled&&!i.viewOnlyExperienceEnabled&&nt.b.hasItemPermission(a,nt.b.openItems)),id:"ViewOriginalImageAction",onExecute:async()=>n?(await t.navigation.navigateTo({url:n,frameId:"_blank"}),{resultType:tt.b.Success}):{resultType:tt.b.Failure}}})}};var t}}}),oneUpStore:se.b},Wc="viewOriginalImageCommand",qc=new f.OJ({name:"ViewOriginalImageCommand",factory:{dependencies:Kc,create:({actionProvider:e})=>({instance:{id:Wc,name:ct.jb,title:ct.jb,automationId:Wc,iconProps:{iconName:"Picture"},evaluateAction:e.evaluateAction,properties:{"aria-label":`${ct.jb}, ${ct.Xb}`}}})}}),Qc=new f.OJ({name:"RequestMoreAccessAction",factory:{dependencies:{},create:()=>({instance:{evaluateAction:()=>({isAvailable:!0,id:"RequestMoreAccessAction",onExecute:()=>{}})}})}}),Yc={actionProvider:n(385).a},Jc="editRequestMoreAccessCommand",Xc={actionProvider:Qc,editRequestMoreAccessCommand:new f.OJ({name:"EditRequestMoreAccessCommand",factory:{dependencies:Yc,create:({actionProvider:e})=>({instance:{id:Jc,name:ct.Ib,automationId:Jc,iconProps:{iconName:"Lock"},evaluateAction:e.evaluateAction}})}}),oneUpStore:se.b},Zc="requestMoreAccessCommand",$c=new f.OJ({name:"RequestMoreAccessCommand",factory:{dependencies:Xc,create:({oneUpStore:e,actionProvider:t,editRequestMoreAccessCommand:n})=>{const{label:a,icon:i}=(e=>{switch(e){case Zi.a.none:return{label:ct.W,icon:""};case Zi.a.review:return{label:ct.xb,icon:"Feedback"};case Zi.a.view:case Zi.a.restrictedview:return{label:ct.Vb,icon:"View"};default:return{label:ct.W,icon:""}}})((0,Xi.b)(e.focusItem?.permissions)),r={iconName:i};return{instance:{id:Zc,automationId:Zc,buttonStyles:(0,Os.a)(),iconProps:r,subCommands:[n],evaluateAction:t.evaluateAction,evaluateCommandName:()=>a}}}}});var ed=n(694);const td={oneUpStateStore:Me.f,resources:f.sp,oneUpStore:se.b,pageContext:z.a},nd=new f.OJ({name:"FeedbackAction",factory:{dependencies:td,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{resources:a,pageContext:i}=t;return{isAvailable:t.oneUpStateStore.currentAppState.isFeedbackEnabled||!1,id:"Feedback",isDisabled:!1,onExecute:async()=>{if(!i){const n=(0,Ie.i)("FeedbackAction: missing pagecontext");return t.oneUpStateStore.updateErrorState("feedbackAction.onExecute",{errorType:Ie.d.actionError,error:n,item:e.item}),{resultType:tt.b.Failure}}(await Promise.all([n.e("ondemand.resx"),n.e(48)]).then(n.bind(n,754))).showOneUpFeedback(e.item,a,i).then(()=>({resultType:tt.b.Success})).catch(n=>(t.oneUpStateStore.updateErrorState("feedbackAction.showOneUpFeedback",{errorType:Ie.d.actionError,error:n,item:e.item}),n instanceof f.a_&&n.isExpected?{resultType:tt.b.ExpectedFailure}:{resultType:tt.b.Failure}))}}})}}}}});let ad=!1;const id=()=>{ad||((0,d.fU)({icons:{QuestionCircleRegular:m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},m.createElement("g",{id:"Fluent-icon"},m.createElement("path",{id:"Shape",d:"M10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2ZM10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3ZM10 13.5C10.4142 13.5 10.75 13.8358 10.75 14.25C10.75 14.6642 10.4142 15 10 15C9.58579 15 9.25 14.6642 9.25 14.25C9.25 13.8358 9.58579 13.5 10 13.5ZM10 5.5C11.3807 5.5 12.5 6.61929 12.5 8C12.5 8.72959 12.1848 9.40774 11.6513 9.8771L11.4967 10.0024L11.2782 10.1655L11.1906 10.2372C11.1348 10.2851 11.0835 10.3337 11.0346 10.3859C10.6963 10.7464 10.5 11.2422 10.5 12C10.5 12.2761 10.2761 12.5 10 12.5C9.72386 12.5 9.5 12.2761 9.5 12C9.5 10.988 9.79312 10.2475 10.3054 9.70162C10.4165 9.5832 10.532 9.47988 10.6609 9.37874L10.9076 9.19439L11.0256 9.09468C11.325 8.81435 11.5 8.42206 11.5 8C11.5 7.17157 10.8284 6.5 10 6.5C9.17157 6.5 8.5 7.17157 8.5 8C8.5 8.27614 8.27614 8.5 8 8.5C7.72386 8.5 7.5 8.27614 7.5 8C7.5 6.61929 8.61929 5.5 10 5.5Z",fill:"#F3F2F1"}))),PersonFeedbackRegular:m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},m.createElement("g",{id:"Fluent-icon"},m.createElement("path",{id:"Shape",d:"M10.5 12C11.3284 12 12 12.6716 12 13.5V14C12 15.9714 10.1405 18 7 18C3.85951 18 2 15.9714 2 14V13.5C2 12.6716 2.67157 12 3.5 12H10.5ZM10.5 13H3.5C3.22386 13 3 13.2239 3 13.5V14C3 15.4376 4.43216 17 7 17C9.56784 17 11 15.4376 11 14V13.5C11 13.2239 10.7761 13 10.5 13ZM7 5.5C8.51878 5.5 9.75 6.73122 9.75 8.25C9.75 9.76878 8.51878 11 7 11C5.48122 11 4.25 9.76878 4.25 8.25C4.25 6.73122 5.48122 5.5 7 5.5ZM16 2C17.0544 2 17.9182 2.81588 17.9945 3.85074L18 4V6C18 7.05436 17.1841 7.91817 16.1493 7.99451L16 8H14.499L13.301 9.59979C12.7716 10.306 11.6965 10.0199 11.5243 9.22426L11.5066 9.11264L11.5008 9L11.5 7.935L11.4224 7.91532C10.697 7.69685 10.1452 7.07753 10.0246 6.3148L10.0055 6.14926L10 6V4C10 2.94564 10.8159 2.08183 11.8507 2.00549L12 2H16ZM7 6.5C6.0335 6.5 5.25 7.2835 5.25 8.25C5.25 9.2165 6.0335 10 7 10C7.9665 10 8.75 9.2165 8.75 8.25C8.75 7.2835 7.9665 6.5 7 6.5ZM16 3H12C11.4872 3 11.0645 3.38604 11.0067 3.88338L11 4V6C11 6.51284 11.386 6.93551 11.8834 6.99327L12 7H12.5008V9L14 7H16C16.5128 7 16.9355 6.61396 16.9933 6.11662L17 6V4C17 3.48716 16.614 3.06449 16.1166 3.00673L16 3Z",fill:"#F3F2F1"}))),LearningAppRegular:m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},m.createElement("g",{id:"Fluent-icon"},m.createElement("path",{id:"Shape",d:"M6 3H14C14.5523 3 15 3.44772 15 4V9.02242C15.3434 9.05337 15.6777 9.11588 16 9.20703V4C16 2.89543 15.1046 2 14 2H6C4.89543 2 4 2.89543 4 4V16C4 17.1046 4.89543 18 6 18H10.2572C10.0035 17.6929 9.78261 17.3578 9.59971 17H6C5.44772 17 5 16.5523 5 16H9.20703C9.11588 15.6777 9.05337 15.3434 9.02242 15H5V4C5 3.44772 5.44772 3 6 3ZM7 4C6.44772 4 6 4.44772 6 5V6C6 6.55228 6.44772 7 7 7H13C13.5523 7 14 6.55228 14 6V5C14 4.44772 13.5523 4 13 4H7ZM13 5V6H7V5H13ZM19 14.5C19 16.9853 16.9853 19 14.5 19C12.0147 19 10 16.9853 10 14.5C10 12.0147 12.0147 10 14.5 10C16.9853 10 19 12.0147 19 14.5ZM14.0203 12.534C13.9423 12.4811 13.8559 12.4546 13.7609 12.4546C13.6948 12.4546 13.6321 12.4687 13.5728 12.4969C13.5134 12.5234 13.4617 12.5596 13.4177 12.6054C13.3736 12.6513 13.338 12.7051 13.3108 12.7668C13.2854 12.8286 13.2727 12.8938 13.2727 12.9626V16.0374C13.2727 16.1045 13.2854 16.1689 13.3108 16.2306C13.338 16.2924 13.3736 16.347 13.4177 16.3947C13.4634 16.4405 13.516 16.4776 13.5753 16.5058C13.6346 16.5323 13.6965 16.5455 13.7609 16.5455C13.8101 16.5455 13.8559 16.5384 13.8983 16.5243C13.9423 16.5102 13.9856 16.489 14.028 16.4608L16.3242 14.8943C16.3937 14.8485 16.448 14.7867 16.4869 14.7091C16.5259 14.6315 16.5454 14.5503 16.5454 14.4656C16.5454 14.3774 16.5251 14.2963 16.4844 14.2222C16.4437 14.1463 16.3878 14.0855 16.3166 14.0396L14.0203 12.534Z",fill:"#F3F2F1"})))}}),ad=!0)},rd={actionProvider:nd},od="feedbackCommand",sd=new f.OJ({name:"FeedbackCommand",factory:{dependencies:rd,create:({actionProvider:e})=>(id(),{instance:{id:od,automationId:od,title:ct.H,name:ct.H,iconProps:{iconName:"PersonFeedbackRegular"},evaluateAction:e.evaluateAction}})}}),cd={oneUpStateStore:Me.f,getValidViewerTypesFromResource:Ce.c},dd={actionProvider:new f.OJ({name:"TutorialFreAction",factory:{dependencies:cd,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{oneUpStateStore:n,getValidViewerTypesFromResource:a}=t,i=a.getValidViewerTypes(e.item),r=n.currentAppState.isOneUpFreOpen,o=n.currentAppState.viewerStates?.get(e.item.key)?.pdfViewerStates;let s=r;return(0,Te.jb)(Te.wb)&&(s=!!r||i===Ce.a.MSPdf&&!o?.isOpened),{isAvailable:!0,id:"TutorialFre",isDisabled:s,onExecute:async()=>{r||t.oneUpStateStore.updateOneUpShellFreIsOpen("tutorialFreAction",!0)}}})}}}}})},ld="tutorialFreCommand",ud={feedbackCommand:sd,tutorialFreCommand:new f.OJ({name:"TutorialFreCommand",factory:{dependencies:dd,create:({actionProvider:e})=>(id(),{instance:{id:ld,automationId:ld,title:ct.Fb,name:ct.Fb,iconProps:{iconName:"LearningAppRegular"},evaluateAction:e.evaluateAction}})}})},fd="helpCommandGroup",pd=e=>({isAvailable:!0}),md=new f.OJ({name:"HelpGroupCommand",factory:{dependencies:ud,create:e=>{const{feedbackCommand:t,tutorialFreCommand:n}=e;return id(),{instance:{id:fd,name:ct.R,title:ct.R,automationId:fd,subCommands:[t,n],evaluateAction:pd,iconProps:{iconName:"QuestionCircleRegular"}}}}}});var _d=n(695);let hd=!1;var bd=n(386);const gd=({oneUpStore:e,oneUpStateStore:t,pageContext:n,resources:a,getExecutor:i})=>()=>{const r=(0,Xi.b)(e.focusItem?.permissions);var o;return{isAvailable:!n.isAnonymousGuestUser&&(o=r,o===Zi.a.restrictedview),id:"DownloadRequestAction",onExecute:async()=>{const o=e.getOneUpProperties();if(o&&r){const e=await i();await e.showRequestMoreAccessDialog({item:o.focusItem,pageContext:n,itemRole:r,requestRole:Zi.a.view,resources:a,onClose:()=>{t.updateModalState("downloadRequestCommand",{showModal:!1,content:void 0})},onRender:e=>{t.updateModalState("downloadRequestCommand",{showModal:!0,content:e})}})}}}},vd={oneUpStore:se.b,oneUpStateStore:Me.f,pageContext:z.a,resources:f.sp,getExecutor:bd.a.async.lazy},yd=new f.OJ({name:"DownloadRequestAction",factory:{dependencies:vd,create:e=>({instance:{evaluateAction:gd(e)}})}});var Sd=n(696);const Dd={actionProvider:yd},Id="downloadRequestMoreAccessCommand",xd=({onClick:e,dismissMenu:t})=>{const n=(0,d.kF)(),a=m.useCallback(()=>{e(),t(void 0,!0)},[]),i=m.useCallback(()=>{t(void 0,!0)},[]);return m.createElement("div",{id:"RequestDownload-container",style:{display:"flex",flexDirection:"row",padding:"8px",backgroundColor:"#292827"}},m.createElement(Di.a,{iconName:"InfoSolid",styles:{root:{paddingRight:"8px",paddingTop:"8px",color:"white"}}}),m.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:"20px",paddingTop:"5px"}},m.createElement("div",{id:"RequestDownload-title",style:{fontWeight:600,color:"white"}},ct.y),m.createElement("div",null,m.createElement(Sd.a,{id:"RequestDownload-button",styles:{root:{padding:"7px 0px",height:"auto",color:"#2899F5"},rootHovered:{textDecoration:"underline"},label:{margin:"0"}},onClick:a,ariaLabel:`${ct.y} ${ct.Ib}`},ct.Ib))),m.createElement(ia.a,{id:"RequestDownload-cancel",onClick:i,iconProps:{iconName:"Cancel"},styles:{root:{color:n.palette.white}},ariaLabel:ct.h}))},Cd=new f.OJ({name:"DownloadRequestCommand",factory:{dependencies:Dd,create:({actionProvider:e})=>({instance:{id:Id,name:ct.w,automationId:Id,iconProps:{iconName:"Feedback"},contextualMenuStyles:{title:{},root:{backgroundColor:"#292827"},list:{padding:"0"},header:{},container:{},subComponentStyles:{menuItem:{},callout:{calloutMain:{backgroundColor:"#292827"}}}},evaluateAction:e.evaluateAction,evaluateRenderMenuList:e=>(t,n)=>m.createElement(xd,{onClick:e,item:t,dismissMenu:n})}})}}),Od={blockDownloadActionProvider:new f.OJ({name:"BlockDownloadAction",factory:{dependencies:{},create:()=>({instance:{evaluateAction:()=>({isAvailable:!0,id:"BlockDownloadAction",onExecute:()=>{}})}})}}),downloadRequestMoreAccessCommand:Cd},wd="blockDownloadCommand",Ed=new f.OJ({name:"BlockDownloadCommand",factory:{dependencies:Od,create:({blockDownloadActionProvider:e,downloadRequestMoreAccessCommand:t})=>{const n={id:wd,name:ct.f,title:ct.g,automationId:wd,subCommands:[t],buttonStyles:{menuIcon:{display:"none"}},iconProps:{iconName:"BlockDownload"},evaluateAction:e.evaluateAction};return hd||((0,d.fU)({icons:{BlockDownload:m.createElement("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"M3.28034 2.21968C2.98745 1.92678 2.51257 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98743 2.21966 3.28032L10.9993 12.0602L10.999 16.4329L7.27997 12.7192L7.1958 12.6467C6.90204 12.429 6.48539 12.4535 6.21931 12.72C5.92661 13.0131 5.92694 13.4879 6.22003 13.7806L11.2235 18.7772L11.3076 18.8498C11.6012 19.0673 12.0176 19.043 12.2837 18.7769L15.0001 16.0611L20.7194 21.7805C21.0123 22.0734 21.4872 22.0734 21.7801 21.7805C22.073 21.4876 22.073 21.0127 21.7801 20.7198L3.28034 2.21968ZM13.9393 15.0002L12.499 16.4399L12.4992 13.5601L13.9393 15.0002ZM17.1218 13.9399L16.0611 12.8792L16.2208 12.7196C16.4871 12.4533 16.9038 12.4291 17.1974 12.647L17.2815 12.7197C17.5477 12.986 17.5719 13.4026 17.354 13.6962L17.2814 13.7803L17.1218 13.9399ZM10.9996 7.81764L12.4995 9.31756L12.5 2.75488L12.4932 2.65311C12.4435 2.28704 12.1297 2.00488 11.75 2.00488L11.6482 2.01173C11.2822 2.06139 11 2.37519 11 2.75488L10.9996 7.81764ZM18.2498 20.4999C18.664 20.4998 19 20.8355 19 21.2497C19 21.6639 18.6644 21.9998 18.2502 21.9999L5.25022 22.0037C4.836 22.0038 4.5 21.6681 4.5 21.2539C4.5 20.8397 4.83557 20.5038 5.24978 20.5037L18.2498 20.4999Z",fill:"currentColor"}))}}),hd=!0),{instance:n}}}}),Ad="EditInAppAction",Ld={oneUpStore:se.b,platform:ie.a,oneUpStateStore:Me.f,itemUrlHelper:$.c,getValidViewerTypesFromResource:Ce.c,resources:f.sp,getExecutor:ys.async.lazy},kd={actionProvider:new f.OJ({name:"EditInAppAction",factory:{dependencies:Ld,create:e=>{return{instance:{evaluateAction:(t=e,e=>{const n=function(e,t,n){if(!(t.isWindows||t.isMac||(0,yn.d)()&&(t.isWinPhone||t.isAndroid||t.isIOS))||!e)return!1;if(n===Ce.a.Copilot)return!1;const a=!!nt.a.hasItemPermission(e,nt.a.openItems);return(n===Ce.a.MSPdf||n===Ce.a.Pdf||n===Ce.a.Photo)&&a&&!e.appMap&&nt.a.hasItemPermission(e,nt.a.insertListItems)&&nt.a.hasItemPermission(e,nt.a.editListItems)}(e.item,t.platform,t.getValidViewerTypesFromResource.getValidViewerTypes(e.item)),a=t.oneUpStore.getOneUpProperties();return{isAvailable:n,id:Ad,onExecute:async()=>{const{focusItem:e,parentItem:n,focusItemSet:i}=a;if(a&&i&&i.length&&e&&n){const n=await t.getExecutor();return await n.executeOpenInApp({item:e,pageContexts:a.pageContexts,resources:t.resources}),{resultType:tt.b.Success}}{const n=(0,Ie.i)("no parent view/item");throw t.oneUpStateStore.updateErrorState(Ad,{errorType:Ie.d.actionError,error:n,item:e}),n}}}})}};var t}}}),oneUpStore:se.b},Md="EditInAppCommand",Pd=new f.OJ({name:"EditInAppCommand",factory:{dependencies:kd,create:e=>({instance:{id:Md,name:ct._,title:ct._,automationId:Md,iconProps:{iconName:"OpenInNewWindow"},evaluateAction:e.actionProvider.evaluateAction}})}}),Td=new f.OJ({name:"isImageEditableInOneUp.key",factory:new f.Rn(()=>!0)}),Ud={oneUpStateStore:Me.f,getValidViewerTypesFromResource:Ce.c,pdfViewerHelper:jt.b,isImageEditable:Td},Fd={editInClipchampCommand:bs,editInAppCommand:Pd,actionProvider:new f.OJ({name:"EditAction",factory:{dependencies:Ud,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{getValidViewerTypes:n}=t.getValidViewerTypesFromResource,a=n(e.item),i=t.oneUpStateStore.currentAppState.deletedKeys?.has(e.item.key);let r=a===Ce.a.Photo&&nt.a.hasItemPermission(e.item,nt.a.editListItems)&&t.isImageEditable()&&!i;const o=t.oneUpStateStore.currentAppState,s=o.eSignData?.isCreateSidePanelActive||o.annotationViewerState?.isActive;if(a===Ce.a.MSPdf){const n=o.viewerStates?.get(e.item.key)?.pdfViewerStates;r=t.pdfViewerHelper.isPdfEditAvailable(e.item)&&t.pdfViewerHelper.isPdfEditable(e.item)&&!n?.isPdfMip&&!s&&!!n?.isOpened&&(n?.isAnnotAllowed??!0)}return{isAvailable:r,id:"EditAction",onExecute:async()=>{t.oneUpStateStore.currentAppState.rightPane.type!==Me.e.none&&t.oneUpStateStore.updateRightPaneState("closeRightPane",{type:Me.e.none,content:void 0}),a===Ce.a.MSPdf?t.oneUpStateStore.updatePdfState("updatePdfAppMode",qe.a.Edit):t.oneUpStateStore.updateImageState("openImageEditor",Me.c.edit)}}})}}}}})},Hd="editSplitCommand",Rd=f.Ov.isActivated("cf60fb7c-d5d8-4232-9286-0ee6464b542a","07/11/2024","Refine style of the edit split button when no subcommands are available"),Nd={splitButtonMenuButton:{width:"24px !important"},label:{textOverflow:"ellipsis",overflow:"hidden"},flexContainer:{padding:"0px 8px !important"}},Bd=new f.OJ({name:"EditSplitCommand",factory:{dependencies:Fd,create:e=>{const{editInClipchampCommand:t,editInAppCommand:n,actionProvider:a}=e,i=[t,n];return{instance:{id:Hd,name:ct.z,automationId:Hd,subCommands:i,evaluateAction:a.evaluateAction,isSplit:!0,splitButtonAriaLabel:ct.B,title:ct.z,...Rd?{buttonStyles:Nd}:{evaluateButtonStyles:e=>i.some(t=>t.evaluateAction({item:e}).isAvailable)?Nd:(0,Os.a)()},iconProps:{iconName:"Edit"},properties:{"aria-roledescription":ct.Pb}}}}}}),jd=new f.OJ({name:"SyntexTranslateExecutor.key",loader:new f.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(73)]).then(n.bind(n,844)).then(e=>e.translateActionExecutorKey))});var Vd=n(698);const zd=f.Ov.isActivated("0b19576b-e1ee-476a-9abd-e85702207850","09/19/2024","Enabling translation command in Syntex Content Center Libraries"),Gd={oneUpStateStore:Me.f,getExecutor:jd.async.lazy,oneUpStore:se.b,pageContext:z.a},Kd=e=>t=>{const{pageContext:n}=e,a=e.oneUpStore.getOneUpProperties()?.focusItem,i=a?.extension??"";let r=!1;const o=n?.listBaseTemplate===cs.a.documentLibrary,s=n?.listBaseTemplate===cs.a.contentCenterPrimeLibrary||n?.listBaseTemplate===cs.a.contentCenterSampleLibrary;Number(n?.webTemplate)===kn.b.mySite?r=!!n?.isSyntexPAYGEnabled&&!!n?.isODBSyntexTranslationEnabled&&(0,Te.jb)(Te.U)&&(0,Vd.a)(i):(o||!zd&&s)&&(r=!!n?.isSyntexPAYGEnabled&&!!n?.isSyntexTranslationEnabled&&(0,Te.jb)(Te.U)&&(0,Vd.a)(i));const c=n?.listPermsMask,d=!!c&&nt.b.hasPermission(c,nt.b.manageLists);return{isAvailable:r&&d,id:"syntexTranslateAction",onExecute:async()=>{if(a){const t={item:a,pageContext:n,isSPDocLib:o||s,onRender:t=>{e.oneUpStateStore.updateModalState("syntexTranslateCommand",{showModal:!0,content:t})},onClose:()=>{e.oneUpStateStore.updateModalState("syntexTranslateCommand",{showModal:!1,content:void 0})}};try{const n=await e.getExecutor();return await n.showTranslationDialog(t),{resultType:ns.a.Success}}catch(e){return{resultType:ns.a.Failure,exception:e}}}}}},Wd={actionProvider:new f.OJ({name:"SyntexTranslateAction",factory:{dependencies:Gd,create:e=>({instance:{evaluateAction:Kd(e)}})}})},qd="syntexTranslateCommand",Qd=new f.OJ({name:"SyntexTranslateCommand",factory:{dependencies:Wd,create:({actionProvider:e})=>({instance:{id:qd,name:ct.Tb,title:ct.Ub,automationId:qd,iconProps:{iconName:"MicrosoftTranslatorLogo"},evaluateAction:e.evaluateAction}})}}),Yd=!f.Ov.isActivated("e4f01914-f051-4eb2-8366-597bdb8113f3"),Jd={openInfoPaneActionAsync:kr.async,oneUpStateStore:Me.f},Xd={actionProvider:new f.OJ({name:"OnClickInfoButtonAction",factory:{dependencies:Jd,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>({isAvailable:!0,id:"onClickInfoButtonAction",onExecute:async()=>{if(t.oneUpStateStore.currentAppState.rightPane.type===Me.e.detailPane)t.oneUpStateStore.updateRightPaneState("onClickInfoButton",{type:Me.e.none});else{const n=(await t.openInfoPaneActionAsync()).evaluateAction({item:e.item});if(!n.isAvailable||!n.onExecute)throw new Error("openInfoPaneAction is not available");await n.onExecute({qosEvent:new tt.a({name:"openInfoPane"})})}}}))}}}}})},Zd="InfoPaneCommand",$d=new f.OJ({name:"InfoPaneCommand",factory:{dependencies:Xd,create:({actionProvider:e})=>({instance:{id:Zd,name:ct.U,title:ct.V,ariaLabel:ct.U+", "+ct.V,properties:{"aria-label":`${ct.U}, ${ct.V}`},automationId:Zd,iconProps:{iconName:"Info"},evaluateAction:e.evaluateAction}})}});var el=n(699);const tl={openAboutThisCopilotPaneActionAsync:Mr.async,oneUpStateStore:Me.f},nl={actionProvider:new f.OJ({name:"OnClickAboutThisCopilotButtonAction",factory:{dependencies:tl,create:e=>{var t;return{instance:{evaluateAction:(t=e,({item:e})=>{const n=e.extension||"";return{isAvailable:(0,el.a)(n),id:"onClickAboutThisCopilotButtonAction",onExecute:async()=>{if(t.oneUpStateStore.currentAppState.rightPane.type===Me.e.copilotDetailPane)t.oneUpStateStore.updateRightPaneState("onClickAboutThisCopilotButton",{type:Me.e.none});else{const n=(await t.openAboutThisCopilotPaneActionAsync()).evaluateAction({item:e});if(!n.isAvailable||!n.onExecute)throw new Error("openAboutThisCopilotPaneAction is not available");await n.onExecute({qosEvent:new tt.a({name:"openAboutThisCopilotPane"})})}}}})}}}}})},al="AboutThisCopilotPaneCommand",il=new f.OJ({name:"AboutThisCopilotPaneCommand",factory:{dependencies:nl,create:({actionProvider:e})=>({instance:{id:al,name:ct.a,title:ct.b,ariaLabel:ct.a+", "+ct.b,properties:{"aria-label":`${ct.a}, ${ct.b}`},automationId:al,evaluateAction:e.evaluateAction,iconProps:{iconName:"info"}}})}});var rl=n(366);const ol=()=>{const e=Bn.b,{palette:t,semanticColors:n}=e,a=`${n.buttonBackground} !important`,i={background:(0,Te.uc)()?a:"transparent !important",padding:"0px",margin:"4px 2px",color:t.black,height:"32px",width:"auto",border:"none",".ms-Button-menuIcon":{marginTop:"2px",color:t.black},".ms-Button-flexContainer":{backgroundColor:"transparent !important",alignItems:"center",justifyContent:"center",padding:"0px 4px"}};return(0,rl.a)(i)},sl={openInfoPaneCommand:$d,openAboutThisCopilotPaneCommand:il},cl="infoPaneCommandGroup",dl=e=>({isAvailable:!0}),ll=new f.OJ({name:"InfoGroupCommand",factory:{dependencies:sl,create:e=>{const{openInfoPaneCommand:t,openAboutThisCopilotPaneCommand:n}=e;return{instance:{id:cl,name:ct.U,title:ct.V,ariaLabel:ct.U+", "+ct.V,properties:{"aria-label":`${ct.U}, ${ct.V}`},automationId:cl,iconProps:{iconName:"Info"},evaluateAction:dl,isFlatten:!0,subCommands:[n,t],buttonStyles:ol()}}}}});var ul=n(700),fl=n(701);const pl=!f.Ov.isActivated("e716b6d4-f575-4940-bc25-37eee28d93a","04/15/2024","Display translate command in 1-up viewer"),ml={oneUpStore:se.b,oneUpStateStore:Me.f,pageContext:z.a,dividerCommand:jr,infoPaneGroupCommand:ll,closeCommand:Jr,downloadCommand:Ot,favoriteCommand:po,blockDownloadCommand:Ed,openGroupCommand:As,editSplitCommand:Bd,saveCommand:Ls.saveCommandKey,copyToCommand:Bs,deleteCommand:qs,annotateCommand:Js,commentsCommand:nc,toggleESignCommand:Sc,printCommand:Cc,pdfExtractCommand:Oc.a,pdfMergeCommand:wc.a,pdfEncryptCommand:ul.a,pdfOutlineCommand:Pc,pdfCompressCommand:fl.a,openVersionHistoryCommand:Hc,embedCommand:zc,viewOriginalImageCommand:qc,openCopilotPaneCommand:ji.a,requestMoreAccessCommand:$c,presenceCommand:ed.a,shareGroupCommand:_d.a,translateCommand:Qd,helpCommandGroup:md},_l=new f.OJ({name:"GenerateOneUpCommandBarWorkingSet",factory:{dependencies:ml,create:e=>{const{oneUpStore:t,oneUpStateStore:n,pageContext:a,dividerCommand:i,infoPaneGroupCommand:r,closeCommand:o,downloadCommand:s,favoriteCommand:c,blockDownloadCommand:d,openGroupCommand:l,editSplitCommand:u,saveCommand:f,copyToCommand:p,deleteCommand:m,annotateCommand:_,commentsCommand:h,printCommand:b,toggleESignCommand:g,pdfExtractCommand:v,pdfMergeCommand:y,pdfEncryptCommand:S,pdfOutlineCommand:D,pdfCompressCommand:I,openVersionHistoryCommand:x,embedCommand:C,viewOriginalImageCommand:O,openCopilotPaneCommand:w,requestMoreAccessCommand:E,presenceCommand:A,shareGroupCommand:L,translateCommand:k,helpCommandGroup:M}=e;return{instance:{generateWorkingSets:function(){return{main:this.generateMainWorkingSet(),far:this.generateFarWorkingSet(),overflow:this.generateOverflowWorkingSet()}},generateMainWorkingSet:function(){const e=[],a=!(!n.currentAppState.deletedKeys||!n.currentAppState.deletedKeys.get(t.focusItem?.key||""));return n.currentAppState.isPublishToWebNavIdSet||a||((0,Te.jb)(Te.J)?e.push(f,D,i,s):e.push(f,s),e.push(c),(0,Ir.d)()&&e.push(d),e.push(m,i,_,g,v,y,S,I,r)),e},generateOverflowWorkingSet:function(){const e=[],a=!(!n.currentAppState.deletedKeys||!n.currentAppState.deletedKeys.get(t.focusItem?.key||""));return n.currentAppState.isPublishToWebNavIdSet||a||(pl&&e.push(k),e.push(p,b,O,C,x),(0,Te.jb)(Te.yb)&&e.push(M)),e},generateFarWorkingSet:function(){const e=[],i=!(!n.currentAppState.deletedKeys||!n.currentAppState.deletedKeys.get(t.focusItem?.key||""));if(!n.currentAppState.isPublishToWebNavIdSet)if(i)e.push(o);else{const{hidePeoplePreviewingFiles:t}=a;(!Yd||!t&&!n.state.currentState.siteHidePeoplePreviewingFiles)&&(0,Te.jb)(Te.j)&&e.push(A),(0,Te.jb)(Te.z)&&e.push(h),(0,Ir.c)(a)||e.push(w),(0,Ir.d)()&&e.push(E),e.push(l(),u,L,o)}return e}}}}}}),hl={generateOneUpCommandBarWorkingSet:_l},bl=new f.OJ({name:"FileHandlerCommandsWorkingSetOverrideFunc",factory:{dependencies:hl,create:e=>({instance:{read:()=>()=>e.generateOneUpCommandBarWorkingSet.generateWorkingSets()}})}}),gl={oneUpStore:se.b,generateOneUpCommandBarWorkingSet:_l,fileHandlerCommandWorkingSetOverrideFunc:bl},vl=new f.OJ({name:"OneUpCommandBarManager",factory:{dependencies:gl,create:e=>{const t=e.generateOneUpCommandBarWorkingSet.generateWorkingSets(),n=e.oneUpStore.focusItem?new Wr({item:e.oneUpStore.focusItem,showCommands:!0,workingSet:t}):void 0;return(0,Te.Sb)()&&n?.addWorkingSetOverride(e.fileHandlerCommandWorkingSetOverrideFunc),{instance:n,disposable:n}}}});var yl=n(707),Sl=n(702);(0,d.ZW)([{rawString:".OneUpNonInteractiveCommandWrapper_d7f8e809{justify-content:center;align-items:center;line-height:40px;font-size:16px;display:flex;flex-wrap:nowrap}.OneUpNonInteractiveCommandSpan_d7f8e809{display:contents;justify-content:center;align-items:center}.OneUpNonInteractiveCommand_d7f8e809{cursor:default;color:"},{theme:"black",defaultValue:"#000"},{rawString:";vertical-align:top;line-height:40px}.OneUpNonInteractiveCommandNewDesign_d7f8e809{cursor:default;color:#fff;vertical-align:top;line-height:40px}.OneUpNonInteractiveIconNewDesign_d7f8e809{margin:0 4px;color:#fff}.OneUpNonInteractiveTitleIcon_d7f8e809{margin:0 6px}"}]);const Dl="OneUpNonInteractiveCommandWrapper_d7f8e809",Il=({icon:e})=>{const t=(0,pa.a)();return(0,Lc.b)(),_().createElement(ra.a,{content:ct.fb},_().createElement(Di.a,{style:{color:t.semanticColors.messageText,margin:"8px"},iconName:"lock"===e?"PdfEncryptLock":"PdfEncryptUnlock"}))},xl=()=>e=>_().createElement("div",{className:Dl,role:"menuitem",id:e.id,"aria-label":e.ariaLabel,tabIndex:-1,"aria-disabled":!0},e.iconProps?.iconName?_().createElement("span",{className:"OneUpNonInteractiveCommandSpan_d7f8e809"},_().createElement(Di.a,{className:"OneUpNonInteractiveIconNewDesign_d7f8e809",iconName:e.iconProps.iconName})):_().createElement(_().Fragment,null));var Cl=n(88),Ol=n(372),wl=n(234);const El=f.Ov.isActivated("675a5397-4561-4df2-a9d8-cb730d9c9b88"),Al=f.Ov.isActivated("f40289e8-e08d-43e8-b00b-47201fb0c49e"),Ll=!f.Ov.isActivated("3ABC5518-5FF8-4C10-BE93-F6A2D40DB92B"),kl=f.Ov.isActivated("fed7ca62-8042-44fa-b153-8d99d0e75d25");function Ml(e,t="none",a,i,r,o){let s=r?e.name:e.displayName,c=!1;if(s)if(El)s.length>23&&(s=s?.replace(/(.{21}).+(\..+)/,"$1...$2"),c=!0);else{const e=Array.from(s);if(e&&e.length>23){const t=Math.floor(11.5);s=`${e.slice(0,t).join("")}...${e.slice(e.length-t).join("")}`,c=!0}}if(!Al&&(0,Te.jb)({ODB:62312})&&!r&&!o&&(gt.a||!(0,bt.c)(e.extension))){const r=(0,ft.a)(async()=>(await Promise.all([n.e("ondemand.resx"),n.e(52)]).then(n.bind(n,833))).OneUpRename);return{key:"title",id:"titleCommand",title:c?e.displayName:void 0,iconProps:{iconName:e.iconName},onRender:()=>m.createElement("div",{style:{paddingBottom:"0px",marginInline:"60px",display:"flex",alignItems:"center"}},m.createElement(r,{item:e,engagementContext:a,activeViewer:i}),"none"!==t&&m.createElement(Il,{icon:t})),data:{automationid:"titleCommand"}}}return{key:"title",id:"titleCommand",text:s,title:c?e.displayName:void 0,iconProps:r?{}:{iconName:e.iconName},icon:t,commandBarButtonAs:e=>{const t=_().createElement(Sl.a,{className:(0,d.ZK)("OneUpNonInteractiveCommandNewDesign_d7f8e809","OneUpCommandBarTitle")},e.text),n="OneUpNonInteractiveTitleIcon_d7f8e809";return _().createElement("div",{className:(0,d.ZK)(Dl,"OneUpCommandBarTitleWrapper"),style:"none"!==e.icon?{transform:"translateX(13px)"}:void 0,role:"menuitem"},_().useMemo(()=>e.iconProps?.iconName?_().createElement(ga,{iconName:e.iconProps.iconName,desiredSize:17,iconSize:32,fileExtention:"svg",className:n,iconFieldAriaLabel:ct.nc}):_().createElement(_().Fragment,null),[n,e.iconProps?.iconName]),e.title?_().createElement(ra.a,{content:e.title},t):t,"none"!==e.icon&&_().createElement(Il,{icon:e.icon}))},data:{automationid:"titleCommand"}}}function Pl(e){const{command:t,onClickQos:n,onClickCustomerPromise:a,computeVeto:i}=e;if(t.action.onExecute){const e=t.action.onExecute({qosEvent:n});e&&e.then(e=>{const t=e||{resultType:tt.b.Success};n.end(t),a?.end(t)}).catch(e=>{const r=new f.a_({code:"OneUpCommandException",innerError:e,extraData:{commandId:t.id}}),o=(0,En.a)(r);n.end(o),a&&Nl(r,a,o,i)})}else{const e=new f.a_({code:"NoAvailableAction",extraData:{commandId:t.id}});n.end((0,En.a)(e)),a?.end((0,En.a)(e))}}function Tl(e,t,n,a){const{startSchema:i,computeVeto:r}=e.action.customerPromise||{},o=`OneUpLightSpeed.commandInvoked.${e.id}`,s=new tt.a({name:o,extraData:{extention:t.extension,viewer:t.viewer,...n}}),c=new vn.a({scenario:o,perfGoalInMs:Ie.b,...i||{},extraData:{extention:t.extension,viewer:t.viewer,...i?.extraData||{},...n}});t.commandName=e?.id||e?.name||e?.title||"UnknownCmdBar",(0,Ei.g)(`${Ei.c}.${Ei.a}`,t);const d={command:e,onClickQos:s,onClickCustomerPromise:c,computeVeto:r,fallbackErrorMsg:"Unhandled exception executing an action"};try{"CloseAction"===e.action.id&&e.action.isAvailable&&a?a().then(()=>{Pl(d)}).catch(()=>{}):Pl(d)}catch(e){const t=new f.a_({code:"commandExecutionError",innerError:e}),n=(0,En.a)(t);s.end(n),c&&Nl(t,c,n,r)}}function Ul(e,t,n,a){const i=[];if(e&&e.length>0)for(let r=0;r<e.length;r++){const o=!!a||!e[r].name,s=!!(e[r].isSplit&&e[r].subCommands&&e[r].subCommands?.length)||void 0,c={key:e[r].id,id:e[r].id,iconOnly:o,iconProps:e[r].iconProps,text:e[r].name,title:o?void 0:e[r].title,disabled:e[r].action.isDisabled,onRender:e[r].onRender,onClick:()=>Tl(e[r],t,e[r]?.extraData,n),buttonStyles:e[r].buttonStyles,split:s,splitButtonAriaLabel:e[r].splitButtonAriaLabel,"data-automation-id":e[r].automationId||e[r].action.id,ariaLabel:e[r].properties?.["aria-label"]||e[r].title||e[r].name,data:{automationid:e[r].automationId||e[r].action.id,"aria-label":e[r].properties?.["aria-label"]||e[r].title||e[r].name},tooltipHostProps:{content:e[r].title||e[r].name},...e[r]?.properties};c.iconProps={...c.iconProps,style:{...c.iconProps?.style,color:"inherit"}};const d=e[r].subCommands;if(d&&d.length>0){const n=Fl(d,t);if(Ll&&e[r].isFlatten&&1===d.length){const e=n.items[0];c.onClick=e.onClick}else c.subMenuProps=n}i.push(c)}return i}function Fl(e,t){const n=[];let a,i;const r={};for(let o=0;o<e.length;o++){const s={key:e[o].id,iconProps:e[o].iconProps,text:e[o].name,title:e[o].title,disabled:e[o].action.isDisabled,onRender:e[o].onRender,onClick:()=>Tl(e[o],t,e[o]?.extraData),"data-automation-id":e[o].automationId||e[o].action.id,ariaLabel:e[o].properties?.["aria-label"]||e[o].title||e[o].name},c=e[o].evaluateRenderMenuList;c&&(s.onRender=c(()=>Tl(e[o],t,e[o]?.extraData))),a=e[o].contextualMenuStyles,i=e[o].groupHeader,i&&!r[i]&&(n.push({key:i,itemType:2,text:i}),r[i]=!0),n.push(s)}return{items:n,styles:a,ariaLabel:i}}function Hl(e,t){if(e.renderedInOverflow||t<1)return m.createElement(m.Fragment,null);{const t=Ol.a,n=(0,Cl.a)(xl(),t);return m.createElement(n,e)}}function Rl(e,t,n,a){e.calcDisplaySet(t.focusItem,t.parentItem);const i=e.displaySet;let r=[],o=[];return i&&i.main&&i.main.length>0&&(r=Ul(i.main,n,void 0,!0)),i&&i.overflow&&i.overflow.length>0&&(o=Ul(i.overflow,n)),i&&i.far&&i.far.length>0?{main:r,overflow:o,far:Ul(i.far,n,a)}:{main:r,overflow:o,far:[]}}function Nl(e,t,n,a){const i=(0,wl.a)(e,{computeVeto:a,qosEndSchema:n});t.end(i)}const Bl=e=>m.createElement(ra.a,{content:ct.Y},m.createElement(Ol.a,e));function jl(e){const t=(0,q.c)(),a=t.consume(se.b),i=m.useContext(Ei.d),r=m.useRef(t.consume(Ce.c)),{getValidViewerTypes:o}=r.current,[s,c]=m.useState(a.getOneUpProperties()),[d,l]=m.useState(!0),[u,f]=m.useState(!0),p=m.useRef(void 0),_=m.useCallback(()=>{if(s){const t={extension:s.focusItem.extension||"",viewer:o(s.focusItem),...i},n=p.current?Rl(p.current,s,t,e.onCloseCallback):void 0;if(n)return n}return{main:[],overflow:[],far:[]}},[s,p]),h=m.useCallback(()=>_(),[_]),b=m.useCallback(()=>_().main,[_]),g=m.useCallback(()=>_().overflow,[_]),v=b(),[y,S]=m.useState(v),D=g(),[I,x]=m.useState(D),[C,O]=m.useState(()=>{if(s){const t={extension:s.focusItem.extension||"Unknown",viewer:o(s.focusItem),...i},n=p.current?Rl(p.current,s,t,e.onCloseCallback):void 0;if(n)return n.far}return[]}),w=m.useCallback(()=>(function(e){if((0,Te.jb)(Te.J))(function(e,t){const n=[];return t.forEach((e,t)=>{"mainDividerCommand"===e.id&&n.push(t)}),n})(0,e).forEach(t=>{const n=e[t];e[t]={...n,key:`${n.key}_${t}`,iconOnly:!0,disabled:!0,ariaLabel:ct.v,commandBarButtonAs:xl(),onRender:e=>Hl(e,t)}});else{const t=e.map(e=>e.key).indexOf("mainDividerCommand");if(t>-1){let n=e[t];n={...n,iconOnly:!0,disabled:!0,ariaLabel:ct.v,commandBarButtonAs:xl(),onRender:e=>Hl(e,t)},e[t]=n}}}(y),[y,C]),[y,C]),E=(0,Se.a)((e,t)=>{if(e&&t){const n=t.get(e);if(n){l(void 0===n.showMainCommands||n.showMainCommands),f(void 0===n.showTitle||n.showTitle);const e=h();S(e.main),x(e.overflow),O(e.far)}else l(!0),f(!0)}else l(!0),f(!0)}),[A]=(0,Me.g)("currentState",e=>e),{rightPane:L,viewerStates:k,isOneUpFreOpen:M,eSignData:P,annotationViewerState:T,isFocusItemFavorited:U,isFeedbackEnabled:F,isUniversalPrintLicenseValid:H,isPdfPaidFeaturesEnabled:R,fileHandlerOptions:N}=A||{},B=A?.renamedKeyInFastOneUp===s?.focusItem.key,j=L?.type;m.useEffect(()=>{E(s?.focusItem.key,k)},[k,M,s,E]),m.useEffect(()=>{const e=_();S(e.main),x(e.overflow),O(e.far)},[P,T,_]),m.useEffect(()=>{const e=_();O(e.far)},[j]),m.useEffect(()=>{if(s?.focusItem){const e=_();S(e.main),(0,Te.jb)(Te.yb)&&x(e.overflow)}},[U,F]),m.useEffect(()=>{if(s?.focusItem&&(0,Te.jb)({ODB:61495})){const e=_();S(e.main)}},[H]),m.useEffect(()=>{if(s?.focusItem){const e=_();S(e.main)}},[R]),m.useEffect(()=>{if(s?.focusItem&&(0,Te.jb)(Te.w)){const e=_();S(e.main)}},[B]),m.useEffect(()=>{if(N){(0,Te.Sb)()&&p.current&&p.current.updateWorkingSetOverride({publisher:"fileHandlerData"});const e=_();O(e.far)}},[N,_,t]),m.useEffect(()=>()=>{(0,Te.jb)(Te.yb)&&(async()=>{const e=await Promise.all([n.e("ondemand.resx"),n.e(48)]).then(n.bind(n,754));await e.dispose()})().then(()=>{}).catch(()=>{})},[]);const V=k?.get(s?.focusItem.key||"")?.pdfViewerStates,z=t.consume(Me.f),G=!(0,Te.Cc)()&&z.currentAppState.isPublishToWebNavIdSet,K=z.currentAppState.deletedKeys?.get(a.focusItem?.key||"")||!1,W=m.useMemo(()=>{if(s&&u){const e=(0,Te.jb)(Te.G)&&V?.isPdfPasswordProtected&&!G?V?.isOpened?"unlock":"lock":"none";return[Ml(s.focusItem,e,i,o(s.focusItem),G,K)]}return[]},[s?.focusItem,V]);(0,dr.b)({updateOneUpStatus:function(n){if("update"in n.detail&&n.detail.update&&"publisher"in n.detail){const a=n.detail.update;p.current||(p.current=t.consume(vl));const r={extension:a.focusItem.extension||"Unknown",viewer:o(a.focusItem),...i},s=p.current?Rl(p.current,a,r,e.onCloseCallback):void 0;if(c(a),s?.main){const e=s.main;S(e),s?.overflow&&x(s.overflow)}s?.far&&O(s.far)}}},se.a.oneUpItemCacheUpdate);const Q=w(),Y={id:"oneupCommandBarOverflow","data-automationid":"overflowButton",menuProps:{items:[],id:"oneupCommandBarOverflowMenu",isBeakVisible:!1},"aria-label":ct.Y},J=Bn.b;J.semanticColors&&(J.semanticColors.menuBackground=Bn.b.palette?.white);const X=z.currentAppState.isTeamsFileScenario;return kl||!X?m.createElement(Rr,{id:"OneUpCommandBar",items:d&&Q?Q[0]:[],overflowItems:d?I:[],middleItems:W,farItems:Q?Q[1]:[],overflowButtonProps:Y,overflowButtonAs:Bl,styles:{root:{overflowY:"hidden"}}}):m.createElement(yl.a,{theme:J},m.createElement(Rr,{id:"OneUpCommandBar",items:d&&Q?Q[0]:[],overflowItems:d?I:[],middleItems:W,farItems:Q?Q[1]:[],overflowButtonProps:Y,overflowButtonAs:Bl,styles:{root:{overflowY:"hidden"}}}))}(0,d.ZW)([{rawString:".reatOneUpToast_b10aa152{position:absolute;bottom:12px;left:50%;transform:translate(-50%,0)}"}]);const Vl=(0,ft.a)(async()=>(await n.e(55).then(n.bind(n,749))).ToastComponent),zl=e=>{const{toastData:t}=e;return t?m.createElement("div",{className:"reatOneUpToast_b10aa152","data-automation-id":"ReactOneUpToastContainer"},(()=>{const e=[];let n=0;return t.forEach((t,a)=>{e.push(m.createElement(Vl,{index:n++,visible:t.visible,actionStatus:t.actionStatus,displayText:t.displayText,toastKey:t.toastKey,actionButtons:t.actionButtons,doNotAutoDismiss:t.doNotAutoDismiss}))}),e})()):m.createElement(m.Fragment,null)};var Gl=n(373);const Kl=!f.Ov.isActivated("1A9C038A-B822-46F4-AC48-2FAEAD75481C"),Wl=!f.Ov.isActivated("058098C5-2E70-4392-980F-D2B0F0E85353"),ql=!f.Ov.isActivated("f1644fe0-2fcc-46cd-a4a6-ceeafb02c981"),Ql=!f.Ov.isActivated("afcbc616-7fc3-4064-b02e-bd2ab3bf06c8"),Yl=!f.Ov.isActivated("E27E48F4-D876-454E-82F9-6578775F9FD7"),Jl=m.lazy(()=>n.e(64).then(n.bind(n,827))),Xl=m.lazy(()=>Promise.all([n.e("ondemand.resx"),n.e(23)]).then(n.bind(n,828))),Zl="publishView";function $l(){const[e]=(0,Me.g)("currentState",e=>e.modal);return e&&e?.showModal?m.createElement("div",{id:"OneUpModalContainer"},e.content):m.createElement(m.Fragment,null)}function eu(){const e=(0,dr.a)(),[t]=(0,Me.g)("currentState",e=>e),a=m.useMemo(()=>{if(!t)return!0;let n=t.imageMode!==Me.c.edit&&t.pdfAppMode!==qe.a.Edit&&t.pdfAppMode!==qe.a.Esign&&t.pdfAppMode!==qe.a.Extract;return Yl&&n&&(n=!(t.navMode===Me.d.single&&(0,bt.c)(e?.focusItem.extension))),n},[t,e]),[i]=(0,Me.g)("currentState",e=>e.toast),[r]=(0,Me.g)("currentState",e=>e.errorState);(0,Gl.b)(),function(){const e=(0,q.c)(),t=(0,dr.a)(e=>e?.focusItem),[n]=(0,Me.g)("currentState",e=>e?.pdfCopilotAction),[a]=(0,Me.g)("currentState",e=>e?.fabCopilotAction),i=e.consume(Me.f);_().useEffect(()=>{if(!Kl)return;let r,o,s;if(t&&(n?.prompt||a?.prompt)){const n=i?.currentAppState?.rightPane?.type===Me.e.copilotPane,a=e.consume(Tr.a)?.evaluateAction({item:t});r=a?.isAvailable,o=n?e=>{}:a?.onExecute,s="autoCopilotAction"}if(r&&o){const e=new tt.a({name:`OneUpLightSpeed.CopilotActionExecutorInvoked.${s||"unknownAction"}`}),t="Unhandled exception executing copilot action";try{const n=o({qosEvent:e});n&&n.then(t=>{const n=t||{resultType:tt.b.Success};e.end(n)}).catch(n=>{const a=n||new Error(t);e.end((0,En.a)(a))})}catch(n){const a=n||new Error(t);e.end((0,En.a)(a))}}},[n,a])}();const o=(0,Ei.h)(),s=window.matchMedia("(prefers-reduced-motion: reduce)"),c=!s||s.matches?0:300,l=xe.k,u=xe.l,[p,h]=m.useState(""),[b,g]=m.useState(!0),[v,y]=m.useState(!1),S=(0,q.c)(),D=S.consume(K.a),I=S.consume(qr.a),x=S.consume(ja.a),C=S.consume(Jr),O=m.useRef(null),w=m.useRef(!1);let E=!1;(0,Te.Tb)()&&Et.k&&(E=S.consume(Et.k.optional)||!1);const A=m.useCallback(t=>!t&&(0,Va.b)({navigation:D,saveAction:x,focusItem:e?.focusItem})?Promise.resolve():(h(u),new Promise(function(e){setTimeout(e,c)})),[D,x,e]),L=(0,Se.a)(t=>{if(e.focusItem&&"Escape"===t.key&&"Escape"===t.key&&e?.parentItem){const t=new tt.a({name:`OneUpLightSpeed.commandInvoked.${C.id}`});if(Wl){const n=I.evaluateAction({item:e.focusItem});A().then(()=>{n.onExecute({qosEvent:t})?.then(e=>{const n=e||{resultType:tt.b.Success};t.end(n)}).catch(e=>{const n=e;t.end((0,En.a)(n))})}).catch(()=>{})}else I.evaluateAction({item:e.focusItem}).onExecute({qosEvent:t})?.then(e=>{const n=e||{resultType:tt.b.Success};t.end(n)}).catch(e=>{const n=e;t.end((0,En.a)(n))})}}),k=(0,Se.a)(async(e,t)=>{if(kr){const n=(await S.consumeAsync(kr)).evaluateAction({item:e});n.isAvailable&&n.onExecute&&await n.onExecute({qosEvent:t})}});return m.useEffect(()=>{if((0,Te.Tb)()&&E&&O&&O.current&&e&&e.focusItem&&!v){const t=new tt.a({name:`OneUpLightSpeed.commandInvoked.${$d.id}`});k(e.focusItem,t).then(e=>{const n=e||{resultType:tt.b.Success};t.end(n),y(!0)}).catch(e=>{const n=e;t.end((0,En.a)(n))})}},[e,O,O.current,k,E]),m.useEffect(()=>{O&&O.current&&e&&(O.current?.focus(),O.current.addEventListener("keydown",L))},[O,O.current,L]),m.useEffect(()=>{setTimeout(()=>h(l),10)},[]),m.useEffect(()=>{const t=S.consume(z.a);if((0,Te.jb)(Te.yb)&&e?.focusItem&&!w.current&&!t.isAnonymousGuestUser){const a=S.consume(se.b),i=S.consume(Me.f),r=a.getOneUpProperties(),o=new ao.b({context:t}),{id:s,listurl:c}=(0,f.pW)(e?.focusItem.key),d=o.getUrlParts({listUrl:c,path:s}),l={webAbsoluteUrl:d.fullWebUrl,listUrl:d.serverRelativeListUrl},u=r?.pageContexts?.get(l);(async()=>{const a=await Promise.all([n.e("ondemand.resx"),n.e(48)]).then(n.bind(n,754)),i=a.getInitializationStatus();return i.isInitialized&&void 0!==i.isAvailable?i.isAvailable:(await a.initOneUpFeedback(e?.focusItem,S,u||t)).isAvailable})().then(e=>{i.setIsFeedbackEnabled("feedbackAction",e),w.current=!0}).catch(()=>{i.setIsFeedbackEnabled("feedbackAction",!1),w.current=!0})}},[e]),m.useEffect(()=>{if(!(0,Te.Cc)()){const e=D.viewParams[je.b.navParamKey],t=S.consume(Me.f);try{!e||e!==Zl&&atob(e)!==Zl||t.updateIsPublishToWebNavIdSet("OneUpRoot",!0)}catch(e){t.updateIsPublishToWebNavIdSet("OneUpRoot",!1)}}},[]),m.useEffect(()=>{if(Ql){const e=new URL(window.location.href.toLowerCase());e&&e.searchParams.has("app")&&"teamsfile"===e.searchParams.get("app").toLocaleLowerCase()&&-1!==e.pathname.indexOf("/_layouts/15/filebrowser.aspx")&&S.consume(Me.f).updateIsTeamsFileScenaro("OneUpRoot",!0)}},[]),m.useEffect(()=>{!(0,Te.Dc)()&&ql&&async function(){const e=await S.consumeAsync(Kn.a),t=await e.hasValidLicenseCached();S.consume(Me.f).updateIsUniversalPrintLicenseValidState("fastOneUpAdapter",t)}().catch(e=>{})},[]),m.useEffect(()=>{p===u&&setTimeout(()=>g(!1),c)},[p]),m.useEffect(()=>{r&&r.errorType===Ie.d.rldsApiError&&g(!1)},[r]),m.createElement(m.Fragment,null,b&&m.createElement("div",{id:"oneUpRoot",...(0,Te.Zb)()&&{"data-suppresskeyboardbinding":"true"},className:(0,d.ZK)(xe.B,p),ref:O},m.createElement(Ei.d.Provider,{value:o},a&&m.createElement(jl,{onCloseCallback:A}),m.createElement("div",{className:(0,d.ZK)(a?xe.E:xe.D,xe.C)},m.createElement(Er,{closeCallback:A}),m.createElement(Fr,null),i&&m.createElement(zl,{toastData:i})),m.createElement($l,null),(0,Te.jb)(Te.kc)&&m.createElement("div",null,m.createElement(m.Suspense,{fallback:m.createElement(m.Fragment,null)},m.createElement(Jl,null))),((0,Te.jb)(Te.Lc)||(0,Te.jb)(Te.yb))&&m.createElement("div",null,m.createElement(m.Suspense,{fallback:m.createElement(m.Fragment,null)},m.createElement(Xl,null))))))}var tu=n(165);const nu={isFastOneUp:Et.j.optional,pageContext:z.a},au=new f.OJ({name:"OneUpBootCustomerPromiseFunctionsKey",factory:{dependencies:nu,create:e=>{let t;const n=e.pageContext,a=(0,tu.b)(n)?.toLowerCase()||"unknown";return{instance:{newBootCustomerPromise:function(i){void 0===t&&(t=new vn.a({scenario:"OneUpLightSpeed.Boot",perfGoalInMs:Ie.a,pillar:"View",extraData:{oneUpRenderingMode:e.isFastOneUp?Ie.e.fastOneUp:Ie.e.inlineOneUpFirstPage,Ring:a,correlationId:n?.CorrelationId,...i}}))},reportBootCXPSuccess:function(e){t?.end({resultType:tt.b.Success,extraData:{...e}}),t=void 0},reportBootCXPFailure:function(e){const{errorType:n,error:a}=e.rawError,i=(0,En.a)(a),r=function(e){return e&&"string"==typeof e?e.split(",").join("_"):JSON.stringify(e)}(i.resultCode||"Unknown"),o=i.resultType;t?.end({resultType:o,errorCode:r,extraData:{errorType:n,rawError:a,...i.extraData}}),t=void 0}}}}}});function iu(){const e=(0,q.c)(),[t]=(0,Me.g)("currentState",e=>e.errorState),[n,a]=m.useState(!1),i=(0,dr.a)(),r=(0,Ei.h)();(0,m.useEffect)(()=>{const t=e.consume(au);i?.focusItem&&(t.reportBootCXPSuccess({engagementContext:r}),e.consume(De.b).newLoadingCustomerPromise(i.focusItem,r))},[i?.focusItem.key,e]),(0,m.useEffect)(()=>{const n=e.consume(au),i=e.consume(De.b);t?.errorType===Ie.d.viewerInitLoadingError&&i.reportLoadingCXPFailure({rawError:t}),t?.errorType===Ie.d.rldsApiError&&(n.reportBootCXPFailure({rawError:t}),a(!0)),t?.errorType===Ie.d.rldsApiErrorNoAccess&&(n.reportBootCXPFailure({rawError:t}),a(!0)),t?.errorType===Ie.d.processOneUpItemError&&n.reportBootCXPFailure({rawError:t})},[t,e]);let o=t?.error?.message;return o||(o=t?.errorType===Ie.d.rldsApiErrorNoAccess?cr.f:cr.e),n&&t?m.createElement("div",null,m.createElement(Hi,{errorTitle:o})):m.createElement(m.Fragment,null)}var ru=n(715);function ou(){(0,W.f)("OneUpLightSpeed");const e=(0,q.c)(),t=e.consume(ie.a),n=e.consume(z.a),a=t.isSafari&&t.isMobile,i=(0,Se.a)((t,n)=>{const a={errorType:Ie.d.reactRenderError,error:t.name?t:new Error("ReactRenderError"),extraData:{info:n.toString(),error:t.toString()}};e.consume(De.b).reportLoadingCXPFailure({rawError:a})}),r=Bn.b;f.Ov.isActivated("662e8b03-bcd7-47a7-9520-1f9801974b7b")||(0,Ir.a)(n);let o="100vh";o=f.Ov.isActivated("28a7c449-3563-4201-b8a9-60840b5f6222")?a?"100%":"100vh":"100dvh";const s=!f.Ov.isActivated("3cf1a381-4d99-4581-870e-fca14d0a3884");let c={height:s?`${o} !important`:o,width:s?"100vw !important":"100vw",maxWidth:s?"unset !important":"unset",maxHeight:s?"unset !important":"unset",minHeight:s?"unset !important":"unset",borderRadius:s?"0px !important":"0px"};const d=!f.Ov.isActivated("d231628a-6f44-4d6f-a8a0-6e4c58723989");c={...c,background:r.semanticColors.bodyBackground,...d?{overflow:"hidden"}:{}};let l="";!f.Ov.isActivated("f91e6032-6933-42ff-b732-5f0af7c73f1c")&&(l="OneUpModalSizing "+(a?"OneUpSafariMobile":""));const u={...r,components:ru.a};return m.createElement(yl.a,{theme:u},m.createElement(ye.a,{componentName:"OneUpLightSpeed",onError:i},m.createElement(ve.a,{className:`${xe.s} ${l}`,allowTouchBodyScroll:!0,isOpen:!0,focusTrapZoneProps:{firstFocusableTarget:"#oneUpCarousel"},layerProps:{eventBubblingEnabled:!0},styles:{main:c,layer:{zIndex:1e3,...f.Ov.isActivated("88516ad7-7d40-471b-b1e1-009af064cab4")?{}:{"&.fui-DialogSurface__backdrop":{zIndex:"auto"}}}}},m.createElement(iu,null),m.createElement(eu,null),m.createElement("div",{id:"oneupFeedbackHostNode"}))))}var su=n(218),cu=n(733),du=n(734);const lu=f.Ov.isActivated("3C8E1B8A-96C9-4AC3-ACAA-0A79AA85F566"),uu={ITEMSVIEWDEMO:"ItemsViewDemo",LISTALLITEMS:"ListAllItems",LISTSHOME:"ListsHome","ODB WEB":"ODB Web",ONEDRIVELTI:"OneDriveLti",SPARTANLIST:"SpartanList","SPLIST WEB":"SPList Web",TEAMS:"Teams",TEAMSLIST:"Teams.List",TEAMSFILE:"Teams.File",TEAMSPAGE:"Teams.Page",YAMMER:"Yammer"},fu={LISTS:"Lists"};for(const e of["Word","Excel","PowerPoint","OneNote","Visio"]){const t=`WACHost.${e}`;uu[t.toUpperCase()]=t;for(const t of["Teams"]){const n=`${t}.UnifiedUiHost.${e}`;uu[n.toUpperCase()]=n}}function pu(e){const{viewParams:t,onGetContext:n}=e;let a;const i=t.app,r=t.scenario;if(i){const e=uu[i.toUpperCase()]||!f.Ov.isActivated("B750D979-8389-4419-9DFE-79EAE5360404","05/03/2022","Allow all host-provided app values")&&i||"Unknown";a={...t,app:e}}!lu&&r&&(a={...a||t,scenario:fu[r.toUpperCase()]||r||"Unknown"});const o=a?{...e,viewParams:a}:e,s=(0,du.a)(o);return n?n({context:s,viewParams:o.viewParams}):s}var mu=n(219),_u=n(193),hu=n(735),bu=n(136);function gu(e){const t=vu(e);return(0,hu.a)(e.pageContext,t)}function vu(e){const{manifest:t,version:n}=(0,su.a)(),{pageContext:a,clientName:i,ashaProduct:r}=e,o=Number(a.webTemplate)===kn.a.mySite;return{Product:r||(o?"Files":"Lists"),Manifest:t,Version:n,ClientName:i}}var yu=n(477);let Su;function Du(e){if(e.spPageContext){const t={...pu({viewParams:e.viewParams,clientName:e.clientName}),...e.context||{}};if(e.initDefaultHandler)if((0,Te.Ec)()){let n;n=e.isODB?(0,cu.a)({sourceName:"oneup-lightspeed",tokens:_u.a,initOneDS:!0,pageContext:e.spPageContext,context:t}):{workload:"ODC",sourceName:"oneup-lightspeed",tokens:yu.a,initOneDS:!0,pageContext:e.spPageContext,context:t},(0,su.b)(n)}else(0,su.b)((0,cu.a)({sourceName:"oneup-lightspeed",tokens:_u.a,initOneDS:!0,pageContext:e.spPageContext,context:t}));Su&&"dispose"in Su&&Su?.dispose();const a=e.isODB?_u.a:yu.a,i=(0,Te.Ec)()?e.clientName.replace(/\s/g,""):`${e.clientName}-${e.viewParams[je.b.queryTypeParamKey]}`,{handler:r}=function(e){const{ariaEnvironment:t}=(0,su.a)(),{pageContext:a,initOneDS:i,tokens:r,resultTypeWhenUnload:o=tt.b.ExpectedFailure}=e,s=Number(a.webTemplate)===kn.a.mySite;let c;c=r?"prod"===t?r.prod:r.ppe:"prod"===t?s?_u.a.prod:_u.b.prod:s?_u.a.ppe:_u.b.ppe;const d=e.customerPromiseManager||(0,bu.a)(),l=e=>{let t;if(!f.Ov.isActivated("eefb75d1-f6be-4415-b145-774162263bac","03/20/2024","unload veto")&&(t={resultType:o,...o===tt.b.ExpectedFailure||o===tt.b.Failure?{errorCode:"unload"}:{}},"unload"===t.errorCode))switch(e?.data.pillar){case"Create":t.veto="unload (create)";break;case"Boot":t.veto="unload (boot)";break;case"View":t.veto="unload (view)";break;case"Edit":t.veto="unload (edit)";break;case"Delete":t.veto="unload (delete)";break;case"Share":t.veto="unload (share)";break;case"Freshness":t.veto="unload (freshness)";break;case"Social":t.veto="unload (social)";break;case"Upload":t.veto="unload (upload)";break;case"Search":t.veto="unload (search)"}e.end(!f.Ov.isActivated("eefb75d1-f6be-4415-b145-774162263bac","03/20/2024","unload veto")&&t?t:{resultType:o,...o===tt.b.ExpectedFailure||o===tt.b.Failure?{errorCode:"unload"}:{}})};if(d.addOnBeforeUnloadHandler(l),i){const t=f.Ov.isActivated("f63f9172-c9f8-444d-b40c-80ac8c57e939","08/05/2025","fix telemetry missing field")?gu(e):{...gu(e),...e.context},{oneDsCollectorUrl:n}=a,i=new mu.a({sourceName:"odsp-spo",tenantToken:c,context:{context:t,oneDsCollectorUrl:n}});return i.attach(d),{dispose:()=>{d.removeOnBeforeUnloadHandler(l),i.dispose()},handler:i}}{const t=vu(e),i=(0,hu.b)({ariaLoader:()=>n.e(2).then(n.t.bind(n,209,23)),pageContext:a,customerContext:t,tenantToken:c}),r=i.attach(d);return{dispose:()=>{d.removeOnBeforeUnloadHandler(l),r()},handler:i}}}({pageContext:e.spPageContext,clientName:i,initOneDS:!0,customerPromiseManager:(0,Pt.a)(),tokens:(0,Te.Ec)()?a:_u.a,ashaProduct:e.ashaProduct,context:t});Su=r}}(0,Pt.a)();const Iu=new f.OJ({name:"initTelemetryHandlerODB",factory:{dependencies:{},create:()=>({instance:function(e){Du({...e,isODB:!0})}})}}),xu=new f.OJ({name:"initTelemetryHandlerODC",factory:{dependencies:{},create:()=>({instance:function(e){Du({...e,isODB:!1})}})}});var Cu=n(736),Ou=n(737),wu=n(421),Eu=n(738);const Au=(0,ft.a)(async()=>(await n.e(65).then(n.bind(n,761))).OnePlayerHost2),Lu=new f.OJ({name:"fluent2Theme.key.Fluent2Theme",factory:new f.Rn({})});var ku=n(739);const Mu=new f.OJ({name:"oneDriveFluent2Theme.key.Fluent2Theme",factory:{dependencies:{},create:()=>({instance:(0,ku.a)({semanticColors:{bodyBackground:ku.b.neutralLighterAlt}})})}}),Pu=new f.OJ({name:"DeferredSetupTasks.key",loader:new f.hg(()=>n.e(12).then(n.bind(n,845)).then(e=>e.resourceKey))});var Tu=n(740),Uu=n(741),Fu=n(74);const Hu=(0,f.C2)("FileHandlerResourceKeys",Uu.a,{pageContext:z.a}),Ru={fileHandlerService:(0,f.C2)("FileHandlerResourceKeys",Tu.a,{dataRequestor:Fu.a,localFileHandlerProvider:Hu}),oneUpStateStore:Me.f,pageContext:z.a,itemUrlHelper:$.c},Nu={oneUpFileHandlerProvider:new f.OJ({name:"OneUpFileHandlerProvider",factory:{dependencies:Ru,create:e=>({instance:{getFileHandlerDataThruAPI:async function(){return await e.fileHandlerService.getFileHandlerData({includePromotedApp:!0})},getFileHandlerDataThruLocalStorage:function(){if("localStorage"in window){const e=this.getFileHandlerCacheKey();if(localStorage.getItem(e))return JSON.parse(localStorage.getItem(e)||"")}},isCacheDataValid:function(e){return Date.now()-e.lastModified<864e5},getFileHandlerEndpoint:function(){return new Ve.a(e.pageContext.webAbsoluteUrl).authority+"/_api/v2.0"},getFileHandlerCacheKey:function(){return`fileHandlerCache_${JSON.stringify({endpoint:this.getFileHandlerEndpoint(),driveId:""})}`},setDataToLocalStorage:function(e){if("localStorage"in window)try{const t=this.getFileHandlerCacheKey();localStorage.setItem(t,JSON.stringify(e))}catch(e){}},getFileHandlerData:async function(){const t=e.oneUpStateStore.getFileHandlerOptions();if(!t||!this.isCacheDataValid(t)){const t=this.getFileHandlerDataThruLocalStorage();if(t&&this.isCacheDataValid(t))e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",t);else{const t=await this.getFileHandlerDataThruAPI();if(t){const n={data:t,lastModified:Date.now(),signature:{driveId:"",endpoint:this.getFileHandlerEndpoint(),includePromotedApp:!0}};this.setDataToLocalStorage(n),e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",n)}}}}}})}}),oneUpStateStore:Me.f},Bu=new f.OJ({name:"GetFileHandlerData",factory:{dependencies:Nu,create:e=>({instance:{getFileHandlerDataForOneUp:async function(){const t=e.oneUpStateStore.getFileHandlerOptions();if(!t||!e.oneUpFileHandlerProvider.isCacheDataValid(t)){const t=e.oneUpFileHandlerProvider.getFileHandlerDataThruLocalStorage();if(t&&e.oneUpFileHandlerProvider.isCacheDataValid(t))e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",t);else{const t=await e.oneUpFileHandlerProvider.getFileHandlerDataThruAPI();if(t){const n={data:t,lastModified:Date.now(),signature:{driveId:"",endpoint:e.oneUpFileHandlerProvider.getFileHandlerEndpoint(),includePromotedApp:!0}};e.oneUpFileHandlerProvider.setDataToLocalStorage(n),e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",n)}}}}}})}}),ju={urlDataSource:J.a},Vu=new f.OJ({name:"isImageEditableInOneUp",factory:{dependencies:ju,create:e=>({instance:()=>e.urlDataSource.getQueryType()!==eo.a.AllMyPhotos})}}),zu=new f.OJ({name:"onRenderOnePlayerHost",loader:new f.hg(()=>n.e(65).then(n.bind(n,846)).then(e=>e.onRenderOnePlayerHostKey))});var Gu=n(457);const Ku=new f.OJ({name:"getOneUpOnePlayerResources",loader:new f.hg(()=>n.e(65).then(n.bind(n,847)).then(e=>e.getOneUpOnePlayerResourcesKey))});var Wu=n(210);const qu={pageContext:z.a,navigation:K.a},Qu=new f.OJ({name:"AshaHelper",factory:{dependencies:qu,create:e=>({instance:{getASHAProductName:function(){const t=e.navigation.viewParams;return(0,Wu.a)(t)===eo.a.AllMyPhotos?"Photos":Number(e.pageContext.webTemplate)===kn.b.mySite?"Files":"SPO DocLib"}}})}});var Yu=n(46);let Ju;function Xu(e){return Ju||(Ju=e)}var Zu=n(35),$u=n(110),ef=n(458);const tf=!f.Ov.isActivated("4FAF036B-29E5-4843-9B7E-DA4E5A096385"),nf={ODB:61546},af={ODB:-61546};var rf=n(478);const of=!f.Ov.isActivated("F43F2BEB-1389-4846-9CC0-85E9A4DB7950");let sf;var cf=n(95),df=n(401);const lf=new f.OJ({name:"PushNotifierAsync.key",loader:new f.hg(()=>n.e(18).then(n.bind(n,848)).then(e=>e.pushNotifierKey))}),uf=new f.Zd;new f.Zd,window.DeferredListDataComplete=()=>{uf.resolve()},(window.g_payload&&window.g_listData||window._spOneDrivePageDataCache)&&uf.resolve();const ff=window._spPageContextInfo;let pf;ff&&ff.webAbsoluteUrl&&(Number(ff.webTemplate)!==kn.b.mySite||ff.listUrl||(ff.listUrl=`${new ii.a(ff.webAbsoluteUrl).path}/Documents`,pf="Documents"),f.Ov.isActivated("3AA8AB74-14AD-4975-AE22-56608B8E8025","11/07/2022","Stop freezing Page Context globally to support MondoPrefetch")&&Object.freeze(ff));var mf=n(140),_f=n(159);const hf={pageContext:z.a},bf=new f.OJ({name:"accountTypeODB",factory:{dependencies:hf,create:e=>({instance:e.pageContext.isAnonymousGuestUser?"BusinessAnonymous":"Business"})}});var gf=n(387);const vf=new f.OJ({name:"isPdfPremiumFeaturesEnabledODB",factory:{dependencies:{},create:()=>({instance:!0})}}),yf=new f.OJ({name:"getIsPdfPaidFeaturesEnabledODB",factory:{dependencies:{},create:()=>({instance:()=>Promise.resolve(!0)})}});var Sf=n(742),Df=n(743);const If=new f.OJ({name:"getOneUpFabCommands",factory:{dependencies:{oneUpStateStore:Me.f},create:e=>{function t(t){return{id:t,name:t,action:async()=>{e.oneUpStateStore.updateFabCopilotAction("fabClicked",t)}}}return{instance:e=>{const n=t(Sf.l),a=t(Sf.b),i=t(Sf.d),r=t(Df.x),o=t(Sf.e),s=t(Df.E),c=t(Df.D),d=t(Sf.g);switch(e){case Ce.a.MSPdf:case Ce.a.TextFile:case Ce.a.Html:case Ce.a.WAC:return[n,a,i];case Ce.a.Photo:case Ce.a.Image360:return[r,o,s];case Ce.a.OnePlayerVideo:return[c,d,i];default:return[]}}}}}});var xf=n(443);const Cf={ODB:62713},Of=!f.Ov.isActivated("4eebbc5c-6021-4270-8ca5-d266dfce8e99"),wf=new f.OJ({name:"isBizChatEnabledForODB",factory:{dependencies:{},create:()=>{const e=(0,Zu.a)(Cf);return{instance:()=>Of&&e}}}}),Ef={ODB:62716},Af=!f.Ov.isActivated("63557ebd-0ea5-4a7f-85d6-ac8896e8e2b9"),Lf=new f.OJ({name:"isBizChatEnabledForSPList",factory:{dependencies:{},create:()=>{const e=(0,Zu.a)(Ef);return{instance:()=>Af&&e}}}}),kf=f.Ov.isActivated("522c147a-a792-48d2-9a26-aa1720532889"),Mf=f.Ov.isActivated("d0c1f2b3-4e5f-6a7b-8c9d-e0f1a2b3c4d5"),Pf=!f.Ov.isActivated("11aaa868-80fc-41cf-b2df-8f66ddcfe134"),Tf=f.Ov.isActivated("371d515c-de3d-45d6-b573-c655e6b005b6"),Uf=!f.Ov.isActivated("77af712f-b482-4d33-be57-59733f90bb6f"),Ff=!f.Ov.isActivated("4eebbc5c-6021-4270-8ca5-d266dfce8e99"),Hf=!f.Ov.isActivated("63557ebd-0ea5-4a7f-85d6-ac8896e8e2b9");var Rf=n(139),Nf=n(104);const Bf=new f.OJ({name:"isCopilotEnabledOnSite",factory:{dependencies:{pageContext:z.a},create:({pageContext:e})=>({instance:function(){let t=!0;return f.Ov.isActivated("44d3c708-0bb8-444d-8457-4b05f3853ba7","11/20/2023","enables the msit site disallow list logic")||((0,Zu.a)({ODB:61346})?t=!0:(t=0===(0,Yu.c)(90214,e),t||new tt.a({name:"CopilotDisabledOnSite_OD_90214"}).end({resultType:tt.b.Success}))),(0,Nf.a)().availability.isSiteAllowed=t,t}})}}),jf={ODB:60732},Vf={ODB:61701},zf={isUserCopilotLicensed:Wi.a,isCopilotEnabledOnSite:Bf},Gf=new f.OJ({name:"areCopilotForODBRequirementsMet",factory:{dependencies:zf,create:({isUserCopilotLicensed:e,isCopilotEnabledOnSite:t})=>{const n=t(),a=e()&&n;return{instance:()=>a}}}}),Kf=new f.OJ({name:"ECSDataSource.key",loader:new f.hg(()=>n.e(14).then(n.bind(n,849)).then(e=>e.ecsDataSourceKey))}),Wf={ODB:61598};function qf(){const e=f.JW.isFeatureEnabled(Wf);return(0,Nf.a)().availability.enableCopilotMochaSegmentation=e,e}function Qf(e){return`mocha_${e}`}let Yf=!1;const Jf={pageContext:z.a,getECSDataSource:Kf.async.lazy},Xf=new f.OJ({name:"isMochaBypassEnabled",factory:{dependencies:Jf,create:({pageContext:e,getECSDataSource:t})=>{let n=!1;if(qf()){const a=e.aadUserId||"";n=function(e){const t=(0,Nf.a)(),n="true"===window.localStorage?.getItem(Qf(e));return t.availability.aadUserId=e,t.availability.isUserInMochaSegmentation=n,n}(a),function(e,t){qf()&&!Yf&&e&&(Yf=!0,t().then(e=>e.getECSSMochaSegmentation()).then(t=>{const n=Qf(e);window.localStorage?.setItem(n,t.toString())}))}(a,t)}return{instance:()=>n}}}}),Zf={areCopilotForODBRequirementsMet:Gf,isMochaBypassEnabled:Xf},$f=new f.OJ({name:"isCopilotFullEnabledForODB",factory:{dependencies:Zf,create:({areCopilotForODBRequirementsMet:e,isMochaBypassEnabled:t})=>{const n=e();let a=(0,Zu.a)(jf);const i=(0,Nf.a)();return i.availability.isFoRFlightEnabled=a||i.availability.isFoRFlightEnabled,i.availability.isFullFlightEnabled=a,a||(a=t()),i.availability.isCopilotEnabled=n&&a,{instance:()=>n&&a}}}}),ep={areCopilotForODBRequirementsMet:Gf,isMochaBypassEnabled:Xf},tp={ODB:61840},np=new f.OJ({name:"isCopilotLiteEnabledForODB",factory:{dependencies:ep,create:({areCopilotForODBRequirementsMet:e,isMochaBypassEnabled:t})=>{const n=e();let a=(0,Zu.a)(Vf);const i=(0,Nf.a)();i.availability.isFoRFlightEnabled=a||i.availability.isFoRFlightEnabled,i.availability.isLiteFlightEnabled=a;const r=(0,Zu.a)(tp);return i.availability.isBypasLiteFlightEnabled=r,!a&&r&&(a=t()),i.availability.isCopilotLiteEnabled=n&&a,{instance:()=>n&&a}}}});var ap=n(233);const ip={isCopilotFullEnabled:$f,isCopilotLiteEnabled:np},rp=new f.OJ({name:"isCopilotEnabledForODB",factory:{dependencies:ip,create:({isCopilotFullEnabled:e,isCopilotLiteEnabled:t})=>{const n=e(),a=t(),i=(0,Nf.a)();return(0,ap.a)(i.availability),(0,ap.b)(n||a,"OneDriveForBusiness",()=>"Licensed"),{instance:()=>n||a}}}}),op={pageContext:z.a},sp=new f.OJ({name:"fastOneUpClientNameODB",factory:{dependencies:op,create:e=>({instance:Number(e.pageContext.webTemplate)===kn.b.mySite?"ODB Web":"SPList Web"})}}),cp=!f.Ov.isActivated("f65de8fd-cc35-4c71-9753-cdc3b55291e1"),dp=f.Ov.isActivated("d0c1f2b3-4e5f-6a7b-8c9d-e0f1a2b3c4d5"),lp=!f.Ov.isActivated("5A28CF1B-7403-40BC-A9DD-0AFCEA3C6DF5"),up={oneUpStore:se.b,oneUpStateStore:Me.f,dividerCommand:jr,infoPaneGroupCommand:ll,closeCommand:Jr,downloadCommand:Ot,openGroupCommand:As,editSplitCommand:Bd,saveCommand:Ls.saveCommandKey,copyToCommand:Bs,deleteCommand:qs,openVersionHistoryCommand:Hc,viewOriginalImageCommand:qc,shareGroupCommand:_d.a,pdfOutlineCommand:Pc,pdfExtractCommand:Oc.a,pdfMergeCommand:wc.a,pdfEncryptCommand:ul.a,pdfCompressCommand:fl.a,openCopilotPaneCommand:ji.a,pageContext:z.a},fp=new f.OJ({name:"GenerateConsumerOneUpCommandBarWorkingSet",factory:{dependencies:up,create:e=>{const{oneUpStore:t,oneUpStateStore:n,dividerCommand:a,infoPaneGroupCommand:i,closeCommand:r,downloadCommand:o,openGroupCommand:s,editSplitCommand:c,saveCommand:d,copyToCommand:l,deleteCommand:u,openVersionHistoryCommand:f,viewOriginalImageCommand:p,shareGroupCommand:m,pdfOutlineCommand:_,pdfExtractCommand:h,pdfMergeCommand:b,pdfEncryptCommand:g,pdfCompressCommand:v,openCopilotPaneCommand:y}=e;return{instance:{generateWorkingSets:function(){return{main:this.generateMainWorkingSet(),far:this.generateFarWorkingSet(),overflow:this.generateOverflowWorkingSet()}},generateMainWorkingSet:function(){const e=[],r=!(!n.currentAppState.deletedKeys||!n.currentAppState.deletedKeys.get(t.focusItem?.key||""));return n.currentAppState.isPublishToWebNavIdSet||r||(e.push(d),(0,Te.jb)(Te.J)&&e.push(_,a),e.push(o,u,a,h,b,g,v,i)),e},generateOverflowWorkingSet:function(){const e=[],a=!(!n.currentAppState.deletedKeys||!n.currentAppState.deletedKeys.get(t.focusItem?.key||""));return n.currentAppState.isPublishToWebNavIdSet||a||e.push(l,p,f),e},generateFarWorkingSet:function(){const a=[],i=!(!n.currentAppState.deletedKeys||!n.currentAppState.deletedKeys.get(t.focusItem?.key||""));return n.currentAppState.isPublishToWebNavIdSet||(i?a.push(r):((0,Ir.c)(e.pageContext)||a.push(y),a.push(s(),c,...lp?[m]:[],r))),a}}}}}}),pp=new f.OJ({name:"getConsumerTextContentFallbackAsync",loader:new f.hg(()=>n.e(24).then(n.bind(n,850)).then(e=>e.resourceKey))}),mp={pageContext:z.a},_p=new f.OJ({name:"accountTypeODC",factory:{dependencies:mp,create:e=>({instance:e.pageContext.isAnonymousGuestUser?"ConsumerAnonymous":"ConsumerOnSPO"})}}),hp=new f.OJ({name:"isPdfPremiumFeaturesEnabledODC",factory:{dependencies:{},create:()=>({instance:!1})}}),bp=new f.OJ("storageInfoProvider");var gp=n(745),vp=n(744);const yp=new f.OJ({name:"getIsPdfPaidFeaturesEnabledODC",factory:{dependencies:{getStorageInfoDataProvider:bp.async},create:({getStorageInfoDataProvider:e})=>({instance:async()=>{let t=!0;const n=await e();if(n.getStorageInfoData){const e=await n.getStorageInfoData({cachingStrategy:gp.a.bypassCache,cacheTimeoutTime:vp.c});if(e){const{entitlements:n}=e;t=!n?.some(e=>"PaidPlan"===e.entitlementType)}}return(0,Te.jb)(Te.P)&&!t}})}}),Sp=new f.OJ({name:"getOneUpFabCommandsODC",factory:{dependencies:{oneUpStateStore:Me.f},create:e=>{function t(t){return{id:t,name:t,action:async()=>{e.oneUpStateStore.updateFabCopilotAction("fabClicked",t)}}}return{instance:e=>[t(Sf.l),t(Sf.b),t(Sf.j)]}}}}),Dp=f.Ov.isActivated("B0AE7992-3B5D-40B0-A5BD-D316B9AD56BA"),Ip=!f.Ov.isActivated("A6C39EC2-C951-45F4-AF81-86FAABEC4E4E"),xp=!f.Ov.isActivated("A6C39EC2-C951-45F4-AF81-86FAABEC4E4E"),Cp=f.Ov.isActivated("d0c1f2b3-4e5f-6a7b-8c9d-e0f1a2b3c4d5"),Op=f.Ov.isActivated("371d515c-de3d-45d6-b573-c655e6b005b6"),wp=!f.Ov.isActivated("01e1e3da-b6fd-410e-9e9d-25ff6461668a");var Ep=n(746);const Ap=new f.OJ({name:"copilotAppName",factory:{dependencies:{},create:()=>({instance:"OneDriveConsumer"})}}),Lp=new f.OJ({name:"isCopilotLiteEnabled",factory:new f.Rn(()=>!1)});var kp=n(220),Mp=n(153);const Pp={isUserCopilotLicensed:Wi.a,navigation:K.a},Tp={ODB:62221},Up=!f.Ov.isActivated("3C442122-33B1-4FBE-A17D-426F4F3FC733"),Fp=new f.OJ({name:"isCopilotLiteEnabledForODC",factory:{dependencies:Pp,create:e=>{const t=(0,Zu.a)(Tp),n=Xu(e.navigation.viewParams),a=(0,Nf.a)();return a.availability.isFoRFlightEnabled=t||a.availability.isFoRFlightEnabled,a.availability.isLiteFlightEnabled=t,{instance:()=>(e.isUserCopilotLicensed()||Up&&function(e){const t=e[Mp.a];return(0,kp.j)(t)}(n))&&t}}}}),Hp={isCopilotLiteEnabled:Fp},Rp=new f.OJ({name:"isCopilotEnabledForODC",factory:{dependencies:Hp,create:({isCopilotLiteEnabled:e})=>({instance:()=>e()})}});var Np=n(459);const Bp=new f.OJ({name:"isUserCopilotLicensed",factory:{dependencies:{pageContext:z.a.optional},create:({pageContext:e})=>({instance:()=>{let t=!1;const n=(0,Nf.a)();return window.sessionStorage.getItem("_isRunningTABTest")?(n.availability.isLicenseCheckBypassed=!0,t=!0):t=(0,Np.a)(),n.availability.isLicensed=t,n.availability.siteSubscriptionId=e?.siteSubscriptionId,t}})}});var jp=n(433);const Vp={pageContext:z.a},zp=new f.OJ({name:"consumerChatODSPPageUrl",factory:{dependencies:Vp,create:e=>({instance:`https://onedrive.live.com${e.pageContext.webServerRelativeUrl}/_layouts/15/chat.aspx`})}}),Gp=!f.Ov.isActivated("0DD08BDF-F41D-4F67-B6B2-034637158393"),Kp=new f.OJ({name:"copilotFeedbackProps.async",loader:new f.hg(()=>Promise.all([n.e("ondemand.resx"),n.e(7)]).then(n.bind(n,765)).then(e=>e.copilotFeedbackPropsKey))}),Wp=new f.OJ({name:"fastOneUpClientNameODC",factory:{dependencies:{},create:()=>({instance:"ODC Web"})}});var qp=n(747),Qp=n(460);const Yp=!f.Ov.isActivated("648e2f9f-7a2d-4791-9dc2-19d6267dc003"),Jp=f.Ov.isActivated("d0c1f2b3-4e5f-6a7b-8c9d-e0f1a2b3c4d5"),Xp=f.Ov.isActivated("371d515c-de3d-45d6-b573-c655e6b005b6");f.Ov.isActivated("6E2C0B42-5F94-4F6E-90E6-422D3EE2D0C9");const Zp=new f.OJ({name:"storageInfoDataManagerAsyncKey",loader:new f.hg(()=>Promise.all([n.e("plt.preact"),n.e(72)]).then(n.bind(n,852)).then(e=>e.StorageInfoDataManagerKey))});var $p=n(444),em=n(144);(0,h.a)(),performance.mark("EUPL.AppStart");const tm=new f.fi({owner:"ODBOneUpLightSpeed",useFactoriesOnKeys:!0}),nm=window._spPageContextInfo,am=tm.consume(Bt),im=am.getOneUpRumoneLogger({});tm.expose(z.a,nm);const{pack:rm,prefetchConfig:om}=!ff||(0,mf.a)(ff)?{pack:function(){const e=new f.LX;return Xp||e.addAsync(bp,new f.hg(async()=>{const{StorageInfoDataProviderKey:e}=await n.e(6).then(n.bind(n,764));return e})),e.addFromPack(function(){const e=new f.LX;return e.add($r.a,!1),Dp||e.addAlias(_l,fp),Ip&&e.addAlias(Et.d,pp),xp&&e.add(Ne.b,!1),Cp||(e.addAlias(Et.g,xu),e.addAlias(Et.a,_p)),Op?e.addAlias(Et.l,hp):e.addAlias(Xn,yp),wp&&e.addAlias(Et.c,Sp),e}()),e.addFromPack(function(){const e=new f.LX;return e.addAlias(Rf.a,Rp),e.addAlias(Lp,Fp),e.addAlias(Wi.a,Bp),e.addAlias(jp.a,zp),Gp&&e.addAsync(Kp,new f.hg(async()=>{const{odcCopilotFeedbackPropsKey:e}=await Promise.all([n.e("ondemand.resx"),n.e(40)]).then(n.bind(n,851));return e})),e}()),Yp&&e.addAlias(Ep.a,Ap),Jp||(e.addAlias(Et.g,xu),e.addAlias(Et.b,Wp)),qp.a&&e.add(Qp.a,!0),e}(),prefetchConfig:{disableUpdatePathForShortUrl:!(0,Zu.a)({ODB:61767})}}:{pack:function(){const e=new f.LX;return e.addFromPack(function(){const e=new f.LX;kf||e.add(_f.a,!0),Mf||(e.addAlias(Et.g,Iu),e.addAlias(Et.a,bf)),Pf&&e.add(gf.a,!0),Tf?e.addAlias(Et.l,vf):e.addAlias(Xn,yf),Uf&&e.addAlias(Et.c,If);const t=Number(ff?.webTemplate)===kn.b.mySite||Number(ff?.webTemplate)===kn.b.mySiteHost;return Hf&&t?e.addAlias(xf.a,wf):Ff&&!t&&e.addAlias(xf.a,Lf),e}()),cp&&e.addAlias(Rf.a,rp),dp||(e.addAlias(Et.g,Iu),e.addAlias(Et.b,sp)),e}(),prefetchConfig:{disableUpdatePathForShortUrl:!1}},{disableUpdatePathForShortUrl:sm}=om,cm=function(e){const{spPageContext:t,disableUpdatePathForShortUrl:n}=e;if(!sf){!function(){const e=window.g_oneUpPathAndQueryString;if(e){const t=new URL(e);if(f.Ov.isActivated("0ba2b5b5-4709-4098-8d6e-08b7bb9ceafd"))t.searchParams&&t.searchParams.get("ga")&&window.history.replaceState({reason:"OneUpServerSideTransfer"},"OneUpServerSideTransfer",e);else if(t.searchParams&&t.searchParams.get("ga")){const n=()=>{try{window.history.replaceState({reason:"OneUpServerSideTransfer"},"OneUpServerSideTransfer",e)}catch(e){}};n(),window.location.href.toString()!==t.toString()&&n()}}}();const e=(function(e){return!!e?.serverRequestPath?.toLowerCase().includes("onedrive.aspx")}(t)||of&&function(e){return!!e?.serverRequestPath?.toLowerCase().includes("odc.aspx")}(t))&&function(e){const{disableUpdatePathForShortUrl:t,platformDetection:n,spPageContext:a}=e;if(!a||!a.isMySiteOwner||(0,$u.a)(a)||n.isPWA)return!1;if(function(e){return!e&&(0,Zu.a)(nf)}(t)){if(location.pathname.toLowerCase().includes("onedrive.aspx"))return history.replaceState(null,"",`/${location.search}${location.hash}`),!0;if(!tf)return!0;const e=location.pathname.split("/");return 2===e.length&&""===e[0]&&void 0!==ef.b[e[1]]||!(!a.routingKey||2!==e.length&&3!==e.length||""!==e[0]||e[1]!==a.routingKey||void 0!==e[2]&&void 0===ef.b[e[2]])&&(history.replaceState(null,"",`/${e[2]||""}${location.search}${location.hash}`),!0)}return(0,Zu.a)(af)&&"/"===location.pathname&&history.replaceState(null,"",`${a.webServerRelativeUrl}/_layouts/15/onedrive.aspx${location.search}${location.hash}`),!1}({disableUpdatePathForShortUrl:n,platformDetection:new f.SW,spPageContext:t}),a=e?ef.a:void 0;sf=new rf.a({prettyPathMap:a}),Xu(sf.viewParams),sf.updateViewParams({},{ignoreHistory:!0})}return sf}({spPageContext:nm,disableUpdatePathForShortUrl:sm});tm.expose(K.a,cm),tm.exposeFromPack(rm);const dm=tm.consume(Et.b),lm=tm.consume(Et.a),um=tm.consume(Qu).getASHAProductName();tm.consume(Et.g)({clientName:`OneUpLightSpeed-fastOneUp-${dm}`,viewParams:cm.viewParams,spPageContext:nm,initDefaultHandler:!0,ashaProduct:um,context:{AccountType:lm}});const fm=tm.consume(au);fm.newBootCustomerPromise({clientName:dm,view:function(){const e=cm.viewParams[je.b.queryTypeParamKey];return e?`view=${e}`:""}(),hidePeoplePreviewingFiles:nm.hidePeoplePreviewingFiles}),im.initRumoneLogger(),(0,Te.Wb)()&&(0,Yu.b)(90198,nm);const pm=e=>{tm.consumeAsync(Pu).then(e=>{e.setupDeferredComponents(tm)});const t=cm.viewParams.ga,n=!!window.g_oneUpPathAndQueryString,a=(0,f.pW)(window.location.search.substring(1)),i={viewerName:e.viewer,isShareLinkRedeeming:void 0!==t,extension:e.extension||"unknown",fileSizeRange:e.fileSizeRange,isCrossList:e.isCrossList,isFluentV9:(0,df.a)(),isFromSyncClientAutoOpen:!!a[je.b.action],...e.extraData};let r;r=(0,Te.Db)()?(0,gn.a)(i):i;const o={oneupScenario:1,endTime:Date.now(),pageTransType:Lt.a.fullPageLoad,userClickTime:NaN,embedStartLoadingTime:void 0,clientId:dm,viewerStartTime:Ht(e.viewer),breakDownData:e.euplBreakDownData,isFastOneUp:!0,isLightSpeed:!0,isServerSideTransfer:n,...r,diagnosticInfo:r,...e.extraPerfData};W.f("EUPL.glass"),im.logRumonePerformance(o,e=>{tm.consume(Me.f).updatePerfButtonState("FastOneUp-OnSlideLoaded",e)}),tm.consume(De.b).reportLoadingCXPSuccess({extraData:{...r,diagnosticInfo:r}})},mm=e=>{const t=am.getOneUpRumoneLogger({loggerName:"fullPage"}),n=!!window.g_oneUpPathAndQueryString;t.initRumoneLogger(),t.logRumonePerformance({oneupScenario:1,endTime:Date.now(),pageTransType:Lt.a.fullPageLoad,userClickTime:NaN,embedStartLoadingTime:void 0,clientId:dm,viewerStartTime:Ht(e.viewer),breakDownData:e.euplBreakDownData,isFastOneUp:!0,isLightSpeed:!0,isServerSideTransfer:n,viewerName:e.viewer,extension:e.extension||"unknown",fileSizeRange:e.fileSizeRange,isCrossList:e.isCrossList,isFullPageLogging:!0,isFluentV9:(0,df.a)(),...e.extraPerfData})};function _m(){try{(0,V.b)(tm),async function(e){const t=e.consume(Bu);await t.getFileHandlerDataForOneUp()}(tm),e=tm,Yd&&nm.hidePeoplePreviewingFiles||!(0,Te.jb)(Te.j)||e.consumeAsync(lf)}catch(e){tm.consume(Me.f).updateErrorState("fastOneUpAdapterException",{errorType:Ie.d.rldsApiError,error:e,item:void 0})}var e;W.f("EUPL.BeforeWaitForDomReady"),(0,Q.a)(()=>{W.f("EUPL.AfterWaitForDomReady"),function(){try{let e=document.getElementById("od-oneup");e&&document.body.removeChild(e),e=document.createElement("div"),e.setAttribute("id","od-oneup"),document.body.appendChild(e);const t=m.createElement(q.a,{resources:tm},m.createElement(ou,null));j.a(t,document.getElementById("od-oneup"))}catch(e){fm.reportBootCXPFailure({rawError:{errorType:Ie.d.processOneUpItemError,error:new f.a_({code:"fastOneUp-initizationException",innerError:e})}})}}()}).catch(e=>{console.log("dom error: ",e)})}function hm(e){try{if(nm){try{const t="isODBDarkMode",n=window&&"true"===window.localStorage.getItem(t);e.expose(Et.i,n)}catch(e){}e.exposeFactory(Y.a,new f.TF(me)),e.exposeFactory(J.a,new f.TF(tn.a)),e.exposeFactory(be.a,new f.TF(ge)),e.exposeFactory(_e.a,new f.TF(he)),e.expose(Et.j,!0),e.expose(Et.o,pm),e.expose(Et.n,mm),function(){if(Su&&"dispose"in Su)return Su}()?.updateContext({product:um}),e.exposeFactory(ds.a,new f.TF(Et.b)),f.Ov.isActivated("B34E3F01-04D5-4161-9629-4B783CA48830","01/23/2024","Customize image editing in one up")||e.exposeFactory(Td,new f.TF(Vu)),ht.a?function(e){e.expose(Ou.a,async()=>{const[{resourceKey:t},{downloadDataSourceKey:a},{legacyGraphDataSourceKey:i},{resourceKey:r},{isOnePlayerEnabledResourceKey:o}]=await Promise.all([n.e(65).then(n.bind(n,762)),n.e(65).then(n.bind(n,467)),n.e(65).then(n.bind(n,238)),Promise.resolve().then(n.bind(n,45)),n.e(65).then(n.bind(n,763))]);e.exposeFactory(wu.f,new f.TF(t)),e.exposeFactory(wu.a,new f.TF(a)),e.exposeFactory(wu.b,new f.TF(i)),e.exposeFactory(wu.e,new f.TF(tn.a)),e.exposeFactory(wu.c,new f.TF(r)),e.exposeFactory(Eu.a,new f.TF(o))}),e.expose(Cu.b,Au)}(e):e.exposeFromPack(function(){const e=new f.LX;return e.addAlias(Gu.a,Ku),e.addAlias(Cu.a,zu),e}()),nm.webTemplate===kn.b.mySite.toString()&&e.exposeFactory(Lu,new f.TF(Mu)),f.Ov.isActivated("9b559192-7d10-466a-a1be-da381f30568a","09/04/2024","aterentiev - enable OCV feedback for copilot viewer")||e.exposeFactory(cf.a,new f.TF(Gt.resourceKey)),f.Ov.isActivated("534bb451-0390-4c4a-927c-ec97a617fd7d","10/25/2024","bentsai - enable host theme resource key")||e.expose(Et.f,(0,d.kF)()),f.Ov.isActivated("74cf6df0-5727-4b29-a71c-d85fea84ae5a","04/02/2025","bentsai - enable alwaysUseTokenFetcherForVroomKey resource key")||e.expose(G.a,!0)}else fm.reportBootCXPFailure({rawError:{errorType:Ie.d.processOneUpItemError,error:new f.a_({code:"fastOneUp-NoPageContext"})}});if(Te.lb()&&(0,mf.a)(nm))return tm.exposeAsync(em.a,new f.hg(async()=>{const{consumerResourceKey:e}=await Promise.all([n.e("ondemand.resx"),n.e(5)]).then(n.bind(n,767));return e})),e.exposeFactory($p.a,new f.TF(Fu.a)),e.consumeAsync(Zp).then(e=>e.initialize())}catch(e){fm.reportBootCXPFailure({rawError:{errorType:Ie.d.processOneUpItemError,error:new f.a_({code:"fastOneUp-initResourcesException",innerError:e})}})}return Promise.resolve()}Te.lb()?hm(tm).then(()=>{_m()}):(hm(tm),_m())}
,,(e,t,n)=>{"use strict";new Date}
,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p,downloadDataSourceKey:()=>m});var a=n(545),i=n("odsp.util_385"),r=n(861);function o(e){if(void 0!==e)return e}var s=n(15),c=n(6),d=n(45),l=n(1),u=n(295),f=n(4);class p{getDownloadUrl(e,t={}){return this._common.getDownloadUrl(o(e),o(void 0),t)}getItemClassicDownloadLink(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl+"?avcmd=1"}downloadItems(e){const t=e.items[0],n=this._itemUrlHelper.getItemUrlParts(t.key);return this.getDownloadRequestParameters(t,0).then(e=>{const t=this._getDownloadIframe();if(window.document.body.appendChild(t),!(0,f.mc)()&&n.isCrossDomain&&e.token&&t&&t.contentDocument)(0,u.a)({url:e.url,postdata:{access_token:e.token},document:t.contentDocument}),setTimeout(function(){window.document.body.removeChild(t)},2e4);else{window.document.body.removeChild(t);const n=this._initIframe(e.url);setTimeout(function(){window.document.body.removeChild(n)},2e4)}})}getItemContents(e){return this.getDownloadRequestParameters(e,2).then(e=>{const t=e.headers,n=t&&t.Authorization,a=n&&n.slice(7);return this._dataRequestor.getData({url:e.url,method:"GET",noRedirect:!0,qosName:"ItemDataSource.getItemContents",responseType:"blob",needsRequestDigest:!1,authToken:a})})}getDownloadRequestParameters(e,t,n){const a=this._itemUrlHelper.getItemUrlParts(e.key),i=new c.a(a.normalizedItemUrl);return a.isCrossDomain?this._identityDataSource.getSharePointToken({webAbsoluteUrl:a.fullWebUrl||i.authority,apiQosName:"DownloadDataSource"}).then(n=>{const r=n.accessToken;return this.getDownloadUrl(e,{downloadType:t,authToken:r,webAbsoluteUrl:a.fullWebUrl||i.authority}).then(e=>({url:e,headers:{Authorization:`bearer ${r}`},token:r}))}):this.getDownloadUrl(e,{downloadType:t,webAbsoluteUrl:a.fullWebUrl||i.authority}).then(e=>({url:e,withCredentials:!0}))}_initIframe(e){const t=document.createElement("iframe");return t.src=e,t.style.display="none",window.document.body.appendChild(t),t}_getDownloadIframe(e=Math.random()){const t=document.createElement("iframe");return t.id="od-download-iframe"+e,t.name=t.id,t.hidden=!0,t}constructor(e,t){this._common=new a.a(t.pageContext),this._dataRequestor=new t.dataRequestorType({}),this._itemUrlHelper=t.itemUrlHelper,this._identityDataSource=t.identityDataSource}}const m=(0,i.C2)("DownloadDataSource",p,{dataRequestorType:r.b,pageContext:l.a,itemUrlHelper:s.c,identityDataSource:d.resourceKey})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>ct});var a=n("tslib_145"),i=n(181),r=n(302),o=n(864),s=n("react-lib"),c=n.n(s),d=n(402),l=n(423),u=n(204),f=n(438),p=n("fui.util_939");(0,p.ZW)([{rawString:".root_58dd2d21{width:100%;height:100%;position:relative;overflow:hidden}"}]);var m=n(583),_=n(404),h=n(37),b=n(71),g=n(336),v=n(64),y=n(84),S=n(63),D=n(411),I=n(32),x=n(127),C=n(67),O=n(52),w=n(332),E=n(199),A=n(85),L=n(559),k=n("fui.core_136"),M={display:"flex",alignItems:"center"},P=(0,p.RM)(function(e,t){var n=e.palette,i={root:{height:44,flexShrink:0,padding:"0 14px",backgroundColor:e.semanticColors.menuBackground,border:"".concat(1,"px solid ").concat(n.neutralLight),boxSizing:"content-box",overflow:"hidden"},center:(0,a.q5)((0,a.q5)({},M),{justifyContent:"center",padding:"0 15px","@media (max-width: 460px)":{display:"none"}})};return(0,k.Akq)(i,t)}),T=(0,a.q5)((0,a.q5)({},M),{flexBasis:"33.3%"}),U=(0,a.q5)((0,a.q5)({},M),{justifyContent:"flex-end",flexBasis:"33.3%"}),F=function(e){var t=e.leftItems,n=void 0===t?[]:t,a=e.centerItems,i=void 0===a?[]:a,r=e.rightItems,o=void 0===r?[]:r,c=e.styles,d=(0,A.a)(),l=P(d,c);return s.createElement(L.a,{horizontal:!0,styles:{root:l.root}},s.createElement(L.a.Item,{style:T,grow:!0},n),s.createElement(L.a.Item,{styles:{root:l.center},grow:!0},i),s.createElement(L.a.Item,{style:U,grow:!0},o))},H=n(308),R=c().memo(function(e){var t=e.disabled,n=e.text,a=e.role,i=e.onClick,r=(0,d.c)(),o=(0,A.a)(),s=o.semanticColors,l=c().useCallback(function(){i(),y.a.logEngagement({name:"SaveChanges",actionGesture:"Click"})},[i]);return c().createElement(H.a,{role:a,text:n||r.get("save"),title:r.get("saveTooltip"),disabled:t,theme:o,onClick:l,styles:{label:{whiteSpace:"nowrap",textOverflow:"ellipsis"},rootDisabled:{color:s.buttonTextDisabled,borderColor:s.buttonBackgroundHovered,borderWidth:"1px",borderStyle:"solid"}}})}),N=n(171),B=c().memo(function(e){var t=e.disabled,n=e.onClick,a=(0,d.c)(),i=(0,A.a)(),r=c().useCallback(function(){n(),y.a.logEngagement({name:"DiscardChanges",actionGesture:"Click"})},[n]);return c().createElement(N.a,{text:a.get("discard"),title:a.get("discardTooltip"),ariaLabel:a.get("discardAria"),disabled:t,theme:i,onClick:r})}),j=n(572),V=n(327),z=n(328),G={isBlocking:!0,isModeless:!0,styles:{main:{"@media (min-width: 640px)":{width:480,maxWidth:480},minWidth:320}},layerProps:{styles:{root:{zIndex:15e5}}}},K=function(e){var t=e.hidden,n=e.contentTitle,a=e.contentSubText,i=e.children,r=e.onDismiss,o=(0,A.a)();return c().createElement(j.a,{hidden:t,theme:o,dialogContentProps:{type:V.a.normal,title:n,subText:a},modalProps:G,onDismiss:r},c().createElement(z.a,null,i))},W=function(e){var t=e.hidden,n=e.onSave,a=e.onDiscard,i=e.onDismiss,r=(0,d.c)();return c().createElement(K,{hidden:t,contentTitle:r.get("unsavedChangesTitle"),contentSubText:r.get("unsavedChangesMessage"),onDismiss:i},c().createElement(R,{onClick:n}),c().createElement(B,{onClick:a}))},q=function(e){var t=e.hidden,n=e.onSave,a=e.onDiscard,i=e.onDismiss,r=(0,d.c)();return c().createElement(K,{hidden:t,contentTitle:r.get("versionChangeTitle"),contentSubText:r.get("versionChangeMessage"),onDismiss:i},c().createElement(R,{onClick:n}),c().createElement(B,{onClick:a}))};(0,p.ZW)([{rawString:"html[dir=ltr] .saveBtn_00e42b0f{padding-left:16px}html[dir=rtl] .saveBtn_00e42b0f{padding-right:16px}.fileHeader_00e42b0f{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;text-align:center;padding:10px}.fileHeader_00e42b0f>*{padding:0 4px}.fileHeader_00e42b0f .fileTitle_00e42b0f{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;max-width:200px;line-height:1}.fileHeader_00e42b0f .fileTitle_00e42b0f>div{white-space:nowrap}.fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{overflow:hidden;text-overflow:ellipsis}html[dir=ltr] .fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{margin-right:4px}html[dir=rtl] .fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{margin-left:4px}.closeButton_00e42b0f{color:inherit}"}]);var Q=function(e){void 0===e&&(e="");var t=e.match(/^([^\\]*)\.(\w+)$/);return t?t[2]:".pdf"},Y=s.lazy(function(){return n.e(28).then(n.bind(n,752)).then(function(e){return{default:e.InkingToolbarNext}})}),J=s.lazy(function(){return n.e(38).then(n.bind(n,788)).then(function(e){return{default:e.UndoRedoButtons}})}),X=s.forwardRef(function(e,t){var n=e.hasEdits,i=e.filename,r=e.allowUnloadPageWithEdits,o=e.inkingToolbarProps,c=e.onSave,l=e.onClose,u=e.onDiscard,f=e.isFileVersionChanged,p=(0,a.pM)(s.useState(!1),2),m=p[0],_=p[1],g=(0,a.pM)(s.useState(!1),2),S=g[0],A=g[1],L=(0,d.c)(),k=(0,D.b)(),M=k.pdfViewer,P=k.annotMode,T=(0,E.a)(function(){n?_(!0):l()});s.useEffect(function(){var e=function(e){n&&!r&&(e.preventDefault(),e.returnValue=!1)};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}},[r,n]),s.useImperativeHandle(t,function(){return{close:T}},[T]);var U=(0,E.a)(function(){y.a.logEngagement({name:"ExitEditMode",actionGesture:"Click",extraData:{hasEdits:n}}),T()}),H=(0,E.a)(function(){null==M||M.triggerInkDrying(),window.setTimeout(function(){U()},200)}),N=s.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t,n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:_(!1),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null==f?void 0:f()];case 2:return e=a.sent(),[3,4];case 3:return t=a.sent(),n=(null==t?void 0:t.message)||JSON.stringify(t),i=new v.c(void 0,"Fail to check file version when saving, reason: ".concat(n)),y.a.logError(i.toCaughtError()),[3,4];case 4:return e?A(!0):c(),[2]}})})},[f,c]),B=(0,E.a)(function(){var e;!(null===(e=h.a.features)||void 0===e?void 0:e.enableEnhancedInk)||P!==b.a.Ink&&P!==b.a.Highlight&&P!==b.a.PointErase?U():H()}),j=s.useCallback(function(){_(!1),u(),l()},[l,u]),V=s.useCallback(function(){_(!1)},[]),z=s.useCallback(function(){A(!1)},[]),G=s.useMemo(function(){var e;return(0,a.lt)([s.createElement("div",{key:"Save",className:"saveBtn_00e42b0f"},s.createElement(R,{role:"menuitem",disabled:!n,text:L.get("saveChanges"),onClick:N}))],(0,a.pM)((null===(e=h.a.features)||void 0===e?void 0:e.enableUndoRedo)?[s.createElement(s.Suspense,{fallback:s.createElement("div",null),key:"UndoRedoButtons"},s.createElement(J,null))]:[]),!1)},[n,L,N]),K=L.get("fileHeaderSuffixInEditMode"),X=s.useMemo(function(){return o?[s.createElement(s.Suspense,{fallback:s.createElement("div",null),key:"inkingToolbar"},s.createElement(Y,(0,a.q5)({key:(null==o?void 0:o.defaultToolType)||"",actionScenario:"PdfAnnotationNext",isHorizontal:!0},o)))]:[s.createElement("div",{key:"FileHeader",className:"fileHeader_00e42b0f",tabIndex:0,"aria-label":"".concat(i,", ").concat(K),"data-is-focusable":!0},s.createElement(I.a,(0,a.q5)({},(0,w.a)({extension:Q(i),size:16}))),s.createElement("div",{className:"fileTitle_00e42b0f"},s.createElement("div",{className:"fileName_00e42b0f"},i),s.createElement("div",null,"- ".concat(K))))]},[K,i,o]),Z=s.useMemo(function(){return[s.createElement(x.a,{key:"Cancel",iconProps:{iconName:"Cancel"},title:L.get("exitEditTooltip"),role:"menuitem",onClick:B,className:"closeButton_00e42b0f"})]},[L,B]),$=s.useMemo(function(){return o?{center:{"@media (max-width: 460px)":{display:"flex"}}}:void 0},[o]);return s.createElement("div",{role:"menubar"},s.createElement(C.a,{shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:O.b.none,direction:O.a.horizontal},s.createElement(F,{leftItems:G,centerItems:X,rightItems:Z,styles:$})),s.createElement(W,{hidden:!m,onSave:N,onDiscard:j,onDismiss:V}),s.createElement(q,{hidden:!S,onSave:c,onDiscard:j,onDismiss:z}))});X.displayName="EditCommandBar";var Z=n(320),$=c().memo(function(e){var t=e.disabled,n=e.onClick,a=(0,d.c)(),i=(0,A.a)(),r=c().useCallback(function(){n(),y.a.logEngagement({name:"DoExtract",actionGesture:"Click"})},[n]);return c().createElement(H.a,{text:a.get("doExtract"),title:a.get("doExtractTooltip"),ariaLabel:a.get("doExtractAria"),disabled:t,theme:i,onClick:r})});(0,p.ZW)([{rawString:"html[dir=ltr] .saveBtn_edd24649{padding-left:16px}html[dir=rtl] .saveBtn_edd24649{padding-right:16px}.title_edd24649{display:inline-block;max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.rightDivider_edd24649{height:16px;margin:0 20px}.selectionCounter_edd24649{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.closeButton_edd24649{color:inherit}"}]);const ee="closeButton_edd24649";var te=s.forwardRef(function(e,t){var n=e.onSave,i=e.onClose,r=e.viewerRef,o=(0,d.c)(),c=(0,a.pM)(s.useState([]),2),u=c[0],f=c[1],p=(0,l.c)(),m=s.useMemo(function(){return u.filter(function(e){return e}).length},[u]),_=m>0;s.useEffect(function(){return p.setMode("Select"),p.subscribe(function(e){f(e)}),function(){var e;null===(e=p.unsubscribe)||void 0===e||e.call(p)}},[p]),s.useEffect(function(){var e=function(e){_&&(e.preventDefault(),e.returnValue=!1)};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}},[_]);var h=s.useCallback(function(){var e;null===(e=p.resetPageSelection)||void 0===e||e.call(p),y.a.logEngagement({name:"DiscardExtractSelections",actionGesture:"Click"})},[p]),b=s.useCallback(function(){var e;null===(e=p.resetPageSelection)||void 0===e||e.call(p),p.toggle(!1),i(),y.a.logEngagement({name:"CancelExtract",actionGesture:"Click"})},[i,p]),g=s.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t,i,o,s;return(0,a.SO)(this,function(a){return e=null===(s=null===(o=r.current)||void 0===o?void 0:o.getViewer())||void 0===s?void 0:s.extract,p&&e?0===(t=(null==u?void 0:u.map(function(e,t){return e?t:null}).filter(function(e){return null!==e}))||[]).length?[2]:(i=function(){return e(t)},[2,null==n?void 0:n(i,b)]):[2]})})},[n,b,u,p,r]);s.useImperativeHandle(t,function(){return{close:b}},[b]);var v=s.useMemo(function(){return[s.createElement("div",{key:"Save",className:"saveBtn_edd24649"},s.createElement($,{disabled:!_,onClick:g}))]},[_,g]),S=s.useMemo(function(){return[s.createElement("div",{key:"Title",className:"title_edd24649"},o.get("extractCommandBarTitle"))]},[o]),D=s.useMemo(function(){return[s.createElement("div",{key:"Discard",className:"selectionCounter_edd24649"},s.createElement(x.a,{className:ee,iconProps:{iconName:"Cancel"},ariaLabel:o.get("clearExtractAria",[m]),title:o.get("clearExtractTooltip"),role:"button",onClick:h,disabled:0===m}),s.createElement("span",{style:{marginLeft:"6px"}},m," selected")),s.createElement(Z.a,{key:"Divider",className:"rightDivider_edd24649"}),s.createElement(x.a,{key:"Cancel",className:ee,iconProps:{iconName:"Cancel"},ariaLabel:o.get("exitExtractAria"),title:o.get("exitExtractTooltip"),role:"button",onClick:b})]},[o,b,h,m]);return s.createElement(F,{leftItems:v,centerItems:S,rightItems:D})}),ne=n(405),ae=n(214),ie=n(57),re=n(128),oe=n(334),se=n(408),ce=n(338);(0,p.ZW)([{rawString:".spinner_c7f02c9d{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);bottom:17px;max-width:50%;padding:12px 15px;border-radius:33px;z-index:99}"}]);var de=function(e){return{root:{backgroundColor:e.semanticColors.menuBackground},circle:{animationDuration:"0.7s",minWidth:20},label:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.palette.neutralPrimary,padding:"0 2px"}}},le=function(){var e=(0,se.b)().contentViewer,t=(0,A.a)();return s.createElement(ce.a,{styles:de(t),className:"spinner_c7f02c9d",label:e.getFilename(),labelPosition:"right"})};(0,p.ZW)([{rawString:".root_72829470{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mainWrapper_72829470{position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1}.saveModal_72829470{position:absolute;bottom:0;width:100%;height:100%;background:rgba(0,0,0,.2)}.main_72829470{position:relative;height:100%}"}]);var ue=n(420),fe=n(331),pe={root:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)"}},me=function(){return(0,f.c)().isVisible?c().createElement(fe.a,{styles:pe}):c().createElement(c().Fragment,null)};(0,p.ZW)([{rawString:".bottomToolArea_7516adf3{position:fixed;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);bottom:17px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:16px;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.placeBottomToolOnTop_7516adf3{z-index:99}.inkBar_7516adf3{position:absolute;top:50%;-webkit-transform:translate(0, -50%);transform:translate(0, -50%)}html[dir=ltr] .inkBar_7516adf3{left:20px}html[dir=rtl] .inkBar_7516adf3{right:20px}.topArea_7516adf3{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);top:0px;width:100%}"}]);var _e=function(e){var t=e.expected,n=e.onDownload,i=e.onOpenInBrowser,r=e.enableDownload,o=e.enableOpenInBrowser,c=(0,a.pM)(s.useState(!0),2),l=c[0],u=c[1],f=(0,d.c)(),p=(0,A.a)(),m=s.useCallback(function(){u(!1)},[]),_=s.useCallback(function(){null==n||n(),m()},[n,m]),h=s.useCallback(function(){null==i||i(),m()},[i,m]);return s.createElement(j.a,{hidden:!l,minWidth:480,theme:p,dialogContentProps:{type:V.a.normal,title:t?f.get("mipUnsupportedTitle"):f.get("mipErrorTitle"),subText:t?f.get("mipUnsupportedMessage"):f.get("mipErrorMessage")},modalProps:{isBlocking:!0,isModeless:t,layerProps:{styles:{root:{zIndex:15e5}}}},onDismiss:m},s.createElement(z.a,null,s.createElement(N.a,{onClick:_,text:f.get("download"),disabled:!r||!n}),s.createElement(H.a,{onClick:h,text:f.get("openInBrowser"),disabled:!o||!i})))},he=n(306),be=n(87),ge=n(581),ve=n(182),ye={background:"#323130",runningIcon:"#FAF9F8",successIcon:"#54B054",errorIcon:"#F1707B",infoIcon:"#EDEBE9",link:"#71ADE2",text:"#EDEBE9",hoveredButtonBackground:"#484644",barColor:"#FAF8F8",barBackground:"#605E5C"},Se={background:"#F3F2F1",runningIcon:"#292827",successIcon:"#54B054",errorIcon:"#F1707B",infoIcon:"#292827",link:"#71ADE2",text:"#292827",hoveredButtonBackground:"#EDEBE9",barColor:"#292827",barBackground:"#A19F9D"};(0,p.ZW)([{rawString:".wrapper_9c898eca{padding:0 10px;z-index:99;width:352px;border-radius:4px;display:block;overflow:hidden;-webkit-transform-origin:center;transform-origin:center;will-change:transform;-webkit-transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:transform 300ms ease,opacity 300ms ease;transition:transform 300ms ease,opacity 300ms ease,-webkit-transform 300ms ease;-webkit-animation:tooltipShow_9c898eca 300ms ease 1;animation:tooltipShow_9c898eca 300ms ease 1}.hidden_9c898eca{-webkit-transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:transform 300ms ease,opacity 300ms ease;transition:transform 300ms ease,opacity 300ms ease,-webkit-transform 300ms ease;-webkit-animation:tooltipHide_9c898eca 300ms ease forwards 1;animation:tooltipHide_9c898eca 300ms ease forwards 1}.displayNone_9c898eca{display:none}@-webkit-keyframes rotating_9c898eca{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotating_9c898eca{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.rotate_9c898eca{-webkit-animation:rotating_9c898eca 1s linear infinite;animation:rotating_9c898eca 1s linear infinite}.toastInfo_9c898eca{gap:8px;padding:6px 4px}.toastLeadIconContainer_9c898eca,.toastPostIconContainer_9c898eca{width:24px;height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.toastLeadIconContainer_9c898eca{font-size:16px}.toastPostIconContainer_9c898eca{font-size:14px;cursor:pointer;border-radius:5px}.toastText_9c898eca{padding:4px 0}@-webkit-keyframes tooltipShow_9c898eca{from{opacity:0;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0)}}@keyframes tooltipShow_9c898eca{from{opacity:0;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0)}}@-webkit-keyframes tooltipHide_9c898eca{to{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}}@keyframes tooltipHide_9c898eca{to{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}}"}]);var De=s.memo(function(e){var t=e.darkMode,n=void 0!==t&&t,i=(0,u.d)(),r=(0,u.c)(),o=r.type,c=r.text,l=r.link,f=r.linkText,_=r.percentComplete,h=r.infoIconName,b=r.shouldAutoFocus,g=void 0===b||b,v=r.disableAutoHide,y=void 0!==v&&v,S=r.onClickButton,D=s.useMemo(function(){return n?Se:ye},[n]),I=s.useMemo(function(){return function(e,t,n){switch(e){case u.b.Error:return{iconName:"StatusErrorFull",iconButtonName:"clear",iconColor:t.errorIcon};case u.b.Success:return{iconName:"SkypeCircleCheck",iconButtonName:"clear",iconColor:t.successIcon};case u.b.Info:return{iconName:n||"Info",iconButtonName:"clear",iconColor:t.infoIcon};case u.b.Running:default:return{iconName:"SyncStatusSolid",iconButtonName:"FullScreen",iconColor:t.runningIcon}}}(o,D,h)},[D,h,o]),C=I.iconName,O=I.iconButtonName,w=I.iconColor,E=s.useRef(u.b.Hidden),A=(0,a.pM)(s.useState(o===u.b.Hidden),2),k=A[0],M=A[1],P=s.useRef(null),T=(0,d.c)(),U=(o===u.b.Success||o===u.b.Error)&&l&&f,F=s.useCallback(function(){setTimeout(function(){i({type:u.b.Hidden})},5e3)},[i]);s.useEffect(function(){E.current!==u.b.Running||o!==u.b.Success||y?E.current!==u.b.Hidden&&o===u.b.Hidden?setTimeout(function(){M(!0)},500):E.current===u.b.Hidden&&o!==u.b.Hidden&&(M(!1),(o===u.b.Info||o===u.b.Success&&!y)&&F()):F(),E.current=o},[F,y,k,o]),s.useEffect(function(){var e;k||(g&&o!==u.b.Info&&o!==u.b.Hidden&&(null===(e=P.current)||void 0===e||e.focus()),oe.a.read(c))},[k,g,c,o]);var H=s.useMemo(function(){return{root:{width:24,height:24},icon:{color:D.text,width:14,height:14,fontSize:14},rootHovered:{backgroundColor:D.hoveredButtonBackground},rootPressed:{backgroundColor:D.hoveredButtonBackground},rootExpanded:{backgroundColor:D.hoveredButtonBackground}}},[D.hoveredButtonBackground,D.text]);return s.createElement("div",{style:{background:D.background,color:D.text},className:(0,p.ZK)("wrapper_9c898eca",o===u.b.Hidden&&"hidden_9c898eca",k&&"displayNone_9c898eca"),tabIndex:0,"data-is-focusable":!0,ref:P},s.createElement(L.a,{className:"toastInfo_9c898eca",horizontal:!0,horizontalAlign:"space-between",verticalAlign:"start"},s.createElement(he.a,{className:(0,p.ZK)("toastLeadIconContainer_9c898eca",o===u.b.Running&&"rotate_9c898eca")},s.createElement(be.a,{style:{color:w},"aria-label":o,iconName:C})),s.createElement(he.a,{grow:!0,className:"toastText_9c898eca"},s.createElement(L.a,null,s.createElement(he.a,null,s.createElement(ge.a,{style:{color:D.text}},c)),U&&s.createElement(he.a,null,s.createElement(ve.a,{style:{color:D.link},href:l,target:"_blank"},f)))),s.createElement(he.a,{className:"toastPostIconContainer_9c898eca"},S&&s.createElement(x.a,{onClick:S,styles:H,iconProps:{iconName:O},"aria-label":"clear"===O?T.get("closeButtonAria"):void 0}))),o===u.b.Running&&s.createElement(m.a,{styles:{itemProgress:{paddingTop:0,paddingBottom:4},progressBar:{background:_?D.barColor:"linear-gradient(to right, ".concat(D.barBackground," 0%, ").concat(D.barColor," 50%, ").concat(D.barBackground," 100%)")},progressTrack:{backgroundColor:D.barBackground}},percentComplete:_,ariaValueText:""}))}),Ie=n(339),xe=function(e){var t=e.semanticColors.menuIcon,n={backgroundColor:e.semanticColors.menuItemBackgroundHovered,color:t};return{root:{backgroundColor:e.semanticColors.menuBackground,color:t},rootHovered:n,rootPressed:n,rootExpanded:n}},Ce={root:{verticalAlign:"baseline",display:"inline-block"}};(0,p.ZW)([{rawString:".toolIcon_66e857e6{height:0;padding:15px 20px;margin:calc(7px) 0;border-radius:5px}.menuIcon_66e857e6{height:0;padding:15px calc(8px);margin:calc(7px) 0}"}]);const Oe="toolIcon_66e857e6";var we=function(e){var t=(0,A.a)(),n=(0,se.b)().contentViewer,i=s.useCallback(function(){var e=n.getViewer();e?e.focus():document.activeElement instanceof HTMLButtonElement&&document.activeElement.blur()},[n]);return e.hidden?s.createElement(s.Fragment,null):s.createElement(Ie.a,{content:e.tooltip,styles:Ce},s.createElement(x.a,(0,a.q5)({},e,{iconProps:{iconName:e.iconName},className:Oe,styles:xe(t),onMouseUp:i})))},Ee=n(51),Ae=function(){return null},Le=function(e){var t=e.iconName,n=e.tooltip,i=e.items,o=e.defaultCheckedKey,c=e.uncheckAll,d=e.onClickMenuItem,l=e.onOpen,u=e.onDismiss,f=(0,a.pM)(s.useState([]),2),m=f[0],_=f[1],h=(0,a.pM)(s.useState(""),2),b=h[0],g=h[1],v=(0,A.a)();return s.useEffect(function(){var e=[],t=function(e,t){var n,r;if(t){var o=void 0;try{for(var s=(0,a.BW)(i),c=s.next();!c.done;c=s.next()){var l=c.value;if(l.key===t.key){o=l.value;break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}null==d||d.call(void 0,o),g(t.key)}};i.forEach(function(n){e.push({key:n.key,text:n.text,canCheck:!0,checked:n.key===b,onClick:t})}),_(e)},[i,b,d]),s.useEffect(function(){g(o||"")},[o]),s.useEffect(function(){c&&g("")},[c]),s.createElement(Ie.a,{content:n,styles:Ce},s.createElement(x.a,(0,a.q5)({},e,{iconProps:{iconName:t},className:(0,p.ZK)(Oe,"menuIcon_66e857e6"),styles:xe(v),persistMenu:!0,menuProps:{shouldFocusOnMount:!0,shouldFocusOnContainer:!0,items:m,focusZoneProps:{handleTabKey:0},directionalHint:(0,r.a)()?Ee.a.topRightEdge:Ee.a.topLeftEdge,directionalHintFixed:!0,styles:{root:{".ms-ContextualMenu-itemText":{flexGrow:0}}},onMenuOpened:l,onMenuDismissed:u},onRenderMenuIcon:Ae})))},ke=n(440);(0,p.ZW)([{rawString:".root_d244541c{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;white-space:nowrap;font-size:14px;bottom:calc(61px);border-radius:21px 21px 0 0;border-bottom:1px solid}@media(max-width: 400px){.root_d244541c{border-radius:0}}.keyword_d244541c{display:inline-table;border-collapse:separate;border-spacing:8px}.keyword_d244541c input{display:table-cell;width:100%;text-indent:5px}html[dir=ltr] .keyword_d244541c input{padding-left:4px}html[dir=rtl] .keyword_d244541c input{padding-right:4px}html[dir=ltr] .keyword_d244541c input{padding-right:2px}html[dir=rtl] .keyword_d244541c input{padding-left:2px}html[dir=ltr] .keyword_d244541c input{text-align:left}html[dir=rtl] .keyword_d244541c input{text-align:right}.keyword_d244541c input:focus{border:1px solid var(--search-focus-border-color) !important}.keyword_d244541c .result_d244541c{display:table-cell;text-align:center}html[dir=ltr] .keyword_d244541c .result_d244541c{padding-left:10px}html[dir=rtl] .keyword_d244541c .result_d244541c{padding-right:10px}"}]);var Me=function(e){var t=e.width,n=(0,a.pM)(s.useState(0),2),i=n[0],r=n[1],o=(0,a.pM)(s.useState(0),2),c=o[0],l=o[1],u=(0,a.pM)(s.useState(""),2),f=u[0],p=u[1],m=s.useRef(!1),_=(0,se.b)().contentViewer.getViewer(),h=(0,d.c)(),b=(0,A.a)();s.useEffect(function(){return function(){null==_||_.stopSearch()}},[_]);var g=s.useCallback(function(e){r(0),l(0);var t=0,n=0;null==_||_.startSearch(e,void 0,void 0,{onHitIndexUpdate:function(a){-1===a?null==_||_.goToNextSearchResult(!0):(l(a),n&&oe.a.read(h.get("searchIndex",[e,a+1,t])))},onTotalResultUpdate:function(a,i){r(a),t=a,n=i,oe.a.read(h.get("searchTotalCount",[e,a]))}})},[h,_]),v=s.useCallback(function(e){var t=e.target.value;p(t),m.current||g(t)},[g]),y=s.useCallback(function(){m.current=!0},[]),S=s.useCallback(function(){m.current=!1,g(f)},[f,g]),D=s.useCallback(function(e){void 0===e&&(e=!0),null==_||_.goToNextSearchResult(e)},[_]),I=s.useCallback(function(){D(!1)},[D]),x=s.useCallback(function(){D(!1)},[D]),C=s.useCallback(function(){D(!0)},[D]);return s.createElement("div",{className:"root_d244541c",style:{backgroundColor:b.semanticColors.menuBackground,borderBottomColor:b.semanticColors.menuDivider},role:"menubar"},s.createElement(ke.a,{autoFocusOnInput:!0,rootProps:{className:"keyword_d244541c",style:{color:b.semanticColors.disabledText,width:t?"".concat(t-100,"px"):"auto","--search-focus-border-color":b.semanticColors.messageLink},role:"menuitem","aria-label":h.get("searchQueryAria")},inputProps:{type:"text",value:f,placeholder:h.get("searchInputPlaceholder"),maxLength:100,role:"textbox","aria-label":h.get("searchInputAria"),onChange:v,onCompositionStart:y,onCompositionUpdate:y,onCompositionEnd:S},onEnterWhenFocused:D,onShiftEnterWhenFocused:I},s.createElement("div",{className:"result_d244541c",style:i?{color:b.semanticColors.menuItemText}:void 0,"aria-label":i?h.get("searchResultAria",[c+1,i]):h.get("noSearchResultAria")},s.createElement("span",null,i?c+1:0),"/",s.createElement("span",null,i))),s.createElement(we,{iconName:"ChevronLeft",tooltip:h.get("previousTooltip"),role:"menuitem",ariaLabel:h.get("previousResultCommandAria"),onClick:x}),s.createElement(we,{iconName:"ChevronRight",tooltip:h.get("nextTooltip"),role:"menuitem",ariaLabel:h.get("nextResultCommandAria"),onClick:C}))};(0,p.ZW)([{rawString:".root_d8a579b8{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;white-space:nowrap;font-size:14px;-webkit-box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);border-radius:33px}@media(max-width: 400px){.root_d8a579b8{border-radius:12px}}.toolBarContent_d8a579b8{overflow:auto;max-width:80vw}.fadeOut_d8a579b8{visibility:hidden;opacity:0;-webkit-transition:visibility 0s linear 300ms,opacity 300ms;transition:visibility 0s linear 300ms,opacity 300ms}.fadeIn_d8a579b8{visibility:visible;opacity:1;-webkit-transition:visibility 0s linear 0s,opacity 150ms;transition:visibility 0s linear 0s,opacity 150ms}.pagination_d8a579b8{display:inline-table}html[dir=ltr] .pagination_d8a579b8{margin-left:10px}html[dir=rtl] .pagination_d8a579b8{margin-right:10px}html[dir=ltr] .pagination_d8a579b8{padding-right:10px}html[dir=rtl] .pagination_d8a579b8{padding-left:10px}.pagination_d8a579b8 input{display:table-cell;width:30px;padding:0 2px;text-align:center}.pagination_d8a579b8 .status_d8a579b8{display:table-cell;text-align:center}.slash_d8a579b8{padding:0 5px}.expanded_d8a579b8{border-radius:0 0 21px 21px;-webkit-box-shadow:none;box-shadow:none}@media(max-width: 400px){.expanded_d8a579b8{border-radius:0}}.shadowBox_d8a579b8{-webkit-box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);border-radius:21px}"}]);const Pe="toolBarContent_d8a579b8";var Te=/^[0-9\b]+$/,Ue=[.5,.75,1,1.25,1.5,2,3,4],Fe={height:"16px",margin:"14px 10px"},He=function(e){e.stopPropagation()},Re=function(e){e.currentTarget.select()},Ne=s.forwardRef(function(e,t){var n=e.visible,i=e.searchBarVisible,r=e.disableSearch,o=e.currentIndex,c=e.showPrint,l=e.showOpenInNewWindow,u=e.dataAttributes,f=e.defaultScale,m=e.onAutoHide,_=e.onOpenInNewWindow,h=e.onSearchToggle,g=(0,a.pM)(s.useState(0),2),v=g[0],S=g[1],D=(0,a.pM)(s.useState(!1),2),I=D[0],x=D[1],w=s.useRef(null),E=s.useRef(),L=s.useRef(!1),k=s.useRef(!1),M=s.useRef(!1),P=s.useRef(null),T=s.useRef(null),U=(0,se.b)().contentViewer.getViewer(),F=(0,d.c)(),H=(0,A.a)(),R=s.useCallback(function(){E.current&&window.clearTimeout(E.current)},[]),N=s.useCallback(function(){k.current||L.current||M.current||i||(R(),E.current=window.setTimeout(function(){m()},4e3))},[m,i,R]),B=s.useCallback(function(){U&&(v>=0&&v<U.pageCount?(U.goToPage(v),y.a.logEngagement({name:"GoToCertainPage",actionGesture:"Click",extraData:{pageIndex:v}})):S(o))},[v,U,o]);s.useEffect(function(){return n&&N(),function(){R()}},[n,N,R]),s.useEffect(function(){S(o)},[o]),s.useImperativeHandle(t,function(){return{focus:function(){window.setTimeout(function(){var e;null===(e=P.current)||void 0===e||e.focus()})},uncheckZoomMenu:function(){x(!0)}}},[]);var j=s.useCallback(function(){L.current=!0,R()},[R]),V=s.useCallback(function(){L.current=!1,N()},[N]),z=s.useCallback(function(){k.current=!0,R()},[R]),G=s.useCallback(function(){k.current=!1,N()},[N]),K=s.useCallback(function(e){void 0===e&&(e=!0);var t=e?o+1:o-1;null==U||U.goToPage(t),y.a.logEngagement({name:e?"GoToNextPage":"GoToPreviousPage",actionGesture:"Click"})},[o,U]),W=s.useCallback(function(){B()},[B]),q=s.useCallback(function(e){var t=e.target.value;t?Te.test(t)&&S(parseInt(t,10)-1):S(-1)},[]),Q=s.useCallback(function(e){"Enter"===e.key&&B()},[B]),Y=s.useCallback(function(e){null==U||U.zoom(e),x(!1),y.a.logEngagement({name:"SelectZoomOption",actionGesture:"Click",extraData:{zoomOption:e}})},[U]),J=s.useCallback(function(){var e=[],t=0;return e.push({key:"".concat(t++),text:F.get("zoomPageFitSize"),value:b.i.FitSize}),e.push({key:"".concat(t++),text:F.get("zoomPageFitWidth"),value:b.i.FitWidth}),Ue.forEach(function(n){e.push({key:"".concat(t++),text:"".concat(100*n,"%"),value:n})}),e},[F]),X=s.useCallback(function(){var e="number"==typeof f?"".concat(100*f,"%"):"",t=(null==U?void 0:U.zoomOpt)||e,n=J().find(function(e){return e.value===t});return n?n.key:""},[f,J,U]),$=s.useCallback(function(){M.current=!0,R(),y.a.logEngagement({name:"OpenZoomMenu",actionGesture:"Click"})},[R]),ee=s.useCallback(function(){M.current=!1,N()},[N]),te=s.useCallback(function(){null==U||U.rotate(),y.a.logEngagement({name:"Rotate",actionGesture:"Click"})},[U]),ne=s.useCallback(function(){null==_||_(),y.a.logEngagement({name:"OpenInNewWindow",actionGesture:"Click"})},[_]),ae=s.useCallback(function(){null==h||h(),R(),y.a.logEngagement({name:"ToggleSearchBar",actionGesture:"Toggle"})},[h,R]),ie=s.useCallback(function(){var e;if(P.current&&w.current){var t=null===(e=w.current)||void 0===e?void 0:e.scrollWidth,n=getComputedStyle(P.current),a=n.paddingLeft,i=n.paddingRight;return t+parseInt(a)+parseInt(i)}return 0},[]),re=s.useCallback(function(){K(!1)},[K]),oe=s.useCallback(function(){K(!0)},[K]),ce=s.useCallback(function(){null==U||U.print()},[U]);return s.createElement("div",(0,a.q5)({},u,{className:i?"shadowBox_d8a579b8":""}),s.createElement("div",{className:i?Pe:""},i&&s.createElement(C.a,{direction:O.a.horizontal,shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:O.b.all},s.createElement(Me,{width:ie()})),s.createElement(C.a,{shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:O.b.all,direction:O.a.horizontal},s.createElement("div",{className:(0,p.ZK)("root_d8a579b8",n?"fadeIn_d8a579b8":"fadeOut_d8a579b8",i?"expanded_d8a579b8":""),style:{backgroundColor:H.semanticColors.menuBackground},ref:P,tabIndex:0,role:"menubar",onMouseEnter:j,onMouseLeave:V,onClick:He,onMouseDown:He,onMouseMove:He,onFocus:z,onBlur:G},s.createElement("div",{className:i?"":Pe},s.createElement("div",{ref:w},s.createElement(we,{iconName:"ChevronUp",tooltip:F.get("previousPageTooltip"),role:"menuitem",ariaLabel:F.get("upCommandAria"),onClick:re}),s.createElement(we,{iconName:"ChevronDown",tooltip:F.get("nextPageTooltip"),role:"menuitem",ariaLabel:F.get("downCommandAria"),onClick:oe}),s.createElement(ke.a,{rootProps:{className:"pagination_d8a579b8",role:"menuitem","aria-label":F.get("pageNumberAria",[o+1,(null==U?void 0:U.pageCount)||1]),style:{color:H.semanticColors.menuItemText}},inputProps:{type:"text",value:v>=0?v+1:"",autoComplete:"off","aria-label":F.get("pageInputAria",[(null==U?void 0:U.pageCount)||1]),onFocus:Re,onBlur:W,onChange:q,onKeyDown:Q},outerRef:T},s.createElement("div",{className:"status_d8a579b8"},s.createElement("span",{className:"slash_d8a579b8"},"/"),s.createElement("span",null,(null==U?void 0:U.pageCount)||1))),s.createElement(Z.a,{styles:{divider:Fe}}),s.createElement(Le,{iconName:"ZoomIn",tooltip:F.get("zoomTooltip"),role:"menuitem",ariaLabel:F.get("zoomCommandAria"),items:J(),defaultCheckedKey:X(),uncheckAll:I,onClickMenuItem:Y,onOpen:$,onDismiss:ee}),s.createElement(we,{iconName:"Rotate",tooltip:F.get("rotateTooltip"),role:"menuitem",ariaLabel:F.get("rotateCommandAria"),onClick:te}),!r&&s.createElement(we,{iconName:"Search",tooltip:F.get("searchTooltip"),role:"menuitem",ariaLabel:i?F.get("closeSearchCommandAria"):F.get("searchCommandAria"),"aria-expanded":i,onClick:ae}),c&&l&&s.createElement(Z.a,{styles:{divider:Fe}}),s.createElement(we,{iconName:"Print",tooltip:F.get("printLabel"),role:"menuitem",ariaLabel:F.get("printLabel"),onClick:ce,hidden:!c}),s.createElement(we,{iconName:"OpenInNewTab",tooltip:F.get("openInNewWindowTooltip"),role:"menuitem",ariaLabel:F.get("openInNewWindowCommandAria"),onClick:ne,hidden:!l})))))))});Ne.defaultProps={defaultScale:b.i.FitSize};var Be=n(76),je=s.lazy(function(){return n.e(74).then(n.bind(n,808)).then(function(e){return{default:e.ThumbnailView}})}),Ve=s.lazy(function(){return n.e(32).then(n.bind(n,809)).then(function(e){return{default:e.MipNeedPermissionDialog}})}),ze=s.lazy(function(){return n.e(35).then(n.bind(n,810)).then(function(e){return{default:e.EncryptDialog}})}),Ge=s.lazy(function(){return n.e(29).then(n.bind(n,811)).then(function(e){return{default:e.CompressDialog}})}),Ke=s.lazy(function(){return n.e(36).then(n.bind(n,812)).then(function(e){return{default:e.PrintDialog}})}),We=s.lazy(function(){return n.e(32).then(n.bind(n,813)).then(function(e){return{default:e.PermissionBanner}})}),qe=s.lazy(function(){return n.e(82).then(n.bind(n,814)).then(function(e){return{default:e.WatermarkWrapper}})}),Qe=function(e){return s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(qe,(0,a.q5)({},e)))},Ye=s.memo(s.forwardRef(function(e,t){var n,i,r,o,c,d=e.enableToolbar,f=e.enableThumbnailView,m=e.enableToast,_=e.enableOpenMip,h=e.mode,b=e.mipDialogProps,g=e.encryptDialogProps,v=e.compressDialogProps,y=e.annotParams,S=e.annotBarStrings,D=e.resetWatermarkAnnotParams,I=e.execSelect,x=e.toolbarProps,C=e.darkMode,O=void 0!==C&&C,w=e.mipAuthFailed,E=void 0!==w&&w,A=e.enablePrint,L=e.discardEdits,k=(0,a.pM)(s.useState(!1),2),M=k[0],P=k[1],T=(0,a.pM)(s.useState(!1),2),U=T[0],F=T[1],H=(0,a.pM)(s.useState(!1),2),R=H[0],N=H[1],B=(0,a.pM)(s.useState(!1),2),j=B[0],V=B[1],z=(0,a.pM)(s.useState(!1),2),G=z[0],K=z[1],W=(0,l.b)(),q=(0,l.c)(),Q=(0,u.d)(),Y=s.useRef(null),J=(0,se.b)().contentViewer.getViewer();s.useEffect(function(){W({toggle:function(e){F(e??function(e){return!e})}})},[W]),s.useImperativeHandle(t,function(){return{print:function(e,t){return(0,a.yv)(void 0,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){return A?(P(!0),n={onPrintEnd:function(){window.setTimeout(function(){P(!1)})}},null==J||J.print(e,t,n),[2]):[2]})})},getThumbnailView:function(){return q},getToolbar:function(){return Y.current||{}},getToastOperation:function(){return Q}}},[A,J,q,Q]);var X=s.useCallback(function(){A&&(P(!1),null==J||J.cancelPrint())},[A,J]),Z=s.useCallback(function(e){K(e)},[K]);return s.useEffect(function(){(null==J?void 0:J.isMip)&&!J.isMipDecrypted&&(V(E),N(!E))},[E,J]),s.createElement("div",null,f&&s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(je,{visible:!!U})),(null===(n=ue.a.features)||void 0===n?void 0:n.enableWatermark)&&s.createElement(me,null),s.createElement("div",{className:(0,p.ZK)("bottomToolArea_7516adf3",x.shouldPlaceToolbarOnTop&&"placeBottomToolOnTop_7516adf3")},d&&s.createElement(Ne,(0,a.q5)({ref:Y},x)),m&&s.createElement(De,{darkMode:O})),s.createElement("div",{className:(0,p.ZK)("topArea_7516adf3")},J&&h===Be.a.View&&s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(We,{pdfViewer:J}))),R&&s.createElement(_e,(0,a.q5)({},b||{},{expected:!_})),j&&s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(Ve,null)),A&&s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(Ke,{hidden:!M,onCancelPrint:X})),(null===(i=ue.a.features)||void 0===i?void 0:i.enableEncrypt)&&g&&g.encryptVisible&&s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(ze,(0,a.q5)({},g))),(null===(r=ue.a.features)||void 0===r?void 0:r.enableWatermark)&&((null===(o=null==y?void 0:y.inkAttributes)||void 0===o?void 0:o.watermark)||G)&&s.createElement(Qe,{annotParams:y,annotBarStrings:S,resetWatermarkAnnotParams:D,execSelect:I,onHoldOnWatermark:Z,discardEdits:L}),(null===(c=ue.a.features)||void 0===c?void 0:c.enableCompress)&&v&&v.compressVisible&&s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(Ge,(0,a.q5)({},v))))}));Ye.displayName="PdfViewerControls",(0,p.ZW)([{rawString:".enterPanel_c6d49072{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);top:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);text-align:center}.prompt_c6d49072{margin-bottom:10px;font-size:16px}"}]);var Je=s.lazy(function(){return n.e(35).then(n.bind(n,757)).then(function(e){return{default:e.PasswordDialog}})}),Xe=function(){var e=(0,a.pM)(s.useState(!1),2),t=e[0],n=e[1],i=(0,se.b)().contentViewer,r=(0,d.c)(),o=s.useCallback(function(){n(!0)},[]),c=s.useCallback(function(){n(!1)},[]);return s.createElement("div",{className:"enterPanel_c6d49072"},s.createElement("div",{className:"prompt_c6d49072"},r.get("needsPasswordLabel",[i.getFilename()])),s.createElement(H.a,{onClick:o,text:r.get("enterPassword")}),t&&s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(Je,{onClose:c})))},Ze=n(441),$e=s.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(27)]).then(n.bind(n,789)).then(function(e){return{default:e.FreeTextContainer}})}),et=s.lazy(function(){return n.e(33).then(n.bind(n,790)).then(function(e){return{default:e.Outline}})}),tt=s.lazy(function(){return n.e(34).then(n.bind(n,791)).then(function(e){return{default:e.Outline}})}),nt=s.memo(s.forwardRef(function(e,t){var n,i,r,o,c,l,f,p,m,_=e.mode,g=void 0===_?Be.a.View:_,v=e.defaultScale,S=void 0===v?b.i.FitSize:v,I=e.showLoadingSpinner,x=void 0===I||I,C=e.disableSearch,O=void 0!==C&&C,w=e.enableToolbar,E=void 0===w||w,L=e.enableGripperContextualMenu,k=void 0===L||L,M=e.enableToast,P=void 0===M||M,T=e.darkMode,U=void 0!==T&&T,F=e.enableEdit,H=void 0!==F&&F,R=e.enableProgressiveLoading,N=e.annotParams,B=e.hasAnnotationPermission,j=e.contentViewerRef,V=e.controlsRef,z=e.outlineProps,G=e.onNeedPassword,K=e.onDocumentLoaded,W=e.onCurrentPageChanged,q=e.onScaleChanged,Q=e.onFontLoading,Y=(0,a.pM)(s.useState(!1),2),J=Y[0],X=Y[1],Z=(0,a.pM)(s.useState(!1),2),$=Z[0],ee=Z[1],te=(0,a.pM)(s.useState(!1),2),ce=te[0],de=te[1],ue=(0,a.pM)(s.useState(!1),2),fe=ue[0],pe=ue[1],me=(0,a.pM)(s.useState(!1),2),_e=me[0],he=me[1],be=(0,a.pM)(s.useState(0),2),ge=be[0],ve=be[1],ye=(0,a.pM)(s.useState(E),2),Se=ye[0],De=ye[1],Ie=(0,a.pM)(s.useState(!1),2),xe=Ie[0],Ce=Ie[1],Oe=(0,a.pM)(s.useState(void 0),2),we=Oe[0],Ee=Oe[1],Ae=(0,d.c)(),Le=(0,A.a)(),ke=(0,D.b)().eventBus,Me=H&&B,Pe=(null===(n=h.a.features)||void 0===n?void 0:n.enableFreeText)&&Me,Te=s.useCallback(function(e){!ce&&Math.sqrt(Math.pow(e.movementX,2)+Math.pow(e.movementY,2))>30&&de(!0)},[ce]);s.useImperativeHandle(t,function(){return{getEventHandlers:function(){return{onMouseMove:Te}}}},[Te]);var Ue=s.useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t,n,i,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return e.altKey&&"T"===e.key.toUpperCase()?(de(!0),null===(i=null===(t=V.current)||void 0===t?void 0:(n=t.getToolbar()).focus)||void 0===i||i.call(n),[3,4]):[3,1];case 1:return(null==N?void 0:N.mode)===b.a.FreeText&&e.altKey&&e.ctrlKey&&"F"===e.key.toUpperCase()?[4,null===(o=null===(r=j.current)||void 0===r?void 0:r.getViewer())||void 0===o?void 0:o.addFreeText()]:[3,3];case 2:return a.sent(),[3,4];case 3:re.a.isActivated("EnableSearchShortcut")||!e.ctrlKey&&!e.metaKey||"F"!==e.key.toUpperCase()||(e.preventDefault(),de(!0),pe(!0),y.a.logEngagement({name:"OpenSearchBar",actionGesture:"Shortcut"})),a.label=4;case 4:return[2]}})})},[N,j,V]),Fe=s.useCallback(function(){fe||de(function(e){return!e})},[fe]),He=s.useCallback(function(){null==G||G(),X(!0)},[G]),Re=s.useCallback(function(e){var t,n,a=null===(t=j.current)||void 0===t?void 0:t.getViewer();if(!re.a.isActivated("ControllOutlineDefaultOn")&&e.hasOutline)try{var i=null==a?void 0:a.getDocumentLeftToViewport();e&&(e.isOutlineDefaultOff=e.pageCount<15||void 0!==i&&i<320||Ze.a.getBooleanItem(ie.t))}catch(e){}null==K||K(e),ee(!0),de(!0),X(!1),he(e.isPrintAllowed),a&&(oe.a.read(Ae.get("displayInfo",[a.getCurrentPageIndex()+1,a.scale,a.rotation])),(null===(n=h.a.features)||void 0===n?void 0:n.enableOutline)&&(e.hasOutline?a.getOutlineData().then(function(e){e&&Ee({outlineData:e,initialPageIndex:a.getCurrentPageIndex()})}).catch(function(){Ee({outlineData:[],initialPageIndex:a.getCurrentPageIndex()})}):Ee({outlineData:[],initialPageIndex:a.getCurrentPageIndex()})))},[K,j,Ae]),Ne=s.useCallback(function(){Ce(!0)},[]);s.useEffect(function(){De(!!E&&$)},[E,$]),s.useEffect(function(){var e;if(R){var t=null===(e=V.current)||void 0===e?void 0:e.getToastOperation();$&&(null==t||t({type:u.b.Success,text:Ae.get("previewToastFinishedText"),link:"",linkText:"",onClickClose:function(){t({type:u.b.Hidden})}}))}},[R,$,V]);var je=s.useCallback(function(e){var t;null==Q||Q(e);var n=null===(t=V.current)||void 0===t?void 0:t.getToastOperation();e?null==n||n({type:u.b.Running,text:Ae.get("loadingFontToast"),onClickExpand:function(){n({type:u.b.Hidden})}}):null==n||n({type:u.b.Success,text:Ae.get("fontAlreadyLoadedToast"),link:"",linkText:"",onClickClose:function(){n({type:u.b.Hidden})}})},[Q,V,Ae]),Ve=s.useCallback(function(e){null==W||W(e),ve(e)},[W]),ze=s.useCallback(function(e,t){var n,a,i;null==q||q(e),t||null===(i=null===(n=V.current)||void 0===n?void 0:(a=n.getToolbar()).uncheckZoomMenu)||void 0===i||i.call(a)},[q,V]),Ge=s.useCallback(function(){de(!1)},[]),Ke=s.useCallback(function(){ke.dispatch(Be.c.MetadataUpdated)},[ke]),We=s.useMemo(function(){return t=e.annotBarStrings,function(e){return s.createElement(ne.a,{strings:t},s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement($e,(0,a.q5)({},e))))};var t},[e.annotBarStrings]);return s.createElement("div",{className:"main_72829470",style:{color:Le.palette.neutralPrimary},onMouseMove:Te,onClick:Fe,onKeyDown:Ue},(null===(i=h.a.features)||void 0===i?void 0:i.enableOutline)&&j.current&&g===Be.a.View&&we&&((null===(r=h.a.features)||void 0===r?void 0:r.enableOutlineNext)?s.createElement(se.a,{contentViewer:j.current,docLoaded:$},s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(et,(0,a.q5)({},z,{outlineInfo:we,goToPage:null===(c=null===(o=j.current)||void 0===o?void 0:o.getViewer())||void 0===c?void 0:c.goToPage})))):we.outlineData.length>0&&s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(tt,(0,a.q5)({},z,{outlineInfo:we,goToPage:null===(f=null===(l=j.current)||void 0===l?void 0:l.getViewer())||void 0===f?void 0:f.goToPage})))),s.createElement(ae.a,(0,a.q5)({},e,{ref:j,localeStrings:e.contentStrings,enableEdit:H,enableGripperContextualMenu:k,isRootFocusable:!1,annotParams:N,ariaHidden:g===Be.a.Extract,onNeedPassword:He,onDocumentLoaded:Re,onCurrentPageChanged:Ve,onScaleChanged:ze,freeTextContainer:Pe&&We||void 0,onMipAuthFailed:Ne,onMetadataUpdated:Ke,onFontLoading:je})),j.current&&s.createElement(se.a,{contentViewer:j.current,docLoaded:$},$?s.createElement(Ye,{ref:V,enableToolbar:Se,enableThumbnailView:e.enableThumbnailView,enableToast:P,enableOpenMip:e.enableOpenMip,mode:g,annotParams:e.annotParams,annotBarStrings:e.annotBarStrings,resetWatermarkAnnotParams:e.resetWatermarkAnnotParams,execSelect:e.execSelect,darkMode:U,mipAuthFailed:xe,toolbarProps:{visible:ce,searchBarVisible:fe,disableSearch:O,currentIndex:ge,defaultScale:S,onAutoHide:Ge,showPrint:_e&&e.showPrint,showOpenInNewWindow:e.showOpenInNewWindow,shouldPlaceToolbarOnTop:e.shouldPlaceToolbarOnTop,dataAttributes:e.toolbarAttributes,onOpenInNewWindow:e.onOpenInNewWindow,onSearchToggle:function(){return pe(!fe)}},mipDialogProps:e.mipDialogProps,inkingToolbarProps:e.inkingToolbarProps,encryptDialogProps:e.encryptDialogProps,compressDialogProps:e.compressDialogProps,discardEdits:null===(m=null===(p=j.current)||void 0===p?void 0:p.getViewer())||void 0===m?void 0:m.discardEdits}):J?s.createElement(Xe,null):x?s.createElement(le,null):void 0))}));nt.displayName="PdfViewerAppMain";var at=function(e){switch(e){case _.b.FreeText:return b.a.FreeText;case _.b.Pen:return b.a.Ink;case _.b.Highlighter:return b.a.Highlight;case _.b.Watermark:return b.a.None;case _.b.Eraser:return b.a.Erase;case _.b.PointEraser:return b.a.PointErase;default:return b.a.None}},it=function(e){var t=e.tool,n=e.color,a=e.thickness,i=e.watermark,r=function(e,t){return(2*e+5)/5*(t===_.b.Highlighter?10:1)}(null!=a?a:3,t);return{width:r,color:{hex:null!=n?n:"#1f1f1f",alpha:t===_.b.Highlighter?.3:1},watermark:i?{name:i.name||"",action:i.action||_.c.Unknown}:void 0}},rt=s.memo(function(e){var t,n=e.mode,i=e.filename,r=e.height,o=e.shouldExitEditModeAfterSave,c=void 0===o||o,f=e.allowUnloadPageWithEdits,p=e.mainRef,I=e.contentViewerRef,x=e.enableEdit,C=e.onDocumentLoaded,O=e.onEditStateChanged,w=e.execSave,E=e.updateMode,A=e.isFileVersionChanged,L=e.isPaidFeaturesEnabled,k=void 0===L||L,M=e.execExtract,P=e.onExitEditMode,T=(0,a.pM)(s.useState(!1),2),U=T[0],F=T[1],H=(0,a.pM)(s.useState(!1),2),R=H[0],N=H[1],B=(0,a.pM)(s.useState(!1),2),j=B[0],V=B[1],z=(0,a.pM)(s.useState(),2),G=z[0],K=z[1],W=(0,a.pM)(s.useState(),2),q=W[0],Q=W[1],Y=(0,a.pM)(s.useState(!0),2),J=Y[0],Z=Y[1],$=(0,a.pM)(s.useState(!1),2),ee=$[0],ne=$[1],ae=s.useRef(),ie=(0,d.c)(),re=(0,l.c)(),oe=(0,u.d)(),se=s.useRef(new g.a),ce=null===(t=I.current)||void 0===t?void 0:t.getViewer(),de=s.useRef(null),le=s.useRef(null),ue=s.useMemo(function(){return ie.get("editToastText")},[ie]),fe=s.useRef(null),pe=e.inkingToolbarProps||{},me=pe.watermarkButtonId,_e=pe.annotationMoreButtonId;s.useEffect(function(){var e=function(e){var t,n,a;"Escape"===e.key&&e.target instanceof Node&&(null===(t=de.current)||void 0===t?void 0:t.contains(e.target))&&(null===(n=le.current)||void 0===n||n.close(),null===(a=fe.current)||void 0===a||a.close())};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[]);var he=s.useCallback(function(){var e=de.current;e&&!e.contains(document.activeElement)&&e.focus()},[]);s.useEffect(function(){n===Be.a.Extract&&(he(),re.toggle(!0))},[n,re,he]),s.useEffect(function(){var e=_.b.Display;n===Be.a.Edit?(he(),Q({mode:at(e)})):Q({mode:b.a.None}),K(e)},[n,he]);var be=s.useCallback(function(e){null==C||C(e),F(!0),Z(e.isAnnotAllowed)},[C]),ge=s.useCallback(function(e){var t=e.dirty,a=e.annotTypeOfLatestEdit;t!==R&&(null==O||O({dirty:t}),N(t)),t&&n===Be.a.View&&(null==E||E(Be.a.Edit),oe({type:u.b.Info,text:ue,infoIconName:"EditSolid12",shouldAutoFocus:!1,onClickClose:function(){oe({type:u.b.Hidden})}}),ae.current=a)},[O,ue,R,n,oe,E]),ve=s.useCallback(function(){var e;null===(e=se.current)||void 0===e||e.dispatch(Be.c.ExitEditMode),V(!1),ae.current=void 0,P?P():null==E||E(Be.a.View)},[P,E]),ye=s.useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:if(!w)throw new v.c(v.b.UploadFileDataFailed,"Empty execSave callback from host");n.label=1;case 1:return n.trys.push([1,3,,4]),[4,w(e)];case 2:return[2,n.sent()];case 3:if((t=n.sent())instanceof v.c)throw t;throw new v.c(v.b.UploadFileDataFailed,(null==t?void 0:t.message)||JSON.stringify(t),null==t?void 0:t.isExpected);case 4:return[2]}})})},[w]),Se=s.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t,n,i,r,o,s,d,l;return(0,a.SO)(this,function(u){switch(u.label){case 0:N(!1),V(!0),e=y.a.createScenario({name:S.a.DocumentSave}),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,null==ce?void 0:ce.getCurrentFileData()];case 2:if(t=u.sent(),!(n=null==t?void 0:t.byteLength))throw new v.c(v.b.GetPdfStreamFailed,0===n?"Empty file data":"Undefined file data");return V(!1),c&&ve(),[4,ye(t)];case 3:return i=u.sent(),e.stop({extraData:(0,a.q5)({fileSize:n},(null==i?void 0:i.extraData)||{})}),o=(r=function(e){return!!e&&e.byteLength>0})(t)?t:null==i?void 0:i.fileData,s=function(e){return new v.c(void 0,"Fail to reload document after saving, reason: ".concat(e)).toCaughtError()},r(o)?null==ce||ce.reloadCurrentDocument(o).catch(function(e){y.a.logError(s(e.message))}):y.a.logError(s("No available file data")),[4,null==ce?void 0:ce.getTelemetryData()];case 4:return void 0!==(d=u.sent())&&y.a.logEngagement({name:"InteractWithForm",actionGesture:"Form",extraData:{telemetryExtraData:d}}),[3,6];case 5:return f=u.sent()||new v.c("Unknown"),l=f instanceof v.c?f.toQosError():{isExpected:!!f.isExpected,error:f,code:f.code||f.name},e.fail(l),[3,6];case 6:return[2]}var f})})},[ce,c,ye,ve]),De=s.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,null==ce?void 0:ce.discardEdits()];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),t="string"==typeof e?e:e.message,y.a.logError({error:{name:e.name,message:"Fail to discard, reason: ".concat(t),stack:e.stack}}),[3,3];case 3:return[2]}})})},[ce]),Ie=s.useCallback(function(){null==E||E(Be.a.View)},[E]),xe=s.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,null===(t=null===(e=I.current)||void 0===e?void 0:e.getViewer())||void 0===t?void 0:t.addFreeText()];case 1:return n.sent(),[2]}})})},[I]),Ce=s.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,null==ce?void 0:ce.getWatermarkInfos()];case 1:return[2,e.sent()||""]}})})},[ce]),Oe=s.useCallback(function(e,t){Q({mode:at(e),inkAttributes:t?it(t):null==q?void 0:q.inkAttributes})},[null==q?void 0:q.inkAttributes]),we=s.useCallback(function(e){Q({mode:null==q?void 0:q.mode,inkAttributes:it(e)})},[q]),Ee=s.useCallback(function(){var e;(null===(e=null==q?void 0:q.inkAttributes)||void 0===e?void 0:e.watermark)&&Q((0,a.q5)((0,a.q5)({},q),{inkAttributes:(0,a.q5)((0,a.q5)({},q.inkAttributes),{watermark:void 0})}))},[q]),Ae=s.useMemo(function(){var t,n,a;return{enableFreeText:null===(t=h.a.features)||void 0===t?void 0:t.enableFreeText,enableWatermark:(null===(n=h.a.features)||void 0===n?void 0:n.enableWatermark)&&k,enablePointEraser:null===(a=h.a.features)||void 0===a?void 0:a.enableEnhancedInk,localeStrings:e.annotBarStrings,defaultToolType:G,watermarkData:{buttonId:me,getWatermarkInfos:Ce},annotationMoreButtonId:_e,onToolChange:Oe,onInkingAttributesUpdate:we,addNewFreeText:xe}},[e.annotBarStrings,k,G,me,Ce,_e,Oe,we,xe]),Le=s.useCallback(function(){switch(n){case Be.a.Edit:return s.createElement(X,{ref:le,hasEdits:R,filename:i,allowUnloadPageWithEdits:f,inkingToolbarProps:x&&J?Ae:void 0,onSave:Se,onClose:ve,onDiscard:De,isFileVersionChanged:A});case Be.a.Extract:return s.createElement(te,{ref:fe,viewerRef:I,onSave:M,onClose:Ie});default:return}},[n,R,i,f,x,J,Ae,Se,ve,De,A,I,M,Ie]),ke=s.useMemo(function(){return U&&(n===Be.a.Edit||n===Be.a.Extract)},[U,n]),Me=s.useMemo(function(){return ke&&r?r-46:r},[r,ke]);return s.createElement(D.a,{eventBus:se.current,pdfViewer:ce,annotMode:null==q?void 0:q.mode,showPermissionBanner:ee,setShowPermissionBanner:ne,isPaidFeaturesEnabled:k},s.createElement("div",{className:"root_72829470",ref:de,tabIndex:0},ke&&Le(),j&&s.createElement(m.a,{styles:{itemProgress:{padding:0}}}),s.createElement("div",{className:"mainWrapper_72829470"},s.createElement(nt,(0,a.q5)({},e,{ref:p,height:Me,annotParams:q,resetWatermarkAnnotParams:Ee,hasAnnotationPermission:J,onDocumentLoaded:be,onEditStateChanged:ge})),j&&s.createElement("div",{className:"saveModal_72829470"}))))});rt.displayName="PdfViewerAppRenderer";var ot=s.forwardRef(function(e,t){var n=s.useRef(null),i=s.useRef(null),r=s.useRef(null);return s.useImperativeHandle(t,function(){return{getViewer:function(){var e;return(null===(e=i.current)||void 0===e?void 0:e.getViewer())||null},print:function(e,t){return(0,a.yv)(void 0,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){return[2,null===(n=r.current)||void 0===n?void 0:n.print(e,t)]})})},onMouseMove:function(e){var t;return null===(t=n.current)||void 0===t?void 0:t.getEventHandlers().onMouseMove(e)},getThumbnailView:function(){var e;return null===(e=r.current)||void 0===e?void 0:e.getThumbnailView()},getToastOperation:function(){var e;return null===(e=r.current)||void 0===e?void 0:e.getToastOperation()}}}),s.createElement(rt,(0,a.q5)({},e,{mainRef:n,contentViewerRef:i,controlsRef:r}))});ot.displayName="PdfViewerAppInner";var st=s.forwardRef(function(e,t){var n=function(e){return s.useMemo(function(){return e?{appStrings:(0,a.q5)((0,a.q5)({},e.app||{}),e.annotBar||{}),contentStrings:e.content||{},annotBarStrings:e.annotBar||{}}:{appStrings:void 0,contentStrings:void 0,annotBarStrings:void 0}},[e])}(e.localeStrings),c=n.appStrings,p=n.contentStrings,m=n.annotBarStrings,_=(0,a.pM)(s.useState(),2),h=_[0],b=_[1],g=s.useRef(!1);s.useEffect(function(){return g.current=!0,function(){g.current=!1}},[]),s.useEffect(function(){(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return(t=c)?[3,2]:[4,(0,d.b)()];case 1:t=n.sent(),n.label=2;case 2:return e=t,g.current&&b(e),[2]}})})},[c]);var v=(0,o.a)(e.theme,e.darkMode);return s.createElement(i.a,{className:"root_58dd2d21",theme:(0,a.q5)({rtl:(0,r.a)()},v)},s.createElement(d.a,{strings:h},s.createElement(l.a,null,s.createElement(f.a,null,s.createElement(u.a,null,s.createElement(ot,(0,a.q5)({},e,{contentStrings:p,annotBarStrings:m,ref:t})))))))});st.displayName="PdfViewerAppWithoutKey";var ct=s.forwardRef(function(e,t){return s.createElement(st,(0,a.q5)({key:e.url,ref:t},e))});ct.displayName="PdfViewerApp"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>r,c:()=>o});var a=n("tslib_145"),i=n("react-lib"),r=i.createContext({}),o=function(){return i.useContext(r)},s=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)}}
,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>i,b:()=>a}),function(e){e[e.ANSI=0]="ANSI",e[e.ChineseSimplified=1]="ChineseSimplified",e[e.ChineseTraditional=2]="ChineseTraditional",e[e.Japanese=3]="Japanese",e[e.Korean=4]="Korean",e[e.Thai=5]="Thai"}(a||(a={})),function(e){e.NotFound="NotFound",e.LoadedOndemandSucceed="LoadedOndemandSucceed",e.LoadedOndemandFailed="LoadedOndemandFailed",e.LoadedRequiredSucceed="LoadedRequiredSucceed",e.LoadedRequiredFailed="LoadedRequiredFailed"}(i||(i={}))}
,(e,t,n)=>{"use strict";e.exports=n(472)}
,(e,t,n)=>{"use strict";n(230);var a=n("react-lib"),i=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var r=Symbol.for;i=r("react.element"),t.Fragment=r("react.fragment")}var o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,n){var a,r={},d=null,l=null;for(a in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,a)&&!c.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:i,type:e,key:d,ref:l,props:r,_owner:o.current}}t.jsx=d,t.jsxs=d}
,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{saveCommandKey:()=>s});var a=n("odsp.util_385"),i=n(42);const r={actionProvider:n(188).a},o="saveCommand",s=new a.OJ({name:"SaveCommand",factory:{dependencies:r,create:({actionProvider:e})=>({instance:{id:o,name:i.Cb,title:i.Ob,automationId:o,iconProps:{iconName:"Save"},evaluateAction:e.evaluateAction}})}})}
,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>F,b:()=>T});var a=n("odsp.util_385"),i=n(100);function r(e){const{AllowGridMode:t,DisableGridEditing:n,ListTemplateType:r,BasePermissions:{ManageLists:o,ManagePersonalViews:s,OpenItems:c,UseClientIntegration:d}={},ListSchema:{DefaultItemOpen:l}={},ExcludeFromOfflineClient:u,WebExcludeFromOfflineClient:f,ListData:p,listBaseType:m,Flags2:_,MachineLearningCaptureEnabled:h,MachineLearningExperienceEnabled:b,AIBuilderEnabled:g,AIBuilderDefaultPowerAppsEnvironment:v,Color:y,Icon:S,ListUrl:D,listUrlDir:I}=e,x=D||I&&decodeURIComponent(I),C="string"==typeof l?"0"===l:void 0;return{id:(0,a.YR)(e.listName),title:e.ListTitle,flags2:_,machineLearningCaptureEnabled:h,machineLearningExperienceEnabled:b,aiBuilderEnabled:g,aiBuilderDefaultPowerAppsEnvironment:v,allowGridMode:"boolean"!=typeof t||t,allowCreateFolder:e.AllowCreateFolder,disableCommenting:"boolean"==typeof e.DisableCommenting&&e.DisableCommenting,disableGridEditing:"boolean"==typeof n&&n,enableMinorVersions:e.EnableMinorVersions,enableVersions:e.verEnabled,templateType:"string"==typeof r?Number(r):void 0,isDocumentLibrary:(0,i.b)(String(m)),isPromotedLinks:"string"==typeof r?(0,i.e)(r):void 0,isForceCheckout:e.isForceCheckout,isModerated:e.isModerated,enableRequestSignOff:e.EnableRequestSignOff,newWOPIDocumentEnabled:e.NewWOPIDocumentEnabled,newWOPIDocumentTypes:e.NewWOPIDocumentTypes,permissions:{manageLists:o,managePersonalViews:s,openItems:c,useClientIntegration:d},openInClient:C,excludeFromOfflineClient:"boolean"==typeof u||"boolean"==typeof f?u||f:void 0,contentTypesEnabled:e.ContentTypesEnabled,metadataNavFeatureEnabled:e.metadataNavFeatureEnabled,canUserCreateMicrosoftForm:e.canUserCreateMicrosoftForm,itemCount:e.ListSchema&&e.ListSchema.ItemCount,rowLimit:p&&p.RowLimit,canShareLinkForNewDocument:e.CanShareLinkForNewDocument,enableAttachments:"true"===e.EnableAttachments,createdFromExcel:e.CreatedFromExcel,createdFromExisting:e.CreatedFromExisting,icon:"string"==typeof S?Number(S):void 0,color:"string"==typeof y?Number(y):void 0,lastItemModifiedTime:e.lastItemModifiedTime,tick:e.tick,modernListTemplateTypeId:e.ModernListTemplateTypeId,readSecurity:e.ListSchema&&e.ListSchema.ReadSecurity,listUrlDir:x,hasPendingBusinessAppMigration:e.hasPendingBusinessAppMigration,modernTemplatesInfo:void 0!==e.IsModernTemplateLinked?{containsTemplates:e.IsModernTemplateLinked,containsListExclusiveTemplates:e.HasListExclusiveModernTemplates||!1}:void 0}}var o=n(503),s=n(504),c=n(257),d=n(266),l=n(17),u=n(269),f=n(97),p=n(0),m=n(506),_=n(105),h=n(10);class b{add(e,t){this._pageContextMap.set(JSON.stringify(e),t)}get(e){return this._pageContextMap.get(JSON.stringify(e))}constructor(){this._pageContextMap=new Map}}var g=n(4),v=n(274),y=n(275),S=n(531),D=n(858),I=n(1),x=n(415),C=n(27),O=n(159),w=n(16),E=n(859),A=n(31),L=n(435);const k=!a.Ov.isActivated("cc69c4e8-4b22-45b5-9f19-caec58f399d7","04/30/2024","if url is not right, log url for ppe "),M=!a.Ov.isActivated("6FFC1444-F0D6-4B94-8C4C-53D14CEF8F27","04/23/2025","updates navigation mode to single"),P=!a.Ov.isActivated("99C2BC64-9842-43D9-B0F3-D6327A18FE6F");function T(e){try{const{idViewParam:t,parentViewParam:i,parentViewViewParam:r,listUrlViewParam:s,viewViewParam:T,webAbsoluteUrl:F,fullListUrl:R,serverRelativeFocusItemUrl:N,serverRelativeParentUrl:B,listContext:j,pageContext:V,cidViewParam:z,parIdViewParam:G}=(0,S.a)(e),K=new p.a({name:_.h}),W=!(0,g.Ac)()&&e.consume(O.a);if(!(0,g.Jb)()&&z&&!W){const t=e.consume(C.a);if(!(0,x.a)(z)&&t.viewParams&&!t.viewParams.ls){const e=new w.a(window.location.href);e.setQueryParameter("ls","true"),t.navigateTo({url:e.toString(),ignoreHistory:!0})}}(0,g.Yb)()&&M&&e.consume(h.f).updateNavMode("fastOneUpAdapter",h.d.single);const q=(i||r||!(0,g.Jb)()&&(!W&&z||G))&&(t||s||T),Q=!!k&&"spdf"===V.cloudType?.toLowerCase();if(q)if(F&&R){const i=e.consume(D.a),r=t?N:void 0,s=new p.a({name:_.l});i.getCurrentItem().then(i=>{if((0,g.Bb)()&&i&&i.ListData&&i.ListData.Row){let t=!0;if(i.ListData.Row.length>0&&i.ListData.Row[0].PermMask){const e=L.a.fromHexString(i.ListData.Row[0].PermMask);t=A.a.hasPermission(e,A.a.viewListItems)}t&&0!==i.ListData.Row.length||e.consume(h.f).updateIsNoAccessScenarioState("fastOneUpAdapter",!0)}if(i&&i.ListData&&i.ListData.Row&&i.ListData.Row.length>0&&i.ListSchema){e.consume(f.a).setBaseInfo({data:i.ListSchema,allowCookies:!1});const D=i.PageContextInfo?JSON.parse(i.PageContextInfo):void 0;if(D&&e.consume(h.f).setSiteHidePeoplePreviewingFiles("fastOneUpAdapter",!!D?.hidePeoplePreviewingFiles),!r&&R){const t=U({spGetFocusItemResponse:i,webAbsoluteUrl:F,listFullUrl:R,listContext:j,parentFolderPath:B,resourceScope:e}),n={focusItem:t,parentItem:t,focusItemSet:[t],list:t,currentIndex:0};e.consume(l.b).update(n,"fastOneUpRLDS"),K.end({resultType:p.b.Success})}else if(V){const r=z&&!W?(0,m.a)({response:i,id:N,odcId:t,listContext:j,qosEvent:s}):(0,m.a)({response:i,id:N,listContext:j,qosEvent:s});if(r.resultType===p.b.Success)try{const t=(0,E.a)({spGetItemResponse:i,webAbsoluteUrl:F,listFullUrl:R,listContext:j,parentFolderPath:B,resourceScope:e,currentPageContext:D});if(t){const a=e.consume(l.b),r=i.ListData&&i.ListData.Row&&i.ListData.Row[0];r&&(async function(e,t){if(e.consume(v.a)){const a=new p.a({name:_.k});(async()=>await n.e(19).then(n.bind(n,770)).then(({favoritesDataManagerKey:n})=>{const i=e.consume(n);return i.populateFavorites().then(n=>{let r=t?.UniqueId;if(r&&-1!==r.indexOf("{")&&(r=r.replace("{","").replace("}","").toLowerCase()),a.end({resultType:p.b.Success}),n&&r){const t=i.isFavorited(r);return e.consume(h.f).setIsFocusItemFavorited("fastoneUpAdapater",t),t}}).catch(e=>{a.end({resultType:p.b.Failure,error:e.message,extraData:{rawError:e}})})}).catch(e=>{a.end({resultType:p.b.Failure,error:e.message,extraData:{rawError:e}})}))().catch(e=>{a.end({resultType:p.b.Failure,error:e.message,extraData:{rawError:e}})})}}(e,r).catch(e=>{}),async function(e){if(e.consume(I.a).isAnonymousGuestUser||(0,g.Dc)())return;const t=await e.consumeAsync(y.a),n=await t.hasValidLicenseCached();e.consume(h.f).updateIsUniversalPrintLicenseValidState("fastOneUpAdapter",n)}(e).catch(e=>{}));const s=function(e){const{resourceScope:t,focusItemResponse:n}=e,{webAbsoluteUrl:a,fullListUrl:i,isRootFolder:r,listContext:s,serverRelativeParentUrl:l}=(0,S.a)(t);let f={key:"",isPlaceholder:!0};const{ParentUniqueId:p}=n.ListData&&n.ListData.Row&&n.ListData.Row[0]||{},m={ID:"",Editor:[],UniqueId:p},_=t.consume(c.a);if(a&&i)if(r&&n){const e={listFullUrl:i,rootFolder:"",webAbsoluteUrl:a},t=(0,o.a)(n),r=_.processOneUpItem({itemFromServer:P?m:void 0,spItemIdentity:e,listContext:s,mediaTransformListSchema:t}),{ListData:c}=n,{FolderPermissions:l}=c||{};let p,h;l&&(p=(0,u.a)(l));const b="root",g=c&&c.Row&&c.Row[0];if(g&&g[".spItemUrl"]){const{driveId:e}=(0,d.a)(g[".spItemUrl"]);h=e}f={...r,itemId:b,...h?{graph:{itemId:b,driveId:h,sessionToken:r.graph?.sessionToken,sessionTokenV21:r.graph?.sessionTokenV21}}:{},folder:{},...p?{permissions:p}:{}},f.isPlaceholder=!1}else{const e=(0,o.a)(n);f={..._.processOneUpItem({itemFromServer:P?m:void 0,spItemIdentity:{itemId:"",listFullUrl:i,webAbsoluteUrl:a,rootFolder:l},listContext:s,mediaTransformListSchema:e}),isPlaceholder:!0}}return f}({resourceScope:e,focusItemResponse:i}),f=U({spGetFocusItemResponse:i,webAbsoluteUrl:F,listFullUrl:R,listContext:j,parentFolderPath:B,resourceScope:e});let m=a.pageContexts;if(D){const e={webAbsoluteUrl:D.webAbsoluteUrl,listUrl:D.listUrl};m||(m=new b),m.add(e,D)}const x={focusItem:t,focusItemSet:[t],parentItem:s,list:f,currentIndex:0,appLevelPageContext:e.consume(I.a),pageContexts:m};a.update(x,"fastOneUpRLDS"),K.end({resultType:p.b.Success})}else K.end({resultType:p.b.Failure,error:"missing focusItem"}),H(e,new a.a_({code:"FastOneUp-NoFocusItem"}))}catch(t){K.end({resultType:p.b.Failure,error:t.message}),H(e,new a.a_({code:"FastOneUp-getOneUpItemException",innerError:t}))}else K.end(r),s.end(r),H(e,new a.a_({code:r.resultCode,extraData:r.extraData}))}else{const t="noPageContext";K.end({resultType:p.b.Failure,error:t}),s.end({resultType:p.b.Failure,error:t}),H(e,new a.a_({code:"FastOneUp-noPageContext"}))}}else{const t="no Row Data from RLDS";K.end({resultType:p.b.Failure,error:t}),s.end({resultType:p.b.Failure,error:t}),H(e,new a.a_({code:"FastOneUp-NoRowData"}))}}).catch(t=>{K.end({resultType:p.b.Failure,error:t.message}),s.end({resultType:p.b.Failure,error:t.message}),H(e,new a.a_({code:"FastOneUp-getSingleItemException",innerError:t}))})}else F?R||(K.end({resultType:p.b.Failure,error:"no listFullUrl"}),H(e,new a.a_({code:"FastOneUp-noListFullUrl"}))):(K.end({resultType:p.b.Failure,error:"no webAbsoluteUrl"}),H(e,new a.a_({code:"FastOneUp-noWebAbsoluteUrl"})));else K.end({resultType:p.b.Failure,error:"no id, parent, parentview or listurl"}),H(e,i||r?new a.a_({code:"FastOneUp-noIdOrListurl",extraData:{url:Q?window.location.href:void 0}}):new a.a_({code:"FastOneUp-noParent",extraData:{url:Q?window.location.href:void 0}}))}catch(t){H(e,new a.a_({code:"FastOneUp-useAdapterException",innerError:t}))}}function U(e){const{webAbsoluteUrl:t,listFullUrl:n,listContext:a,resourceScope:i,spGetFocusItemResponse:s}=e,d=s.ListData&&s.ListData.Row&&s.ListData.Row[0],l=i.consume(c.a),f=s&&(0,o.a)(s),p=d&&d.PermMask?(0,u.a)(d.PermMask):void 0;let m;if(s&&p){const e={list:r(s),permissions:p,mediaTransform:f},i={itemId:"",listFullUrl:n,rootFolder:"",webAbsoluteUrl:t};return m=l.processOneUpListRootItem({spItemIdentity:i,listContext:a,oneUpListInfo:e}),m}}function F(e){const t=new p.a({name:_.j}),n=e.consume(h.f);try{const a=e.consume(l.b),i=a.getOneUpProperties();if(i&&(!i.parentItem||i.parentItem.isPlaceholder)){const{webAbsoluteUrl:r,fullListUrl:o,serverRelativeParentUrl:c,isRootFolder:d,listContext:l,pageContext:u}=(0,S.a)(e);if(c&&r&&o&&!d){const d={pageContext:u,id:c,webAbsoluteUrl:r,listFullUrl:o,listContext:l};new s.a(d).getSingleItem(!0).then(s=>{if(s&&s.ListData&&s.ListData.Row&&s.ListData.Row.length>0&&s.ListSchema){if(e.consume(f.a).setBaseInfo({data:s.ListSchema,allowCookies:!1}),u&&(0,m.a)({response:s,id:c||"",listContext:l,qosEvent:t}))try{const t=(0,E.a)({spGetItemResponse:s,webAbsoluteUrl:r,listFullUrl:o,listContext:l,parentFolderPath:void 0,resourceScope:e});t&&(a.update({...i,parentItem:t},"fastOneUpRLDS"),n.updateParentPermissionValidity("ensureParentItem",!0))}catch(e){const a=e instanceof Error?e:new Error(e);t.end({resultType:p.b.Failure,error:a.message}),n.updateParentPermissionValidity("ensureParentItem",!1)}}else{const e="no Row Data from RLDS";t.end({resultType:p.b.Failure,error:e}),n.updateParentPermissionValidity("ensureParentItem",!1)}}).catch(e=>{t.end({resultType:p.b.Failure,error:e.message}),n.updateParentPermissionValidity("ensureParentItem",!1)})}}}catch(e){const a=e instanceof Error?e:new Error(e);t.end({resultType:p.b.Failure,error:a.message}),n.updateParentPermissionValidity("ensureParentItem",!1)}}function H(e,t,n){const a=e.consume(h.f);(0,g.Bb)()&&a.currentAppState.isNoAccessScenario?a.updateErrorState("fastOneUpAdapterException",{errorType:_.d.rldsApiErrorNoAccess,error:t,item:void 0,extraData:n}):a.updateErrorState("fastOneUpAdapterException",{errorType:_.d.rldsApiError,error:t,item:void 0,extraData:n})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const a=[".accessToken",".callerStack",".correlationId",".driveAccessToken",".driveAccessTokenV21",".driveAccessCode",".driveAccessCodeV21",".driveUrl",".mediaBaseUrl",".officeBundleGenerate",".officeBundleGetFragment",".pdfConversionUrl",".pushChannelBaseUrl",".thumbnailUrl",".transformUrl",".videoManifestUrl"];function i(e){const t={},n=e.ListSchema;if(n)for(const e of a){let a=n[e];a&&".mediaBaseUrl"===e&&(a=a.replace("https://media.cloudapp.net",window.__mediaBaseUrl||"https://northcentralus1-medias.svc.ms")),t[e]=a}return t}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>f});var a,i=n(102),r=n(0),o=n(508),s=n(254),c=n(506),d=n(105),l=n(4),u=n(255);!function(e){e.preload="preload",e.callRLDS="callRLDS"}(a||(a={}));class f extends i.b{getSingleItem(e=!1){const t=new r.a({name:d.m,extraData:{...this._extraLoggingData}});if(!this._listContext)throw new Error("no listContext");if(!e&&window.g_listData){if(this._id){if((0,c.a)({response:window.g_listData,id:this._id,listContext:this._listContext,qosEvent:t,extraData:{isRace:!1}}).resultType===r.b.Success)return Promise.resolve(window.g_listData);{const e=new r.a({name:d.f,extraData:{...this._extraLoggingData}});return this._retriever.getItem(this._getContext(),this._listContext,{qosEvent:e,qosName:d.f})}}throw new Error("noItemId")}return this._racePrefetchAndRLDSAPI(t).then(e=>e.response)}_racePrefetchAndRLDSAPI(e){const t=new Promise((e,t)=>{window.DeferredListDataComplete=()=>{if(!this._id||!window.g_listData)throw new Error("no g_listData");if((0,c.a)({response:window.g_listData,id:this._id,listContext:this._listContext}).resultType!==r.b.Success)throw new Error("incorrect g_listData");e({response:window.g_listData,type:"preload"})}}),n=new r.a({name:d.n,extraData:{...this._extraLoggingData}}),a=this._retriever.getItem(this._getContext(),this._listContext,{qosEvent:n,qosName:d.n}).then(e=>({response:e,type:"callRLDS"}));return Promise.race([t,a]).then(t=>("preload"===t.type?e.end({resultType:r.b.Success,extraData:{isRace:!0}}):"callRLDS"===t.type&&e.end({resultType:r.b.Failure,extraData:{isRace:!0,reason:"callRLDAS wins"}}),t))}_getContext(){let e;if(!(0,l.Jb)()&&this._odcId){const{itemId:t,itemUniqueId:n}=(0,u.a)(this._odcId);e=s.b({itemIds:this._getItemIds(n,t),itemRefs:void 0,pageSize:1,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:!0})}else e=this._id?s.b({sortField:void 0,itemIds:void 0,itemRefs:[this._id],isAscending:void 0,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:!0,pageSize:1}):s.b({itemIds:void 0,itemRefs:void 0,pageSize:0,recurseInFolders:!0,fieldNames:["File_x0020_Type","FileRef","FileLeafRef","Editor","Author","PrincipalCount","Title"]});return this._id?{parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!1,needSchema:!0,postDataContext:{disableAutoHyperlink:!1,isListDataRenderOptionChangeFeatureEnabled:!0,isSpotlightFeatureEnabled:!0,needClientSideComponentManifest:!1,needUpdatePageContext:!0,needsContentTypeOrder:!0,needsContentTypes:!1,needsForms:!1,needsGridInitInfo:!1,needsListAvailableContentTypes:!0,needsMountPoint:!0,needsParentInfo:!0,needsQuickLaunch:!1,needsSchema:!0,needsSpotlight:!0,needsViewMetadata:!0,renderCustomActions:!0,renderSpfxCustomActions:!1,preAuthorizedDownloadUrl:!0,requireDownloadUrlNoAuth:!0,viewXml:e}}:{parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!1,needSchema:!0,postDataContext:{isListDataRenderOptionChangeFeatureEnabled:!0,isSpotlightFeatureEnabled:!0,needsSchema:!0,needUpdatePageContext:!0,needsMountPoint:!0,requireFolderColoringFields:!0,viewXml:e}}}constructor(e){super({dataSourceName:"OneUpRLDS"},{pageContext:e.pageContext}),this._getItemIds=(e,t)=>e?[e]:t?[t]:void 0,this._id=e.id,this._odcId=e.odcId,this._retriever=new o.a({pageContext:e.pageContext}),this._listContext=e.listContext,this._extraLoggingData=e.extraLoggingData}}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n(0),i=n(30),r=n(4),o=n(255);function s(e){const{response:t,id:n,odcId:s,listContext:c,qosEvent:d,extraData:l}=e;let u;if(t&&t.ListData&&t.ListData.Row){const e=t.ListData.Row;if(1===e.length){const d=e[0],f=d.FileRef?.toLowerCase()===n.toLowerCase()&&t.ListUrl?.toLowerCase()===c?.listUrl?.toLowerCase();let p,m;if(!(0,r.Jb)()&&s){const{itemId:e,itemUniqueId:t}=(0,o.a)(s);p=!(!t||!d.UniqueId)&&i.a.normalizeLower(i.a.normalizeDashes(d.UniqueId,!1))===i.a.normalizeLower(i.a.normalizeDashes(t,!1)),m=!!e&&d.Id===e}u=f||p||m?{resultType:a.b.Success}:{resultType:a.b.Failure,resultCode:"idFileRefMismatch",extraData:{...l,serverFileRef:d.FileRef,fileId:n,serverlistUrl:t.ListUrl,fileListUrl:c?.listUrl}}}else u={resultType:a.b.Failure,resultCode:"wrongRowDataLength",extraData:{...l,rowDataLength:e.length}}}else u={resultType:a.b.Failure,resultCode:"noRowData",extraData:{...l}};return d?.end(u),u}}
,,,,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>a}),function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={})),function(e){e[e.None=0]="None",e[e.CommentsDisabled=1]="CommentsDisabled",e[e.CommentsInTable=2]="CommentsInTable",e[e.CommentsMigrating=4]="CommentsMigrating",e[e.LikesMigrating=8]="LikesMigrating"}(i||(i={}))}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a="photosData"}
,,,,(e,t,n)=>{"use strict";function a(){return window.$oneup||(window.$oneup={isDebugMode:!1,stores:{},debug:function(){return this.isDebugMode=!this.isDebugMode},attachStores:function(e){this.stores=Object.assign(this.stores,e)}}),window.$oneup}n.d(t,{a:()=>a})}
,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>d});var a=n(15),i=n(21),r=n(27),o=n(1),s=n(6),c=n(4);function d(e){const t=e.consume(r.a),n=e.consume(o.a),d=t.viewParams;let l,u=d[i.b.idParamKey],f=d[i.b.parentIdParamKey],p=d[i.b.parentQueryTypeParamKey],m=d[i.b.queryTypeParamKey],_=d[i.b.listUrlKey];if((0,c.ub)()&&window.g_oneUpPathAndQueryString){const e=window.g_oneUpPathAndQueryString,t=new URL(e);if(t.searchParams&&t.searchParams.get("ga")){let e=t.searchParams?.get("id");e&&(u=e),e=t.searchParams?.get("parent"),e&&(f=e),e=t.searchParams?.get("parentview"),e&&(p=e),e=t.searchParams?.get("view"),e&&(m=e),e=t.searchParams?.get("listurl"),e&&(_=e)}}let h=f;const b=e.consume(a.c),g=b.getUrlParts({path:u,listUrl:_}),v=g.fullItemUrl?new s.a(g.fullItemUrl):void 0;h?l=b.getUrlParts({path:l,listUrl:_}).fullItemUrl:(l=v?`${v.authority}${v.segments.slice(0,-1).join("/")}`:void 0,h=b.getUrlParts({path:l,listUrl:_}).serverRelativeItemUrl);const y=b.getUrlParts({path:h,listUrl:_}),S=g.fullWebUrl,D=g.fullListUrl,I={listUrl:g.serverRelativeListUrl,needSchema:!0,urlParts:g},x=g.fullItemUrl;h=y.serverRelativeItemUrl!==y.serverRelativeListUrl&&y.fullItemUrl!==S&&"/"!==y.serverRelativeListUrl&&y.serverRelativeItemUrl||"";const C=!h||!!h&&D===y.fullItemUrl;return{idViewParam:u,parentViewParam:f,parentViewViewParam:p,listUrlViewParam:_,viewViewParam:m,webAbsoluteUrl:S,fullListUrl:D,serverRelativeListUrl:g.serverRelativeListUrl,fullFocusItemUrl:x,serverRelativeFocusItemUrl:g.serverRelativeItemUrl,fullParentUrl:l,serverRelativeParentUrl:h,isRootFolder:C,listContext:I,pageContext:n,cidViewParam:d[i.b.cid],parIdViewParam:d.parId}}}
,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n(47);class i{getValue(e,t){const n=this._store.getValue(e);if(n?.expiration&&t<n.expiration)return n;this._store.remove(e)}setValue(e,t){if(t){if(!t.expiration||!t.value)return;this._store.setValue(e,t)}else this._store.remove(e)}constructor(e){const{userId:t,cachingType:n}=e;this._store=new a.a(`Identity.OAuth.${t}`,n)}}}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>u,c:()=>d});var a=n(48),i=n(9),r=n(22),o=n("odsp.util_385"),s=n(0);function c(e,t,n){return i.c.all([l(e),l(e,n)]).then(([e,n])=>{const a=n.length>e.length;return{text:a?e:n,mimeType:t,isSafeText:a||f(n)}},e=>e.filter(e=>!i.c.isCanceled(e))[0]||e[0])}function d(e,t){return l(e).then(e=>({text:e,mimeType:t,isSafeText:!0}))}function l(e,t){const n=new a.b,i=new FileReader,r=new s.a({name:"FileContentHelper.parseFile"});return i.onload=()=>{n.complete(i.result||""),r.end({resultType:s.b.Success})},i.onerror=e=>{const t=new o.a_({code:"FileContentHelperParseBlobFailure",innerError:i.error,message:i.error?.message||"FileContentHelperParseBlobGenericFailure"});r.end({resultType:s.b.Failure,extraData:{error:t}})},i.readAsText(e,t),n.getPromise()}function u(e,t){return-1===t.search(/^http/)||t.lastIndexOf(":")===t.indexOf(":")&&t.indexOf("/content?format=")<0||t.indexOf(":/content?")>=0?t:`${t.indexOf("/content?format=")>=0?`${t}`:`${t}:/content?`}${(0,r.a)(e)}`}function f(e){for(let n=0;n<e.length;n++)if(!((t=e.charCodeAt(n))<127||p[t]))return!1;var t;return!0}const p={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("odsp.util_385");const i={Modified:"modified",ExitEdit:"exitEdit"},r=new a.OJ({name:"PdfEmbedHelper.key",loader:new a.hg(()=>n.e(62).then(n.bind(n,784)).then(e=>e.resourceKey))})}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>m,b:()=>_,c:()=>b,d:()=>h});var a=n("react-lib"),i=n.n(a),r=n(555),o=n(204),s=n(301),c=n(63),d=n(557),l=n(300),u=n(169),f=n("odsp.util_385"),p=n(114);const m=()=>i().useContext(r.a),_=()=>i().useContext(r.b),h=e=>{const t=i().useCallback((t,n)=>{const a=e?.current?.getToastOperation();a?.({type:o.b.Running,text:t,percentComplete:n/100})},[e]),n=i().useCallback((t,n,a=!1)=>{const i=e?.current?.getToastOperation();i?.({type:o.b.Success,text:t,link:n,linkText:u.g,disableAutoHide:a,onClickClose:()=>{i?.({type:o.b.Hidden})}})},[e]),a=i().useCallback(t=>{const n=e?.current?.getToastOperation();n?.({type:o.b.Error,text:t,onClickClose:()=>{n?.({type:o.b.Hidden})}})},[e]);return i().useCallback(async e=>{let i=0,r=0;const o=new s.d({name:e.scenarioName});try{i=window.setInterval(()=>{if(100-r>10)return r+=10,void t(e.runningText,r);r=Math.floor((100-r)/4)+r,t(e.runningText,r)},200),e.telemetryHandler?.logQosStart(o),e.before?.();const a=await e.runner();clearInterval(i),n(e.successText,a,e.disableAutoHide),e.telemetryHandler?.logQosEnd(new s.c(o.payload.id,e.scenarioName,c.b.Succeed,{}))}catch(t){clearInterval(i);let n,r=!1,m=e.failedText;t instanceof l.d&&t.type===l.c.ExceedsMaximumLength&&(r=!0,m=f._0(u.w,t.url.length)),!(0,p.g)()&&t instanceof l.b&&void 0!==t.code&&(n=(0,d.a)(t.code),t.code===l.a.UnableFurtherCompression&&(m=u.x)),a(m),e.telemetryHandler?.logQosEnd(new s.c(o.payload.id,e.scenarioName,c.b.Fail,{isExpected:r,error:t,code:n}))}finally{e.after?.()}},[t,n,a])},b=e=>i().useCallback(async(t,n)=>{if(!e)throw new l.b("Manipulator is not ready in PDF engine");const{newFileName:a,items:i}=t;let r;(0,l.h)(a,i[0]);try{r=await n()}catch(e){throw new l.b(`Manipulator runtime error: ${e.message}`)}if(!r)throw new l.b("Manipulator is not ready in PDF engine");const[o,s]=r;if(0!==o)throw(0,p.g)()?new l.b(`Fail to manipulate PDF from PDF Parser, code=${o}`):new l.b(`Fail to manipulate PDF from PDF Parser, code=${o}`,o);const c=new Blob([s],{type:"application/pdf"}),d=new File([c],`${a}.pdf`,{type:"application/pdf"});return e(d,i[0])},[e])}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("react-lib");const i=(0,a.createContext)(()=>{throw new Error("closeFilePickerCtx call out of context scope")}),r=(0,a.createContext)(()=>{throw new Error("confirmFilePickerCtx call out of context scope")})}
,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>l});var i=new Uint8Array(16);function r(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}const o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,s=function(e){return"string"==typeof e&&o.test(e)};for(var c=[],d=0;d<256;++d)c.push((d+256).toString(16).substr(1));const l=function(e,t,n){var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=a[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n}(a)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=new Map([[0,"Task_Success"],[1,"Task_Cancelled"],[2,"Task_Failed"],[3,"Wrong_Password"],[4,"Unsupported_Encryption_Algorithm"],[5,"Permission_Denied"],[6,"File_Corrupted"],[7,"Page_Index_Out_Of_Range"],[8,"Save_Path_Invalid"],[9,"File_With_XFA"],[10,"Unsupported_AcroForm_Pattern"],[11,"Unexpected_File_Size"],[12,"Invalid_Argument"],[13,"Unable_Further_Compression"]]);function i(e){return a.get(e)||"Unknown_".concat(e)}}
,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=function(){function e(){}return e.getTempAuthLogFields=function(e,t){if(!e)return{};var n=function(e){try{var t=new URL(e.toLowerCase()).searchParams,a=t.get("tempauth"),i=t.get("access_token"),r=t.get("docid");return!!(a&&"false"!==a||i&&"false"!==i)||!!r&&n(decodeURI(r))}catch(e){return}},a=n(e);return void 0!==a?{noTempAuth:!a,useToken:!!t}:{useToken:!!t}},e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n(82),i=n(335),r=function(e){var t=new a.a(e.origin.x,e.origin.y);return{image:e.image,origin:t.scale(1/(0,i.a)()),triggerType:e.triggerType}},o=function(e,t,n,i,r){return new a.b(e,t,n-e,i-t).scale(r||1)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("tslib_145");const i=()=>(0,a.yv)(void 0,void 0,void 0,function*(){return Promise.all([n.e("odsp.react.lib"),n.e(27)]).then(n.bind(n,802))})}
,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>a}),function(e){e.Space=" ",e.Tab="Tab",e.Home="Home",e.Enter="Enter",e.End="End",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.Escape="Escape",e.Delete="Delete"}(a||(a={}))}
,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f,b:()=>u,c:()=>l});var a=n(115),i=n(290),r=n("odsp.util_385"),o=n(590),s=n(296);const c=!r.Ov.isActivated("e33725dc-ac48-468a-91e4-c333939ac75f"),d=/&(?:access_|proof)token=[^&]*/g;async function l(e){const{resources:t,thumbnailUrl:n,isRetry:l,forceRefresh:f=!1,isMeTA:p,isMeTATempAuthDeprecationEnabled:m}=e;if(!n)return{error:new Error("ThumbnailUrl is empty")};let _;if(p){const e=t.consume(s.a);_=await e({forceRefresh:f})}const h=c?"no-cache":void 0;try{const e=await fetch(n||"",{headers:_,cache:h}),{status:s}=e;if(200===s)return{file:await e.blob()};{if((401===s||400===s)&&!l){let e=n;if(m||(e=await async function(e,t){try{const n=await e.consumeAsync(i.a),a=await n.refreshAuthToken();if(a){const{authToken:e,proofToken:n}=a;return t.replace(d,`&access_token=${e}${n?`&prooftoken=${n}`:""}`)}}catch(e){return}}(t,n)),e)return u({resources:t,thumbnailUrl:e,isRetry:!0,forceRefresh:!0,isMeTA:p,isMeTATempAuthDeprecationEnabled:m})}const{correlationId:c,errorCode:f,region:_}=(0,a.c)(e);return{error:new r.a_({isExpected:(0,o.a)(e),code:`${s.toString()}_${f||"UrlFetchException"}`,correlationId:c,extraData:{region:_}})}}}catch(e){return{error:e}}}async function u(e){const{file:t,error:n}=await l(e);return t?{blobUrl:URL.createObjectURL(t),error:n}:{error:n}}function f(e,t){const n="isExpected"in e?!!e.isExpected:void 0,a="correlationId"in e?e.correlationId:void 0,i=p(e),o=p(t),s=m(e),c=m(t);return new r.a_({isExpected:n,code:`${i}_${o}`,correlationId:a,extraData:{...s,...c}})}function p(e){return"code"in e?e.code:`${e.name}: ${e.message}`}function m(e){return"extraData"in e?e.extraData:void 0}}
,(e,t,n)=>{"use strict";function a(e){return e.ok||(t=e.status)>=400&&t<500;var t}n.d(t,{a:()=>a})}
,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>pe,b:()=>_e,c:()=>se,d:()=>le,e:()=>fe,f:()=>me,g:()=>ce,h:()=>de,i:()=>ue});const a=["top","right","bottom","left"],i=Math.min,r=Math.max,o=Math.round,s=(Math.floor,e=>({x:e,y:e})),c={left:"right",right:"left",bottom:"top",top:"bottom"},d={start:"end",end:"start"};function l(e,t,n){return r(e,i(t,n))}function u(e,t){return"function"==typeof e?e(t):e}function f(e){return e.split("-")[0]}function p(e){return e.split("-")[1]}function m(e){return"x"===e?"y":"x"}function _(e){return"y"===e?"height":"width"}function h(e){return["top","bottom"].includes(f(e))?"y":"x"}function b(e){return m(h(e))}function g(e){return e.replace(/start|end/g,e=>d[e])}function v(e){return e.replace(/left|right|bottom|top/g,e=>c[e])}function y(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function S(e){const{x:t,y:n,width:a,height:i}=e;return{width:a,height:i,top:n,left:t,right:t+a,bottom:n+i,x:t,y:n}}function D(e,t,n){let{reference:a,floating:i}=e;const r=h(t),o=b(t),s=_(o),c=f(t),d="y"===r,l=a.x+a.width/2-i.width/2,u=a.y+a.height/2-i.height/2,m=a[s]/2-i[s]/2;let g;switch(c){case"top":g={x:l,y:a.y-i.height};break;case"bottom":g={x:l,y:a.y+a.height};break;case"right":g={x:a.x+a.width,y:u};break;case"left":g={x:a.x-i.width,y:u};break;default:g={x:a.x,y:a.y}}switch(p(t)){case"start":g[o]-=m*(n&&d?-1:1);break;case"end":g[o]+=m*(n&&d?-1:1)}return g}async function I(e,t){var n;void 0===t&&(t={});const{x:a,y:i,platform:r,rects:o,elements:s,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:l="viewport",elementContext:f="floating",altBoundary:p=!1,padding:m=0}=u(t,e),_=y(m),h=s[p?"floating"===f?"reference":"floating":f],b=S(await r.getClippingRect({element:null==(n=await(null==r.isElement?void 0:r.isElement(h)))||n?h:h.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(s.floating)),boundary:d,rootBoundary:l,strategy:c})),g="floating"===f?{...o.floating,x:a,y:i}:o.reference,v=await(null==r.getOffsetParent?void 0:r.getOffsetParent(s.floating)),D=await(null==r.isElement?void 0:r.isElement(v))&&await(null==r.getScale?void 0:r.getScale(v))||{x:1,y:1},I=S(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:g,offsetParent:v,strategy:c}):g);return{top:(b.top-I.top+_.top)/D.y,bottom:(I.bottom-b.bottom+_.bottom)/D.y,left:(b.left-I.left+_.left)/D.x,right:(I.right-b.right+_.right)/D.x}}function x(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function C(e){return a.some(t=>e[t]>=0)}function O(){return"undefined"!=typeof window}function w(e){return L(e)?(e.nodeName||"").toLowerCase():"#document"}function E(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function A(e){var t;return null==(t=(L(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function L(e){return!!O()&&(e instanceof Node||e instanceof E(e).Node)}function k(e){return!!O()&&(e instanceof Element||e instanceof E(e).Element)}function M(e){return!!O()&&(e instanceof HTMLElement||e instanceof E(e).HTMLElement)}function P(e){return!(!O()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof E(e).ShadowRoot)}function T(e){const{overflow:t,overflowX:n,overflowY:a,display:i}=B(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+n)&&!["inline","contents"].includes(i)}function U(e){return["table","td","th"].includes(w(e))}function F(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch(e){return!1}})}function H(e){const t=R(),n=k(e)?B(e):e;return["transform","translate","scale","rotate","perspective"].some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some(e=>(n.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(n.contain||"").includes(e))}function R(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function N(e){return["html","body","#document"].includes(w(e))}function B(e){return E(e).getComputedStyle(e)}function j(e){return k(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function V(e){if("html"===w(e))return e;const t=e.assignedSlot||e.parentNode||P(e)&&e.host||A(e);return P(t)?t.host:t}function z(e){const t=V(e);return N(t)?e.ownerDocument?e.ownerDocument.body:e.body:M(t)&&T(t)?t:z(t)}function G(e,t,n){var a;void 0===t&&(t=[]),void 0===n&&(n=!0);const i=z(e),r=i===(null==(a=e.ownerDocument)?void 0:a.body),o=E(i);if(r){const e=K(o);return t.concat(o,o.visualViewport||[],T(i)?i:[],e&&n?G(e):[])}return t.concat(i,G(i,[],n))}function K(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function W(e){const t=B(e);let n=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const i=M(e),r=i?e.offsetWidth:n,s=i?e.offsetHeight:a,c=o(n)!==r||o(a)!==s;return c&&(n=r,a=s),{width:n,height:a,$:c}}function q(e){return k(e)?e:e.contextElement}function Q(e){const t=q(e);if(!M(t))return s(1);const n=t.getBoundingClientRect(),{width:a,height:i,$:r}=W(t);let c=(r?o(n.width):n.width)/a,d=(r?o(n.height):n.height)/i;return c&&Number.isFinite(c)||(c=1),d&&Number.isFinite(d)||(d=1),{x:c,y:d}}const Y=s(0);function J(e){const t=E(e);return R()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Y}function X(e,t,n,a){void 0===t&&(t=!1),void 0===n&&(n=!1);const i=e.getBoundingClientRect(),r=q(e);let o=s(1);t&&(a?k(a)&&(o=Q(a)):o=Q(e));const c=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==E(e))&&t}(r,n,a)?J(r):s(0);let d=(i.left+c.x)/o.x,l=(i.top+c.y)/o.y,u=i.width/o.x,f=i.height/o.y;if(r){const e=E(r),t=a&&k(a)?E(a):a;let n=e,i=K(n);for(;i&&a&&t!==n;){const e=Q(i),t=i.getBoundingClientRect(),a=B(i),r=t.left+(i.clientLeft+parseFloat(a.paddingLeft))*e.x,o=t.top+(i.clientTop+parseFloat(a.paddingTop))*e.y;d*=e.x,l*=e.y,u*=e.x,f*=e.y,d+=r,l+=o,n=E(i),i=K(n)}}return S({width:u,height:f,x:d,y:l})}function Z(e,t){const n=j(e).scrollLeft;return t?t.left+n:X(A(e)).left+n}function $(e,t,n){void 0===n&&(n=!1);const a=e.getBoundingClientRect();return{x:a.left+t.scrollLeft-(n?0:Z(e,a)),y:a.top+t.scrollTop}}function ee(e,t,n){let a;if("viewport"===t)a=function(e,t){const n=E(e),a=A(e),i=n.visualViewport;let r=a.clientWidth,o=a.clientHeight,s=0,c=0;if(i){r=i.width,o=i.height;const e=R();(!e||e&&"fixed"===t)&&(s=i.offsetLeft,c=i.offsetTop)}return{width:r,height:o,x:s,y:c}}(e,n);else if("document"===t)a=function(e){const t=A(e),n=j(e),a=e.ownerDocument.body,i=r(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),o=r(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let s=-n.scrollLeft+Z(e);const c=-n.scrollTop;return"rtl"===B(a).direction&&(s+=r(t.clientWidth,a.clientWidth)-i),{width:i,height:o,x:s,y:c}}(A(e));else if(k(t))a=function(e,t){const n=X(e,!0,"fixed"===t),a=n.top+e.clientTop,i=n.left+e.clientLeft,r=M(e)?Q(e):s(1);return{width:e.clientWidth*r.x,height:e.clientHeight*r.y,x:i*r.x,y:a*r.y}}(t,n);else{const n=J(e);a={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return S(a)}function te(e,t){const n=V(e);return!(n===t||!k(n)||N(n))&&("fixed"===B(n).position||te(n,t))}function ne(e,t,n){const a=M(t),i=A(t),r="fixed"===n,o=X(e,!0,r,t);let c={scrollLeft:0,scrollTop:0};const d=s(0);if(a||!a&&!r)if(("body"!==w(t)||T(i))&&(c=j(t)),a){const e=X(t,!0,r,t);d.x=e.x+t.clientLeft,d.y=e.y+t.clientTop}else i&&(d.x=Z(i));const l=!i||a||r?s(0):$(i,c);return{x:o.left+c.scrollLeft-d.x-l.x,y:o.top+c.scrollTop-d.y-l.y,width:o.width,height:o.height}}function ae(e){return"static"===B(e).position}function ie(e,t){if(!M(e)||"fixed"===B(e).position)return null;if(t)return t(e);let n=e.offsetParent;return A(e)===n&&(n=n.ownerDocument.body),n}function re(e,t){const n=E(e);if(F(e))return n;if(!M(e)){let t=V(e);for(;t&&!N(t);){if(k(t)&&!ae(t))return t;t=V(t)}return n}let a=ie(e,t);for(;a&&U(a)&&ae(a);)a=ie(a,t);return a&&N(a)&&ae(a)&&!H(a)?n:a||function(e){let t=V(e);for(;M(t)&&!N(t);){if(H(t))return t;if(F(t))return null;t=V(t)}return null}(e)||n}const oe={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:a,strategy:i}=e;const r="fixed"===i,o=A(a),c=!!t&&F(t.floating);if(a===o||c&&r)return n;let d={scrollLeft:0,scrollTop:0},l=s(1);const u=s(0),f=M(a);if((f||!f&&!r)&&(("body"!==w(a)||T(o))&&(d=j(a)),M(a))){const e=X(a);l=Q(a),u.x=e.x+a.clientLeft,u.y=e.y+a.clientTop}const p=!o||f||r?s(0):$(o,d,!0);return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-d.scrollLeft*l.x+u.x+p.x,y:n.y*l.y-d.scrollTop*l.y+u.y+p.y}},getDocumentElement:A,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:a,strategy:o}=e;const s="clippingAncestors"===n?F(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let a=G(e,[],!1).filter(e=>k(e)&&"body"!==w(e)),i=null;const r="fixed"===B(e).position;let o=r?V(e):e;for(;k(o)&&!N(o);){const t=B(o),n=H(o);n||"fixed"!==t.position||(i=null),(r?!n&&!i:!n&&"static"===t.position&&i&&["absolute","fixed"].includes(i.position)||T(o)&&!n&&te(e,o))?a=a.filter(e=>e!==o):i=t,o=V(o)}return t.set(e,a),a}(t,this._c):[].concat(n),c=[...s,a],d=c[0],l=c.reduce((e,n)=>{const a=ee(t,n,o);return e.top=r(a.top,e.top),e.right=i(a.right,e.right),e.bottom=i(a.bottom,e.bottom),e.left=r(a.left,e.left),e},ee(t,d,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:re,getElementRects:async function(e){const t=this.getOffsetParent||re,n=this.getDimensions,a=await n(e.floating);return{reference:ne(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=W(e);return{width:t,height:n}},getScale:Q,isElement:k,isRTL:function(e){return"rtl"===B(e).direction}},se=I,ce=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,a;const{x:i,y:r,placement:o,middlewareData:s}=t,c=await async function(e,t){const{placement:n,platform:a,elements:i}=e,r=await(null==a.isRTL?void 0:a.isRTL(i.floating)),o=f(n),s=p(n),c="y"===h(n),d=["left","top"].includes(o)?-1:1,l=r&&c?-1:1,m=u(t,e);let{mainAxis:_,crossAxis:b,alignmentAxis:g}="number"==typeof m?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...m};return s&&"number"==typeof g&&(b="end"===s?-1*g:g),c?{x:b*l,y:_*d}:{x:_*d,y:b*l}}(t,e);return o===(null==(n=s.offset)?void 0:n.placement)&&null!=(a=s.arrow)&&a.alignmentOffset?{}:{x:i+c.x,y:r+c.y,data:{...c,placement:o}}}}},de=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:a,placement:i}=t,{mainAxis:r=!0,crossAxis:o=!1,limiter:s={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...c}=u(e,t),d={x:n,y:a},p=await I(t,c),_=h(f(i)),b=m(_);let g=d[b],v=d[_];if(r){const e="y"===b?"bottom":"right";g=l(g+p["y"===b?"top":"left"],g,g-p[e])}if(o){const e="y"===_?"bottom":"right";v=l(v+p["y"===_?"top":"left"],v,v-p[e])}const y=s.fn({...t,[b]:g,[_]:v});return{...y,data:{x:y.x-n,y:y.y-a}}}}},le=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,a;const{placement:i,middlewareData:r,rects:o,initialPlacement:s,platform:c,elements:d}=t,{mainAxis:l=!0,crossAxis:m=!0,fallbackPlacements:h,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:S="none",flipAlignment:D=!0,...x}=u(e,t);if(null!=(n=r.arrow)&&n.alignmentOffset)return{};const C=f(i),O=f(s)===s,w=await(null==c.isRTL?void 0:c.isRTL(d.floating)),E=h||(O||!D?[v(s)]:function(e){const t=v(e);return[g(e),t,g(t)]}(s));h||"none"===S||E.push(...function(e,t,n,a){const i=p(e);let r=function(e,t,n){const a=["left","right"],i=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:a:t?a:i;case"left":case"right":return t?r:o;default:return[]}}(f(e),"start"===n,a);return i&&(r=r.map(e=>e+"-"+i),t&&(r=r.concat(r.map(g)))),r}(s,D,S,w));const A=[s,...E],L=await I(t,x),k=[];let M=(null==(a=r.flip)?void 0:a.overflows)||[];if(l&&k.push(L[C]),m){const e=function(e,t,n){void 0===n&&(n=!1);const a=p(e),i=b(e),r=_(i);let o="x"===i?a===(n?"end":"start")?"right":"left":"start"===a?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=v(o)),[o,v(o)]}(i,o,w);k.push(L[e[0]],L[e[1]])}if(M=[...M,{placement:i,overflows:k}],!k.every(e=>e<=0)){var P,T;const e=((null==(P=r.flip)?void 0:P.index)||0)+1,t=A[e];if(t)return{data:{index:e,overflows:M},reset:{placement:t}};let n=null==(T=M.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:T.placement;if(!n)switch(y){case"bestFit":{var U;const e=null==(U=M.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:U[0];e&&(n=e);break}case"initialPlacement":n=s}if(i!==n)return{reset:{placement:n}}}return{}}}},ue=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:a,platform:o,elements:s}=t,{apply:c=(()=>{}),...d}=u(e,t),l=await I(t,d),m=f(n),_=p(n),b="y"===h(n),{width:g,height:v}=a.floating;let y,S;"top"===m||"bottom"===m?(y=m,S=_===(await(null==o.isRTL?void 0:o.isRTL(s.floating))?"start":"end")?"left":"right"):(S=m,y="end"===_?"top":"bottom");const D=v-l[y],x=g-l[S],C=!t.middlewareData.shift;let O=D,w=x;if(b){const e=g-l.left-l.right;w=_||C?i(x,e):e}else{const e=v-l.top-l.bottom;O=_||C?i(D,e):e}if(C&&!_){const e=r(l.left,0),t=r(l.right,0),n=r(l.top,0),a=r(l.bottom,0);b?w=g-2*(0!==e||0!==t?e+t:r(l.left,l.right)):O=v-2*(0!==n||0!==a?n+a:r(l.top,l.bottom))}await c({...t,availableWidth:w,availableHeight:O});const E=await o.getDimensions(s.floating);return g!==E.width||v!==E.height?{reset:{rects:!0}}:{}}}},fe=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:a="referenceHidden",...i}=u(e,t);switch(a){case"referenceHidden":{const e=x(await I(t,{...i,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:C(e)}}}case"escaped":{const e=x(await I(t,{...i,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:C(e)}}}default:return{}}}}},pe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:a,placement:r,rects:o,platform:s,elements:c,middlewareData:d}=t,{element:f,padding:m=0}=u(e,t)||{};if(null==f)return{};const h=y(m),g={x:n,y:a},v=b(r),S=_(v),D=await s.getDimensions(f),I="y"===v,x=I?"top":"left",C=I?"bottom":"right",O=I?"clientHeight":"clientWidth",w=o.reference[S]+o.reference[v]-g[v]-o.floating[S],E=g[v]-o.reference[v],A=await(null==s.getOffsetParent?void 0:s.getOffsetParent(f));let L=A?A[O]:0;L&&await(null==s.isElement?void 0:s.isElement(A))||(L=c.floating[O]||o.floating[S]);const k=w/2-E/2,M=L/2-D[S]/2-1,P=i(h[x],M),T=i(h[C],M),U=P,F=L-D[S]-T,H=L/2-D[S]/2+k,R=l(U,H,F),N=!d.arrow&&null!=p(r)&&H!==R&&o.reference[S]/2-(H<U?P:T)-D[S]/2<0,B=N?H<U?H-U:H-F:0;return{[v]:g[v]+B,data:{[v]:R,centerOffset:H-R-B,...N&&{alignmentOffset:B}},reset:N}}}),me=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:n,y:a,placement:i,rects:r,middlewareData:o}=t,{offset:s=0,mainAxis:c=!0,crossAxis:d=!0}=u(e,t),l={x:n,y:a},p=h(i),_=m(p);let b=l[_],g=l[p];const v=u(s,t),y="number"==typeof v?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const e="y"===_?"height":"width",t=r.reference[_]-r.floating[e]+y.mainAxis,n=r.reference[_]+r.reference[e]-y.mainAxis;b<t?b=t:b>n&&(b=n)}if(d){var S,D;const e="y"===_?"width":"height",t=["top","left"].includes(f(i)),n=r.reference[p]-r.floating[e]+(t&&(null==(S=o.offset)?void 0:S[p])||0)+(t?0:y.crossAxis),a=r.reference[p]+r.reference[e]+(t?0:(null==(D=o.offset)?void 0:D[p])||0)-(t?y.crossAxis:0);g<n?g=n:g>a&&(g=a)}return{[_]:b,[p]:g}}}},_e=(e,t,n)=>{const a=new Map,i={platform:oe,...n},r={...i.platform,_c:a};return(async(e,t,n)=>{const{placement:a="bottom",strategy:i="absolute",middleware:r=[],platform:o}=n,s=r.filter(Boolean),c=await(null==o.isRTL?void 0:o.isRTL(t));let d=await o.getElementRects({reference:e,floating:t,strategy:i}),{x:l,y:u}=D(d,a,c),f=a,p={},m=0;for(let n=0;n<s.length;n++){const{name:r,fn:_}=s[n],{x:h,y:b,data:g,reset:v}=await _({x:l,y:u,initialPlacement:a,placement:f,strategy:i,middlewareData:p,rects:d,platform:o,elements:{reference:e,floating:t}});l=null!=h?h:l,u=null!=b?b:u,p={...p,[r]:{...p[r],...g}},v&&m<=50&&(m++,"object"==typeof v&&(v.placement&&(f=v.placement),v.rects&&(d=!0===v.rects?await o.getElementRects({reference:e,floating:t,strategy:i}):v.rects),({x:l,y:u}=D(d,f,c))),n=-1)}return{x:l,y:u,placement:f,strategy:i,middlewareData:p}})(e,t,{...i,platform:r})}}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var a=n("react-lib"),i=n(607),r=n("fui.util_939"),o=n("odsp.util_385"),s=n(608);function c(e){const t=e.allowInfectedFileDownload?i.c:i.f,n=(0,r.kF)();return a.createElement(s.a,null,o.gt(t,a.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank",rel:"noreferrer"},a.createElement("span",{style:{color:n.palette.themePrimary}},i.e))))}}
,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_385");const i=new a.OJ({name:"SaveActionExecutor.key",loader:new a.hg(()=>n.e(68).then(n.bind(n,819)).then(e=>e.saveActionExecutorKey))})}
,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>S});var a=n(42),i=n("odsp.util_385"),r=n(4),o=n(233),s=n(17),c=n(1),d=n(365),l=n(10),u=n(139),f=n(190);const p={resources:i.sp,oneUpStateStore:l.f,getExecutor:d.a.async.lazy,oneUpStore:s.b,appPageContext:c.a,openCopilotPaneAction:f.a,isCopilotEnabled:u.a},m=new i.OJ({name:"onClickCopilotPaneAction",factory:{dependencies:p,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const n=(0,r.jb)(r.h)&&t.isCopilotEnabled(),a=t.oneUpStateStore.currentAppState.rightPane.type===l.e.copilotPane;return(0,o.b)(n,"OneUp",()=>"Licensed"),a?{isAvailable:!0,id:"closeCopilotPaneAction",onExecute:async()=>{t.oneUpStateStore.updateRightPaneState("closeCopilotPane",{type:l.e.none})}}:t.openCopilotPaneAction.evaluateAction({item:e.item})})}}}}});var _=n(191),h=n(641);const b={actionProvider:m},g="CopilotPaneCommand",v=h.a,y=(0,_.a)(),S=new i.OJ({name:"CopilotCommand",factory:{dependencies:b,create:({actionProvider:e})=>({instance:{id:g,title:a.k,automationId:g,iconProps:{imageProps:{src:v}},evaluateAction:e.evaluateAction,buttonStyles:y}})}})}
,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>k});var a=n("odsp.util_385"),i=n(27),r=n(0),o=n(21),s=n(22),c=n(17),d=n(10),l=n(282),u=n(80),f=n(4),p=n(137),m=n(188),_=n(354),h=n(15),b=n(79),g=n(513),v=n(373),y=n(141);const S=e=>o.b.driveIdParamKey in e||o.b.parentDriveIdParamKey in e,D=!a.Ov.isActivated("520D3434-B1DD-43EC-9350-065337C1E8E0"),I=!a.Ov.isActivated("550C51AB-F752-4034-84AE-9AFC2B9780E5"),x=!a.Ov.isActivated("6149D03E-B2BF-4691-8598-5FC674B09264"),C=!a.Ov.isActivated("2365740E-F7A0-4E9D-9BD3-2B690262624E"),O=a.Ov.isActivated("a5e1d64c-8940-4ce7-9446-9ba2565085ed"),w=!a.Ov.isActivated("5ca4278e-b244-4595-b3dd-fc470790798d"),E=a.Ov.isActivated("c8636355-f925-4b6c-932c-70b5008f78eb"),A={oneUpStore:c.b,navigation:i.a,resources:a.sp,oneUpStateStore:d.f,oneUpLoadingCustomerPromiseFunctions:l.b,saveAction:m.a,isFastOneUpKey:u.j.optional,itemUrlHelper:h.c},L=e=>{const{navigation:t,oneUpStore:n,oneUpStateStore:a,saveAction:i}=e;return c=>({isAvailable:!0,id:"CloseAction",onExecute:async()=>{(0,f.db)()&&(0,v.a)();const d=(0,_.b)({saveAction:i,navigation:t,focusItem:c.item}),{parentItem:u,parentStoreKey:m}=n.getOneUpProperties()||{};d||(n.clean(),a.clean());const h=e.navigation.viewParams?.parentview;let A="",L={};h&&(L={...L,[o.b.queryTypeParamKey]:`${h}`}),m?m?.id&&(L={...L,[o.b.idParamKey]:`${m?.id}`}):L={...L,[o.b.idParamKey]:`${u?.id}`};let k={};const M=u?.mainLinkInfo;w&&(0,b.a)()&&M?.ShareTokenString&&(void 0===h||parseInt(h,10)===y.a.Files)&&(k={[o.b.shareTokenKey]:M.ShareTokenString});const P=(n=>{let a={};const i=t.viewParams;if(i){for(const e of Object.keys(i))if(e===o.b.queryParamKey||e===o.b.searchScopeKey||e===o.b.meetingIdKey||e===o.b.personIdKey||e===o.b.emailIdKey||e===o.b.pageParamKey||e===o.b.viewIdKey||e===o.b.queryTypeParamKey||o.c.test(e)||e===o.b.sortFieldKey||e===o.b.isAscendingKey||e===o.b.groupByKey||e===o.b.listUrlKey||e===g.a||D&&e===o.b.remoteItem)if(e===o.b.listUrlKey){const t=i[o.b.parentQueryTypeParamKey],n=(0,p.h)(i);t&&"0"!==t||n||(a[e]=i[e])}else a[e]=i[e];if(!(0,f.ac)()){const t=(0,p.c)({key:c.item.key,viewParams:i,defaultRootItemId:e.itemUrlHelper.getItemUrlParts("").serverRelativeItemUrl||""});C&&S(i)&&(delete t[o.b.driveIdParamKey],delete t[o.b.parentDriveIdParamKey]);const r=i[o.b.parentQueryTypeParamKey];!n||r&&"0"!==r||(!O&&i[o.b.webUrlKey]&&(t[o.b.webUrlKey]=i[o.b.webUrlKey]),!E&&i[o.b.routingKey]&&(t[o.b.routingKey]=i[o.b.routingKey])),delete t[o.b.idParamKey],I&&delete t[o.b.navModeKey],x&&r&&"0"!==r&&delete t[o.b.listUrlKey],a={...a,...t}}}return(0,b.a)()&&delete a[o.b.shareTokenKey],a})(!!M);return C&&S(t.viewParams)&&(delete L[o.b.idParamKey],delete P[o.b.idParamKey]),A=(0,s.a)({...L,...P,...k}),A=`${e.isFastOneUpKey?"?":"#"}${A}`,e.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:l.a.close}}),(0,f.ub)()&&window.g_oneUpPathAndQueryString&&(A=-1!==A.search("&view")?A.slice(0,A.search("&view")):A),e.navigation.navigateTo({url:A,ignoreHistory:!0}),{resultType:r.b.Success}}})},k=new a.OJ({name:"CloseAction",factory:{dependencies:A,create:e=>({instance:{evaluateAction:L(e)}})}})}
,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=!n("odsp.util_385").Ov.isActivated("5B291913-1DFD-4DEF-8B87-1AB526D8120B")}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("fui.util_939");function i(){const e=(0,a.kF)();return{...e,palette:{...e.palette,neutralPrimary:"transparent",themeTertiary:"#0F6CBD",themeLight:"#115EA3",themeLighter:"#0F6CBD"}}}}
,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>o});var a=n(271),i=n(116),r=n(168);function o(e){const t=e&&e.replace(/^\./,"");return!(!t||!a.b[t])}function s(e){return!(!e||!e.extension)&&!o(e.extension)&&(r.a||!(0,i.c)(e.extension))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n(20);const i="OneUpUniversalAnnotation.UACommentsPane";var r;function o(e,t){a.a.logData({name:e,scenario:"OneUp Universal Annotation",isIntentional:!0,extraData:{itemType:t}})}!function(e){e[e.UACommentsPane=i]="UACommentsPane",e[e.OpenCommentsFromCommandBar=`${i}.OpenFromCommandBar`]="OpenCommentsFromCommandBar",e[e.CloseCommentsFromCommandBar=`${i}.CloseFromCommandBar`]="CloseCommentsFromCommandBar",e[e.DeleteComment=`${i}.DeleteComment`]="DeleteComment"}(r||(r={}))}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>h});var a=n("odsp.util_385"),i=n(50),r=n(10),o=n(76),s=n(388),c=n(133),d=n(114);const l={pdfViewerHelper:i.b,oneUpStateStore:r.f},u=new a.OJ({name:"ExtractAction",factory:{dependencies:l,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{pdfViewerHelper:n}=t,a=t.oneUpStateStore.currentAppState,i=a.viewerStates?.get(e.item.key)?.pdfViewerStates;return{isAvailable:!!a.isPdfPaidFeaturesEnabled&&n.isPdfExtractAvailable(e.item)&&n.isPdfEditable(e.item)&&!i?.isFileEncrypted&&!i?.isSigned&&!i?.isPdfMip,id:"PdfExtract",isDisabled:!i?.isOpened||c.k&&t.oneUpStateStore.getESignData().isCreateSidePanelActive,onExecute:async()=>{t.oneUpStateStore.state.currentState.annotationViewerState.viewerVisiblity===r.a.On&&t.oneUpStateStore.toggleAnnotationViewerVisiblity(s.a),(0,d.b)()||t.oneUpStateStore.currentAppState.rightPane.type===r.e.none||t.oneUpStateStore.updateRightPaneState("closeRightPaneForPdfExtract",{type:r.e.none,content:void 0}),t.oneUpStateStore.updatePdfState("updatePdfAppMode",o.a.Extract),t.oneUpStateStore.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerConfig:{mode:"close"}}}})}}})}}}}});var f=n(42),p=n(131);const m={actionProvider:u},_="pdfExtractCommand",h=new a.OJ({name:"PdfExtractCommand",factory:{dependencies:m,create:({actionProvider:e})=>{const t={id:_,automationId:_,title:f._b,name:f.hb,iconProps:{iconName:"PdfExtract"},evaluateAction:e.evaluateAction};return(0,p.c)(),{instance:t}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a=n("odsp.util_385"),i=n(50),r=n(10);const o={pdfViewerHelper:i.b,oneUpStateStore:r.f},s=new a.OJ({name:"MergeAction",factory:{dependencies:o,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{pdfViewerHelper:n}=t,a=t.oneUpStateStore.currentAppState,i=a.viewerStates?.get(e.item.key)?.pdfViewerStates;return{isAvailable:!!a.isPdfPaidFeaturesEnabled&&n.isPdfExtractAvailable(e.item)&&n.isPdfEditable(e.item)&&!i?.isFileEncrypted&&!i?.isSigned&&!i?.isPdfMip,id:"PdfMerge",isDisabled:!i?.isOpened,onExecute:async()=>{t.oneUpStateStore.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerConfig:{mode:"merge"}}}})}}})}}}}});var c=n(42);const d={actionProvider:s},l="pdfMergeCommand",u=new a.OJ({name:"PdfMergeCommand",factory:{dependencies:d,create:({actionProvider:e})=>({instance:{id:l,automationId:l,title:c.bb,name:c.gb,iconProps:{iconName:"PdfMerge"},evaluateAction:e.evaluateAction}})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var a=n("react-lib"),i=n("odsp.util_385"),r=n(167);const o="presenceCommand";function s(e){return{id:o,isAvailable:!0,isDisabled:!0}}const c=new i.OJ({name:"PresenceCommand",factory:{dependencies:{},create:()=>{const e=(0,r.a)(async()=>(await n.e(51).then(n.bind(n,843))).PresenceHeaderAsyncDeferred);return{instance:{id:o,automationId:o,onRender:t=>a.createElement(e,null),evaluateAction:s}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>C});var a=n(42),i=n("odsp.util_385"),r=n(374);const o={actionProvider:r.d},s="shareCommand",c=new i.OJ({name:"ShareCommand",factory:{dependencies:o,create:({actionProvider:e})=>({instance:{id:s,name:a.Ab,title:a.Lb,automationId:s,iconProps:{iconName:"Share"},evaluateAction:e.evaluateAction}})}}),d={actionProvider:r.b},l="copyLinkCommand",u=new i.OJ({name:"CopyCommand",factory:{dependencies:d,create:({actionProvider:e})=>({instance:{id:l,name:a.l,title:a.l,automationId:l,iconProps:{iconName:"Link"},evaluateAction:e.evaluateAction}})}}),f={actionProvider:r.c},p="manageAccessCommand",m=new i.OJ({name:"ManageAccessCommand",factory:{dependencies:f,create:({actionProvider:e})=>({instance:{id:p,name:a.X,title:a.X,automationId:p,iconProps:{iconName:"Contact"},evaluateAction:e.evaluateAction}})}});var _=n(191);const h={actionProvider:r.a},b="addAgentToTeamsCommand",g=new i.OJ({name:"AddAgentToTeamsCommand",factory:{dependencies:h,create:({actionProvider:e})=>({instance:{id:b,name:a.c,title:a.d,automationId:b,iconProps:{iconName:"Link"},evaluateAction:e.evaluateAction}})}});var v=n(4),y=n(116),S=n(168);const D={shareCommand:c,copyCommand:u,manageAccessCommand:m,addAgentToTeamsCommand:g},I="shareCommandGroup",x=e=>({isAvailable:S.a||!(0,y.c)(e.item.extension)}),C=new i.OJ({name:"ShareGroupCommand",factory:{dependencies:D,create:e=>{const{addAgentToTeamsCommand:t,shareCommand:n,copyCommand:i,manageAccessCommand:r}=e;return{instance:{id:I,name:a.Ab,automationId:I,subCommands:(0,v.hb)()?[t,n,i,r]:[n,i,r],evaluateAction:x,buttonStyles:(0,_.a)(),iconProps:{iconName:"Share"}}}}}})}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f});var a=n("odsp.util_385"),i=n(50),r=n(10);const o={pdfViewerHelper:i.b,oneUpStateStore:r.f},s=new a.OJ({name:"EncryptAction",factory:{dependencies:o,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{pdfViewerHelper:n}=t,a=t.oneUpStateStore.currentAppState,i=a.viewerStates?.get(e.item.key)?.pdfViewerStates;return{isAvailable:!!a.isPdfPaidFeaturesEnabled&&n.isPdfEncryptAvailable(e.item)&&n.isPdfEditable(e.item)&&!i?.isFileEncrypted&&!i?.isSigned&&!i?.isPdfMip,id:"Pdf",isDisabled:!i?.isOpened,onExecute:async()=>{t.oneUpStateStore.updateViewerState("updatePdfEncryptDialogVisibleState",{key:e.item.key,options:{pdfViewerStates:{pdfEncryptDialogVisible:!0}}})}}})}}}}});var c=n(42),d=n(131);const l={actionProvider:s},u="pdfEncryptCommand",f=new a.OJ({name:"PdfEncryptCommand",factory:{dependencies:l,create:({actionProvider:e})=>{const t={id:u,automationId:u,title:c.pb,name:c.mb,iconProps:{iconName:"PdfEncryptLock"},evaluateAction:e.evaluateAction};return(0,d.b)(),{instance:t}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>f});var a=n("odsp.util_385"),i=n(50),r=n(10);const o={pdfViewerHelper:i.b,oneUpStateStore:r.f},s=new a.OJ({name:"CompressAction",factory:{dependencies:o,create:e=>{var t;return{instance:{evaluateAction:(t=e,e=>{const{pdfViewerHelper:n}=t,a=t.oneUpStateStore.currentAppState,i=a.viewerStates?.get(e.item.key)?.pdfViewerStates;return{isAvailable:!!a.isPdfPaidFeaturesEnabled&&n.isPdfCompressAvailable(e.item)&&n.isPdfEditable(e.item)&&!i?.isFileEncrypted&&!i?.isSigned&&!i?.isPdfMip,id:"PdfCompress",isDisabled:!i?.isOpened,onExecute:async()=>{t.oneUpStateStore.updateViewerState("updatePdfCompressDialogVisibleState",{key:e.item.key,options:{pdfViewerStates:{pdfCompressDialogVisible:!0}}})}}})}}}}});var c=n(42),d=n(131);const l={actionProvider:s},u="pdfCompressCommand",f=new a.OJ({name:"PdfCompressCommand",factory:{dependencies:l,create:({actionProvider:e})=>{const t={id:u,automationId:u,title:c.lb,name:c.ub,iconProps:{iconName:"PdfCompress"},evaluateAction:e.evaluateAction};return(0,d.a)(),{instance:t}}}})}
,,,,,,,,,,,,,,(e,t,n)=>{"use strict";function a(e){return{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:e}}}n.d(t,{a:()=>i});const i={...n(716).a,Pivot:{styles:function(e){const{linkFormat:t,theme:n}=e,{effects:a,semanticColors:i,palette:r}=n,o="tabs"===t,s={border:"2px solid transparent",borderRadius:a.roundedCorner4,height:"44px",lineHeight:"20px",marginRight:0,".ms-Fabric--isFocusVisible &:focus":{border:`2px solid ${i.focusBorder}`,borderRadius:a.roundedCorner4,inset:0,outline:"none"}},c={color:o?i.primaryButtonText:r.themePrimary};return{link:{...s,backgroundColor:"transparent","&:hover::before":{borderRadius:a.roundedCorner4,height:"3px",backgroundColor:o?"transparent":r.neutralQuaternary},"&:hover":{".ms-Pivot-icon":c}},icon:{height:"14px",width:"14px"},linkIsSelected:{...s,"&::before":{borderRadius:a.roundedCorner4,height:"3px"},".ms-Pivot-icon":c}}}},CommandBarButton:{styles:function(e){const{theme:t}=e,{semanticColors:n,effects:i}=t,r={borderRadius:0,borderTopRightRadius:i.roundedCorner6,borderBottomRightRadius:i.roundedCorner6},o={borderRadius:0,borderTopLeftRadius:i.roundedCorner6,borderBottomLeftRadius:i.roundedCorner6},s=function(e){const{effects:t,semanticColors:n}=e,a={borderRadius:0,borderTopRightRadius:t.roundedCorner6,borderBottomRightRadius:t.roundedCorner6},i={borderRadius:0,borderTopLeftRadius:t.roundedCorner6,borderBottomLeftRadius:t.roundedCorner6};return{splitButtonContainer:{borderRadius:t.roundedCorner6,color:n.buttonText,".ms-Button:first-child":{...i,height:"100%"},".ms-Button--primary:hover":{border:"none"}},splitButtonMenuButton:{...a,height:"100%",padding:"0px",width:20},splitButtonContainerFocused:{":focus::after":{inset:"0px",outline:"none",borderRadius:t.roundedCorner6,border:`2px solid ${n.focusBorder}`}},splitButtonMenuFocused:{":focus::after":{inset:"0px",outline:"none",border:`2px solid ${n.focusBorder}`,...a}},splitButtonDivider:{display:"none"},splitButtonDividerDisabled:{display:"none"}}}(t);return{root:{backgroundColor:"transparent",height:"100%",minWidth:"20px",padding:"0px",margin:"0px 2px",borderRadius:i.roundedCorner6,".ms-Fabric--isFocusVisible &:focus::after":{top:4,right:0,bottom:4,left:0,outline:"none",borderRadius:i.roundedCorner6,border:`2px solid ${n.focusBorder}`}},rootHovered:a(n.buttonBackgroundHovered),rootPressed:a(n.buttonBackgroundPressed),rootExpanded:{...a("transparent"),color:"inherit"},rootChecked:a(n.buttonBackgroundChecked),rootCheckedHovered:a(n.buttonBackgroundCheckedHovered),rootCheckedPressed:a(n.buttonBackgroundPressed),rootExpandedHovered:a(n.buttonBackgroundHovered),flexContainer:{height:32,width:32,paddingLeft:0,paddingRight:0,borderRadius:i.roundedCorner6},icon:{color:"inherit"},menuIcon:{color:"inherit",fontSize:"10px"},rootDisabled:{backgroundColor:"transparent"},textContainer:{height:16},...s,splitButtonContainer:{borderRadius:i.roundedCorner6,color:n.buttonText,".ms-Button:first-child":{".ms-Button-flexContainer":{...o,width:"auto",height:30,border:`1px solid ${n.buttonBorder}`,backgroundColor:n.buttonBackground},".ms-Button-textContainer":{width:"auto",minWidth:25,maxWidth:100,marginTop:2}}},splitButtonMenuButton:{...r,height:"100%",padding:"0px",width:20,marginLeft:"-2px",backgroundColor:"transparent",".ms-Button-flexContainer":{...r,height:32,width:32,paddingLeft:4,paddingRight:4},"&:hover":{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:n.buttonBackgroundHovered}}},splitButtonContainerFocused:{":focus::after":{inset:"4px 0px",outline:"none",borderRadius:i.roundedCorner6,border:`2px solid ${n.focusBorder}`}},splitButtonMenuButtonExpanded:{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:n.buttonBackgroundChecked},"&:hover":{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:n.buttonBackgroundCheckedHovered}}},splitButtonFlexContainer:{borderTop:`1px solid ${n.buttonBorder}`,borderRight:`1px solid ${n.buttonBorder}`,borderBottom:`1px solid ${n.buttonBorder}`,backgroundColor:n.buttonBackground,height:"30px !important",width:"auto !important",".ms-Button-textContainer":{marginTop:2}}}}},TeachingBubble:{styles:e=>{const{theme:{palette:t}}=e;return{root:{color:t.black,backgroundColor:t.themePrimary},subText:{color:t.black},headline:{color:t.black},footer:{color:t.black,"& > .ms-StackItem":{display:"flex",flexDirection:"row-reverse"},"& > .ms-StackItem > .ms-Button:not(:first-child)":{margin:"0 15px 0 0"}},subComponentStyles:{callout:{borderRadius:"6px",beak:{borderRadius:0}}},primaryButton:{backgroundColor:t.black,color:t.white,borderColor:t.black,borderRadius:"4px",":hover":{borderColor:t.black,backgroundColor:t.black,color:t.white},":focus":{borderColor:t.black,backgroundColor:t.black,color:t.white}},secondaryButton:{borderColor:t.black,".ms-Button-label":{color:t.black},":hover":{borderColor:t.black,backgroundColor:t.themeSecondary}},closeButton:{backgroundColor:t.themePrimary,color:t.black,":hover":{backgroundColor:t.themeSecondary+"!important",color:t.black}}}}}}}
,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";function a(e){const{viewParams:t,clientName:n}=e,{app:a,scenario:i}=t;let r=!0;try{r=window.parent!==window.self||!!window.opener}catch{}return{Scenario:i||(r?"Unknown":"Default"),ClientName:`${a?`${a}.`:""}${n}`}}function i(e){const{viewParams:t,clientName:n}=e;let i;return i=n&&t?a({viewParams:t,clientName:n}).ClientName:n??t?.app,i}n.d(t,{a:()=>a,b:()=>i})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("odsp.util_385");const i=new a.OJ("onRenderOneUpPlayerHost"),r=new a.OJ("OneUpPlayerHost")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("oneUpPlayerHostInitResourcesKey")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("oneUpOnePlayerEnabled")}
,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)({name:"copilotAppName",factory:{dependencies:{},create:()=>({instance:"OneUp"})}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=!n("odsp.util_385").Ov.isActivated("CF5E8614-A7E0-4200-8C03-658ED1F6B731")}
,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p,b:()=>d,c:()=>r,d:()=>u,e:()=>l,f:()=>o,g:()=>c,h:()=>s,i:()=>f});var a=n("tslib_145"),i=n(37),r=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,792))];case 1:return[2,e.sent().PdfPrintService]}})})},o=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,793))];case 1:return[2,e.sent().PdfThumbnailService]}})})},s=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,794))];case 1:return[2,e.sent().PdfWatermarkService]}})})},c=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,795))];case 1:return[2,e.sent().PdfUndoRedoService]}})})},d=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,796))];case 1:return[2,e.sent().PdfDocumentLoaderByQueue]}})})},l=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,797))];case 1:return[2,e.sent().PdfRotateService]}})})},u=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,798))];case 1:return[2,e.sent().PdfProgressiveLoadingService]}})})},f=function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(null===(t=i.a.features)||void 0===t?void 0:t.enableOptimizedPinch)?[4,n.e(37).then(n.bind(n,799))]:[3,2];case 1:return e=a.sent().Pinchable,[3,4];case 2:return[4,n.e(37).then(n.bind(n,800))];case 3:e=a.sent().Pinchable,a.label=4;case 4:return[2,e]}})})},p=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(37).then(n.bind(n,801))];case 1:return[2,e.sent().FontProvider]}})})}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>_,b:()=>f,c:()=>y,d:()=>a,e:()=>c,f:()=>u,g:()=>p,h:()=>d,i:()=>v,j:()=>s,k:()=>o,l:()=>S,m:()=>b,n:()=>h,o:()=>g,p:()=>m,q:()=>l,r:()=>i,s:()=>r});const a="cid",i="sb",r="sd",o="mid",s="mcid",c="ft",d="ext",l="searchsessionid",u="df",f="beginDate",p="endDate",m="scope",_="authkey",h="redeem",b="v",g="resid",v="ithint",y="challengeToken",S="migratedtospo"}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p});var a=n(27),i=n(49),r=n(13),o=n("odsp.util_385"),s=n(4),c=n(159),d=n(504),l=n(276),u=n(531);const f={resourceScope:o.sp,navigation:a.a,engagementContext:l.a},p=new o.OJ({name:"ListItemRetrieverHelper",factory:{dependencies:f,create:({resourceScope:e,navigation:t,engagementContext:n})=>{const a=!(0,s.Ac)()&&e.consume(c.a);return{instance:{getCurrentItem:function(o){const{idViewParam:s,webAbsoluteUrl:c,fullListUrl:l,serverRelativeFocusItemUrl:f,listContext:p,pageContext:m,cidViewParam:_}=(0,u.a)(e),h=new i.a({},{pageContext:m}),{isCrossList:b,isCrossDomain:g,geoRelation:v}=h.getItemUrlParts(window.location.href),y=c&&l?{pageContext:m,id:s?f:void 0,odcId:_&&!a?s:void 0,webAbsoluteUrl:c,listFullUrl:l,listContext:p,extraLoggingData:{isCrossList:b,isCrossDomain:g,isCrossGeo:v!==r.a.sameGeo,correlationId:m.CorrelationId,engagementContext:n,isShareLinkRedeeming:void 0!==t.viewParams.ga}}:void 0;return y?new d.a(y).getSingleItem(o):Promise.resolve(void 0)}}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(503),i=n(257);function r(e){const{webAbsoluteUrl:t,listFullUrl:n,listContext:r,parentFolderPath:o,resourceScope:s,spGetItemResponse:c,currentPageContext:d}=e,l=c.ListData&&c.ListData.Row&&c.ListData.Row[0];if(l){const e={itemId:l.ID,listFullUrl:n,rootFolder:"",webAbsoluteUrl:t},u=o?{itemId:"",listFullUrl:n,rootFolder:o,webAbsoluteUrl:t}:void 0,f=s.consume(i.a),p=(0,a.a)(c);return f.processOneUpItem({itemFromServer:l,spItemIdentity:e,spParentItemIdentity:u,listContext:r,mediaTransformListSchema:p,currentPageContext:d})}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=new(n("odsp.util_385").OJ)("people")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s});var a=n(59),i=n(1),r=n(98),o=n(213);const s=(0,n("odsp.util_385").A)("DataRequestor",a.b,{pageContext:i.a,offlineDetection:r.a,noRedirect:o.a}),c=a.b}
,,(e,t,n)=>{"use strict";function a(){return window.location!==window.parent.location}function i(){var e=window;return e.parent===e&&!e.opener&&void 0!==e.external&&("messageToHost"in e.external||"notify"in e.external)}n.d(t,{a:()=>a,b:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>f,b:()=>r});var a=n("tslib_145"),i=n("fui.util_939"),r="#141414",o={neutralDark:"#201f1e",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",neutralPrimary:"#323130",neutralTertiary:"#616161",neutralSecondary:"#605e5c",neutralQuaternaryAlt:"#8a8886",neutralQuaternary:"#d2d0ce",neutralSecondaryAlt:"#8a8886",themeDark:"#005a9e",themePrimary:"#0078d4",white:"#ffffff",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeLighter:"#deecf9"},s={bodyBackground:"#faf9f8",menuBackground:"#ffffff",menuItemBackgroundHovered:"#f3f2f1",menuItemBackgroundPressed:"#f3f2f1",menuDivider:"#c8c6c4",menuIcon:"#605e5c",menuItemText:"#323130",menuItemTextHovered:o.neutralDark,inputBackground:"#ffffff",inputBorder:"#bebbb8",inputText:"#323130",inputPlaceholderText:"#605e5c",primaryButtonBackgroundDisabled:o.neutralLighter,primaryButtonTextDisabled:o.neutralQuaternary,primaryButtonBackgroundPressed:o.themeDark,primaryButtonText:o.white,primaryButtonTextHovered:o.white,primaryButtonTextPressed:o.white,disabledText:o.neutralTertiary,bodySubtext:o.neutralSecondary,buttonBackgroundPressed:o.neutralLight,buttonBackgroundHovered:o.neutralLighter,buttonTextDisabled:o.neutralTertiary,buttonBorderDisabled:"#bdbdbd",cardStandoutBackground:"#ebf3fc",cardShadowHovered:"#b4d6fa",listText:"#242424",disabledBorder:"#707070",messageLink:"#115ea3",messageLinkHovered:"#0f548c",primaryButtonBorder:"#424242"},c={neutralDark:"#f3f2f1",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",neutralPrimary:"#f3f2f1",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralSecondaryAlt:"#979693",themeDark:"#faf9f8",themePrimary:"#2899f5",white:"#1b1a19",themeLight:"#004c87",themeTertiary:"#0078D4",themeLighter:"#043862"},d={bodyBackground:"#201f1e",menuBackground:c.neutralLighter,menuItemBackgroundHovered:c.neutralQuaternaryAlt,menuItemBackgroundPressed:c.neutralQuaternary,menuDivider:"#BEBBB8",menuIcon:"#FFFFFF",menuItemText:"#F3F2F1",menuItemTextHovered:"#F3F2F1",inputBackground:"#292929",inputBorder:"#bebbb8",inputText:"#F3F2F1",inputPlaceholderText:"#999999",primaryButtonBackgroundDisabled:"#252423",primaryButtonTextDisabled:"#605E5C",primaryButtonBackgroundPressed:"#043862",primaryButtonText:"#FFFFFF",primaryButtonTextHovered:"#FFFFFF",primaryButtonTextPressed:"#FFFFFF",disabledText:"#A19F9D",bodySubtext:"#A19F9D",buttonBackgroundPressed:"#292827",buttonBackgroundHovered:"#424242",buttonTextDisabled:"#797775",buttonBorderDisabled:"#5C5C5C",cardStandoutBackground:"#082338",cardShadowHovered:"#0e4775",listText:"#ffffff",disabledBorder:"#999999",messageLink:"#479ef5",messageLinkHovered:"#62abf5",primaryButtonBorder:"#D6D6D6"},l=(0,i.es)({palette:o,semanticColors:s}),u=(0,i.es)({palette:c,semanticColors:d,isInverted:!0}),f=function(e,t){if(void 0===t&&(t=!1),!e)return t?u:l;var n=e.palette,r=e.semanticColors,f=(0,a.dc)(e,["palette","semanticColors"]),p=(0,a.q5)({palette:t?(0,a.q5)((0,a.q5)({},c),n):(0,a.q5)((0,a.q5)({},o),n),semanticColors:t?(0,a.q5)((0,a.q5)({},d),r):(0,a.q5)((0,a.q5)({},s),r),isInverted:(null==e?void 0:e.isInverted)||t},f);return(0,i.es)(p)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a}),(0,n("fui.util_939").ZW)([{rawString:"#printContainer_08edcb3d{display:none}@media print{body{background:rgba(0,0,0,0)}body[data-pdfprinting]>*{display:none}body[data-pdfprinting]>#printContainer_08edcb3d{display:block;height:100%}body[data-pdfprinting]>#printContainer_08edcb3d>div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:100%;page-break-after:always;page-break-inside:avoid}body[data-pdfprinting]>#printContainer_08edcb3d>div img{max-width:100%;max-height:100%}}"}]);const a="printContainer_08edcb3d"}
],t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e;var a=document.currentScript,i=window,r=i.require,o=i.__launchpad;function s(e){var t=e&&e.indexOf("/",e.indexOf("://")+3)+1;return t?e.slice(0,t):e}var c,d,l,u,f,p=s(a&&a.src||r&&r.toUrl("")),m=s(i.__backupBaseUrl),_=r&&r.s&&r.s.contexts&&r.s.contexts._,h=i.__odspSriHashes;h&&0===Object.keys(h).length&&(h=void 0),n.amdO={},c=[],n.O=(e,t,a,i)=>{if(!t){var r=1/0;for(l=0;l<c.length;l++){for(var[t,a,i]=c[l],o=!0,s=0;s<t.length;s++)(!1&i||r>=i)&&Object.keys(n.O).every(e=>n.O[e](t[s]))?t.splice(s--,1):(o=!1,i<r&&(r=i));if(o){c.splice(l--,1);var d=a();void 0!==d&&(e=d)}}return e}i=i||0;for(var l=c.length;l>0&&c[l-1][2]>i;l--)c[l]=c[l-1];c[l]=[t,a,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},l=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var a=Object.create(null);n.r(a);var i={};d=d||[null,l({}),l([]),l(l)];for(var r=2&t&&e;"object"==typeof r&&!~d.indexOf(r);r=l(r))Object.getOwnPropertyNames(r).forEach(t=>i[t]=()=>e[t]);return i.default=()=>e,n.d(a,i),a},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,a)=>(n.f[a](e,t),t),[])),n.u=e=>"odsp.1ds.lib"===e?"odsp.1ds.lib.js":({"ondemand.resx":1,"odsp.1ds.lib":1}[e]?self.__odsp_culture+"/":"")+e+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u={},f="__webpack_result__:",n.l=(e,t,a,r)=>{if(u[e])u[e].push(t);else{var o,s;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var l=c[d];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==f+a){o=l;break}}if(!o){s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",f+a),o.setAttribute("fetchpriority","high"),o.src=e,0!==o.src.indexOf(window.location.origin+"/")&&(o.crossOrigin="anonymous");var p=function(e){var t;return h&&(t=h[i.__odsp_culture+"/"+e]||h[e]||"sha256-Missing+Integrity+Hash+For+Script+Aborting="),t}(r);p&&(o.integrity=p)}u[e]=[t];var m=(t,n)=>{o.onerror=o.onload=null,clearTimeout(_);var a=u[e];if(delete u[e],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(n)),t)return t(n)},_=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),s&&document.head.appendChild(o)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var i=a.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=a[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{n.b=document.baseURI||self.location.href;var e={oneuplightspeedwebpack:0};n.f.j=(t,a)=>{var r=t.toString(),s=o&&o.getScriptUrl(r),c=_&&_.config.paths[r]&&_.nameToUrl(r),d=(o?s:c)||n.p+n.u(t);function l(t){var a=n.o(e,t)?e[t]:void 0;if(0!==a){if(a)return a;var i=new Promise((n,i)=>a=e[t]=[n,i]);a[2]=i,a[3]=d;var r=new Error;return n.l(d,i=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;r.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",r.loggableMessage={__isPrivacyDataWrapper:!0,_value:"Loading chunk "+t+" failed.\n("+o+": "+s+")",_type:"safe"},r.name="ChunkLoadError",r.type=o,r.request=s,r.chunkId=t,r.extraData={type:o,url:s,chunkId:t,qosName:"ChunkLoadError"},a[1](r)}},"chunk-"+t,t),a}}var u=l(t);u&&(o?a.push(u[2]):a.push(u[2].catch(function(e){var n=i.__integrityViolationCallBack;n&&n(e.request);var a=i.__swChunkLoadErrorHandler;a&&a(e.request);var r=u[3],o=m&&r.replace(p,m);if(o&&o!==r){d=o;var s=l(t);return s&&s[2]}return Promise.reject(e)})))},n.O.j=t=>0===e[t];var t=(t,a)=>{var i,r,[o,s,c]=a,d=0;if(o.some(t=>0!==e[t])){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)var l=c(n)}for(t&&t(a);d<o.length;d++)r=o[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},a=self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),(()=>{var e=window.__launchpad;e&&(n.l=(t,n,a,i)=>{e.loadScript(t,n,void 0,"anonymous",void 0,12e4,"utf-8")})})();var b=n.O(void 0,["odsp.react.lib","fui.util","odsp.util","tslib","fui.core","initial.resx","plt.office-ui-fabric-react","plt.odsp-common","plt.items-view"],()=>n(462));b=n.O(b),__webpack_result__=b})(),define("oneuplightspeedwebpack",[],{});